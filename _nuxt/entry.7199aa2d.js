function AO(t,e){for(var n=0;n<e.length;n++){const s=e[n];if(typeof s!="string"&&!Array.isArray(s)){for(const o in s)if(o!=="default"&&!(o in t)){const r=Object.getOwnPropertyDescriptor(s,o);r&&Object.defineProperty(t,o,r.get?r:{enumerable:!0,get:()=>s[o]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}function vb(t,e){const n=Object.create(null),s=t.split(",");for(let o=0;o<s.length;o++)n[s[o]]=!0;return e?o=>!!n[o.toLowerCase()]:o=>!!n[o]}const RO="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",DO=vb(RO);function o$(t){return!!t||t===""}function jd(t){if(je(t)){const e={};for(let n=0;n<t.length;n++){const s=t[n],o=cn(s)?LO(s):jd(s);if(o)for(const r in o)e[r]=o[r]}return e}else{if(cn(t))return t;if(Ut(t))return t}}const OO=/;(?![^(]*\))/g,FO=/:(.+)/;function LO(t){const e={};return t.split(OO).forEach(n=>{if(n){const s=n.split(FO);s.length>1&&(e[s[0].trim()]=s[1].trim())}}),e}function Sr(t){let e="";if(cn(t))e=t;else if(je(t))for(let n=0;n<t.length;n++){const s=Sr(t[n]);s&&(e+=s+" ")}else if(Ut(t))for(const n in t)t[n]&&(e+=n+" ");return e.trim()}function Xhe(t){if(!t)return null;let{class:e,style:n}=t;return e&&!cn(e)&&(t.class=Sr(e)),n&&(t.style=jd(n)),t}const Ro=t=>cn(t)?t:t==null?"":je(t)||Ut(t)&&(t.toString===l$||!Xe(t.toString))?JSON.stringify(t,r$,2):String(t),r$=(t,e)=>e&&e.__v_isRef?r$(t,e.value):za(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((n,[s,o])=>(n[`${s} =>`]=o,n),{})}:i$(e)?{[`Set(${e.size})`]:[...e.values()]}:Ut(e)&&!je(e)&&!c$(e)?String(e):e,Lt={},Va=[],fo=()=>{},PO=()=>!1,MO=/^on[^a-z]/,Fc=t=>MO.test(t),wb=t=>t.startsWith("onUpdate:"),On=Object.assign,Cb=(t,e)=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},BO=Object.prototype.hasOwnProperty,ft=(t,e)=>BO.call(t,e),je=Array.isArray,za=t=>qd(t)==="[object Map]",i$=t=>qd(t)==="[object Set]",Xe=t=>typeof t=="function",cn=t=>typeof t=="string",$b=t=>typeof t=="symbol",Ut=t=>t!==null&&typeof t=="object",a$=t=>Ut(t)&&Xe(t.then)&&Xe(t.catch),l$=Object.prototype.toString,qd=t=>l$.call(t),VO=t=>qd(t).slice(8,-1),c$=t=>qd(t)==="[object Object]",Ib=t=>cn(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,lc=vb(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Kd=t=>{const e=Object.create(null);return n=>e[n]||(e[n]=t(n))},zO=/-(\w)/g,Vo=Kd(t=>t.replace(zO,(e,n)=>n?n.toUpperCase():"")),WO=/\B([A-Z])/g,bl=Kd(t=>t.replace(WO,"-$1").toLowerCase()),Xd=Kd(t=>t.charAt(0).toUpperCase()+t.slice(1)),km=Kd(t=>t?`on${Xd(t)}`:""),xc=(t,e)=>!Object.is(t,e),cc=(t,e)=>{for(let n=0;n<t.length;n++)t[n](e)},rd=(t,e,n)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,value:n})},_b=t=>{const e=parseFloat(t);return isNaN(e)?t:e};let h1;const UO=()=>h1||(h1=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});let Io;class HO{constructor(e=!1){this.active=!0,this.effects=[],this.cleanups=[],!e&&Io&&(this.parent=Io,this.index=(Io.scopes||(Io.scopes=[])).push(this)-1)}run(e){if(this.active){const n=Io;try{return Io=this,e()}finally{Io=n}}}on(){Io=this}off(){Io=this.parent}stop(e){if(this.active){let n,s;for(n=0,s=this.effects.length;n<s;n++)this.effects[n].stop();for(n=0,s=this.cleanups.length;n<s;n++)this.cleanups[n]();if(this.scopes)for(n=0,s=this.scopes.length;n<s;n++)this.scopes[n].stop(!0);if(this.parent&&!e){const o=this.parent.scopes.pop();o&&o!==this&&(this.parent.scopes[this.index]=o,o.index=this.index)}this.active=!1}}}function GO(t,e=Io){e&&e.active&&e.effects.push(t)}const kb=t=>{const e=new Set(t);return e.w=0,e.n=0,e},u$=t=>(t.w&Pr)>0,h$=t=>(t.n&Pr)>0,jO=({deps:t})=>{if(t.length)for(let e=0;e<t.length;e++)t[e].w|=Pr},qO=t=>{const{deps:e}=t;if(e.length){let n=0;for(let s=0;s<e.length;s++){const o=e[s];u$(o)&&!h$(o)?o.delete(t):e[n++]=o,o.w&=~Pr,o.n&=~Pr}e.length=n}},ig=new WeakMap;let Ql=0,Pr=1;const ag=30;let uo;const Ri=Symbol(""),lg=Symbol("");class Eb{constructor(e,n=null,s){this.fn=e,this.scheduler=n,this.active=!0,this.deps=[],this.parent=void 0,GO(this,s)}run(){if(!this.active)return this.fn();let e=uo,n=Ar;for(;e;){if(e===this)return;e=e.parent}try{return this.parent=uo,uo=this,Ar=!0,Pr=1<<++Ql,Ql<=ag?jO(this):d1(this),this.fn()}finally{Ql<=ag&&qO(this),Pr=1<<--Ql,uo=this.parent,Ar=n,this.parent=void 0,this.deferStop&&this.stop()}}stop(){uo===this?this.deferStop=!0:this.active&&(d1(this),this.onStop&&this.onStop(),this.active=!1)}}function d1(t){const{deps:e}=t;if(e.length){for(let n=0;n<e.length;n++)e[n].delete(t);e.length=0}}let Ar=!0;const d$=[];function xl(){d$.push(Ar),Ar=!1}function yl(){const t=d$.pop();Ar=t===void 0?!0:t}function ks(t,e,n){if(Ar&&uo){let s=ig.get(t);s||ig.set(t,s=new Map);let o=s.get(n);o||s.set(n,o=kb()),f$(o)}}function f$(t,e){let n=!1;Ql<=ag?h$(t)||(t.n|=Pr,n=!u$(t)):n=!t.has(uo),n&&(t.add(uo),uo.deps.push(t))}function or(t,e,n,s,o,r){const i=ig.get(t);if(!i)return;let a=[];if(e==="clear")a=[...i.values()];else if(n==="length"&&je(t))i.forEach((l,c)=>{(c==="length"||c>=s)&&a.push(l)});else switch(n!==void 0&&a.push(i.get(n)),e){case"add":je(t)?Ib(n)&&a.push(i.get("length")):(a.push(i.get(Ri)),za(t)&&a.push(i.get(lg)));break;case"delete":je(t)||(a.push(i.get(Ri)),za(t)&&a.push(i.get(lg)));break;case"set":za(t)&&a.push(i.get(Ri));break}if(a.length===1)a[0]&&cg(a[0]);else{const l=[];for(const c of a)c&&l.push(...c);cg(kb(l))}}function cg(t,e){const n=je(t)?t:[...t];for(const s of n)s.computed&&f1(s);for(const s of n)s.computed||f1(s)}function f1(t,e){(t!==uo||t.allowRecurse)&&(t.scheduler?t.scheduler():t.run())}const KO=vb("__proto__,__v_isRef,__isVue"),p$=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter($b)),XO=Sb(),YO=Sb(!1,!0),ZO=Sb(!0),p1=QO();function QO(){const t={};return["includes","indexOf","lastIndexOf"].forEach(e=>{t[e]=function(...n){const s=yt(this);for(let r=0,i=this.length;r<i;r++)ks(s,"get",r+"");const o=s[e](...n);return o===-1||o===!1?s[e](...n.map(yt)):o}}),["push","pop","shift","unshift","splice"].forEach(e=>{t[e]=function(...n){xl();const s=yt(this)[e].apply(this,n);return yl(),s}}),t}function Sb(t=!1,e=!1){return function(s,o,r){if(o==="__v_isReactive")return!t;if(o==="__v_isReadonly")return t;if(o==="__v_isShallow")return e;if(o==="__v_raw"&&r===(t?e?pF:y$:e?x$:b$).get(s))return s;const i=je(s);if(!t&&i&&ft(p1,o))return Reflect.get(p1,o,r);const a=Reflect.get(s,o,r);return($b(o)?p$.has(o):KO(o))||(t||ks(s,"get",o),e)?a:bn(a)?i&&Ib(o)?a:a.value:Ut(a)?t?v$(a):zo(a):a}}const JO=m$(),eF=m$(!0);function m$(t=!1){return function(n,s,o,r){let i=n[s];if(Ya(i)&&bn(i)&&!bn(o))return!1;if(!t&&(!id(o)&&!Ya(o)&&(i=yt(i),o=yt(o)),!je(n)&&bn(i)&&!bn(o)))return i.value=o,!0;const a=je(n)&&Ib(s)?Number(s)<n.length:ft(n,s),l=Reflect.set(n,s,o,r);return n===yt(r)&&(a?xc(o,i)&&or(n,"set",s,o):or(n,"add",s,o)),l}}function tF(t,e){const n=ft(t,e);t[e];const s=Reflect.deleteProperty(t,e);return s&&n&&or(t,"delete",e,void 0),s}function nF(t,e){const n=Reflect.has(t,e);return(!$b(e)||!p$.has(e))&&ks(t,"has",e),n}function sF(t){return ks(t,"iterate",je(t)?"length":Ri),Reflect.ownKeys(t)}const g$={get:XO,set:JO,deleteProperty:tF,has:nF,ownKeys:sF},oF={get:ZO,set(t,e){return!0},deleteProperty(t,e){return!0}},rF=On({},g$,{get:YO,set:eF}),Tb=t=>t,Yd=t=>Reflect.getPrototypeOf(t);function Sh(t,e,n=!1,s=!1){t=t.__v_raw;const o=yt(t),r=yt(e);n||(e!==r&&ks(o,"get",e),ks(o,"get",r));const{has:i}=Yd(o),a=s?Tb:n?Db:yc;if(i.call(o,e))return a(t.get(e));if(i.call(o,r))return a(t.get(r));t!==o&&t.get(e)}function Th(t,e=!1){const n=this.__v_raw,s=yt(n),o=yt(t);return e||(t!==o&&ks(s,"has",t),ks(s,"has",o)),t===o?n.has(t):n.has(t)||n.has(o)}function Nh(t,e=!1){return t=t.__v_raw,!e&&ks(yt(t),"iterate",Ri),Reflect.get(t,"size",t)}function m1(t){t=yt(t);const e=yt(this);return Yd(e).has.call(e,t)||(e.add(t),or(e,"add",t,t)),this}function g1(t,e){e=yt(e);const n=yt(this),{has:s,get:o}=Yd(n);let r=s.call(n,t);r||(t=yt(t),r=s.call(n,t));const i=o.call(n,t);return n.set(t,e),r?xc(e,i)&&or(n,"set",t,e):or(n,"add",t,e),this}function b1(t){const e=yt(this),{has:n,get:s}=Yd(e);let o=n.call(e,t);o||(t=yt(t),o=n.call(e,t)),s&&s.call(e,t);const r=e.delete(t);return o&&or(e,"delete",t,void 0),r}function x1(){const t=yt(this),e=t.size!==0,n=t.clear();return e&&or(t,"clear",void 0,void 0),n}function Ah(t,e){return function(s,o){const r=this,i=r.__v_raw,a=yt(i),l=e?Tb:t?Db:yc;return!t&&ks(a,"iterate",Ri),i.forEach((c,u)=>s.call(o,l(c),l(u),r))}}function Rh(t,e,n){return function(...s){const o=this.__v_raw,r=yt(o),i=za(r),a=t==="entries"||t===Symbol.iterator&&i,l=t==="keys"&&i,c=o[t](...s),u=n?Tb:e?Db:yc;return!e&&ks(r,"iterate",l?lg:Ri),{next(){const{value:h,done:d}=c.next();return d?{value:h,done:d}:{value:a?[u(h[0]),u(h[1])]:u(h),done:d}},[Symbol.iterator](){return this}}}}function yr(t){return function(...e){return t==="delete"?!1:this}}function iF(){const t={get(r){return Sh(this,r)},get size(){return Nh(this)},has:Th,add:m1,set:g1,delete:b1,clear:x1,forEach:Ah(!1,!1)},e={get(r){return Sh(this,r,!1,!0)},get size(){return Nh(this)},has:Th,add:m1,set:g1,delete:b1,clear:x1,forEach:Ah(!1,!0)},n={get(r){return Sh(this,r,!0)},get size(){return Nh(this,!0)},has(r){return Th.call(this,r,!0)},add:yr("add"),set:yr("set"),delete:yr("delete"),clear:yr("clear"),forEach:Ah(!0,!1)},s={get(r){return Sh(this,r,!0,!0)},get size(){return Nh(this,!0)},has(r){return Th.call(this,r,!0)},add:yr("add"),set:yr("set"),delete:yr("delete"),clear:yr("clear"),forEach:Ah(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(r=>{t[r]=Rh(r,!1,!1),n[r]=Rh(r,!0,!1),e[r]=Rh(r,!1,!0),s[r]=Rh(r,!0,!0)}),[t,n,e,s]}const[aF,lF,cF,uF]=iF();function Nb(t,e){const n=e?t?uF:cF:t?lF:aF;return(s,o,r)=>o==="__v_isReactive"?!t:o==="__v_isReadonly"?t:o==="__v_raw"?s:Reflect.get(ft(n,o)&&o in s?n:s,o,r)}const hF={get:Nb(!1,!1)},dF={get:Nb(!1,!0)},fF={get:Nb(!0,!1)},b$=new WeakMap,x$=new WeakMap,y$=new WeakMap,pF=new WeakMap;function mF(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function gF(t){return t.__v_skip||!Object.isExtensible(t)?0:mF(VO(t))}function zo(t){return Ya(t)?t:Ab(t,!1,g$,hF,b$)}function bF(t){return Ab(t,!1,rF,dF,x$)}function v$(t){return Ab(t,!0,oF,fF,y$)}function Ab(t,e,n,s,o){if(!Ut(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const r=o.get(t);if(r)return r;const i=gF(t);if(i===0)return t;const a=new Proxy(t,i===2?s:n);return o.set(t,a),a}function Wa(t){return Ya(t)?Wa(t.__v_raw):!!(t&&t.__v_isReactive)}function Ya(t){return!!(t&&t.__v_isReadonly)}function id(t){return!!(t&&t.__v_isShallow)}function w$(t){return Wa(t)||Ya(t)}function yt(t){const e=t&&t.__v_raw;return e?yt(e):t}function Rb(t){return rd(t,"__v_skip",!0),t}const yc=t=>Ut(t)?zo(t):t,Db=t=>Ut(t)?v$(t):t;function C$(t){Ar&&uo&&(t=yt(t),f$(t.dep||(t.dep=kb())))}function $$(t,e){t=yt(t),t.dep&&cg(t.dep)}function bn(t){return!!(t&&t.__v_isRef===!0)}function Di(t){return I$(t,!1)}function ad(t){return I$(t,!0)}function I$(t,e){return bn(t)?t:new xF(t,e)}class xF{constructor(e,n){this.__v_isShallow=n,this.dep=void 0,this.__v_isRef=!0,this._rawValue=n?e:yt(e),this._value=n?e:yc(e)}get value(){return C$(this),this._value}set value(e){const n=this.__v_isShallow||id(e)||Ya(e);e=n?e:yt(e),xc(e,this._rawValue)&&(this._rawValue=e,this._value=n?e:yc(e),$$(this))}}function ts(t){return bn(t)?t.value:t}const yF={get:(t,e,n)=>ts(Reflect.get(t,e,n)),set:(t,e,n,s)=>{const o=t[e];return bn(o)&&!bn(n)?(o.value=n,!0):Reflect.set(t,e,n,s)}};function _$(t){return Wa(t)?t:new Proxy(t,yF)}class vF{constructor(e,n,s){this._object=e,this._key=n,this._defaultValue=s,this.__v_isRef=!0}get value(){const e=this._object[this._key];return e===void 0?this._defaultValue:e}set value(e){this._object[this._key]=e}}function k$(t,e,n){const s=t[e];return bn(s)?s:new vF(t,e,n)}var E$;class wF{constructor(e,n,s,o){this._setter=n,this.dep=void 0,this.__v_isRef=!0,this[E$]=!1,this._dirty=!0,this.effect=new Eb(e,()=>{this._dirty||(this._dirty=!0,$$(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!o,this.__v_isReadonly=s}get value(){const e=yt(this);return C$(e),(e._dirty||!e._cacheable)&&(e._dirty=!1,e._value=e.effect.run()),e._value}set value(e){this._setter(e)}}E$="__v_isReadonly";function CF(t,e,n=!1){let s,o;const r=Xe(t);return r?(s=t,o=fo):(s=t.get,o=t.set),new wF(s,o,r||!o,n)}function Rr(t,e,n,s){let o;try{o=s?t(...s):t()}catch(r){vl(r,e,n)}return o}function Gs(t,e,n,s){if(Xe(t)){const r=Rr(t,e,n,s);return r&&a$(r)&&r.catch(i=>{vl(i,e,n)}),r}const o=[];for(let r=0;r<t.length;r++)o.push(Gs(t[r],e,n,s));return o}function vl(t,e,n,s=!0){const o=e?e.vnode:null;if(e){let r=e.parent;const i=e.proxy,a=n;for(;r;){const c=r.ec;if(c){for(let u=0;u<c.length;u++)if(c[u](t,i,a)===!1)return}r=r.parent}const l=e.appContext.config.errorHandler;if(l){Rr(l,null,10,[t,i,a]);return}}$F(t,n,o,s)}function $F(t,e,n,s=!0){console.error(t)}let vc=!1,ug=!1;const Vn=[];let No=0;const Ua=[];let Qo=null,Ii=0;const S$=Promise.resolve();let Ob=null;function Fb(t){const e=Ob||S$;return t?e.then(this?t.bind(this):t):e}function IF(t){let e=No+1,n=Vn.length;for(;e<n;){const s=e+n>>>1;wc(Vn[s])<t?e=s+1:n=s}return e}function Zd(t){(!Vn.length||!Vn.includes(t,vc&&t.allowRecurse?No+1:No))&&(t.id==null?Vn.push(t):Vn.splice(IF(t.id),0,t),T$())}function T$(){!vc&&!ug&&(ug=!0,Ob=S$.then(A$))}function _F(t){const e=Vn.indexOf(t);e>No&&Vn.splice(e,1)}function N$(t){je(t)?Ua.push(...t):(!Qo||!Qo.includes(t,t.allowRecurse?Ii+1:Ii))&&Ua.push(t),T$()}function y1(t,e=vc?No+1:0){for(;e<Vn.length;e++){const n=Vn[e];n&&n.pre&&(Vn.splice(e,1),e--,n())}}function ld(t){if(Ua.length){const e=[...new Set(Ua)];if(Ua.length=0,Qo){Qo.push(...e);return}for(Qo=e,Qo.sort((n,s)=>wc(n)-wc(s)),Ii=0;Ii<Qo.length;Ii++)Qo[Ii]();Qo=null,Ii=0}}const wc=t=>t.id==null?1/0:t.id,kF=(t,e)=>{const n=wc(t)-wc(e);if(n===0){if(t.pre&&!e.pre)return-1;if(e.pre&&!t.pre)return 1}return n};function A$(t){ug=!1,vc=!0,Vn.sort(kF);const e=fo;try{for(No=0;No<Vn.length;No++){const n=Vn[No];n&&n.active!==!1&&Rr(n,null,14)}}finally{No=0,Vn.length=0,ld(),vc=!1,Ob=null,(Vn.length||Ua.length)&&A$()}}function EF(t,e,...n){if(t.isUnmounted)return;const s=t.vnode.props||Lt;let o=n;const r=e.startsWith("update:"),i=r&&e.slice(7);if(i&&i in s){const u=`${i==="modelValue"?"model":i}Modifiers`,{number:h,trim:d}=s[u]||Lt;d&&(o=n.map(f=>f.trim())),h&&(o=n.map(_b))}let a,l=s[a=km(e)]||s[a=km(Vo(e))];!l&&r&&(l=s[a=km(bl(e))]),l&&Gs(l,t,6,o);const c=s[a+"Once"];if(c){if(!t.emitted)t.emitted={};else if(t.emitted[a])return;t.emitted[a]=!0,Gs(c,t,6,o)}}function R$(t,e,n=!1){const s=e.emitsCache,o=s.get(t);if(o!==void 0)return o;const r=t.emits;let i={},a=!1;if(!Xe(t)){const l=c=>{const u=R$(c,e,!0);u&&(a=!0,On(i,u))};!n&&e.mixins.length&&e.mixins.forEach(l),t.extends&&l(t.extends),t.mixins&&t.mixins.forEach(l)}return!r&&!a?(Ut(t)&&s.set(t,null),null):(je(r)?r.forEach(l=>i[l]=null):On(i,r),Ut(t)&&s.set(t,i),i)}function Qd(t,e){return!t||!Fc(e)?!1:(e=e.slice(2).replace(/Once$/,""),ft(t,e[0].toLowerCase()+e.slice(1))||ft(t,bl(e))||ft(t,e))}let ns=null,Jd=null;function cd(t){const e=ns;return ns=t,Jd=t&&t.type.__scopeId||null,e}function D$(t){Jd=t}function O$(){Jd=null}function Wi(t,e=ns,n){if(!e||t._n)return t;const s=(...o)=>{s._d&&R1(-1);const r=cd(e),i=t(...o);return cd(r),s._d&&R1(1),i};return s._n=!0,s._c=!0,s._d=!0,s}function Em(t){const{type:e,vnode:n,proxy:s,withProxy:o,props:r,propsOptions:[i],slots:a,attrs:l,emit:c,render:u,renderCache:h,data:d,setupState:f,ctx:p,inheritAttrs:g}=t;let b,x;const y=cd(t);try{if(n.shapeFlag&4){const v=o||s;b=Ls(u.call(v,v,h,r,f,d,p)),x=l}else{const v=e;b=Ls(v.length>1?v(r,{attrs:l,slots:a,emit:c}):v(r,null)),x=e.props?l:TF(l)}}catch(v){hc.length=0,vl(v,t,1),b=He(ss)}let w=b;if(x&&g!==!1){const v=Object.keys(x),{shapeFlag:$}=w;v.length&&$&7&&(i&&v.some(wb)&&(x=NF(x,i)),w=rr(w,x))}return n.dirs&&(w=rr(w),w.dirs=w.dirs?w.dirs.concat(n.dirs):n.dirs),n.transition&&(w.transition=n.transition),b=w,cd(y),b}function SF(t){let e;for(let n=0;n<t.length;n++){const s=t[n];if(Qa(s)){if(s.type!==ss||s.children==="v-if"){if(e)return;e=s}}else return}return e}const TF=t=>{let e;for(const n in t)(n==="class"||n==="style"||Fc(n))&&((e||(e={}))[n]=t[n]);return e},NF=(t,e)=>{const n={};for(const s in t)(!wb(s)||!(s.slice(9)in e))&&(n[s]=t[s]);return n};function AF(t,e,n){const{props:s,children:o,component:r}=t,{props:i,children:a,patchFlag:l}=e,c=r.emitsOptions;if(e.dirs||e.transition)return!0;if(n&&l>=0){if(l&1024)return!0;if(l&16)return s?v1(s,i,c):!!i;if(l&8){const u=e.dynamicProps;for(let h=0;h<u.length;h++){const d=u[h];if(i[d]!==s[d]&&!Qd(c,d))return!0}}}else return(o||a)&&(!a||!a.$stable)?!0:s===i?!1:s?i?v1(s,i,c):!0:!!i;return!1}function v1(t,e,n){const s=Object.keys(e);if(s.length!==Object.keys(t).length)return!0;for(let o=0;o<s.length;o++){const r=s[o];if(e[r]!==t[r]&&!Qd(n,r))return!0}return!1}function Lb({vnode:t,parent:e},n){for(;e&&e.subTree===t;)(t=e.vnode).el=n,e=e.parent}const F$=t=>t.__isSuspense,RF={name:"Suspense",__isSuspense:!0,process(t,e,n,s,o,r,i,a,l,c){t==null?DF(e,n,s,o,r,i,a,l,c):OF(t,e,n,s,o,i,a,l,c)},hydrate:FF,create:Pb,normalize:LF},L$=RF;function Cc(t,e){const n=t.props&&t.props[e];Xe(n)&&n()}function DF(t,e,n,s,o,r,i,a,l){const{p:c,o:{createElement:u}}=l,h=u("div"),d=t.suspense=Pb(t,o,s,e,h,n,r,i,a,l);c(null,d.pendingBranch=t.ssContent,h,null,s,d,r,i),d.deps>0?(Cc(t,"onPending"),Cc(t,"onFallback"),c(null,t.ssFallback,e,n,s,null,r,i),Ha(d,t.ssFallback)):d.resolve()}function OF(t,e,n,s,o,r,i,a,{p:l,um:c,o:{createElement:u}}){const h=e.suspense=t.suspense;h.vnode=e,e.el=t.el;const d=e.ssContent,f=e.ssFallback,{activeBranch:p,pendingBranch:g,isInFallback:b,isHydrating:x}=h;if(g)h.pendingBranch=d,Ao(d,g)?(l(g,d,h.hiddenContainer,null,o,h,r,i,a),h.deps<=0?h.resolve():b&&(l(p,f,n,s,o,null,r,i,a),Ha(h,f))):(h.pendingId++,x?(h.isHydrating=!1,h.activeBranch=g):c(g,o,h),h.deps=0,h.effects.length=0,h.hiddenContainer=u("div"),b?(l(null,d,h.hiddenContainer,null,o,h,r,i,a),h.deps<=0?h.resolve():(l(p,f,n,s,o,null,r,i,a),Ha(h,f))):p&&Ao(d,p)?(l(p,d,n,s,o,h,r,i,a),h.resolve(!0)):(l(null,d,h.hiddenContainer,null,o,h,r,i,a),h.deps<=0&&h.resolve()));else if(p&&Ao(d,p))l(p,d,n,s,o,h,r,i,a),Ha(h,d);else if(Cc(e,"onPending"),h.pendingBranch=d,h.pendingId++,l(null,d,h.hiddenContainer,null,o,h,r,i,a),h.deps<=0)h.resolve();else{const{timeout:y,pendingId:w}=h;y>0?setTimeout(()=>{h.pendingId===w&&h.fallback(f)},y):y===0&&h.fallback(f)}}function Pb(t,e,n,s,o,r,i,a,l,c,u=!1){const{p:h,m:d,um:f,n:p,o:{parentNode:g,remove:b}}=c,x=_b(t.props&&t.props.timeout),y={vnode:t,parent:e,parentComponent:n,isSVG:i,container:s,hiddenContainer:o,anchor:r,deps:0,pendingId:0,timeout:typeof x=="number"?x:-1,activeBranch:null,pendingBranch:null,isInFallback:!0,isHydrating:u,isUnmounted:!1,effects:[],resolve(w=!1){const{vnode:v,activeBranch:$,pendingBranch:_,pendingId:E,effects:k,parentComponent:N,container:A}=y;if(y.isHydrating)y.isHydrating=!1;else if(!w){const H=$&&_.transition&&_.transition.mode==="out-in";H&&($.transition.afterLeave=()=>{E===y.pendingId&&d(_,A,M,0)});let{anchor:M}=y;$&&(M=p($),f($,N,y,!0)),H||d(_,A,M,0)}Ha(y,_),y.pendingBranch=null,y.isInFallback=!1;let F=y.parent,L=!1;for(;F;){if(F.pendingBranch){F.effects.push(...k),L=!0;break}F=F.parent}L||N$(k),y.effects=[],Cc(v,"onResolve")},fallback(w){if(!y.pendingBranch)return;const{vnode:v,activeBranch:$,parentComponent:_,container:E,isSVG:k}=y;Cc(v,"onFallback");const N=p($),A=()=>{!y.isInFallback||(h(null,w,E,N,_,null,k,a,l),Ha(y,w))},F=w.transition&&w.transition.mode==="out-in";F&&($.transition.afterLeave=A),y.isInFallback=!0,f($,_,null,!0),F||A()},move(w,v,$){y.activeBranch&&d(y.activeBranch,w,v,$),y.container=w},next(){return y.activeBranch&&p(y.activeBranch)},registerDep(w,v){const $=!!y.pendingBranch;$&&y.deps++;const _=w.vnode.el;w.asyncDep.catch(E=>{vl(E,w,0)}).then(E=>{if(w.isUnmounted||y.isUnmounted||y.pendingId!==w.suspenseId)return;w.asyncResolved=!0;const{vnode:k}=w;bg(w,E,!1),_&&(k.el=_);const N=!_&&w.subTree.el;v(w,k,g(_||w.subTree.el),_?null:p(w.subTree),y,i,l),N&&b(N),Lb(w,k.el),$&&--y.deps===0&&y.resolve()})},unmount(w,v){y.isUnmounted=!0,y.activeBranch&&f(y.activeBranch,n,w,v),y.pendingBranch&&f(y.pendingBranch,n,w,v)}};return y}function FF(t,e,n,s,o,r,i,a,l){const c=e.suspense=Pb(e,s,n,t.parentNode,document.createElement("div"),null,o,r,i,a,!0),u=l(t,c.pendingBranch=e.ssContent,n,c,r,i);return c.deps===0&&c.resolve(),u}function LF(t){const{shapeFlag:e,children:n}=t,s=e&32;t.ssContent=w1(s?n.default:n),t.ssFallback=s?w1(n.fallback):He(ss)}function w1(t){let e;if(Xe(t)){const n=Za&&t._c;n&&(t._d=!1,pt()),t=t(),n&&(t._d=!0,e=Bs,sI())}return je(t)&&(t=SF(t)),t=Ls(t),e&&!t.dynamicChildren&&(t.dynamicChildren=e.filter(n=>n!==t)),t}function P$(t,e){e&&e.pendingBranch?je(t)?e.effects.push(...t):e.effects.push(t):N$(t)}function Ha(t,e){t.activeBranch=e;const{vnode:n,parentComponent:s}=t,o=n.el=e.el;s&&s.subTree===n&&(s.vnode.el=o,Lb(s,o))}function Oi(t,e){if(pn){let n=pn.provides;const s=pn.parent&&pn.parent.provides;s===n&&(n=pn.provides=Object.create(s)),n[t]=e}}function Oo(t,e,n=!1){const s=pn||ns;if(s){const o=s.parent==null?s.vnode.appContext&&s.vnode.appContext.provides:s.parent.provides;if(o&&t in o)return o[t];if(arguments.length>1)return n&&Xe(e)?e.call(s.proxy):e}}function C1(t,e){return Mb(t,null,e)}const $1={};function uc(t,e,n){return Mb(t,e,n)}function Mb(t,e,{immediate:n,deep:s,flush:o,onTrack:r,onTrigger:i}=Lt){const a=pn;let l,c=!1,u=!1;if(bn(t)?(l=()=>t.value,c=id(t)):Wa(t)?(l=()=>t,s=!0):je(t)?(u=!0,c=t.some(x=>Wa(x)||id(x)),l=()=>t.map(x=>{if(bn(x))return x.value;if(Wa(x))return Pa(x);if(Xe(x))return Rr(x,a,2)})):Xe(t)?e?l=()=>Rr(t,a,2):l=()=>{if(!(a&&a.isUnmounted))return h&&h(),Gs(t,a,3,[d])}:l=fo,e&&s){const x=l;l=()=>Pa(x())}let h,d=x=>{h=b.onStop=()=>{Rr(x,a,4)}};if(el)return d=fo,e?n&&Gs(e,a,3,[l(),u?[]:void 0,d]):l(),fo;let f=u?[]:$1;const p=()=>{if(!!b.active)if(e){const x=b.run();(s||c||(u?x.some((y,w)=>xc(y,f[w])):xc(x,f)))&&(h&&h(),Gs(e,a,3,[x,f===$1?void 0:f,d]),f=x)}else b.run()};p.allowRecurse=!!e;let g;o==="sync"?g=p:o==="post"?g=()=>Nn(p,a&&a.suspense):(p.pre=!0,a&&(p.id=a.uid),g=()=>Zd(p));const b=new Eb(l,g);return e?n?p():f=b.run():o==="post"?Nn(b.run.bind(b),a&&a.suspense):b.run(),()=>{b.stop(),a&&a.scope&&Cb(a.scope.effects,b)}}function PF(t,e,n){const s=this.proxy,o=cn(t)?t.includes(".")?M$(s,t):()=>s[t]:t.bind(s,s);let r;Xe(e)?r=e:(r=e.handler,n=e);const i=pn;Ja(this);const a=Mb(o,r.bind(s),n);return i?Ja(i):Pi(),a}function M$(t,e){const n=e.split(".");return()=>{let s=t;for(let o=0;o<n.length&&s;o++)s=s[n[o]];return s}}function Pa(t,e){if(!Ut(t)||t.__v_skip||(e=e||new Set,e.has(t)))return t;if(e.add(t),bn(t))Pa(t.value,e);else if(je(t))for(let n=0;n<t.length;n++)Pa(t[n],e);else if(i$(t)||za(t))t.forEach(n=>{Pa(n,e)});else if(c$(t))for(const n in t)Pa(t[n],e);return t}function MF(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return tf(()=>{t.isMounted=!0}),Pc(()=>{t.isUnmounting=!0}),t}const Rs=[Function,Array],BF={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Rs,onEnter:Rs,onAfterEnter:Rs,onEnterCancelled:Rs,onBeforeLeave:Rs,onLeave:Rs,onAfterLeave:Rs,onLeaveCancelled:Rs,onBeforeAppear:Rs,onAppear:Rs,onAfterAppear:Rs,onAppearCancelled:Rs},setup(t,{slots:e}){const n=wl(),s=MF();let o;return()=>{const r=e.default&&z$(e.default(),!0);if(!r||!r.length)return;let i=r[0];if(r.length>1){for(const g of r)if(g.type!==ss){i=g;break}}const a=yt(t),{mode:l}=a;if(s.isLeaving)return Sm(i);const c=I1(i);if(!c)return Sm(i);const u=hg(c,a,s,n);ud(c,u);const h=n.subTree,d=h&&I1(h);let f=!1;const{getTransitionKey:p}=c.type;if(p){const g=p();o===void 0?o=g:g!==o&&(o=g,f=!0)}if(d&&d.type!==ss&&(!Ao(c,d)||f)){const g=hg(d,a,s,n);if(ud(d,g),l==="out-in")return s.isLeaving=!0,g.afterLeave=()=>{s.isLeaving=!1,n.update()},Sm(i);l==="in-out"&&c.type!==ss&&(g.delayLeave=(b,x,y)=>{const w=V$(s,d);w[String(d.key)]=d,b._leaveCb=()=>{x(),b._leaveCb=void 0,delete u.delayedLeave},u.delayedLeave=y})}return i}}},B$=BF;function V$(t,e){const{leavingVNodes:n}=t;let s=n.get(e.type);return s||(s=Object.create(null),n.set(e.type,s)),s}function hg(t,e,n,s){const{appear:o,mode:r,persisted:i=!1,onBeforeEnter:a,onEnter:l,onAfterEnter:c,onEnterCancelled:u,onBeforeLeave:h,onLeave:d,onAfterLeave:f,onLeaveCancelled:p,onBeforeAppear:g,onAppear:b,onAfterAppear:x,onAppearCancelled:y}=e,w=String(t.key),v=V$(n,t),$=(k,N)=>{k&&Gs(k,s,9,N)},_=(k,N)=>{const A=N[1];$(k,N),je(k)?k.every(F=>F.length<=1)&&A():k.length<=1&&A()},E={mode:r,persisted:i,beforeEnter(k){let N=a;if(!n.isMounted)if(o)N=g||a;else return;k._leaveCb&&k._leaveCb(!0);const A=v[w];A&&Ao(t,A)&&A.el._leaveCb&&A.el._leaveCb(),$(N,[k])},enter(k){let N=l,A=c,F=u;if(!n.isMounted)if(o)N=b||l,A=x||c,F=y||u;else return;let L=!1;const H=k._enterCb=M=>{L||(L=!0,M?$(F,[k]):$(A,[k]),E.delayedLeave&&E.delayedLeave(),k._enterCb=void 0)};N?_(N,[k,H]):H()},leave(k,N){const A=String(t.key);if(k._enterCb&&k._enterCb(!0),n.isUnmounting)return N();$(h,[k]);let F=!1;const L=k._leaveCb=H=>{F||(F=!0,N(),H?$(p,[k]):$(f,[k]),k._leaveCb=void 0,v[A]===t&&delete v[A])};v[A]=t,d?_(d,[k,L]):L()},clone(k){return hg(k,e,n,s)}};return E}function Sm(t){if(Lc(t))return t=rr(t),t.children=null,t}function I1(t){return Lc(t)?t.children?t.children[0]:void 0:t}function ud(t,e){t.shapeFlag&6&&t.component?ud(t.component.subTree,e):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function z$(t,e=!1,n){let s=[],o=0;for(let r=0;r<t.length;r++){let i=t[r];const a=n==null?i.key:String(n)+String(i.key!=null?i.key:r);i.type===Qn?(i.patchFlag&128&&o++,s=s.concat(z$(i.children,e,a))):(e||i.type!==ss)&&s.push(a!=null?rr(i,{key:a}):i)}if(o>1)for(let r=0;r<s.length;r++)s[r].patchFlag=-2;return s}function _t(t){return Xe(t)?{setup:t,name:t.name}:t}const Fi=t=>!!t.type.__asyncLoader;function dg(t){Xe(t)&&(t={loader:t});const{loader:e,loadingComponent:n,errorComponent:s,delay:o=200,timeout:r,suspensible:i=!0,onError:a}=t;let l=null,c,u=0;const h=()=>(u++,l=null,d()),d=()=>{let f;return l||(f=l=e().catch(p=>{if(p=p instanceof Error?p:new Error(String(p)),a)return new Promise((g,b)=>{a(p,()=>g(h()),()=>b(p),u+1)});throw p}).then(p=>f!==l&&l?l:(p&&(p.__esModule||p[Symbol.toStringTag]==="Module")&&(p=p.default),c=p,p)))};return _t({name:"AsyncComponentWrapper",__asyncLoader:d,get __asyncResolved(){return c},setup(){const f=pn;if(c)return()=>Tm(c,f);const p=y=>{l=null,vl(y,f,13,!s)};if(i&&f.suspense||el)return d().then(y=>()=>Tm(y,f)).catch(y=>(p(y),()=>s?He(s,{error:y}):null));const g=Di(!1),b=Di(),x=Di(!!o);return o&&setTimeout(()=>{x.value=!1},o),r!=null&&setTimeout(()=>{if(!g.value&&!b.value){const y=new Error(`Async component timed out after ${r}ms.`);p(y),b.value=y}},r),d().then(()=>{g.value=!0,f.parent&&Lc(f.parent.vnode)&&Zd(f.parent.update)}).catch(y=>{p(y),b.value=y}),()=>{if(g.value&&c)return Tm(c,f);if(b.value&&s)return He(s,{error:b.value});if(n&&!x.value)return He(n)}}})}function Tm(t,{vnode:{ref:e,props:n,children:s,shapeFlag:o},parent:r}){const i=He(t,n,s);return i.ref=e,i}const Lc=t=>t.type.__isKeepAlive,VF={name:"KeepAlive",__isKeepAlive:!0,props:{include:[String,RegExp,Array],exclude:[String,RegExp,Array],max:[String,Number]},setup(t,{slots:e}){const n=wl(),s=n.ctx;if(!s.renderer)return()=>{const y=e.default&&e.default();return y&&y.length===1?y[0]:y};const o=new Map,r=new Set;let i=null;const a=n.suspense,{renderer:{p:l,m:c,um:u,o:{createElement:h}}}=s,d=h("div");s.activate=(y,w,v,$,_)=>{const E=y.component;c(y,w,v,0,a),l(E.vnode,y,w,v,E,a,$,y.slotScopeIds,_),Nn(()=>{E.isDeactivated=!1,E.a&&cc(E.a);const k=y.props&&y.props.onVnodeMounted;k&&ls(k,E.parent,y)},a)},s.deactivate=y=>{const w=y.component;c(y,d,null,1,a),Nn(()=>{w.da&&cc(w.da);const v=y.props&&y.props.onVnodeUnmounted;v&&ls(v,w.parent,y),w.isDeactivated=!0},a)};function f(y){Nm(y),u(y,n,a,!0)}function p(y){o.forEach((w,v)=>{const $=xg(w.type);$&&(!y||!y($))&&g(v)})}function g(y){const w=o.get(y);!i||w.type!==i.type?f(w):i&&Nm(i),o.delete(y),r.delete(y)}uc(()=>[t.include,t.exclude],([y,w])=>{y&&p(v=>Jl(y,v)),w&&p(v=>!Jl(w,v))},{flush:"post",deep:!0});let b=null;const x=()=>{b!=null&&o.set(b,Am(n.subTree))};return tf(x),U$(x),Pc(()=>{o.forEach(y=>{const{subTree:w,suspense:v}=n,$=Am(w);if(y.type===$.type){Nm($);const _=$.component.da;_&&Nn(_,v);return}f(y)})}),()=>{if(b=null,!e.default)return null;const y=e.default(),w=y[0];if(y.length>1)return i=null,y;if(!Qa(w)||!(w.shapeFlag&4)&&!(w.shapeFlag&128))return i=null,w;let v=Am(w);const $=v.type,_=xg(Fi(v)?v.type.__asyncResolved||{}:$),{include:E,exclude:k,max:N}=t;if(E&&(!_||!Jl(E,_))||k&&_&&Jl(k,_))return i=v,w;const A=v.key==null?$:v.key,F=o.get(A);return v.el&&(v=rr(v),w.shapeFlag&128&&(w.ssContent=v)),b=A,F?(v.el=F.el,v.component=F.component,v.transition&&ud(v,v.transition),v.shapeFlag|=512,r.delete(A),r.add(A)):(r.add(A),N&&r.size>parseInt(N,10)&&g(r.values().next().value)),v.shapeFlag|=256,i=v,F$(w.type)?w:v}}},zF=VF;function Jl(t,e){return je(t)?t.some(n=>Jl(n,e)):cn(t)?t.split(",").includes(e):t.test?t.test(e):!1}function WF(t,e){W$(t,"a",e)}function UF(t,e){W$(t,"da",e)}function W$(t,e,n=pn){const s=t.__wdc||(t.__wdc=()=>{let o=n;for(;o;){if(o.isDeactivated)return;o=o.parent}return t()});if(ef(e,s,n),n){let o=n.parent;for(;o&&o.parent;)Lc(o.parent.vnode)&&HF(s,e,n,o),o=o.parent}}function HF(t,e,n,s){const o=ef(e,t,s,!0);H$(()=>{Cb(s[e],o)},n)}function Nm(t){let e=t.shapeFlag;e&256&&(e-=256),e&512&&(e-=512),t.shapeFlag=e}function Am(t){return t.shapeFlag&128?t.ssContent:t}function ef(t,e,n=pn,s=!1){if(n){const o=n[t]||(n[t]=[]),r=e.__weh||(e.__weh=(...i)=>{if(n.isUnmounted)return;xl(),Ja(n);const a=Gs(e,n,t,i);return Pi(),yl(),a});return s?o.unshift(r):o.push(r),r}}const lr=t=>(e,n=pn)=>(!el||t==="sp")&&ef(t,e,n),GF=lr("bm"),tf=lr("m"),jF=lr("bu"),U$=lr("u"),Pc=lr("bum"),H$=lr("um"),qF=lr("sp"),KF=lr("rtg"),XF=lr("rtc");function G$(t,e=pn){ef("ec",t,e)}function _o(t,e,n,s){const o=t.dirs,r=e&&e.dirs;for(let i=0;i<o.length;i++){const a=o[i];r&&(a.oldValue=r[i].value);let l=a.dir[s];l&&(xl(),Gs(l,n,8,[t.el,a,t,e]),yl())}}const j$="components";function js(t,e){return ZF(j$,t,!0,e)||t}const YF=Symbol();function ZF(t,e,n=!0,s=!1){const o=ns||pn;if(o){const r=o.type;if(t===j$){const a=xg(r,!1);if(a&&(a===e||a===Vo(e)||a===Xd(Vo(e))))return r}const i=_1(o[t]||r[t],e)||_1(o.appContext[t],e);return!i&&s?r:i}}function _1(t,e){return t&&(t[e]||t[Vo(e)]||t[Xd(Vo(e))])}function QF(t,e,n,s){let o;const r=n&&n[s];if(je(t)||cn(t)){o=new Array(t.length);for(let i=0,a=t.length;i<a;i++)o[i]=e(t[i],i,void 0,r&&r[i])}else if(typeof t=="number"){o=new Array(t);for(let i=0;i<t;i++)o[i]=e(i+1,i,void 0,r&&r[i])}else if(Ut(t))if(t[Symbol.iterator])o=Array.from(t,(i,a)=>e(i,a,void 0,r&&r[a]));else{const i=Object.keys(t);o=new Array(i.length);for(let a=0,l=i.length;a<l;a++){const c=i[a];o[a]=e(t[c],c,a,r&&r[a])}}else o=[];return n&&(n[s]=o),o}function JF(t,e,n={},s,o){if(ns.isCE||ns.parent&&Fi(ns.parent)&&ns.parent.isCE)return He("slot",e==="default"?null:{name:e},s&&s());let r=t[e];r&&r._c&&(r._d=!1),pt();const i=r&&q$(r(n)),a=Li(Qn,{key:n.key||i&&i.key||`_${e}`},i||(s?s():[]),i&&t._===1?64:-2);return!o&&a.scopeId&&(a.slotScopeIds=[a.scopeId+"-s"]),r&&r._c&&(r._d=!0),a}function q$(t){return t.some(e=>Qa(e)?!(e.type===ss||e.type===Qn&&!q$(e.children)):!0)?t:null}const fg=t=>t?iI(t)?Wb(t)||t.proxy:fg(t.parent):null,hd=On(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>fg(t.parent),$root:t=>fg(t.root),$emit:t=>t.emit,$options:t=>Bb(t),$forceUpdate:t=>t.f||(t.f=()=>Zd(t.update)),$nextTick:t=>t.n||(t.n=Fb.bind(t.proxy)),$watch:t=>PF.bind(t)}),eL={get({_:t},e){const{ctx:n,setupState:s,data:o,props:r,accessCache:i,type:a,appContext:l}=t;let c;if(e[0]!=="$"){const f=i[e];if(f!==void 0)switch(f){case 1:return s[e];case 2:return o[e];case 4:return n[e];case 3:return r[e]}else{if(s!==Lt&&ft(s,e))return i[e]=1,s[e];if(o!==Lt&&ft(o,e))return i[e]=2,o[e];if((c=t.propsOptions[0])&&ft(c,e))return i[e]=3,r[e];if(n!==Lt&&ft(n,e))return i[e]=4,n[e];pg&&(i[e]=0)}}const u=hd[e];let h,d;if(u)return e==="$attrs"&&ks(t,"get",e),u(t);if((h=a.__cssModules)&&(h=h[e]))return h;if(n!==Lt&&ft(n,e))return i[e]=4,n[e];if(d=l.config.globalProperties,ft(d,e))return d[e]},set({_:t},e,n){const{data:s,setupState:o,ctx:r}=t;return o!==Lt&&ft(o,e)?(o[e]=n,!0):s!==Lt&&ft(s,e)?(s[e]=n,!0):ft(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(r[e]=n,!0)},has({_:{data:t,setupState:e,accessCache:n,ctx:s,appContext:o,propsOptions:r}},i){let a;return!!n[i]||t!==Lt&&ft(t,i)||e!==Lt&&ft(e,i)||(a=r[0])&&ft(a,i)||ft(s,i)||ft(hd,i)||ft(o.config.globalProperties,i)},defineProperty(t,e,n){return n.get!=null?t._.accessCache[e]=0:ft(n,"value")&&this.set(t,e,n.value,null),Reflect.defineProperty(t,e,n)}};let pg=!0;function tL(t){const e=Bb(t),n=t.proxy,s=t.ctx;pg=!1,e.beforeCreate&&k1(e.beforeCreate,t,"bc");const{data:o,computed:r,methods:i,watch:a,provide:l,inject:c,created:u,beforeMount:h,mounted:d,beforeUpdate:f,updated:p,activated:g,deactivated:b,beforeDestroy:x,beforeUnmount:y,destroyed:w,unmounted:v,render:$,renderTracked:_,renderTriggered:E,errorCaptured:k,serverPrefetch:N,expose:A,inheritAttrs:F,components:L,directives:H,filters:M}=e;if(c&&nL(c,s,null,t.appContext.config.unwrapInjectedRef),i)for(const Q in i){const Y=i[Q];Xe(Y)&&(s[Q]=Y.bind(n))}if(o){const Q=o.call(n,n);Ut(Q)&&(t.data=zo(Q))}if(pg=!0,r)for(const Q in r){const Y=r[Q],ie=Xe(Y)?Y.bind(n,n):Xe(Y.get)?Y.get.bind(n,n):fo,pe=!Xe(Y)&&Xe(Y.set)?Y.set.bind(n):fo,he=mn({get:ie,set:pe});Object.defineProperty(s,Q,{enumerable:!0,configurable:!0,get:()=>he.value,set:xe=>he.value=xe})}if(a)for(const Q in a)K$(a[Q],s,n,Q);if(l){const Q=Xe(l)?l.call(n):l;Reflect.ownKeys(Q).forEach(Y=>{Oi(Y,Q[Y])})}u&&k1(u,t,"c");function q(Q,Y){je(Y)?Y.forEach(ie=>Q(ie.bind(n))):Y&&Q(Y.bind(n))}if(q(GF,h),q(tf,d),q(jF,f),q(U$,p),q(WF,g),q(UF,b),q(G$,k),q(XF,_),q(KF,E),q(Pc,y),q(H$,v),q(qF,N),je(A))if(A.length){const Q=t.exposed||(t.exposed={});A.forEach(Y=>{Object.defineProperty(Q,Y,{get:()=>n[Y],set:ie=>n[Y]=ie})})}else t.exposed||(t.exposed={});$&&t.render===fo&&(t.render=$),F!=null&&(t.inheritAttrs=F),L&&(t.components=L),H&&(t.directives=H)}function nL(t,e,n=fo,s=!1){je(t)&&(t=mg(t));for(const o in t){const r=t[o];let i;Ut(r)?"default"in r?i=Oo(r.from||o,r.default,!0):i=Oo(r.from||o):i=Oo(r),bn(i)&&s?Object.defineProperty(e,o,{enumerable:!0,configurable:!0,get:()=>i.value,set:a=>i.value=a}):e[o]=i}}function k1(t,e,n){Gs(je(t)?t.map(s=>s.bind(e.proxy)):t.bind(e.proxy),e,n)}function K$(t,e,n,s){const o=s.includes(".")?M$(n,s):()=>n[s];if(cn(t)){const r=e[t];Xe(r)&&uc(o,r)}else if(Xe(t))uc(o,t.bind(n));else if(Ut(t))if(je(t))t.forEach(r=>K$(r,e,n,s));else{const r=Xe(t.handler)?t.handler.bind(n):e[t.handler];Xe(r)&&uc(o,r,t)}}function Bb(t){const e=t.type,{mixins:n,extends:s}=e,{mixins:o,optionsCache:r,config:{optionMergeStrategies:i}}=t.appContext,a=r.get(e);let l;return a?l=a:!o.length&&!n&&!s?l=e:(l={},o.length&&o.forEach(c=>dd(l,c,i,!0)),dd(l,e,i)),Ut(e)&&r.set(e,l),l}function dd(t,e,n,s=!1){const{mixins:o,extends:r}=e;r&&dd(t,r,n,!0),o&&o.forEach(i=>dd(t,i,n,!0));for(const i in e)if(!(s&&i==="expose")){const a=sL[i]||n&&n[i];t[i]=a?a(t[i],e[i]):e[i]}return t}const sL={data:E1,props:Ci,emits:Ci,methods:Ci,computed:Ci,beforeCreate:Yn,created:Yn,beforeMount:Yn,mounted:Yn,beforeUpdate:Yn,updated:Yn,beforeDestroy:Yn,beforeUnmount:Yn,destroyed:Yn,unmounted:Yn,activated:Yn,deactivated:Yn,errorCaptured:Yn,serverPrefetch:Yn,components:Ci,directives:Ci,watch:rL,provide:E1,inject:oL};function E1(t,e){return e?t?function(){return On(Xe(t)?t.call(this,this):t,Xe(e)?e.call(this,this):e)}:e:t}function oL(t,e){return Ci(mg(t),mg(e))}function mg(t){if(je(t)){const e={};for(let n=0;n<t.length;n++)e[t[n]]=t[n];return e}return t}function Yn(t,e){return t?[...new Set([].concat(t,e))]:e}function Ci(t,e){return t?On(On(Object.create(null),t),e):e}function rL(t,e){if(!t)return e;if(!e)return t;const n=On(Object.create(null),t);for(const s in e)n[s]=Yn(t[s],e[s]);return n}function iL(t,e,n,s=!1){const o={},r={};rd(r,nf,1),t.propsDefaults=Object.create(null),X$(t,e,o,r);for(const i in t.propsOptions[0])i in o||(o[i]=void 0);n?t.props=s?o:bF(o):t.type.props?t.props=o:t.props=r,t.attrs=r}function aL(t,e,n,s){const{props:o,attrs:r,vnode:{patchFlag:i}}=t,a=yt(o),[l]=t.propsOptions;let c=!1;if((s||i>0)&&!(i&16)){if(i&8){const u=t.vnode.dynamicProps;for(let h=0;h<u.length;h++){let d=u[h];if(Qd(t.emitsOptions,d))continue;const f=e[d];if(l)if(ft(r,d))f!==r[d]&&(r[d]=f,c=!0);else{const p=Vo(d);o[p]=gg(l,a,p,f,t,!1)}else f!==r[d]&&(r[d]=f,c=!0)}}}else{X$(t,e,o,r)&&(c=!0);let u;for(const h in a)(!e||!ft(e,h)&&((u=bl(h))===h||!ft(e,u)))&&(l?n&&(n[h]!==void 0||n[u]!==void 0)&&(o[h]=gg(l,a,h,void 0,t,!0)):delete o[h]);if(r!==a)for(const h in r)(!e||!ft(e,h)&&!0)&&(delete r[h],c=!0)}c&&or(t,"set","$attrs")}function X$(t,e,n,s){const[o,r]=t.propsOptions;let i=!1,a;if(e)for(let l in e){if(lc(l))continue;const c=e[l];let u;o&&ft(o,u=Vo(l))?!r||!r.includes(u)?n[u]=c:(a||(a={}))[u]=c:Qd(t.emitsOptions,l)||(!(l in s)||c!==s[l])&&(s[l]=c,i=!0)}if(r){const l=yt(n),c=a||Lt;for(let u=0;u<r.length;u++){const h=r[u];n[h]=gg(o,l,h,c[h],t,!ft(c,h))}}return i}function gg(t,e,n,s,o,r){const i=t[n];if(i!=null){const a=ft(i,"default");if(a&&s===void 0){const l=i.default;if(i.type!==Function&&Xe(l)){const{propsDefaults:c}=o;n in c?s=c[n]:(Ja(o),s=c[n]=l.call(null,e),Pi())}else s=l}i[0]&&(r&&!a?s=!1:i[1]&&(s===""||s===bl(n))&&(s=!0))}return s}function Y$(t,e,n=!1){const s=e.propsCache,o=s.get(t);if(o)return o;const r=t.props,i={},a=[];let l=!1;if(!Xe(t)){const u=h=>{l=!0;const[d,f]=Y$(h,e,!0);On(i,d),f&&a.push(...f)};!n&&e.mixins.length&&e.mixins.forEach(u),t.extends&&u(t.extends),t.mixins&&t.mixins.forEach(u)}if(!r&&!l)return Ut(t)&&s.set(t,Va),Va;if(je(r))for(let u=0;u<r.length;u++){const h=Vo(r[u]);S1(h)&&(i[h]=Lt)}else if(r)for(const u in r){const h=Vo(u);if(S1(h)){const d=r[u],f=i[h]=je(d)||Xe(d)?{type:d}:d;if(f){const p=A1(Boolean,f.type),g=A1(String,f.type);f[0]=p>-1,f[1]=g<0||p<g,(p>-1||ft(f,"default"))&&a.push(h)}}}const c=[i,a];return Ut(t)&&s.set(t,c),c}function S1(t){return t[0]!=="$"}function T1(t){const e=t&&t.toString().match(/^\s*function (\w+)/);return e?e[1]:t===null?"null":""}function N1(t,e){return T1(t)===T1(e)}function A1(t,e){return je(e)?e.findIndex(n=>N1(n,t)):Xe(e)&&N1(e,t)?0:-1}const Z$=t=>t[0]==="_"||t==="$stable",Vb=t=>je(t)?t.map(Ls):[Ls(t)],lL=(t,e,n)=>{if(e._n)return e;const s=Wi((...o)=>Vb(e(...o)),n);return s._c=!1,s},Q$=(t,e,n)=>{const s=t._ctx;for(const o in t){if(Z$(o))continue;const r=t[o];if(Xe(r))e[o]=lL(o,r,s);else if(r!=null){const i=Vb(r);e[o]=()=>i}}},J$=(t,e)=>{const n=Vb(e);t.slots.default=()=>n},cL=(t,e)=>{if(t.vnode.shapeFlag&32){const n=e._;n?(t.slots=yt(e),rd(e,"_",n)):Q$(e,t.slots={})}else t.slots={},e&&J$(t,e);rd(t.slots,nf,1)},uL=(t,e,n)=>{const{vnode:s,slots:o}=t;let r=!0,i=Lt;if(s.shapeFlag&32){const a=e._;a?n&&a===1?r=!1:(On(o,e),!n&&a===1&&delete o._):(r=!e.$stable,Q$(e,o)),i=e}else e&&(J$(t,e),i={default:1});if(r)for(const a in o)!Z$(a)&&!(a in i)&&delete o[a]};function eI(){return{app:null,config:{isNativeTag:PO,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let hL=0;function dL(t,e){return function(s,o=null){Xe(s)||(s=Object.assign({},s)),o!=null&&!Ut(o)&&(o=null);const r=eI(),i=new Set;let a=!1;const l=r.app={_uid:hL++,_component:s,_props:o,_container:null,_context:r,_instance:null,version:TL,get config(){return r.config},set config(c){},use(c,...u){return i.has(c)||(c&&Xe(c.install)?(i.add(c),c.install(l,...u)):Xe(c)&&(i.add(c),c(l,...u))),l},mixin(c){return r.mixins.includes(c)||r.mixins.push(c),l},component(c,u){return u?(r.components[c]=u,l):r.components[c]},directive(c,u){return u?(r.directives[c]=u,l):r.directives[c]},mount(c,u,h){if(!a){const d=He(s,o);return d.appContext=r,u&&e?e(d,c):t(d,c,h),a=!0,l._container=c,c.__vue_app__=l,Wb(d.component)||d.component.proxy}},unmount(){a&&(t(null,l._container),delete l._container.__vue_app__)},provide(c,u){return r.provides[c]=u,l}};return l}}function fd(t,e,n,s,o=!1){if(je(t)){t.forEach((d,f)=>fd(d,e&&(je(e)?e[f]:e),n,s,o));return}if(Fi(s)&&!o)return;const r=s.shapeFlag&4?Wb(s.component)||s.component.proxy:s.el,i=o?null:r,{i:a,r:l}=t,c=e&&e.r,u=a.refs===Lt?a.refs={}:a.refs,h=a.setupState;if(c!=null&&c!==l&&(cn(c)?(u[c]=null,ft(h,c)&&(h[c]=null)):bn(c)&&(c.value=null)),Xe(l))Rr(l,a,12,[i,u]);else{const d=cn(l),f=bn(l);if(d||f){const p=()=>{if(t.f){const g=d?u[l]:l.value;o?je(g)&&Cb(g,r):je(g)?g.includes(r)||g.push(r):d?(u[l]=[r],ft(h,l)&&(h[l]=u[l])):(l.value=[r],t.k&&(u[t.k]=l.value))}else d?(u[l]=i,ft(h,l)&&(h[l]=i)):f&&(l.value=i,t.k&&(u[t.k]=i))};i?(p.id=-1,Nn(p,n)):p()}}}let vr=!1;const Dh=t=>/svg/.test(t.namespaceURI)&&t.tagName!=="foreignObject",Oh=t=>t.nodeType===8;function fL(t){const{mt:e,p:n,o:{patchProp:s,createText:o,nextSibling:r,parentNode:i,remove:a,insert:l,createComment:c}}=t,u=(x,y)=>{if(!y.hasChildNodes()){n(null,x,y),ld(),y._vnode=x;return}vr=!1,h(y.firstChild,x,null,null,null),ld(),y._vnode=x,vr&&console.error("Hydration completed but contains mismatches.")},h=(x,y,w,v,$,_=!1)=>{const E=Oh(x)&&x.data==="[",k=()=>g(x,y,w,v,$,E),{type:N,ref:A,shapeFlag:F,patchFlag:L}=y,H=x.nodeType;y.el=x,L===-2&&(_=!1,y.dynamicChildren=null);let M=null;switch(N){case $c:H!==3?y.children===""?(l(y.el=o(""),i(x),x),M=x):M=k():(x.data!==y.children&&(vr=!0,x.data=y.children),M=r(x));break;case ss:H!==8||E?M=k():M=r(x);break;case ed:if(H!==1&&H!==3)M=k();else{M=x;const K=!y.children.length;for(let q=0;q<y.staticCount;q++)K&&(y.children+=M.nodeType===1?M.outerHTML:M.data),q===y.staticCount-1&&(y.anchor=M),M=r(M);return M}break;case Qn:E?M=p(x,y,w,v,$,_):M=k();break;default:if(F&1)H!==1||y.type.toLowerCase()!==x.tagName.toLowerCase()?M=k():M=d(x,y,w,v,$,_);else if(F&6){y.slotScopeIds=$;const K=i(x);if(e(y,K,null,w,v,Dh(K),_),M=E?b(x):r(x),M&&Oh(M)&&M.data==="teleport end"&&(M=r(M)),Fi(y)){let q;E?(q=He(Qn),q.anchor=M?M.previousSibling:K.lastChild):q=x.nodeType===3?At(""):He("div"),q.el=x,y.component.subTree=q}}else F&64?H!==8?M=k():M=y.type.hydrate(x,y,w,v,$,_,t,f):F&128&&(M=y.type.hydrate(x,y,w,v,Dh(i(x)),$,_,t,h))}return A!=null&&fd(A,null,v,y),M},d=(x,y,w,v,$,_)=>{_=_||!!y.dynamicChildren;const{type:E,props:k,patchFlag:N,shapeFlag:A,dirs:F}=y,L=E==="input"&&F||E==="option";if(L||N!==-1){if(F&&_o(y,null,w,"created"),k)if(L||!_||N&48)for(const M in k)(L&&M.endsWith("value")||Fc(M)&&!lc(M))&&s(x,M,null,k[M],!1,void 0,w);else k.onClick&&s(x,"onClick",null,k.onClick,!1,void 0,w);let H;if((H=k&&k.onVnodeBeforeMount)&&ls(H,w,y),F&&_o(y,null,w,"beforeMount"),((H=k&&k.onVnodeMounted)||F)&&P$(()=>{H&&ls(H,w,y),F&&_o(y,null,w,"mounted")},v),A&16&&!(k&&(k.innerHTML||k.textContent))){let M=f(x.firstChild,y,x,w,v,$,_);for(;M;){vr=!0;const K=M;M=M.nextSibling,a(K)}}else A&8&&x.textContent!==y.children&&(vr=!0,x.textContent=y.children)}return x.nextSibling},f=(x,y,w,v,$,_,E)=>{E=E||!!y.dynamicChildren;const k=y.children,N=k.length;for(let A=0;A<N;A++){const F=E?k[A]:k[A]=Ls(k[A]);if(x)x=h(x,F,v,$,_,E);else{if(F.type===$c&&!F.children)continue;vr=!0,n(null,F,w,null,v,$,Dh(w),_)}}return x},p=(x,y,w,v,$,_)=>{const{slotScopeIds:E}=y;E&&($=$?$.concat(E):E);const k=i(x),N=f(r(x),y,k,w,v,$,_);return N&&Oh(N)&&N.data==="]"?r(y.anchor=N):(vr=!0,l(y.anchor=c("]"),k,N),N)},g=(x,y,w,v,$,_)=>{if(vr=!0,y.el=null,_){const N=b(x);for(;;){const A=r(x);if(A&&A!==N)a(A);else break}}const E=r(x),k=i(x);return a(x),n(null,y,k,E,w,v,Dh(k),$),E},b=x=>{let y=0;for(;x;)if(x=r(x),x&&Oh(x)&&(x.data==="["&&y++,x.data==="]")){if(y===0)return r(x);y--}return x};return[u,h]}const Nn=P$;function pL(t){return tI(t)}function mL(t){return tI(t,fL)}function tI(t,e){const n=UO();n.__VUE__=!0;const{insert:s,remove:o,patchProp:r,createElement:i,createText:a,createComment:l,setText:c,setElementText:u,parentNode:h,nextSibling:d,setScopeId:f=fo,cloneNode:p,insertStaticContent:g}=t,b=(D,P,X,ce=null,re=null,de=null,_e=!1,be=null,we=!!P.dynamicChildren)=>{if(D===P)return;D&&!Ao(D,P)&&(ce=B(D),me(D,re,de,!0),D=null),P.patchFlag===-2&&(we=!1,P.dynamicChildren=null);const{type:fe,ref:Me,shapeFlag:Re}=P;switch(fe){case $c:x(D,P,X,ce);break;case ss:y(D,P,X,ce);break;case ed:D==null&&w(P,X,ce,_e);break;case Qn:H(D,P,X,ce,re,de,_e,be,we);break;default:Re&1?_(D,P,X,ce,re,de,_e,be,we):Re&6?M(D,P,X,ce,re,de,_e,be,we):(Re&64||Re&128)&&fe.process(D,P,X,ce,re,de,_e,be,we,Se)}Me!=null&&re&&fd(Me,D&&D.ref,de,P||D,!P)},x=(D,P,X,ce)=>{if(D==null)s(P.el=a(P.children),X,ce);else{const re=P.el=D.el;P.children!==D.children&&c(re,P.children)}},y=(D,P,X,ce)=>{D==null?s(P.el=l(P.children||""),X,ce):P.el=D.el},w=(D,P,X,ce)=>{[D.el,D.anchor]=g(D.children,P,X,ce,D.el,D.anchor)},v=({el:D,anchor:P},X,ce)=>{let re;for(;D&&D!==P;)re=d(D),s(D,X,ce),D=re;s(P,X,ce)},$=({el:D,anchor:P})=>{let X;for(;D&&D!==P;)X=d(D),o(D),D=X;o(P)},_=(D,P,X,ce,re,de,_e,be,we)=>{_e=_e||P.type==="svg",D==null?E(P,X,ce,re,de,_e,be,we):A(D,P,re,de,_e,be,we)},E=(D,P,X,ce,re,de,_e,be)=>{let we,fe;const{type:Me,props:Re,shapeFlag:Oe,transition:Ve,patchFlag:Ke,dirs:rt}=D;if(D.el&&p!==void 0&&Ke===-1)we=D.el=p(D.el);else{if(we=D.el=i(D.type,de,Re&&Re.is,Re),Oe&8?u(we,D.children):Oe&16&&N(D.children,we,null,ce,re,de&&Me!=="foreignObject",_e,be),rt&&_o(D,null,ce,"created"),Re){for(const xt in Re)xt!=="value"&&!lc(xt)&&r(we,xt,null,Re[xt],de,D.children,ce,re,ne);"value"in Re&&r(we,"value",null,Re.value),(fe=Re.onVnodeBeforeMount)&&ls(fe,ce,D)}k(we,D,D.scopeId,_e,ce)}rt&&_o(D,null,ce,"beforeMount");const ct=(!re||re&&!re.pendingBranch)&&Ve&&!Ve.persisted;ct&&Ve.beforeEnter(we),s(we,P,X),((fe=Re&&Re.onVnodeMounted)||ct||rt)&&Nn(()=>{fe&&ls(fe,ce,D),ct&&Ve.enter(we),rt&&_o(D,null,ce,"mounted")},re)},k=(D,P,X,ce,re)=>{if(X&&f(D,X),ce)for(let de=0;de<ce.length;de++)f(D,ce[de]);if(re){let de=re.subTree;if(P===de){const _e=re.vnode;k(D,_e,_e.scopeId,_e.slotScopeIds,re.parent)}}},N=(D,P,X,ce,re,de,_e,be,we=0)=>{for(let fe=we;fe<D.length;fe++){const Me=D[fe]=be?Ir(D[fe]):Ls(D[fe]);b(null,Me,P,X,ce,re,de,_e,be)}},A=(D,P,X,ce,re,de,_e)=>{const be=P.el=D.el;let{patchFlag:we,dynamicChildren:fe,dirs:Me}=P;we|=D.patchFlag&16;const Re=D.props||Lt,Oe=P.props||Lt;let Ve;X&&gi(X,!1),(Ve=Oe.onVnodeBeforeUpdate)&&ls(Ve,X,P,D),Me&&_o(P,D,X,"beforeUpdate"),X&&gi(X,!0);const Ke=re&&P.type!=="foreignObject";if(fe?F(D.dynamicChildren,fe,be,X,ce,Ke,de):_e||ie(D,P,be,null,X,ce,Ke,de,!1),we>0){if(we&16)L(be,P,Re,Oe,X,ce,re);else if(we&2&&Re.class!==Oe.class&&r(be,"class",null,Oe.class,re),we&4&&r(be,"style",Re.style,Oe.style,re),we&8){const rt=P.dynamicProps;for(let ct=0;ct<rt.length;ct++){const xt=rt[ct],En=Re[xt],to=Oe[xt];(to!==En||xt==="value")&&r(be,xt,En,to,re,D.children,X,ce,ne)}}we&1&&D.children!==P.children&&u(be,P.children)}else!_e&&fe==null&&L(be,P,Re,Oe,X,ce,re);((Ve=Oe.onVnodeUpdated)||Me)&&Nn(()=>{Ve&&ls(Ve,X,P,D),Me&&_o(P,D,X,"updated")},ce)},F=(D,P,X,ce,re,de,_e)=>{for(let be=0;be<P.length;be++){const we=D[be],fe=P[be],Me=we.el&&(we.type===Qn||!Ao(we,fe)||we.shapeFlag&70)?h(we.el):X;b(we,fe,Me,null,ce,re,de,_e,!0)}},L=(D,P,X,ce,re,de,_e)=>{if(X!==ce){for(const be in ce){if(lc(be))continue;const we=ce[be],fe=X[be];we!==fe&&be!=="value"&&r(D,be,fe,we,_e,P.children,re,de,ne)}if(X!==Lt)for(const be in X)!lc(be)&&!(be in ce)&&r(D,be,X[be],null,_e,P.children,re,de,ne);"value"in ce&&r(D,"value",X.value,ce.value)}},H=(D,P,X,ce,re,de,_e,be,we)=>{const fe=P.el=D?D.el:a(""),Me=P.anchor=D?D.anchor:a("");let{patchFlag:Re,dynamicChildren:Oe,slotScopeIds:Ve}=P;Ve&&(be=be?be.concat(Ve):Ve),D==null?(s(fe,X,ce),s(Me,X,ce),N(P.children,X,Me,re,de,_e,be,we)):Re>0&&Re&64&&Oe&&D.dynamicChildren?(F(D.dynamicChildren,Oe,X,re,de,_e,be),(P.key!=null||re&&P===re.subTree)&&nI(D,P,!0)):ie(D,P,X,Me,re,de,_e,be,we)},M=(D,P,X,ce,re,de,_e,be,we)=>{P.slotScopeIds=be,D==null?P.shapeFlag&512?re.ctx.activate(P,X,ce,_e,we):K(P,X,ce,re,de,_e,we):q(D,P,we)},K=(D,P,X,ce,re,de,_e)=>{const be=D.component=$L(D,ce,re);if(Lc(D)&&(be.ctx.renderer=Se),IL(be),be.asyncDep){if(re&&re.registerDep(be,Q),!D.el){const we=be.subTree=He(ss);y(null,we,P,X)}return}Q(be,D,P,X,re,de,_e)},q=(D,P,X)=>{const ce=P.component=D.component;if(AF(D,P,X))if(ce.asyncDep&&!ce.asyncResolved){Y(ce,P,X);return}else ce.next=P,_F(ce.update),ce.update();else P.el=D.el,ce.vnode=P},Q=(D,P,X,ce,re,de,_e)=>{const be=()=>{if(D.isMounted){let{next:Me,bu:Re,u:Oe,parent:Ve,vnode:Ke}=D,rt=Me,ct;gi(D,!1),Me?(Me.el=Ke.el,Y(D,Me,_e)):Me=Ke,Re&&cc(Re),(ct=Me.props&&Me.props.onVnodeBeforeUpdate)&&ls(ct,Ve,Me,Ke),gi(D,!0);const xt=Em(D),En=D.subTree;D.subTree=xt,b(En,xt,h(En.el),B(En),D,re,de),Me.el=xt.el,rt===null&&Lb(D,xt.el),Oe&&Nn(Oe,re),(ct=Me.props&&Me.props.onVnodeUpdated)&&Nn(()=>ls(ct,Ve,Me,Ke),re)}else{let Me;const{el:Re,props:Oe}=P,{bm:Ve,m:Ke,parent:rt}=D,ct=Fi(P);if(gi(D,!1),Ve&&cc(Ve),!ct&&(Me=Oe&&Oe.onVnodeBeforeMount)&&ls(Me,rt,P),gi(D,!0),Re&&Ne){const xt=()=>{D.subTree=Em(D),Ne(Re,D.subTree,D,re,null)};ct?P.type.__asyncLoader().then(()=>!D.isUnmounted&&xt()):xt()}else{const xt=D.subTree=Em(D);b(null,xt,X,ce,D,re,de),P.el=xt.el}if(Ke&&Nn(Ke,re),!ct&&(Me=Oe&&Oe.onVnodeMounted)){const xt=P;Nn(()=>ls(Me,rt,xt),re)}(P.shapeFlag&256||rt&&Fi(rt.vnode)&&rt.vnode.shapeFlag&256)&&D.a&&Nn(D.a,re),D.isMounted=!0,P=X=ce=null}},we=D.effect=new Eb(be,()=>Zd(fe),D.scope),fe=D.update=()=>we.run();fe.id=D.uid,gi(D,!0),fe()},Y=(D,P,X)=>{P.component=D;const ce=D.vnode.props;D.vnode=P,D.next=null,aL(D,P.props,ce,X),uL(D,P.children,X),xl(),y1(),yl()},ie=(D,P,X,ce,re,de,_e,be,we=!1)=>{const fe=D&&D.children,Me=D?D.shapeFlag:0,Re=P.children,{patchFlag:Oe,shapeFlag:Ve}=P;if(Oe>0){if(Oe&128){he(fe,Re,X,ce,re,de,_e,be,we);return}else if(Oe&256){pe(fe,Re,X,ce,re,de,_e,be,we);return}}Ve&8?(Me&16&&ne(fe,re,de),Re!==fe&&u(X,Re)):Me&16?Ve&16?he(fe,Re,X,ce,re,de,_e,be,we):ne(fe,re,de,!0):(Me&8&&u(X,""),Ve&16&&N(Re,X,ce,re,de,_e,be,we))},pe=(D,P,X,ce,re,de,_e,be,we)=>{D=D||Va,P=P||Va;const fe=D.length,Me=P.length,Re=Math.min(fe,Me);let Oe;for(Oe=0;Oe<Re;Oe++){const Ve=P[Oe]=we?Ir(P[Oe]):Ls(P[Oe]);b(D[Oe],Ve,X,null,re,de,_e,be,we)}fe>Me?ne(D,re,de,!0,!1,Re):N(P,X,ce,re,de,_e,be,we,Re)},he=(D,P,X,ce,re,de,_e,be,we)=>{let fe=0;const Me=P.length;let Re=D.length-1,Oe=Me-1;for(;fe<=Re&&fe<=Oe;){const Ve=D[fe],Ke=P[fe]=we?Ir(P[fe]):Ls(P[fe]);if(Ao(Ve,Ke))b(Ve,Ke,X,null,re,de,_e,be,we);else break;fe++}for(;fe<=Re&&fe<=Oe;){const Ve=D[Re],Ke=P[Oe]=we?Ir(P[Oe]):Ls(P[Oe]);if(Ao(Ve,Ke))b(Ve,Ke,X,null,re,de,_e,be,we);else break;Re--,Oe--}if(fe>Re){if(fe<=Oe){const Ve=Oe+1,Ke=Ve<Me?P[Ve].el:ce;for(;fe<=Oe;)b(null,P[fe]=we?Ir(P[fe]):Ls(P[fe]),X,Ke,re,de,_e,be,we),fe++}}else if(fe>Oe)for(;fe<=Re;)me(D[fe],re,de,!0),fe++;else{const Ve=fe,Ke=fe,rt=new Map;for(fe=Ke;fe<=Oe;fe++){const jn=P[fe]=we?Ir(P[fe]):Ls(P[fe]);jn.key!=null&&rt.set(jn.key,fe)}let ct,xt=0;const En=Oe-Ke+1;let to=!1,jo=0;const bs=new Array(En);for(fe=0;fe<En;fe++)bs[fe]=0;for(fe=Ve;fe<=Re;fe++){const jn=D[fe];if(xt>=En){me(jn,re,de,!0);continue}let Sn;if(jn.key!=null)Sn=rt.get(jn.key);else for(ct=Ke;ct<=Oe;ct++)if(bs[ct-Ke]===0&&Ao(jn,P[ct])){Sn=ct;break}Sn===void 0?me(jn,re,de,!0):(bs[Sn-Ke]=fe+1,Sn>=jo?jo=Sn:to=!0,b(jn,P[Sn],X,null,re,de,_e,be,we),xt++)}const Qe=to?gL(bs):Va;for(ct=Qe.length-1,fe=En-1;fe>=0;fe--){const jn=Ke+fe,Sn=P[jn],ih=jn+1<Me?P[jn+1].el:ce;bs[fe]===0?b(null,Sn,X,ih,re,de,_e,be,we):to&&(ct<0||fe!==Qe[ct]?xe(Sn,X,ih,2):ct--)}}},xe=(D,P,X,ce,re=null)=>{const{el:de,type:_e,transition:be,children:we,shapeFlag:fe}=D;if(fe&6){xe(D.component.subTree,P,X,ce);return}if(fe&128){D.suspense.move(P,X,ce);return}if(fe&64){_e.move(D,P,X,Se);return}if(_e===Qn){s(de,P,X);for(let Re=0;Re<we.length;Re++)xe(we[Re],P,X,ce);s(D.anchor,P,X);return}if(_e===ed){v(D,P,X);return}if(ce!==2&&fe&1&&be)if(ce===0)be.beforeEnter(de),s(de,P,X),Nn(()=>be.enter(de),re);else{const{leave:Re,delayLeave:Oe,afterLeave:Ve}=be,Ke=()=>s(de,P,X),rt=()=>{Re(de,()=>{Ke(),Ve&&Ve()})};Oe?Oe(de,Ke,rt):rt()}else s(de,P,X)},me=(D,P,X,ce=!1,re=!1)=>{const{type:de,props:_e,ref:be,children:we,dynamicChildren:fe,shapeFlag:Me,patchFlag:Re,dirs:Oe}=D;if(be!=null&&fd(be,null,X,D,!0),Me&256){P.ctx.deactivate(D);return}const Ve=Me&1&&Oe,Ke=!Fi(D);let rt;if(Ke&&(rt=_e&&_e.onVnodeBeforeUnmount)&&ls(rt,P,D),Me&6)le(D.component,X,ce);else{if(Me&128){D.suspense.unmount(X,ce);return}Ve&&_o(D,null,P,"beforeUnmount"),Me&64?D.type.remove(D,P,X,re,Se,ce):fe&&(de!==Qn||Re>0&&Re&64)?ne(fe,P,X,!1,!0):(de===Qn&&Re&384||!re&&Me&16)&&ne(we,P,X),ce&&Ie(D)}(Ke&&(rt=_e&&_e.onVnodeUnmounted)||Ve)&&Nn(()=>{rt&&ls(rt,P,D),Ve&&_o(D,null,P,"unmounted")},X)},Ie=D=>{const{type:P,el:X,anchor:ce,transition:re}=D;if(P===Qn){G(X,ce);return}if(P===ed){$(D);return}const de=()=>{o(X),re&&!re.persisted&&re.afterLeave&&re.afterLeave()};if(D.shapeFlag&1&&re&&!re.persisted){const{leave:_e,delayLeave:be}=re,we=()=>_e(X,de);be?be(D.el,de,we):we()}else de()},G=(D,P)=>{let X;for(;D!==P;)X=d(D),o(D),D=X;o(P)},le=(D,P,X)=>{const{bum:ce,scope:re,update:de,subTree:_e,um:be}=D;ce&&cc(ce),re.stop(),de&&(de.active=!1,me(_e,D,P,X)),be&&Nn(be,P),Nn(()=>{D.isUnmounted=!0},P),P&&P.pendingBranch&&!P.isUnmounted&&D.asyncDep&&!D.asyncResolved&&D.suspenseId===P.pendingId&&(P.deps--,P.deps===0&&P.resolve())},ne=(D,P,X,ce=!1,re=!1,de=0)=>{for(let _e=de;_e<D.length;_e++)me(D[_e],P,X,ce,re)},B=D=>D.shapeFlag&6?B(D.component.subTree):D.shapeFlag&128?D.suspense.next():d(D.anchor||D.el),$e=(D,P,X)=>{D==null?P._vnode&&me(P._vnode,null,null,!0):b(P._vnode||null,D,P,null,null,null,X),y1(),ld(),P._vnode=D},Se={p:b,um:me,m:xe,r:Ie,mt:K,mc:N,pc:ie,pbc:F,n:B,o:t};let ke,Ne;return e&&([ke,Ne]=e(Se)),{render:$e,hydrate:ke,createApp:dL($e,ke)}}function gi({effect:t,update:e},n){t.allowRecurse=e.allowRecurse=n}function nI(t,e,n=!1){const s=t.children,o=e.children;if(je(s)&&je(o))for(let r=0;r<s.length;r++){const i=s[r];let a=o[r];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=o[r]=Ir(o[r]),a.el=i.el),n||nI(i,a))}}function gL(t){const e=t.slice(),n=[0];let s,o,r,i,a;const l=t.length;for(s=0;s<l;s++){const c=t[s];if(c!==0){if(o=n[n.length-1],t[o]<c){e[s]=o,n.push(s);continue}for(r=0,i=n.length-1;r<i;)a=r+i>>1,t[n[a]]<c?r=a+1:i=a;c<t[n[r]]&&(r>0&&(e[s]=n[r-1]),n[r]=s)}}for(r=n.length,i=n[r-1];r-- >0;)n[r]=i,i=e[i];return n}const bL=t=>t.__isTeleport,Qn=Symbol(void 0),$c=Symbol(void 0),ss=Symbol(void 0),ed=Symbol(void 0),hc=[];let Bs=null;function pt(t=!1){hc.push(Bs=t?null:[])}function sI(){hc.pop(),Bs=hc[hc.length-1]||null}let Za=1;function R1(t){Za+=t}function oI(t){return t.dynamicChildren=Za>0?Bs||Va:null,sI(),Za>0&&Bs&&Bs.push(t),t}function Vt(t,e,n,s,o,r){return oI(te(t,e,n,s,o,r,!0))}function Li(t,e,n,s,o){return oI(He(t,e,n,s,o,!0))}function Qa(t){return t?t.__v_isVNode===!0:!1}function Ao(t,e){return t.type===e.type&&t.key===e.key}const nf="__vInternal",rI=({key:t})=>t!=null?t:null,td=({ref:t,ref_key:e,ref_for:n})=>t!=null?cn(t)||bn(t)||Xe(t)?{i:ns,r:t,k:e,f:!!n}:t:null;function te(t,e=null,n=null,s=0,o=null,r=t===Qn?0:1,i=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&rI(e),ref:e&&td(e),scopeId:Jd,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:r,patchFlag:s,dynamicProps:o,dynamicChildren:null,appContext:null};return a?(zb(l,n),r&128&&t.normalize(l)):n&&(l.shapeFlag|=cn(n)?8:16),Za>0&&!i&&Bs&&(l.patchFlag>0||r&6)&&l.patchFlag!==32&&Bs.push(l),l}const He=xL;function xL(t,e=null,n=null,s=0,o=null,r=!1){if((!t||t===YF)&&(t=ss),Qa(t)){const a=rr(t,e,!0);return n&&zb(a,n),Za>0&&!r&&Bs&&(a.shapeFlag&6?Bs[Bs.indexOf(t)]=a:Bs.push(a)),a.patchFlag|=-2,a}if(SL(t)&&(t=t.__vccOpts),e){e=yL(e);let{class:a,style:l}=e;a&&!cn(a)&&(e.class=Sr(a)),Ut(l)&&(w$(l)&&!je(l)&&(l=On({},l)),e.style=jd(l))}const i=cn(t)?1:F$(t)?128:bL(t)?64:Ut(t)?4:Xe(t)?2:0;return te(t,e,n,s,o,i,r,!0)}function yL(t){return t?w$(t)||nf in t?On({},t):t:null}function rr(t,e,n=!1){const{props:s,ref:o,patchFlag:r,children:i}=t,a=e?vL(s||{},e):s;return{__v_isVNode:!0,__v_skip:!0,type:t.type,props:a,key:a&&rI(a),ref:e&&e.ref?n&&o?je(o)?o.concat(td(e)):[o,td(e)]:td(e):o,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:i,target:t.target,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==Qn?r===-1?16:r|16:r,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:t.transition,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&rr(t.ssContent),ssFallback:t.ssFallback&&rr(t.ssFallback),el:t.el,anchor:t.anchor}}function At(t=" ",e=0){return He($c,null,t,e)}function Jo(t="",e=!1){return e?(pt(),Li(ss,null,t)):He(ss,null,t)}function Ls(t){return t==null||typeof t=="boolean"?He(ss):je(t)?He(Qn,null,t.slice()):typeof t=="object"?Ir(t):He($c,null,String(t))}function Ir(t){return t.el===null||t.memo?t:rr(t)}function zb(t,e){let n=0;const{shapeFlag:s}=t;if(e==null)e=null;else if(je(e))n=16;else if(typeof e=="object")if(s&65){const o=e.default;o&&(o._c&&(o._d=!1),zb(t,o()),o._c&&(o._d=!0));return}else{n=32;const o=e._;!o&&!(nf in e)?e._ctx=ns:o===3&&ns&&(ns.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else Xe(e)?(e={default:e,_ctx:ns},n=32):(e=String(e),s&64?(n=16,e=[At(e)]):n=8);t.children=e,t.shapeFlag|=n}function vL(...t){const e={};for(let n=0;n<t.length;n++){const s=t[n];for(const o in s)if(o==="class")e.class!==s.class&&(e.class=Sr([e.class,s.class]));else if(o==="style")e.style=jd([e.style,s.style]);else if(Fc(o)){const r=e[o],i=s[o];i&&r!==i&&!(je(r)&&r.includes(i))&&(e[o]=r?[].concat(r,i):i)}else o!==""&&(e[o]=s[o])}return e}function ls(t,e,n,s=null){Gs(t,e,7,[n,s])}const wL=eI();let CL=0;function $L(t,e,n){const s=t.type,o=(e?e.appContext:t.appContext)||wL,r={uid:CL++,vnode:t,type:s,parent:e,appContext:o,root:null,next:null,subTree:null,effect:null,update:null,scope:new HO(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(o.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Y$(s,o),emitsOptions:R$(s,o),emit:null,emitted:null,propsDefaults:Lt,inheritAttrs:s.inheritAttrs,ctx:Lt,data:Lt,props:Lt,attrs:Lt,slots:Lt,refs:Lt,setupState:Lt,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return r.ctx={_:r},r.root=e?e.root:r,r.emit=EF.bind(null,r),t.ce&&t.ce(r),r}let pn=null;const wl=()=>pn||ns,Ja=t=>{pn=t,t.scope.on()},Pi=()=>{pn&&pn.scope.off(),pn=null};function iI(t){return t.vnode.shapeFlag&4}let el=!1;function IL(t,e=!1){el=e;const{props:n,children:s}=t.vnode,o=iI(t);iL(t,n,o,e),cL(t,s);const r=o?_L(t,e):void 0;return el=!1,r}function _L(t,e){const n=t.type;t.accessCache=Object.create(null),t.proxy=Rb(new Proxy(t.ctx,eL));const{setup:s}=n;if(s){const o=t.setupContext=s.length>1?EL(t):null;Ja(t),xl();const r=Rr(s,t,0,[t.props,o]);if(yl(),Pi(),a$(r)){if(r.then(Pi,Pi),e)return r.then(i=>{bg(t,i,e)}).catch(i=>{vl(i,t,0)});t.asyncDep=r}else bg(t,r,e)}else aI(t,e)}function bg(t,e,n){Xe(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:Ut(e)&&(t.setupState=_$(e)),aI(t,n)}let D1;function aI(t,e,n){const s=t.type;if(!t.render){if(!e&&D1&&!s.render){const o=s.template||Bb(t).template;if(o){const{isCustomElement:r,compilerOptions:i}=t.appContext.config,{delimiters:a,compilerOptions:l}=s,c=On(On({isCustomElement:r,delimiters:a},i),l);s.render=D1(o,c)}}t.render=s.render||fo}Ja(t),xl(),tL(t),yl(),Pi()}function kL(t){return new Proxy(t.attrs,{get(e,n){return ks(t,"get","$attrs"),e[n]}})}function EL(t){const e=s=>{t.exposed=s||{}};let n;return{get attrs(){return n||(n=kL(t))},slots:t.slots,emit:t.emit,expose:e}}function Wb(t){if(t.exposed)return t.exposeProxy||(t.exposeProxy=new Proxy(_$(Rb(t.exposed)),{get(e,n){if(n in e)return e[n];if(n in hd)return hd[n](t)}}))}function xg(t,e=!0){return Xe(t)?t.displayName||t.name:t.name||e&&t.__name}function SL(t){return Xe(t)&&"__vccOpts"in t}const mn=(t,e)=>CF(t,e,el);function $s(t,e,n){const s=arguments.length;return s===2?Ut(e)&&!je(e)?Qa(e)?He(t,null,[e]):He(t,e):He(t,null,e):(s>3?n=Array.prototype.slice.call(arguments,2):s===3&&Qa(n)&&(n=[n]),He(t,e,n))}const TL="3.2.39",NL="http://www.w3.org/2000/svg",_i=typeof document<"u"?document:null,O1=_i&&_i.createElement("template"),AL={insert:(t,e,n)=>{e.insertBefore(t,n||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,n,s)=>{const o=e?_i.createElementNS(NL,t):_i.createElement(t,n?{is:n}:void 0);return t==="select"&&s&&s.multiple!=null&&o.setAttribute("multiple",s.multiple),o},createText:t=>_i.createTextNode(t),createComment:t=>_i.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>_i.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},cloneNode(t){const e=t.cloneNode(!0);return"_value"in t&&(e._value=t._value),e},insertStaticContent(t,e,n,s,o,r){const i=n?n.previousSibling:e.lastChild;if(o&&(o===r||o.nextSibling))for(;e.insertBefore(o.cloneNode(!0),n),!(o===r||!(o=o.nextSibling)););else{O1.innerHTML=s?`<svg>${t}</svg>`:t;const a=O1.content;if(s){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}e.insertBefore(a,n)}return[i?i.nextSibling:e.firstChild,n?n.previousSibling:e.lastChild]}};function RL(t,e,n){const s=t._vtc;s&&(e=(e?[e,...s]:[...s]).join(" ")),e==null?t.removeAttribute("class"):n?t.setAttribute("class",e):t.className=e}function DL(t,e,n){const s=t.style,o=cn(n);if(n&&!o){for(const r in n)yg(s,r,n[r]);if(e&&!cn(e))for(const r in e)n[r]==null&&yg(s,r,"")}else{const r=s.display;o?e!==n&&(s.cssText=n):e&&t.removeAttribute("style"),"_vod"in t&&(s.display=r)}}const F1=/\s*!important$/;function yg(t,e,n){if(je(n))n.forEach(s=>yg(t,e,s));else if(n==null&&(n=""),e.startsWith("--"))t.setProperty(e,n);else{const s=OL(t,e);F1.test(n)?t.setProperty(bl(s),n.replace(F1,""),"important"):t[s]=n}}const L1=["Webkit","Moz","ms"],Rm={};function OL(t,e){const n=Rm[e];if(n)return n;let s=Vo(e);if(s!=="filter"&&s in t)return Rm[e]=s;s=Xd(s);for(let o=0;o<L1.length;o++){const r=L1[o]+s;if(r in t)return Rm[e]=r}return e}const P1="http://www.w3.org/1999/xlink";function FL(t,e,n,s,o){if(s&&e.startsWith("xlink:"))n==null?t.removeAttributeNS(P1,e.slice(6,e.length)):t.setAttributeNS(P1,e,n);else{const r=DO(e);n==null||r&&!o$(n)?t.removeAttribute(e):t.setAttribute(e,r?"":n)}}function LL(t,e,n,s,o,r,i){if(e==="innerHTML"||e==="textContent"){s&&i(s,o,r),t[e]=n==null?"":n;return}if(e==="value"&&t.tagName!=="PROGRESS"&&!t.tagName.includes("-")){t._value=n;const l=n==null?"":n;(t.value!==l||t.tagName==="OPTION")&&(t.value=l),n==null&&t.removeAttribute(e);return}let a=!1;if(n===""||n==null){const l=typeof t[e];l==="boolean"?n=o$(n):n==null&&l==="string"?(n="",a=!0):l==="number"&&(n=0,a=!0)}try{t[e]=n}catch{}a&&t.removeAttribute(e)}const[lI,PL]=(()=>{let t=Date.now,e=!1;if(typeof window<"u"){Date.now()>document.createEvent("Event").timeStamp&&(t=performance.now.bind(performance));const n=navigator.userAgent.match(/firefox\/(\d+)/i);e=!!(n&&Number(n[1])<=53)}return[t,e]})();let vg=0;const ML=Promise.resolve(),BL=()=>{vg=0},VL=()=>vg||(ML.then(BL),vg=lI());function zL(t,e,n,s){t.addEventListener(e,n,s)}function WL(t,e,n,s){t.removeEventListener(e,n,s)}function UL(t,e,n,s,o=null){const r=t._vei||(t._vei={}),i=r[e];if(s&&i)i.value=s;else{const[a,l]=HL(e);if(s){const c=r[e]=GL(s,o);zL(t,a,c,l)}else i&&(WL(t,a,i,l),r[e]=void 0)}}const M1=/(?:Once|Passive|Capture)$/;function HL(t){let e;if(M1.test(t)){e={};let s;for(;s=t.match(M1);)t=t.slice(0,t.length-s[0].length),e[s[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):bl(t.slice(2)),e]}function GL(t,e){const n=s=>{const o=s.timeStamp||lI();(PL||o>=n.attached-1)&&Gs(jL(s,n.value),e,5,[s])};return n.value=t,n.attached=VL(),n}function jL(t,e){if(je(e)){const n=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{n.call(t),t._stopped=!0},e.map(s=>o=>!o._stopped&&s&&s(o))}else return e}const B1=/^on[a-z]/,qL=(t,e,n,s,o=!1,r,i,a,l)=>{e==="class"?RL(t,s,o):e==="style"?DL(t,n,s):Fc(e)?wb(e)||UL(t,e,n,s,i):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):KL(t,e,s,o))?LL(t,e,s,r,i,a,l):(e==="true-value"?t._trueValue=s:e==="false-value"&&(t._falseValue=s),FL(t,e,s,o))};function KL(t,e,n,s){return s?!!(e==="innerHTML"||e==="textContent"||e in t&&B1.test(e)&&Xe(n)):e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA"||B1.test(e)&&cn(n)?!1:e in t}const wr="transition",Kl="animation",sf=(t,{slots:e})=>$s(B$,XL(t),e);sf.displayName="Transition";const cI={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String};sf.props=On({},B$.props,cI);const bi=(t,e=[])=>{je(t)?t.forEach(n=>n(...e)):t&&t(...e)},V1=t=>t?je(t)?t.some(e=>e.length>1):t.length>1:!1;function XL(t){const e={};for(const L in t)L in cI||(e[L]=t[L]);if(t.css===!1)return e;const{name:n="v",type:s,duration:o,enterFromClass:r=`${n}-enter-from`,enterActiveClass:i=`${n}-enter-active`,enterToClass:a=`${n}-enter-to`,appearFromClass:l=r,appearActiveClass:c=i,appearToClass:u=a,leaveFromClass:h=`${n}-leave-from`,leaveActiveClass:d=`${n}-leave-active`,leaveToClass:f=`${n}-leave-to`}=t,p=YL(o),g=p&&p[0],b=p&&p[1],{onBeforeEnter:x,onEnter:y,onEnterCancelled:w,onLeave:v,onLeaveCancelled:$,onBeforeAppear:_=x,onAppear:E=y,onAppearCancelled:k=w}=e,N=(L,H,M)=>{xi(L,H?u:a),xi(L,H?c:i),M&&M()},A=(L,H)=>{L._isLeaving=!1,xi(L,h),xi(L,f),xi(L,d),H&&H()},F=L=>(H,M)=>{const K=L?E:y,q=()=>N(H,L,M);bi(K,[H,q]),z1(()=>{xi(H,L?l:r),Cr(H,L?u:a),V1(K)||W1(H,s,g,q)})};return On(e,{onBeforeEnter(L){bi(x,[L]),Cr(L,r),Cr(L,i)},onBeforeAppear(L){bi(_,[L]),Cr(L,l),Cr(L,c)},onEnter:F(!1),onAppear:F(!0),onLeave(L,H){L._isLeaving=!0;const M=()=>A(L,H);Cr(L,h),JL(),Cr(L,d),z1(()=>{!L._isLeaving||(xi(L,h),Cr(L,f),V1(v)||W1(L,s,b,M))}),bi(v,[L,M])},onEnterCancelled(L){N(L,!1),bi(w,[L])},onAppearCancelled(L){N(L,!0),bi(k,[L])},onLeaveCancelled(L){A(L),bi($,[L])}})}function YL(t){if(t==null)return null;if(Ut(t))return[Dm(t.enter),Dm(t.leave)];{const e=Dm(t);return[e,e]}}function Dm(t){return _b(t)}function Cr(t,e){e.split(/\s+/).forEach(n=>n&&t.classList.add(n)),(t._vtc||(t._vtc=new Set)).add(e)}function xi(t,e){e.split(/\s+/).forEach(s=>s&&t.classList.remove(s));const{_vtc:n}=t;n&&(n.delete(e),n.size||(t._vtc=void 0))}function z1(t){requestAnimationFrame(()=>{requestAnimationFrame(t)})}let ZL=0;function W1(t,e,n,s){const o=t._endId=++ZL,r=()=>{o===t._endId&&s()};if(n)return setTimeout(r,n);const{type:i,timeout:a,propCount:l}=QL(t,e);if(!i)return s();const c=i+"end";let u=0;const h=()=>{t.removeEventListener(c,d),r()},d=f=>{f.target===t&&++u>=l&&h()};setTimeout(()=>{u<l&&h()},a+1),t.addEventListener(c,d)}function QL(t,e){const n=window.getComputedStyle(t),s=p=>(n[p]||"").split(", "),o=s(wr+"Delay"),r=s(wr+"Duration"),i=U1(o,r),a=s(Kl+"Delay"),l=s(Kl+"Duration"),c=U1(a,l);let u=null,h=0,d=0;e===wr?i>0&&(u=wr,h=i,d=r.length):e===Kl?c>0&&(u=Kl,h=c,d=l.length):(h=Math.max(i,c),u=h>0?i>c?wr:Kl:null,d=u?u===wr?r.length:l.length:0);const f=u===wr&&/\b(transform|all)(,|$)/.test(n[wr+"Property"]);return{type:u,timeout:h,propCount:d,hasTransform:f}}function U1(t,e){for(;t.length<e.length;)t=t.concat(t);return Math.max(...e.map((n,s)=>H1(n)+H1(t[s])))}function H1(t){return Number(t.slice(0,-1).replace(",","."))*1e3}function JL(){return document.body.offsetHeight}const uI=On({patchProp:qL},AL);let dc,G1=!1;function eP(){return dc||(dc=pL(uI))}function tP(){return dc=G1?dc:mL(uI),G1=!0,dc}const nP=(...t)=>{const e=eP().createApp(...t),{mount:n}=e;return e.mount=s=>{const o=hI(s);if(!o)return;const r=e._component;!Xe(r)&&!r.render&&!r.template&&(r.template=o.innerHTML),o.innerHTML="";const i=n(o,!1,o instanceof SVGElement);return o instanceof Element&&(o.removeAttribute("v-cloak"),o.setAttribute("data-v-app","")),i},e},sP=(...t)=>{const e=tP().createApp(...t),{mount:n}=e;return e.mount=s=>{const o=hI(s);if(o)return n(o,!0,o instanceof SVGElement)},e};function hI(t){return cn(t)?document.querySelector(t):t}const oP=/"(?:_|\\u005[Ff])(?:_|\\u005[Ff])(?:p|\\u0070)(?:r|\\u0072)(?:o|\\u006[Ff])(?:t|\\u0074)(?:o|\\u006[Ff])(?:_|\\u005[Ff])(?:_|\\u005[Ff])"\s*:/,rP=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,iP=/^["{[]|^-?[0-9][0-9.]{0,14}$/;function aP(t,e){if(!(t==="__proto__"||t==="constructor"))return e}function lP(t){if(typeof t!="string")return t;const e=t.toLowerCase();if(e==="true")return!0;if(e==="false")return!1;if(e==="null")return null;if(e==="nan")return NaN;if(e==="infinity")return 1/0;if(e!=="undefined"){if(!iP.test(t))return t;try{return oP.test(t)||rP.test(t)?JSON.parse(t,aP):JSON.parse(t)}catch{return t}}}const cP=/#/g,uP=/&/g,hP=/=/g,dI=/\+/g,dP=/%5B/gi,fP=/%5D/gi,pP=/%5E/gi,mP=/%60/gi,gP=/%7B/gi,bP=/%7C/gi,xP=/%7D/gi,yP=/%20/gi;function vP(t){return encodeURI(""+t).replace(bP,"|").replace(dP,"[").replace(fP,"]")}function wg(t){return vP(t).replace(dI,"%2B").replace(yP,"+").replace(cP,"%23").replace(uP,"%26").replace(mP,"`").replace(gP,"{").replace(xP,"}").replace(pP,"^")}function Om(t){return wg(t).replace(hP,"%3D")}function fI(t=""){try{return decodeURIComponent(""+t)}catch{return""+t}}function wP(t){return fI(t.replace(dI," "))}function CP(t=""){const e={};t[0]==="?"&&(t=t.substr(1));for(const n of t.split("&")){const s=n.match(/([^=]+)=?(.*)/)||[];if(s.length<2)continue;const o=fI(s[1]);if(o==="__proto__"||o==="constructor")continue;const r=wP(s[2]||"");e[o]?Array.isArray(e[o])?e[o].push(r):e[o]=[e[o],r]:e[o]=r}return e}function $P(t,e){return(typeof e=="number"||typeof e=="boolean")&&(e=String(e)),e?Array.isArray(e)?e.map(n=>`${Om(t)}=${wg(n)}`).join("&"):`${Om(t)}=${wg(e)}`:Om(t)}function IP(t){return Object.keys(t).map(e=>$P(e,t[e])).join("&")}const _P=/^\w+:(\/\/)?/,kP=/^\/\/[^/]+/;function Ub(t,e=!1){return _P.test(t)||e&&kP.test(t)}const EP=/\/$|\/\?/;function Cg(t="",e=!1){return e?EP.test(t):t.endsWith("/")}function pI(t="",e=!1){if(!e)return(Cg(t)?t.slice(0,-1):t)||"/";if(!Cg(t,!0))return t||"/";const[n,...s]=t.split("?");return(n.slice(0,-1)||"/")+(s.length?`?${s.join("?")}`:"")}function SP(t="",e=!1){if(!e)return t.endsWith("/")?t:t+"/";if(Cg(t,!0))return t||"/";const[n,...s]=t.split("?");return n+"/"+(s.length?`?${s.join("?")}`:"")}function TP(t=""){return t.startsWith("/")}function NP(t=""){return(TP(t)?t.substr(1):t)||"/"}function AP(t,e){if(mI(e))return t;const n=pI(e);return t.startsWith(n)?t:of(n,t)}function j1(t,e){if(mI(e))return t;const n=pI(e);if(!t.startsWith(n))return t;const s=t.substring(n.length);return s[0]==="/"?s:"/"+s}function RP(t,e){const n=rf(t),s={...CP(n.search),...e};return n.search=IP(s),OP(n)}function mI(t){return!t||t==="/"}function DP(t){return t&&t!=="/"}function of(t,...e){let n=t||"";for(const s of e.filter(DP))n=n?SP(n)+NP(s):s;return n}function rf(t="",e){if(!Ub(t,!0))return e?rf(e+t):q1(t);const[n="",s,o=""]=(t.replace(/\\/g,"/").match(/([^:/]+:)?\/\/([^/@]+@)?(.*)/)||[]).splice(1),[r="",i=""]=(o.match(/([^/?#]*)(.*)?/)||[]).splice(1),{pathname:a,search:l,hash:c}=q1(i);return{protocol:n,auth:s?s.substr(0,s.length-1):"",host:r,pathname:a,search:l,hash:c}}function q1(t=""){const[e="",n="",s=""]=(t.match(/([^#?]*)(\?[^#]*)?(#.*)?/)||[]).splice(1);return{pathname:e,search:n,hash:s}}function OP(t){const e=t.pathname+(t.search?(t.search.startsWith("?")?"":"?")+t.search:"")+t.hash;return t.protocol?t.protocol+"//"+(t.auth?t.auth+"@":"")+t.host+e:e}class FP extends Error{constructor(){super(...arguments),this.name="FetchError"}}function LP(t,e,n){let s="";t&&n&&(s=`${n.status} ${n.statusText} (${t.toString()})`),e&&(s=`${e.message} (${s})`);const o=new FP(s);return Object.defineProperty(o,"request",{get(){return t}}),Object.defineProperty(o,"response",{get(){return n}}),Object.defineProperty(o,"data",{get(){return n&&n._data}}),o}const PP=new Set(Object.freeze(["PATCH","POST","PUT","DELETE"]));function K1(t="GET"){return PP.has(t.toUpperCase())}function MP(t){if(t===void 0)return!1;const e=typeof t;return e==="string"||e==="number"||e==="boolean"||e===null?!0:e!=="object"?!1:Array.isArray(t)?!0:t.constructor&&t.constructor.name==="Object"||typeof t.toJSON=="function"}const BP=new Set(["image/svg","application/xml","application/xhtml","application/html"]),VP=/^application\/(?:[\w!#$%&*`\-.^~]*\+)?json(;.+)?$/i;function zP(t=""){if(!t)return"json";const e=t.split(";").shift();return VP.test(e)?"json":BP.has(e)||e.startsWith("text/")?"text":"blob"}const WP=new Set([408,409,425,429,500,502,503,504]);function gI(t){const{fetch:e,Headers:n}=t;function s(i){const a=i.error&&i.error.name==="AbortError"||!1;if(i.options.retry!==!1&&!a){const c=typeof i.options.retry=="number"?i.options.retry:K1(i.options.method)?0:1,u=i.response&&i.response.status||500;if(c>0&&WP.has(u))return o(i.request,{...i.options,retry:c-1})}const l=LP(i.request,i.error,i.response);throw Error.captureStackTrace&&Error.captureStackTrace(l,o),l}const o=async function(a,l={}){const c={request:a,options:{...t.defaults,...l},response:void 0,error:void 0};c.options.onRequest&&await c.options.onRequest(c),typeof c.request=="string"&&(c.options.baseURL&&(c.request=AP(c.request,c.options.baseURL)),(c.options.query||c.options.params)&&(c.request=RP(c.request,{...c.options.params,...c.options.query})),c.options.body&&K1(c.options.method)&&MP(c.options.body)&&(c.options.body=typeof c.options.body=="string"?c.options.body:JSON.stringify(c.options.body),c.options.headers=new n(c.options.headers),c.options.headers.has("content-type")||c.options.headers.set("content-type","application/json"),c.options.headers.has("accept")||c.options.headers.set("accept","application/json"))),c.response=await e(c.request,c.options).catch(async h=>(c.error=h,c.options.onRequestError&&await c.options.onRequestError(c),s(c)));const u=(c.options.parseResponse?"json":c.options.responseType)||zP(c.response.headers.get("content-type")||"");if(u==="json"){const h=await c.response.text(),d=c.options.parseResponse||lP;c.response._data=d(h)}else u==="stream"?c.response._data=c.response.body:c.response._data=await c.response[u]();return c.options.onResponse&&await c.options.onResponse(c),c.response.ok||c.options.onResponseError&&await c.options.onResponseError(c),c.response.ok?c.response:s(c)},r=function(a,l){return o(a,l).then(c=>c._data)};return r.raw=o,r.create=(i={})=>gI({...t,defaults:{...t.defaults,...i}}),r}const bI=function(){if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")}(),UP=bI.fetch||(()=>Promise.reject(new Error("[ohmyfetch] global.fetch is not supported!"))),HP=bI.Headers,GP=gI({fetch:UP,Headers:HP}),jP=()=>{var t;return((t=window==null?void 0:window.__NUXT__)==null?void 0:t.config)||{}},pd=jP().app,qP=()=>pd.baseURL,KP=()=>pd.buildAssetsDir,XP=(...t)=>of(xI(),KP(),...t),xI=(...t)=>{const e=pd.cdnURL||pd.baseURL;return t.length?of(e,...t):e};globalThis.__buildAssetsURL=XP;globalThis.__publicAssetsURL=xI;function $g(t,e={},n){for(const s in t){const o=t[s],r=n?`${n}:${s}`:s;typeof o=="object"&&o!==null?$g(o,e,r):typeof o=="function"&&(e[r]=o)}return e}function YP(t,e){return t.reduce((n,s)=>n.then(()=>s.apply(void 0,e)),Promise.resolve(null))}function ZP(t,e){return Promise.all(t.map(n=>n.apply(void 0,e)))}function Fm(t,e){for(const n of t)n(e)}class QP{constructor(){this._hooks={},this._before=null,this._after=null,this._deprecatedMessages=null,this._deprecatedHooks={},this.hook=this.hook.bind(this),this.callHook=this.callHook.bind(this),this.callHookWith=this.callHookWith.bind(this)}hook(e,n,s={}){if(!e||typeof n!="function")return()=>{};const o=e;let r;for(;this._deprecatedHooks[e];)r=this._deprecatedHooks[e],e=r.to;if(r&&!s.allowDeprecated){let i=r.message;i||(i=`${o} hook has been deprecated`+(r.to?`, please use ${r.to}`:"")),this._deprecatedMessages||(this._deprecatedMessages=new Set),this._deprecatedMessages.has(i)||(console.warn(i),this._deprecatedMessages.add(i))}return this._hooks[e]=this._hooks[e]||[],this._hooks[e].push(n),()=>{n&&(this.removeHook(e,n),n=null)}}hookOnce(e,n){let s,o=(...r)=>(s(),s=null,o=null,n(...r));return s=this.hook(e,o),s}removeHook(e,n){if(this._hooks[e]){const s=this._hooks[e].indexOf(n);s!==-1&&this._hooks[e].splice(s,1),this._hooks[e].length===0&&delete this._hooks[e]}}deprecateHook(e,n){this._deprecatedHooks[e]=typeof n=="string"?{to:n}:n;const s=this._hooks[e]||[];this._hooks[e]=void 0;for(const o of s)this.hook(e,o)}deprecateHooks(e){Object.assign(this._deprecatedHooks,e);for(const n in e)this.deprecateHook(n,e[n])}addHooks(e){const n=$g(e),s=Object.keys(n).map(o=>this.hook(o,n[o]));return()=>{s.splice(0,s.length).forEach(o=>o())}}removeHooks(e){const n=$g(e);for(const s in n)this.removeHook(s,n[s])}callHook(e,...n){return this.callHookWith(YP,e,...n)}callHookParallel(e,...n){return this.callHookWith(ZP,e,...n)}callHookWith(e,n,...s){const o=this._before||this._after?{name:n,args:s,context:{}}:void 0;this._before&&Fm(this._before,o);const r=e(this._hooks[n]||[],s);return r instanceof Promise?r.finally(()=>{this._after&&Fm(this._after,o)}):(this._after&&Fm(this._after,o),r)}beforeEach(e){this._before=this._before||[],this._before.push(e)}afterEach(e){this._after=this._after||[],this._after.push(e)}}function JP(){return new QP}function eM(){let t=null,e=!1;const n=s=>{if(t&&t!==s)throw new Error("Context conflict")};return{use:()=>{if(t==null)throw new Error("Context is not available");return t},tryUse:()=>t,set:(s,o)=>{o||n(s),t=s,e=!0},unset:()=>{t=null,e=!1},call:(s,o)=>{n(s),t=s;try{return o()}finally{e||(t=null)}},async callAsync(s,o){t=s;const r=()=>{t=s},i=()=>t===s?r:void 0;Ig.add(i);try{const a=o();return e||(t=null),await a}finally{Ig.delete(i)}}}}function tM(){const t={};return{get(e){return t[e]||(t[e]=eM()),t[e],t[e]}}}const md=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof global<"u"?global:typeof window<"u"?window:{},X1="__unctx__",nM=md[X1]||(md[X1]=tM()),sM=t=>nM.get(t),Y1="__unctx_async_handlers__",Ig=md[Y1]||(md[Y1]=new Set);function oM(t){const e=[];for(const o of Ig){const r=o();r&&e.push(r)}const n=()=>{for(const o of e)o()};let s=t();return"catch"in s&&(s=s.catch(o=>{throw n(),o})),[s,n]}const yI=sM("nuxt-app"),rM="__nuxt_plugin";function iM(t){const e={provide:void 0,globalName:"nuxt",payload:zo({data:{},state:{},_errors:{},...window.__NUXT__}),isHydrating:!0,_asyncDataPromises:{},_asyncData:{},...t};e.hooks=JP(),e.hook=e.hooks.hook,e.callHook=e.hooks.callHook,e.provide=(o,r)=>{const i="$"+o;Fh(e,i,r),Fh(e.vueApp.config.globalProperties,i,r)},Fh(e.vueApp,"$nuxt",e),Fh(e.vueApp.config.globalProperties,"$nuxt",e);const n=zo(e.payload.config),s=new Proxy(n,{get(o,r){var i;return r==="public"?o.public:(i=o[r])!=null?i:o.public[r]},set(o,r,i){return r==="public"||r==="app"?!1:(o[r]=i,o.public[r]=i,!0)}});return e.provide("config",s),e}async function aM(t,e){if(typeof e!="function")return;const{provide:n}=await _r(t,e,[t])||{};if(n&&typeof n=="object")for(const s in n)t.provide(s,n[s])}async function lM(t,e){for(const n of e)await aM(t,n)}function cM(t){return t.map(n=>typeof n!="function"?null:n.length>1?s=>n(s,s.provide):n).filter(Boolean)}function Cl(t){return t[rM]=!0,t}function _r(t,e,n){const s=()=>n?e(...n):e();return yI.set(t),s()}function Fn(){const t=yI.tryUse();if(!t){const e=wl();if(!e)throw new Error("nuxt instance unavailable");return e.appContext.app.$nuxt}return t}function uM(){return Fn().$config}function Fh(t,e,n){Object.defineProperty(t,e,{get:()=>n})}/*!
  * vue-router v4.1.5
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */const Da=typeof window<"u";function hM(t){return t.__esModule||t[Symbol.toStringTag]==="Module"}const Ct=Object.assign;function Lm(t,e){const n={};for(const s in e){const o=e[s];n[s]=go(o)?o.map(t):t(o)}return n}const fc=()=>{},go=Array.isArray,dM=/\/$/,fM=t=>t.replace(dM,"");function Pm(t,e,n="/"){let s,o={},r="",i="";const a=e.indexOf("#");let l=e.indexOf("?");return a<l&&a>=0&&(l=-1),l>-1&&(s=e.slice(0,l),r=e.slice(l+1,a>-1?a:e.length),o=t(r)),a>-1&&(s=s||e.slice(0,a),i=e.slice(a,e.length)),s=bM(s!=null?s:e,n),{fullPath:s+(r&&"?")+r+i,path:s,query:o,hash:i}}function pM(t,e){const n=e.query?t(e.query):"";return e.path+(n&&"?")+n+(e.hash||"")}function Z1(t,e){return!e||!t.toLowerCase().startsWith(e.toLowerCase())?t:t.slice(e.length)||"/"}function mM(t,e,n){const s=e.matched.length-1,o=n.matched.length-1;return s>-1&&s===o&&tl(e.matched[s],n.matched[o])&&vI(e.params,n.params)&&t(e.query)===t(n.query)&&e.hash===n.hash}function tl(t,e){return(t.aliasOf||t)===(e.aliasOf||e)}function vI(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(!gM(t[n],e[n]))return!1;return!0}function gM(t,e){return go(t)?Q1(t,e):go(e)?Q1(e,t):t===e}function Q1(t,e){return go(e)?t.length===e.length&&t.every((n,s)=>n===e[s]):t.length===1&&t[0]===e}function bM(t,e){if(t.startsWith("/"))return t;if(!t)return e;const n=e.split("/"),s=t.split("/");let o=n.length-1,r,i;for(r=0;r<s.length;r++)if(i=s[r],i!==".")if(i==="..")o>1&&o--;else break;return n.slice(0,o).join("/")+"/"+s.slice(r-(r===s.length?1:0)).join("/")}var Ic;(function(t){t.pop="pop",t.push="push"})(Ic||(Ic={}));var pc;(function(t){t.back="back",t.forward="forward",t.unknown=""})(pc||(pc={}));function xM(t){if(!t)if(Da){const e=document.querySelector("base");t=e&&e.getAttribute("href")||"/",t=t.replace(/^\w+:\/\/[^\/]+/,"")}else t="/";return t[0]!=="/"&&t[0]!=="#"&&(t="/"+t),fM(t)}const yM=/^[^#]+#/;function vM(t,e){return t.replace(yM,"#")+e}function wM(t,e){const n=document.documentElement.getBoundingClientRect(),s=t.getBoundingClientRect();return{behavior:e.behavior,left:s.left-n.left-(e.left||0),top:s.top-n.top-(e.top||0)}}const af=()=>({left:window.pageXOffset,top:window.pageYOffset});function CM(t){let e;if("el"in t){const n=t.el,s=typeof n=="string"&&n.startsWith("#"),o=typeof n=="string"?s?document.getElementById(n.slice(1)):document.querySelector(n):n;if(!o)return;e=wM(o,t)}else e=t;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.pageXOffset,e.top!=null?e.top:window.pageYOffset)}function J1(t,e){return(history.state?history.state.position-e:-1)+t}const _g=new Map;function $M(t,e){_g.set(t,e)}function IM(t){const e=_g.get(t);return _g.delete(t),e}let _M=()=>location.protocol+"//"+location.host;function wI(t,e){const{pathname:n,search:s,hash:o}=e,r=t.indexOf("#");if(r>-1){let a=o.includes(t.slice(r))?t.slice(r).length:1,l=o.slice(a);return l[0]!=="/"&&(l="/"+l),Z1(l,"")}return Z1(n,t)+s+o}function kM(t,e,n,s){let o=[],r=[],i=null;const a=({state:d})=>{const f=wI(t,location),p=n.value,g=e.value;let b=0;if(d){if(n.value=f,e.value=d,i&&i===p){i=null;return}b=g?d.position-g.position:0}else s(f);o.forEach(x=>{x(n.value,p,{delta:b,type:Ic.pop,direction:b?b>0?pc.forward:pc.back:pc.unknown})})};function l(){i=n.value}function c(d){o.push(d);const f=()=>{const p=o.indexOf(d);p>-1&&o.splice(p,1)};return r.push(f),f}function u(){const{history:d}=window;!d.state||d.replaceState(Ct({},d.state,{scroll:af()}),"")}function h(){for(const d of r)d();r=[],window.removeEventListener("popstate",a),window.removeEventListener("beforeunload",u)}return window.addEventListener("popstate",a),window.addEventListener("beforeunload",u),{pauseListeners:l,listen:c,destroy:h}}function ew(t,e,n,s=!1,o=!1){return{back:t,current:e,forward:n,replaced:s,position:window.history.length,scroll:o?af():null}}function EM(t){const{history:e,location:n}=window,s={value:wI(t,n)},o={value:e.state};o.value||r(s.value,{back:null,current:s.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function r(l,c,u){const h=t.indexOf("#"),d=h>-1?(n.host&&document.querySelector("base")?t:t.slice(h))+l:_M()+t+l;try{e[u?"replaceState":"pushState"](c,"",d),o.value=c}catch(f){console.error(f),n[u?"replace":"assign"](d)}}function i(l,c){const u=Ct({},e.state,ew(o.value.back,l,o.value.forward,!0),c,{position:o.value.position});r(l,u,!0),s.value=l}function a(l,c){const u=Ct({},o.value,e.state,{forward:l,scroll:af()});r(u.current,u,!0);const h=Ct({},ew(s.value,l,null),{position:u.position+1},c);r(l,h,!1),s.value=l}return{location:s,state:o,push:a,replace:i}}function CI(t){t=xM(t);const e=EM(t),n=kM(t,e.state,e.location,e.replace);function s(r,i=!0){i||n.pauseListeners(),history.go(r)}const o=Ct({location:"",base:t,go:s,createHref:vM.bind(null,t)},e,n);return Object.defineProperty(o,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(o,"state",{enumerable:!0,get:()=>e.state.value}),o}function SM(t){return t=location.host?t||location.pathname+location.search:"",t.includes("#")||(t+="#"),CI(t)}function TM(t){return typeof t=="string"||t&&typeof t=="object"}function $I(t){return typeof t=="string"||typeof t=="symbol"}const $r={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},II=Symbol("");var tw;(function(t){t[t.aborted=4]="aborted",t[t.cancelled=8]="cancelled",t[t.duplicated=16]="duplicated"})(tw||(tw={}));function nl(t,e){return Ct(new Error,{type:t,[II]:!0},e)}function Yo(t,e){return t instanceof Error&&II in t&&(e==null||!!(t.type&e))}const nw="[^/]+?",NM={sensitive:!1,strict:!1,start:!0,end:!0},AM=/[.+*?^${}()[\]/\\]/g;function RM(t,e){const n=Ct({},NM,e),s=[];let o=n.start?"^":"";const r=[];for(const c of t){const u=c.length?[]:[90];n.strict&&!c.length&&(o+="/");for(let h=0;h<c.length;h++){const d=c[h];let f=40+(n.sensitive?.25:0);if(d.type===0)h||(o+="/"),o+=d.value.replace(AM,"\\$&"),f+=40;else if(d.type===1){const{value:p,repeatable:g,optional:b,regexp:x}=d;r.push({name:p,repeatable:g,optional:b});const y=x||nw;if(y!==nw){f+=10;try{new RegExp(`(${y})`)}catch(v){throw new Error(`Invalid custom RegExp for param "${p}" (${y}): `+v.message)}}let w=g?`((?:${y})(?:/(?:${y}))*)`:`(${y})`;h||(w=b&&c.length<2?`(?:/${w})`:"/"+w),b&&(w+="?"),o+=w,f+=20,b&&(f+=-8),g&&(f+=-20),y===".*"&&(f+=-50)}u.push(f)}s.push(u)}if(n.strict&&n.end){const c=s.length-1;s[c][s[c].length-1]+=.7000000000000001}n.strict||(o+="/?"),n.end?o+="$":n.strict&&(o+="(?:/|$)");const i=new RegExp(o,n.sensitive?"":"i");function a(c){const u=c.match(i),h={};if(!u)return null;for(let d=1;d<u.length;d++){const f=u[d]||"",p=r[d-1];h[p.name]=f&&p.repeatable?f.split("/"):f}return h}function l(c){let u="",h=!1;for(const d of t){(!h||!u.endsWith("/"))&&(u+="/"),h=!1;for(const f of d)if(f.type===0)u+=f.value;else if(f.type===1){const{value:p,repeatable:g,optional:b}=f,x=p in c?c[p]:"";if(go(x)&&!g)throw new Error(`Provided param "${p}" is an array but it is not repeatable (* or + modifiers)`);const y=go(x)?x.join("/"):x;if(!y)if(b)d.length<2&&(u.endsWith("/")?u=u.slice(0,-1):h=!0);else throw new Error(`Missing required param "${p}"`);u+=y}}return u||"/"}return{re:i,score:s,keys:r,parse:a,stringify:l}}function DM(t,e){let n=0;for(;n<t.length&&n<e.length;){const s=e[n]-t[n];if(s)return s;n++}return t.length<e.length?t.length===1&&t[0]===40+40?-1:1:t.length>e.length?e.length===1&&e[0]===40+40?1:-1:0}function OM(t,e){let n=0;const s=t.score,o=e.score;for(;n<s.length&&n<o.length;){const r=DM(s[n],o[n]);if(r)return r;n++}if(Math.abs(o.length-s.length)===1){if(sw(s))return 1;if(sw(o))return-1}return o.length-s.length}function sw(t){const e=t[t.length-1];return t.length>0&&e[e.length-1]<0}const FM={type:0,value:""},LM=/[a-zA-Z0-9_]/;function PM(t){if(!t)return[[]];if(t==="/")return[[FM]];if(!t.startsWith("/"))throw new Error(`Invalid path "${t}"`);function e(f){throw new Error(`ERR (${n})/"${c}": ${f}`)}let n=0,s=n;const o=[];let r;function i(){r&&o.push(r),r=[]}let a=0,l,c="",u="";function h(){!c||(n===0?r.push({type:0,value:c}):n===1||n===2||n===3?(r.length>1&&(l==="*"||l==="+")&&e(`A repeatable param (${c}) must be alone in its segment. eg: '/:ids+.`),r.push({type:1,value:c,regexp:u,repeatable:l==="*"||l==="+",optional:l==="*"||l==="?"})):e("Invalid state to consume buffer"),c="")}function d(){c+=l}for(;a<t.length;){if(l=t[a++],l==="\\"&&n!==2){s=n,n=4;continue}switch(n){case 0:l==="/"?(c&&h(),i()):l===":"?(h(),n=1):d();break;case 4:d(),n=s;break;case 1:l==="("?n=2:LM.test(l)?d():(h(),n=0,l!=="*"&&l!=="?"&&l!=="+"&&a--);break;case 2:l===")"?u[u.length-1]=="\\"?u=u.slice(0,-1)+l:n=3:u+=l;break;case 3:h(),n=0,l!=="*"&&l!=="?"&&l!=="+"&&a--,u="";break;default:e("Unknown state");break}}return n===2&&e(`Unfinished custom RegExp for param "${c}"`),h(),i(),o}function MM(t,e,n){const s=RM(PM(t.path),n),o=Ct(s,{record:t,parent:e,children:[],alias:[]});return e&&!o.record.aliasOf==!e.record.aliasOf&&e.children.push(o),o}function BM(t,e){const n=[],s=new Map;e=iw({strict:!1,end:!0,sensitive:!1},e);function o(u){return s.get(u)}function r(u,h,d){const f=!d,p=VM(u);p.aliasOf=d&&d.record;const g=iw(e,u),b=[p];if("alias"in u){const w=typeof u.alias=="string"?[u.alias]:u.alias;for(const v of w)b.push(Ct({},p,{components:d?d.record.components:p.components,path:v,aliasOf:d?d.record:p}))}let x,y;for(const w of b){const{path:v}=w;if(h&&v[0]!=="/"){const $=h.record.path,_=$[$.length-1]==="/"?"":"/";w.path=h.record.path+(v&&_+v)}if(x=MM(w,h,g),d?d.alias.push(x):(y=y||x,y!==x&&y.alias.push(x),f&&u.name&&!rw(x)&&i(u.name)),p.children){const $=p.children;for(let _=0;_<$.length;_++)r($[_],x,d&&d.children[_])}d=d||x,l(x)}return y?()=>{i(y)}:fc}function i(u){if($I(u)){const h=s.get(u);h&&(s.delete(u),n.splice(n.indexOf(h),1),h.children.forEach(i),h.alias.forEach(i))}else{const h=n.indexOf(u);h>-1&&(n.splice(h,1),u.record.name&&s.delete(u.record.name),u.children.forEach(i),u.alias.forEach(i))}}function a(){return n}function l(u){let h=0;for(;h<n.length&&OM(u,n[h])>=0&&(u.record.path!==n[h].record.path||!_I(u,n[h]));)h++;n.splice(h,0,u),u.record.name&&!rw(u)&&s.set(u.record.name,u)}function c(u,h){let d,f={},p,g;if("name"in u&&u.name){if(d=s.get(u.name),!d)throw nl(1,{location:u});g=d.record.name,f=Ct(ow(h.params,d.keys.filter(y=>!y.optional).map(y=>y.name)),u.params&&ow(u.params,d.keys.map(y=>y.name))),p=d.stringify(f)}else if("path"in u)p=u.path,d=n.find(y=>y.re.test(p)),d&&(f=d.parse(p),g=d.record.name);else{if(d=h.name?s.get(h.name):n.find(y=>y.re.test(h.path)),!d)throw nl(1,{location:u,currentLocation:h});g=d.record.name,f=Ct({},h.params,u.params),p=d.stringify(f)}const b=[];let x=d;for(;x;)b.unshift(x.record),x=x.parent;return{name:g,path:p,params:f,matched:b,meta:WM(b)}}return t.forEach(u=>r(u)),{addRoute:r,resolve:c,removeRoute:i,getRoutes:a,getRecordMatcher:o}}function ow(t,e){const n={};for(const s of e)s in t&&(n[s]=t[s]);return n}function VM(t){return{path:t.path,redirect:t.redirect,name:t.name,meta:t.meta||{},aliasOf:void 0,beforeEnter:t.beforeEnter,props:zM(t),children:t.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in t?t.components||null:t.component&&{default:t.component}}}function zM(t){const e={},n=t.props||!1;if("component"in t)e.default=n;else for(const s in t.components)e[s]=typeof n=="boolean"?n:n[s];return e}function rw(t){for(;t;){if(t.record.aliasOf)return!0;t=t.parent}return!1}function WM(t){return t.reduce((e,n)=>Ct(e,n.meta),{})}function iw(t,e){const n={};for(const s in t)n[s]=s in e?e[s]:t[s];return n}function _I(t,e){return e.children.some(n=>n===t||_I(t,n))}const kI=/#/g,UM=/&/g,HM=/\//g,GM=/=/g,jM=/\?/g,EI=/\+/g,qM=/%5B/g,KM=/%5D/g,SI=/%5E/g,XM=/%60/g,TI=/%7B/g,YM=/%7C/g,NI=/%7D/g,ZM=/%20/g;function Hb(t){return encodeURI(""+t).replace(YM,"|").replace(qM,"[").replace(KM,"]")}function QM(t){return Hb(t).replace(TI,"{").replace(NI,"}").replace(SI,"^")}function kg(t){return Hb(t).replace(EI,"%2B").replace(ZM,"+").replace(kI,"%23").replace(UM,"%26").replace(XM,"`").replace(TI,"{").replace(NI,"}").replace(SI,"^")}function JM(t){return kg(t).replace(GM,"%3D")}function e3(t){return Hb(t).replace(kI,"%23").replace(jM,"%3F")}function t3(t){return t==null?"":e3(t).replace(HM,"%2F")}function gd(t){try{return decodeURIComponent(""+t)}catch{}return""+t}function n3(t){const e={};if(t===""||t==="?")return e;const s=(t[0]==="?"?t.slice(1):t).split("&");for(let o=0;o<s.length;++o){const r=s[o].replace(EI," "),i=r.indexOf("="),a=gd(i<0?r:r.slice(0,i)),l=i<0?null:gd(r.slice(i+1));if(a in e){let c=e[a];go(c)||(c=e[a]=[c]),c.push(l)}else e[a]=l}return e}function aw(t){let e="";for(let n in t){const s=t[n];if(n=JM(n),s==null){s!==void 0&&(e+=(e.length?"&":"")+n);continue}(go(s)?s.map(r=>r&&kg(r)):[s&&kg(s)]).forEach(r=>{r!==void 0&&(e+=(e.length?"&":"")+n,r!=null&&(e+="="+r))})}return e}function s3(t){const e={};for(const n in t){const s=t[n];s!==void 0&&(e[n]=go(s)?s.map(o=>o==null?null:""+o):s==null?s:""+s)}return e}const o3=Symbol(""),lw=Symbol(""),Gb=Symbol(""),AI=Symbol(""),Eg=Symbol("");function Xl(){let t=[];function e(s){return t.push(s),()=>{const o=t.indexOf(s);o>-1&&t.splice(o,1)}}function n(){t=[]}return{add:e,list:()=>t,reset:n}}function kr(t,e,n,s,o){const r=s&&(s.enterCallbacks[o]=s.enterCallbacks[o]||[]);return()=>new Promise((i,a)=>{const l=h=>{h===!1?a(nl(4,{from:n,to:e})):h instanceof Error?a(h):TM(h)?a(nl(2,{from:e,to:h})):(r&&s.enterCallbacks[o]===r&&typeof h=="function"&&r.push(h),i())},c=t.call(s&&s.instances[o],e,n,l);let u=Promise.resolve(c);t.length<3&&(u=u.then(l)),u.catch(h=>a(h))})}function Mm(t,e,n,s){const o=[];for(const r of t)for(const i in r.components){let a=r.components[i];if(!(e!=="beforeRouteEnter"&&!r.instances[i]))if(r3(a)){const c=(a.__vccOpts||a)[e];c&&o.push(kr(c,n,s,r,i))}else{let l=a();o.push(()=>l.then(c=>{if(!c)return Promise.reject(new Error(`Couldn't resolve component "${i}" at "${r.path}"`));const u=hM(c)?c.default:c;r.components[i]=u;const d=(u.__vccOpts||u)[e];return d&&kr(d,n,s,r,i)()}))}}return o}function r3(t){return typeof t=="object"||"displayName"in t||"props"in t||"__vccOpts"in t}function cw(t){const e=Oo(Gb),n=Oo(AI),s=mn(()=>e.resolve(ts(t.to))),o=mn(()=>{const{matched:l}=s.value,{length:c}=l,u=l[c-1],h=n.matched;if(!u||!h.length)return-1;const d=h.findIndex(tl.bind(null,u));if(d>-1)return d;const f=uw(l[c-2]);return c>1&&uw(u)===f&&h[h.length-1].path!==f?h.findIndex(tl.bind(null,l[c-2])):d}),r=mn(()=>o.value>-1&&c3(n.params,s.value.params)),i=mn(()=>o.value>-1&&o.value===n.matched.length-1&&vI(n.params,s.value.params));function a(l={}){return l3(l)?e[ts(t.replace)?"replace":"push"](ts(t.to)).catch(fc):Promise.resolve()}return{route:s,href:mn(()=>s.value.href),isActive:r,isExactActive:i,navigate:a}}const i3=_t({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:cw,setup(t,{slots:e}){const n=zo(cw(t)),{options:s}=Oo(Gb),o=mn(()=>({[hw(t.activeClass,s.linkActiveClass,"router-link-active")]:n.isActive,[hw(t.exactActiveClass,s.linkExactActiveClass,"router-link-exact-active")]:n.isExactActive}));return()=>{const r=e.default&&e.default(n);return t.custom?r:$s("a",{"aria-current":n.isExactActive?t.ariaCurrentValue:null,href:n.href,onClick:n.navigate,class:o.value},r)}}}),a3=i3;function l3(t){if(!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)&&!t.defaultPrevented&&!(t.button!==void 0&&t.button!==0)){if(t.currentTarget&&t.currentTarget.getAttribute){const e=t.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return t.preventDefault&&t.preventDefault(),!0}}function c3(t,e){for(const n in e){const s=e[n],o=t[n];if(typeof s=="string"){if(s!==o)return!1}else if(!go(o)||o.length!==s.length||s.some((r,i)=>r!==o[i]))return!1}return!0}function uw(t){return t?t.aliasOf?t.aliasOf.path:t.path:""}const hw=(t,e,n)=>t!=null?t:e!=null?e:n,u3=_t({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(t,{attrs:e,slots:n}){const s=Oo(Eg),o=mn(()=>t.route||s.value),r=Oo(lw,0),i=mn(()=>{let c=ts(r);const{matched:u}=o.value;let h;for(;(h=u[c])&&!h.components;)c++;return c}),a=mn(()=>o.value.matched[i.value]);Oi(lw,mn(()=>i.value+1)),Oi(o3,a),Oi(Eg,o);const l=Di();return uc(()=>[l.value,a.value,t.name],([c,u,h],[d,f,p])=>{u&&(u.instances[h]=c,f&&f!==u&&c&&c===d&&(u.leaveGuards.size||(u.leaveGuards=f.leaveGuards),u.updateGuards.size||(u.updateGuards=f.updateGuards))),c&&u&&(!f||!tl(u,f)||!d)&&(u.enterCallbacks[h]||[]).forEach(g=>g(c))},{flush:"post"}),()=>{const c=o.value,u=t.name,h=a.value,d=h&&h.components[u];if(!d)return dw(n.default,{Component:d,route:c});const f=h.props[u],p=f?f===!0?c.params:typeof f=="function"?f(c):f:null,b=$s(d,Ct({},p,e,{onVnodeUnmounted:x=>{x.component.isUnmounted&&(h.instances[u]=null)},ref:l}));return dw(n.default,{Component:b,route:c})||b}}});function dw(t,e){if(!t)return null;const n=t(e);return n.length===1?n[0]:n}const RI=u3;function h3(t){const e=BM(t.routes,t),n=t.parseQuery||n3,s=t.stringifyQuery||aw,o=t.history,r=Xl(),i=Xl(),a=Xl(),l=ad($r);let c=$r;Da&&t.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const u=Lm.bind(null,G=>""+G),h=Lm.bind(null,t3),d=Lm.bind(null,gd);function f(G,le){let ne,B;return $I(G)?(ne=e.getRecordMatcher(G),B=le):B=G,e.addRoute(B,ne)}function p(G){const le=e.getRecordMatcher(G);le&&e.removeRoute(le)}function g(){return e.getRoutes().map(G=>G.record)}function b(G){return!!e.getRecordMatcher(G)}function x(G,le){if(le=Ct({},le||l.value),typeof G=="string"){const Ne=Pm(n,G,le.path),D=e.resolve({path:Ne.path},le),P=o.createHref(Ne.fullPath);return Ct(Ne,D,{params:d(D.params),hash:gd(Ne.hash),redirectedFrom:void 0,href:P})}let ne;if("path"in G)ne=Ct({},G,{path:Pm(n,G.path,le.path).path});else{const Ne=Ct({},G.params);for(const D in Ne)Ne[D]==null&&delete Ne[D];ne=Ct({},G,{params:h(G.params)}),le.params=h(le.params)}const B=e.resolve(ne,le),$e=G.hash||"";B.params=u(d(B.params));const Se=pM(s,Ct({},G,{hash:QM($e),path:B.path})),ke=o.createHref(Se);return Ct({fullPath:Se,hash:$e,query:s===aw?s3(G.query):G.query||{}},B,{redirectedFrom:void 0,href:ke})}function y(G){return typeof G=="string"?Pm(n,G,l.value.path):Ct({},G)}function w(G,le){if(c!==G)return nl(8,{from:le,to:G})}function v(G){return E(G)}function $(G){return v(Ct(y(G),{replace:!0}))}function _(G){const le=G.matched[G.matched.length-1];if(le&&le.redirect){const{redirect:ne}=le;let B=typeof ne=="function"?ne(G):ne;return typeof B=="string"&&(B=B.includes("?")||B.includes("#")?B=y(B):{path:B},B.params={}),Ct({query:G.query,hash:G.hash,params:"path"in B?{}:G.params},B)}}function E(G,le){const ne=c=x(G),B=l.value,$e=G.state,Se=G.force,ke=G.replace===!0,Ne=_(ne);if(Ne)return E(Ct(y(Ne),{state:typeof Ne=="object"?Ct({},$e,Ne.state):$e,force:Se,replace:ke}),le||ne);const D=ne;D.redirectedFrom=le;let P;return!Se&&mM(s,B,ne)&&(P=nl(16,{to:D,from:B}),pe(B,B,!0,!1)),(P?Promise.resolve(P):N(D,B)).catch(X=>Yo(X)?Yo(X,2)?X:ie(X):Q(X,D,B)).then(X=>{if(X){if(Yo(X,2))return E(Ct({replace:ke},y(X.to),{state:typeof X.to=="object"?Ct({},$e,X.to.state):$e,force:Se}),le||D)}else X=F(D,B,!0,ke,$e);return A(D,B,X),X})}function k(G,le){const ne=w(G,le);return ne?Promise.reject(ne):Promise.resolve()}function N(G,le){let ne;const[B,$e,Se]=d3(G,le);ne=Mm(B.reverse(),"beforeRouteLeave",G,le);for(const Ne of B)Ne.leaveGuards.forEach(D=>{ne.push(kr(D,G,le))});const ke=k.bind(null,G,le);return ne.push(ke),Sa(ne).then(()=>{ne=[];for(const Ne of r.list())ne.push(kr(Ne,G,le));return ne.push(ke),Sa(ne)}).then(()=>{ne=Mm($e,"beforeRouteUpdate",G,le);for(const Ne of $e)Ne.updateGuards.forEach(D=>{ne.push(kr(D,G,le))});return ne.push(ke),Sa(ne)}).then(()=>{ne=[];for(const Ne of G.matched)if(Ne.beforeEnter&&!le.matched.includes(Ne))if(go(Ne.beforeEnter))for(const D of Ne.beforeEnter)ne.push(kr(D,G,le));else ne.push(kr(Ne.beforeEnter,G,le));return ne.push(ke),Sa(ne)}).then(()=>(G.matched.forEach(Ne=>Ne.enterCallbacks={}),ne=Mm(Se,"beforeRouteEnter",G,le),ne.push(ke),Sa(ne))).then(()=>{ne=[];for(const Ne of i.list())ne.push(kr(Ne,G,le));return ne.push(ke),Sa(ne)}).catch(Ne=>Yo(Ne,8)?Ne:Promise.reject(Ne))}function A(G,le,ne){for(const B of a.list())B(G,le,ne)}function F(G,le,ne,B,$e){const Se=w(G,le);if(Se)return Se;const ke=le===$r,Ne=Da?history.state:{};ne&&(B||ke?o.replace(G.fullPath,Ct({scroll:ke&&Ne&&Ne.scroll},$e)):o.push(G.fullPath,$e)),l.value=G,pe(G,le,ne,ke),ie()}let L;function H(){L||(L=o.listen((G,le,ne)=>{if(!Ie.listening)return;const B=x(G),$e=_(B);if($e){E(Ct($e,{replace:!0}),B).catch(fc);return}c=B;const Se=l.value;Da&&$M(J1(Se.fullPath,ne.delta),af()),N(B,Se).catch(ke=>Yo(ke,12)?ke:Yo(ke,2)?(E(ke.to,B).then(Ne=>{Yo(Ne,20)&&!ne.delta&&ne.type===Ic.pop&&o.go(-1,!1)}).catch(fc),Promise.reject()):(ne.delta&&o.go(-ne.delta,!1),Q(ke,B,Se))).then(ke=>{ke=ke||F(B,Se,!1),ke&&(ne.delta&&!Yo(ke,8)?o.go(-ne.delta,!1):ne.type===Ic.pop&&Yo(ke,20)&&o.go(-1,!1)),A(B,Se,ke)}).catch(fc)}))}let M=Xl(),K=Xl(),q;function Q(G,le,ne){ie(G);const B=K.list();return B.length?B.forEach($e=>$e(G,le,ne)):console.error(G),Promise.reject(G)}function Y(){return q&&l.value!==$r?Promise.resolve():new Promise((G,le)=>{M.add([G,le])})}function ie(G){return q||(q=!G,H(),M.list().forEach(([le,ne])=>G?ne(G):le()),M.reset()),G}function pe(G,le,ne,B){const{scrollBehavior:$e}=t;if(!Da||!$e)return Promise.resolve();const Se=!ne&&IM(J1(G.fullPath,0))||(B||!ne)&&history.state&&history.state.scroll||null;return Fb().then(()=>$e(G,le,Se)).then(ke=>ke&&CM(ke)).catch(ke=>Q(ke,G,le))}const he=G=>o.go(G);let xe;const me=new Set,Ie={currentRoute:l,listening:!0,addRoute:f,removeRoute:p,hasRoute:b,getRoutes:g,resolve:x,options:t,push:v,replace:$,go:he,back:()=>he(-1),forward:()=>he(1),beforeEach:r.add,beforeResolve:i.add,afterEach:a.add,onError:K.add,isReady:Y,install(G){const le=this;G.component("RouterLink",a3),G.component("RouterView",RI),G.config.globalProperties.$router=le,Object.defineProperty(G.config.globalProperties,"$route",{enumerable:!0,get:()=>ts(l)}),Da&&!xe&&l.value===$r&&(xe=!0,v(o.location).catch($e=>{}));const ne={};for(const $e in $r)ne[$e]=mn(()=>l.value[$e]);G.provide(Gb,le),G.provide(AI,zo(ne)),G.provide(Eg,l);const B=G.unmount;me.add(G),G.unmount=function(){me.delete(G),me.size<1&&(c=$r,L&&L(),L=null,l.value=$r,xe=!1,q=!1),B()}}};return Ie}function Sa(t){return t.reduce((e,n)=>e.then(()=>n()),Promise.resolve())}function d3(t,e){const n=[],s=[],o=[],r=Math.max(e.matched.length,t.matched.length);for(let i=0;i<r;i++){const a=e.matched[i];a&&(t.matched.find(c=>tl(c,a))?s.push(a):n.push(a));const l=t.matched[i];l&&(e.matched.find(c=>tl(c,l))||o.push(l))}return[n,s,o]}function f3(...t){const e=typeof t[t.length-1]=="string"?t.pop():void 0;typeof t[0]!="string"&&t.unshift(e);const[n,s]=t;if(!n||typeof n!="string")throw new TypeError("[nuxt] [useState] key must be a string: "+n);if(s!==void 0&&typeof s!="function")throw new Error("[nuxt] [useState] init must be a function: "+s);const o="$s"+n,r=Fn(),i=k$(r.payload.state,o);if(i.value===void 0&&s){const a=s();if(bn(a))return r.payload.state[o]=a,a;i.value=a}return i}class Sg extends Error{constructor(){super(...arguments),this.statusCode=500,this.fatal=!1,this.unhandled=!1,this.statusMessage="Internal Server Error"}}Sg.__h3_error__=!0;function Tg(t){var n;if(typeof t=="string")return new Sg(t);if(p3(t))return t;const e=new Sg((n=t.message)!=null?n:t.statusMessage,t.cause?{cause:t.cause}:void 0);if("stack"in t)try{Object.defineProperty(e,"stack",{get(){return t.stack}})}catch{try{e.stack=t.stack}catch{}}return t.statusCode&&(e.statusCode=t.statusCode),t.statusMessage&&(e.statusMessage=t.statusMessage),t.data&&(e.data=t.data),t.fatal!==void 0&&(e.fatal=t.fatal),t.unhandled!==void 0&&(e.unhandled=t.unhandled),e}function p3(t){var e;return((e=t==null?void 0:t.constructor)==null?void 0:e.__h3_error__)===!0}const lf=()=>k$(Fn().payload,"error"),ec=t=>{const e=b3(t);try{Fn().callHook("app:error",e);const s=lf();s.value=s.value||e}catch{throw e}return e},m3=async(t={})=>{const e=Fn(),n=lf();e.callHook("app:error:cleared",t),t.redirect&&await e.$router.replace(t.redirect),n.value=null},g3=t=>!!(t&&typeof t=="object"&&"__nuxt_error"in t),b3=t=>{const e=Tg(t);return e.__nuxt_error=!0,e},cf=()=>{var t;return(t=Fn())==null?void 0:t.$router},DI=()=>wl()?Oo("_route",Fn()._route):Fn()._route,x3=()=>{try{if(Fn()._processingMiddleware)return!0}catch{return!0}return!1},y3=(t,e)=>{t||(t="/");const n=typeof t=="string"?t:t.path||"/",s=Ub(n,!0);if(s&&!(e!=null&&e.external))throw new Error("Navigating to external URL is not allowed by default. Use `nagivateTo (url, { external: true })`.");if(s&&rf(n).protocol==="script:")throw new Error("Cannot navigate to an URL with script protocol.");if(!s&&x3())return t;const o=cf();return s?(e!=null&&e.replace?location.replace(n):location.href=n,Promise.resolve()):e!=null&&e.replace?o.replace(t):o.push(t)},v3="modulepreload",w3=function(t,e){return new URL(t,e).href},fw={},tr=function(e,n,s){return!n||n.length===0?e():Promise.all(n.map(o=>{if(o=w3(o,s),o in fw)return;fw[o]=!0;const r=o.endsWith(".css"),i=r?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${o}"]${i}`))return;const a=document.createElement("link");if(a.rel=r?"stylesheet":v3,r||(a.as="script",a.crossOrigin=""),a.href=o,document.head.appendChild(a),r)return new Promise((l,c)=>{a.addEventListener("load",l),a.addEventListener("error",()=>c(new Error(`Unable to preload CSS for ${o}`)))})})).then(()=>e())};function pw(t,e={}){const n=C3(t,e),s=Fn(),o=s._payloadCache=s._payloadCache||{};return o[n]?o[n]:(o[t]=$3(n).then(r=>r||(delete o[t],null)),o[t])}function C3(t,e={}){const n=rf(t);if(n.search)throw new Error("Payload URL cannot contain search params: "+t);const s=e.hash||(e.fresh?Date.now():"");return of(n.pathname,s?`_payload.${s}.js`:"_payload.js")}async function $3(t){const e=await tr(()=>import(t),[],import.meta.url).catch(n=>{console.warn("[nuxt] Cannot load payload ",t,n)});return(e==null?void 0:e.default)||null}function I3(){return!!Fn().payload.prerenderedAt}const _3=(...t)=>t.find(e=>e!==void 0),k3="noopener noreferrer",E3=globalThis.requestIdleCallback||(t=>{const e=Date.now(),n={didTimeout:!1,timeRemaining:()=>Math.max(0,50-(Date.now()-e))};return setTimeout(()=>{t(n)},1)}),S3=globalThis.cancelIdleCallback||(t=>{clearTimeout(t)});function T3(t){const e=t.componentName||"NuxtLink";return _t({name:e,props:{to:{type:[String,Object],default:void 0,required:!1},href:{type:[String,Object],default:void 0,required:!1},target:{type:String,default:void 0,required:!1},rel:{type:String,default:void 0,required:!1},noRel:{type:Boolean,default:void 0,required:!1},prefetch:{type:Boolean,default:void 0,required:!1},noPrefetch:{type:Boolean,default:void 0,required:!1},activeClass:{type:String,default:void 0,required:!1},exactActiveClass:{type:String,default:void 0,required:!1},prefetchedClass:{type:String,default:void 0,required:!1},replace:{type:Boolean,default:void 0,required:!1},ariaCurrentValue:{type:String,default:void 0,required:!1},external:{type:Boolean,default:void 0,required:!1},custom:{type:Boolean,default:void 0,required:!1}},setup(n,{slots:s}){const o=cf(),r=mn(()=>n.to||n.href||""),i=mn(()=>n.external||n.target&&n.target!=="_self"?!0:typeof r.value=="object"?!1:r.value===""||Ub(r.value,!0)),a=Di(!1),l=Di(null);if(n.prefetch!==!1&&n.noPrefetch!==!0&&typeof r.value=="string"&&!A3()){const u=Fn(),h=N3();let d,f=null;tf(()=>{d=E3(()=>{var p;(p=l==null?void 0:l.value)!=null&&p.tagName&&(f=h.observe(l.value,async()=>{f==null||f(),f=null,await Promise.all([u.hooks.callHook("link:prefetch",r.value).catch(()=>{}),R3(r.value,o).catch(()=>{})]),a.value=!0}))})}),Pc(()=>{d&&S3(d),f==null||f(),f=null})}return()=>{var f,p,g;if(!i.value)return $s(js("RouterLink"),{ref:b=>{l.value=b==null?void 0:b.$el},to:r.value,...a.value&&!n.custom?{class:n.prefetchedClass||t.prefetchedClass}:{},activeClass:n.activeClass||t.activeClass,exactActiveClass:n.exactActiveClass||t.exactActiveClass,replace:n.replace,ariaCurrentValue:n.ariaCurrentValue,custom:n.custom},s.default);const c=typeof r.value=="object"?(p=(f=o.resolve(r.value))==null?void 0:f.href)!=null?p:null:r.value||null,u=n.target||null,h=n.noRel?null:_3(n.rel,t.externalRelAttribute,c?k3:"")||null,d=()=>y3(c,{replace:n.replace});return n.custom?s.default?s.default({href:c,navigate:d,route:o.resolve(c),rel:h,target:u,isActive:!1,isExactActive:!1}):null:$s("a",{href:c,rel:h,target:u},(g=s.default)==null?void 0:g.call(s))}}})}const OI=T3({componentName:"NuxtLink"});function N3(){const t=Fn();if(t._observer)return t._observer;let e=null;const n=new Map,s=(r,i)=>(e||(e=new IntersectionObserver(a=>{for(const l of a){const c=n.get(l.target);(l.isIntersecting||l.intersectionRatio>0)&&c&&c()}})),n.set(r,i),e.observe(r),()=>{n.delete(r),e.unobserve(r),n.size===0&&(e.disconnect(),e=null)});return t._observer={observe:s}}function A3(){const t=navigator.connection;return!!(t&&(t.saveData||/2g/.test(t.effectiveType)))}async function R3(t,e=cf()){if(e._nuxtLinkPreloaded||(e._nuxtLinkPreloaded=new Set),e._nuxtLinkPreloaded.has(t))return;e._nuxtLinkPreloaded.add(t);const n=e.resolve(t).matched.map(o=>{var r;return(r=o.components)==null?void 0:r.default}).filter(o=>typeof o=="function"),s=[];for(const o of n){const r=Promise.resolve(o()).catch(()=>{});s.push(r)}await Promise.all(s)}function Bm(t){return t!==null&&typeof t=="object"}function Ng(t,e,n=".",s){if(!Bm(e))return Ng(t,{},n,s);const o=Object.assign({},e);for(const r in t){if(r==="__proto__"||r==="constructor")continue;const i=t[r];i!=null&&(s&&s(o,r,i,n)||(Array.isArray(i)&&Array.isArray(o[r])?o[r]=i.concat(o[r]):Bm(i)&&Bm(o[r])?o[r]=Ng(i,o[r],(n?`${n}.`:"")+r.toString(),s):o[r]=i))}return o}function FI(t){return(...e)=>e.reduce((n,s)=>Ng(n,s,"",t),{})}const D3=FI(),O3=FI((t,e,n,s)=>{if(typeof t[e]<"u"&&typeof n=="function")return t[e]=n(t[e]),!0}),F3={};O3(F3);function jb(t){const e=Xe(t)?mn(t):t;Fn()._useHead(e)}const Vm={},L3=Cl(t=>{for(const e in Vm)t.vueApp.component(e,Vm[e]),t.vueApp.component("Lazy"+e,Vm[e])});var P3="usehead",mw="head:count",zm="data-head-attrs",LI="data-meta-body",M3=(t,e,n)=>{const s=n.createElement(t);for(const o of Object.keys(e))if(o==="body"&&e.body===!0)s.setAttribute(LI,"true");else{let r=e[o];if(o==="renderPriority"||o==="key"||r===!1)continue;o==="children"?s.textContent=r:s.setAttribute(o,r)}return s};function gw(t,e){if(t instanceof HTMLElement&&e instanceof HTMLElement){const n=e.getAttribute("nonce");if(n&&!t.getAttribute("nonce")){const s=e.cloneNode(!0);return s.setAttribute("nonce",""),s.nonce=n,n===t.nonce&&t.isEqualNode(s)}}return t.isEqualNode(e)}var B3=t=>{if(!["meta","base","script","link"].includes(t.tag))return!1;const{props:e,tag:n}=t;if(n==="base")return!0;if(n==="link"&&e.rel==="canonical")return{propValue:"canonical"};if(e.charset)return{propKey:"charset"};const s=["key","id","name","property","http-equiv"];for(const o of s){let r;if(typeof e.getAttribute=="function"&&e.hasAttribute(o)?r=e.getAttribute(o):r=e[o],r!==void 0)return{propValue:o}}return!1},V3=["title","meta","link","base","style","script","noscript","htmlAttrs","bodyAttrs"],z3=(t,e)=>t==null?"":typeof t=="string"?t.replace("%s",e!=null?e:""):t(ts(e)),W3=t=>{const e=[],n=Object.keys(t);for(const s of n)if(t[s]!=null)switch(s){case"title":e.push({tag:s,props:{children:t[s]}});break;case"titleTemplate":break;case"base":e.push({tag:s,props:{key:"default",...t[s]}});break;default:if(V3.includes(s)){const o=t[s];Array.isArray(o)?o.forEach(r=>{e.push({tag:s,props:ts(r)})}):o&&e.push({tag:s,props:o})}break}return e},bw=(t,e)=>{const n=t.getAttribute(zm);if(n)for(const o of n.split(","))o in e||t.removeAttribute(o);const s=[];for(const o in e){const r=e[o];r!=null&&(r===!1?t.removeAttribute(o):t.setAttribute(o,r),s.push(o))}s.length?t.setAttribute(zm,s.join(",")):t.removeAttribute(zm)},U3=(t=window.document,e,n)=>{var s,o;const r=t.head,i=t.body;let a=r.querySelector(`meta[name="${mw}"]`),l=i.querySelectorAll(`[${LI}]`);const c=a?Number(a.getAttribute("content")):0,u=[],h=[];if(l)for(let f=0;f<l.length;f++)l[f]&&((s=l[f].tagName)==null?void 0:s.toLowerCase())===e&&h.push(l[f]);if(a)for(let f=0,p=a.previousElementSibling;f<c;f++,p=(p==null?void 0:p.previousElementSibling)||null)((o=p==null?void 0:p.tagName)==null?void 0:o.toLowerCase())===e&&u.push(p);else a=t.createElement("meta"),a.setAttribute("name",mw),a.setAttribute("content","0"),r.append(a);let d=n.map(f=>{var p;return{element:M3(f.tag,f.props,t),body:(p=f.props.body)!=null?p:!1}});d=d.filter(f=>{for(let p=0;p<u.length;p++){const g=u[p];if(gw(g,f.element))return u.splice(p,1),!1}for(let p=0;p<h.length;p++){const g=h[p];if(gw(g,f.element))return h.splice(p,1),!1}return!0}),h.forEach(f=>{var p;return(p=f.parentNode)==null?void 0:p.removeChild(f)}),u.forEach(f=>{var p;return(p=f.parentNode)==null?void 0:p.removeChild(f)}),d.forEach(f=>{f.body===!0?i.insertAdjacentElement("beforeend",f.element):r.insertBefore(f.element,a)}),a.setAttribute("content",""+(c-u.length+d.filter(f=>!f.body).length))},H3=t=>{let e=[],n=new Set;t&&e.push(ad(t));const s={install(o){o.config.globalProperties.$head=s,o.provide(P3,s)},get headTags(){const o=[],r=e.map(i=>ts(i).titleTemplate).reverse().find(i=>i!=null);return e.forEach(i=>{W3(ts(i)).forEach(l=>{const c=B3(l);if(c){let u=-1;for(let h=0;h<o.length;h++){const d=o[h];if(d.tag===l.tag&&((c===!0||c.propValue&&ts(d.props[c.propValue])===ts(l.props[c.propValue])||c.propKey&&d.props[c.propKey]&&l.props[c.propKey])&&(u=h),u!==-1))break}u!==-1&&o.splice(u,1)}r&&l.tag==="title"&&(l.props.children=z3(r,l.props.children)),o.push(l)})}),o},addHeadObjs(o){e.push(o)},removeHeadObjs(o){e=e.filter(r=>r!==o)},updateDOM(o=window.document){let r,i={},a={};const l={};for(const u of s.headTags.sort(G3)){if(u.tag==="title"){r=u.props.children;continue}if(u.tag==="htmlAttrs"){Object.assign(i,u.props);continue}if(u.tag==="bodyAttrs"){Object.assign(a,u.props);continue}l[u.tag]=l[u.tag]||[],l[u.tag].push(u)}r!==void 0&&(o.title=r),bw(o.documentElement,i),bw(o.body,a);const c=new Set([...Object.keys(l),...n]);for(const u of c)U3(o,u,l[u]||[]);n.clear(),Object.keys(l).forEach(u=>n.add(u))}};return s},G3=(t,e)=>{const n=s=>{if(s.props.renderPriority)return s.props.renderPriority;switch(s.tag){case"base":return-1;case"meta":return s.props.charset?-2:s.props["http-equiv"]==="content-security-policy"?0:10;default:return 10}};return n(t)-n(e)};const j3=Cl(t=>{const e=H3();t.vueApp.use(e);let n=!1;t.hooks.hookOnce("app:mounted",()=>{C1(()=>{e.updateDOM()}),n=!0}),t._useHead=s=>{const o=Di(s),r=mn(()=>{const a={meta:[]};return o.value.charset&&a.meta.push({key:"charset",charset:o.value.charset}),o.value.viewport&&a.meta.push({name:"viewport",content:o.value.viewport}),D3(a,o.value)});e.addHeadObjs(r),n&&C1(()=>{e.updateDOM()}),wl()&&Pc(()=>{e.removeHeadObjs(r),e.updateDOM()})}}),q3=t=>Object.fromEntries(Object.entries(t).filter(([,e])=>e!==void 0)),cr=(t,e)=>(n,s)=>(jb(()=>t({...q3(n),...s.attrs},s)),()=>{var o,r;return e?(r=(o=s.slots).default)==null?void 0:r.call(o):null}),Hr={accesskey:String,autocapitalize:String,autofocus:{type:Boolean,default:void 0},class:String,contenteditable:{type:Boolean,default:void 0},contextmenu:String,dir:String,draggable:{type:Boolean,default:void 0},enterkeyhint:String,exportparts:String,hidden:{type:Boolean,default:void 0},id:String,inputmode:String,is:String,itemid:String,itemprop:String,itemref:String,itemscope:String,itemtype:String,lang:String,nonce:String,part:String,slot:String,spellcheck:{type:Boolean,default:void 0},style:String,tabindex:String,title:String,translate:String},K3=_t({name:"Script",inheritAttrs:!1,props:{...Hr,async:Boolean,crossorigin:{type:[Boolean,String],default:void 0},defer:Boolean,fetchpriority:String,integrity:String,nomodule:Boolean,nonce:String,referrerpolicy:String,src:String,type:String,charset:String,language:String},setup:cr(t=>({script:[t]}))}),X3=_t({name:"NoScript",inheritAttrs:!1,props:{...Hr,title:String},setup:cr((t,{slots:e})=>{var o;const n={...t},s=(((o=e.default)==null?void 0:o.call(e))||[]).filter(({children:r})=>r).map(({children:r})=>r).join("");return s&&(n.children=s),{noscript:[n]}})}),Y3=_t({name:"Link",inheritAttrs:!1,props:{...Hr,as:String,crossorigin:String,disabled:Boolean,fetchpriority:String,href:String,hreflang:String,imagesizes:String,imagesrcset:String,integrity:String,media:String,prefetch:{type:Boolean,default:void 0},referrerpolicy:String,rel:String,sizes:String,title:String,type:String,methods:String,target:String},setup:cr(t=>({link:[t]}))}),Z3=_t({name:"Base",inheritAttrs:!1,props:{...Hr,href:String,target:String},setup:cr(t=>({base:t}))}),Q3=_t({name:"Title",inheritAttrs:!1,setup:cr((t,{slots:e})=>{var s,o,r;return{title:((r=(o=(s=e.default)==null?void 0:s.call(e))==null?void 0:o[0])==null?void 0:r.children)||null}})}),J3=_t({name:"Meta",inheritAttrs:!1,props:{...Hr,charset:String,content:String,httpEquiv:String,name:String},setup:cr(t=>{const e={...t};return e.httpEquiv&&(e["http-equiv"]=e.httpEquiv,delete e.httpEquiv),{meta:[e]}})}),eB=_t({name:"Style",inheritAttrs:!1,props:{...Hr,type:String,media:String,nonce:String,title:String,scoped:{type:Boolean,default:void 0}},setup:cr((t,{slots:e})=>{var o,r,i;const n={...t},s=(i=(r=(o=e.default)==null?void 0:o.call(e))==null?void 0:r[0])==null?void 0:i.children;return s&&(n.children=s),{style:[n]}})}),tB=_t({name:"Head",inheritAttrs:!1,setup:(t,e)=>()=>{var n,s;return(s=(n=e.slots).default)==null?void 0:s.call(n)}}),nB=_t({name:"Html",inheritAttrs:!1,props:{...Hr,manifest:String,version:String,xmlns:String},setup:cr(t=>({htmlAttrs:t}),!0)}),sB=_t({name:"Body",inheritAttrs:!1,props:Hr,setup:cr(t=>({bodyAttrs:t}),!0)}),xw=Object.freeze(Object.defineProperty({__proto__:null,Script:K3,NoScript:X3,Link:Y3,Base:Z3,Title:Q3,Meta:J3,Style:eB,Head:tB,Html:nB,Body:sB},Symbol.toStringTag,{value:"Module"})),oB={meta:[],link:[],style:[],script:[],noscript:[],charset:"utf-8",viewport:"width=device-width, initial-scale=1"},rB={name:"layout",mode:"out-in"},iB={name:"page",mode:"out-in"},aB=!1,lB={created(){const t=wl();if(!t)return;const e=t.type;if(!e||!("head"in e))return;const n=Fn(),s=typeof e.head=="function"?mn(()=>e.head(n)):e.head;jb(s)}},cB=Cl(t=>{jb(Rb({title:"",...oB})),t.vueApp.mixin(lB);for(const e in xw)t.vueApp.component(e,xw[e])}),uB=(t,e)=>e.path.replace(/(:\w+)\([^)]+\)/g,"$1").replace(/(:\w+)[?+*]/g,"$1").replace(/:\w+/g,n=>{var s;return((s=t.params[n.slice(1)])==null?void 0:s.toString())||""}),hB=(t,e)=>{var o;const n=e.route.matched.find(r=>{var i;return((i=r.components)==null?void 0:i.default)===e.Component.type}),s=(o=t!=null?t:n==null?void 0:n.meta.key)!=null?o:n&&uB(e.route,n);return typeof s=="function"?s(e.route):s},dB=(t,e)=>({default:()=>t?$s(zF,t===!0?{}:t,e):e}),fB=_t({setup(t,{slots:e}){return()=>{var n;return(n=e.default)==null?void 0:n.call(e)}}}),Ag=(t,e,n)=>({default:()=>e?$s(t,e===!0?{}:e,n):$s(fB,{},n)}),yw=Symbol("isNested"),Wm=_t({name:"NuxtPage",inheritAttrs:!1,props:{name:{type:String},transition:{type:[Boolean,Object],default:void 0},keepalive:{type:[Boolean,Object],default:void 0},route:{type:Object},pageKey:{type:[Function,String],default:null}},setup(t,{attrs:e}){const n=Fn(),s=Oo(yw,!1);return Oi(yw,!0),()=>$s(RI,{name:t.name,route:t.route,...e},{default:o=>{var a,l,c,u;if(!o.Component)return;const r=hB(t.pageKey,o),i=(l=(a=t.transition)!=null?a:o.route.meta.pageTransition)!=null?l:iB;return Ag(sf,i,dB((u=(c=t.keepalive)!=null?c:o.route.meta.keepalive)!=null?u:aB,s&&n.isHydrating?$s(vw,{key:r,routeProps:o,pageKey:r,hasTransition:!!i}):$s(L$,{onPending:()=>n.callHook("page:start",o.Component),onResolve:()=>n.callHook("page:finish",o.Component)},{default:()=>$s(vw,{key:r,routeProps:o,pageKey:r,hasTransition:!!i})}))).default()}})}}),vw=_t({props:["routeProps","pageKey","hasTransition"],setup(t){const e=t.pageKey,n=t.routeProps.route,s={};for(const o in t.routeProps.route)s[o]=mn(()=>e===t.pageKey?t.routeProps.route[o]:n[o]);return Oi("_route",zo(s)),()=>$s(t.routeProps.Component)}}),rs=(t,e)=>{const n=t.__vccOpts||t;for(const[s,o]of e)n[s]=o;return n},pB=_t({name:"VAccordion",props:{title:{type:String,required:!0},content:{type:String,required:!0}},data(){return{accordionId:"accordion-"+Math.random().toString(36).substr(2,9),accordionHeadingId:"accordion-heading-"+Math.random().toString(36).substr(2,9)}}}),mB={id:"accordion",class:"accordion accordion-flush"},gB={class:"accordion-item"},bB=["id"],xB=["data-bs-target","aria-controls"],yB={class:"h4 text-primary"},vB=["id","aria-labelledby"],wB={class:"accordion-body"},CB=["innerHTML"];function $B(t,e,n,s,o,r){return pt(),Vt("div",mB,[te("div",gB,[te("h2",{id:t.accordionHeadingId,class:"accordion-header"},[te("button",{class:"accordion-button collapsed",type:"button","data-bs-toggle":"collapse","data-bs-target":"#"+t.accordionId,"aria-expanded":"false","aria-controls":t.accordionId},[te("span",yB,Ro(t.title),1)],8,xB)],8,bB),te("div",{id:t.accordionId,class:"accordion-collapse collapse","aria-labelledby":t.accordionHeadingId,"data-bs-parent":"#accordion"},[te("div",wB,[te("p",{innerHTML:t.content},null,8,CB)])],8,vB)])])}const IB=rs(pB,[["render",$B]]),Lh=void 0;var Ft=(t=>(t.Explanation="EXPLANATION",t.Personal="PERSONAL",t.Health="HEALTH",t.General="GENERAL",t.Result="RESULT",t.None="NONE",t))(Ft||{});const _B=_t({name:"VCheckStateHandler",props:{nextForm:{type:String,default:""},previousForm:{type:String,default:""},hasPrevious:{type:Boolean,default:!0},nextModelValue:{type:String,default:""},previousModelValue:{type:String,default:""}},emits:["update:nextModelValue","update:previousModelValue"]});function kB(t,e,n,s,o,r){return pt(),Vt("div",null,[te("input",{type:"submit",value:"Next",class:"next action-button bg-primary",onClick:e[0]||(e[0]=i=>t.$emit("update:nextModelValue",t.nextForm))})])}const uf=rs(_B,[["render",kB]]);const EB={name:"VRadio",props:{option:{required:!0,type:Number},optionAlias:{required:!0,type:String},radioGroupName:{required:!0,type:String},isRequired:{required:!1,type:Boolean,default:!1}},computed:{getId(){return"id_"+this.radioGroupName+"_"+this.option},getIsRequired(){return this.isRequired?"required":""}}},SB={class:"form-check form-check-inline"},TB=["id","name","value","required","checked"],NB=["for"];function AB(t,e,n,s,o,r){return pt(),Vt("div",SB,[te("input",{id:r.getId,class:"btn-check",type:"radio",name:n.radioGroupName,value:n.option,required:r.getIsRequired,checked:n.option===0,onChange:e[0]||(e[0]=i=>t.$parent.$emit("input",n.option))},null,40,TB),te("label",{class:"btn btn-outline-primary",for:r.getId},Ro(n.optionAlias),9,NB)])}const RB=rs(EB,[["render",AB],["__scopeId","data-v-13de4c09"]]);const DB={name:"VRadioGroup",components:{VRadio:RB},props:{options:{required:!0,type:Array},optionsAlias:{required:!0,type:Array},radioGroupName:{required:!0,type:String},isRequired:{required:!1,type:Boolean,default:!1}}},OB={class:"btn-group",role:"group"};function FB(t,e,n,s,o,r){const i=js("VRadio");return pt(),Vt("div",OB,[(pt(!0),Vt(Qn,null,QF(n.options,(a,l)=>(pt(),Li(i,{key:a,option:l,"option-alias":n.optionsAlias[a],"radio-group-name":n.radioGroupName},null,8,["option","option-alias","radio-group-name"]))),128))])}const PI=rs(DB,[["render",FB],["__scopeId","data-v-d9948ac3"]]),LB={name:"VSlider",props:{id:{required:!0,type:String},sliderText:{required:!0,type:String},minValue:{required:!1,type:Number,default:0},maxValue:{required:!1,type:Number,default:10},stepValue:{required:!1,type:Number,default:1},goodMaxValueName:{required:!1,type:String,default:"Good"},badMinValueName:{required:!1,type:String,default:"Bad"},isRequired:{required:!1,type:Boolean,default:!1}},data(){return{s_value:0}},computed:{getIsRequired(){return this.isRequired?"required":""}},methods:{onChange(t){this.s_value=t.target.value,this.$emit("input",t.target.value)}}},PB=["for"],MB=["id","min","max","step","required"],BB={class:"row"},VB={class:"col"},zB={class:"float-start text-muted"},WB={class:"col"},UB={class:"text-primary"},HB={class:"col"},GB={class:"float-end text-muted"};function jB(t,e,n,s,o,r){return pt(),Vt("div",null,[te("label",{for:n.id,class:"form-label"},Ro(n.sliderText),9,PB),te("input",{id:n.id,type:"range",class:"form-range border-0",min:n.minValue,max:n.maxValue,step:n.stepValue,required:r.getIsRequired,onChange:e[0]||(e[0]=(...i)=>r.onChange&&r.onChange(...i))},null,40,MB),te("div",BB,[te("div",VB,[te("strong",zB,Ro(n.badMinValueName),1)]),te("div",WB,[te("strong",UB,Ro(o.s_value),1)]),te("div",HB,[te("strong",GB,Ro(n.goodMaxValueName),1)])])])}const qB=rs(LB,[["render",jB]]),KB=_t({name:"VCheckHealthForm",components:{VSlider:qB,VRadioGroup:PI,VCheckStateHandler:uf},props:{formData:{type:Object,required:!0},nextModelValue:{type:String,default:""},previousModelValue:{type:String,default:""}},emits:["update:nextModelValue","update:previousModelValue"],data(){return{i_formData:this.formData,decisionsValues:[1,0],decisionsAliases:["Yes","No"],nextChildModelValue:"",previousChildModelValue:""}},computed:{nextForm(){return Ft.Result},previousForm(){return Ft.General}},watch:{nextChildModelValue(t){this.$emit("update:nextModelValue",t)},previousChildModelValue(t){this.$emit("update:previousModelValue",t)}},methods:{updateProperty(t,e){return this.i_formData.healthData[t]=e,this.formData}}}),XB=te("h2",{class:"fs-title"},"Health Data",-1),YB=te("h3",{class:"fs-subtitle"},"How is your current health?",-1),ZB={class:"form-container"},QB={class:"col-lg-8"},JB=te("p",null,"Do you have a high blood pressure (confirmed by a doctor)?",-1),eV=te("br",null,null,-1),tV={class:"col-lg-8"},nV=te("p",null,[At(" Have you "),te("strong",{class:"text-primary"},"ever"),At(" been told by a doctor, nurse or other health professional that your blood cholesterol is high? ")],-1),sV=te("br",null,null,-1),oV={class:"col-lg-8"},rV=te("p",null,[At(" Have you smoked at least 100 cigarettes in your "),te("strong",{class:"text-primary"},"entire"),At(" life? (Note: 5 packs = 100 cigarettes) ")],-1),iV=te("br",null,null,-1),aV={class:"col-lg-8"},lV=te("p",null,[At("Have you "),te("strong",{class:"text-primary"},"ever"),At(" had a stroke?")],-1),cV=te("br",null,null,-1),uV={class:"col-lg-8"},hV=te("p",null," Have you done any physical activity or exercise during the past 30 days other than their regular job? ",-1),dV=te("br",null,null,-1),fV={class:"col-lg-8"},pV=te("p",null,[At(" Do you eat atleast one piece of fruit "),te("strong",{class:"text-primary"},"every"),At(" day? ")],-1),mV=te("br",null,null,-1),gV={class:"col-lg-8"},bV=te("p",null,[At(" Do you eat atleast one vegetable "),te("strong",{class:"text-primary"},"every"),At(" day? ")],-1),xV=te("br",null,null,-1),yV={class:"col-lg-8"},vV=te("p",null,"Do you have serious difficulty walking or climbing stairs?",-1),wV=te("br",null,null,-1),CV={class:"col-lg-5"},$V=te("label",{for:"BMI"},"What is your Body Mass Index (BMI)?",-1),IV={class:"input-group mb-3"},_V=["value"],kV=te("small",{class:"w-100 text-muted"},[At("If you don't know your BMI click "),te("a",{href:"https://www.calculator.net/bmi-calculator.html",target:"_blank",class:"text-decoration-none fw-bold"},"here")],-1),EV=te("br",null,null,-1),SV={class:"col-lg-8"},TV=te("br",null,null,-1),NV={class:"col-lg-8"},AV=te("br",null,null,-1),RV={class:"col-lg-8"};function DV(t,e,n,s,o,r){const i=js("VRadioGroup"),a=js("VSlider"),l=js("VCheckStateHandler");return pt(),Vt("fieldset",null,[XB,YB,te("div",ZB,[te("div",QB,[JB,He(i,{id:"HighBP","v-model":t.formData.healthData.highBP,options:t.decisionsValues,"options-alias":t.decisionsAliases,"is-required":!0,"radio-group-name":"HighBP",onChange:e[0]||(e[0]=c=>t.$emit("update:formData",t.updateProperty("highBP",c.target.value)))},null,8,["v-model","options","options-alias"])]),eV,te("div",tV,[nV,He(i,{id:"HighChol","v-model":t.formData.healthData.highChol,options:t.decisionsValues,"options-alias":t.decisionsAliases,"is-required":!0,"radio-group-name":"HighChol",onChange:e[1]||(e[1]=c=>t.$emit("update:formData",t.updateProperty("highChol",c.target.value)))},null,8,["v-model","options","options-alias"])]),sV,te("div",oV,[rV,He(i,{id:"Smoker","v-model":t.formData.healthData.smoker,options:t.decisionsValues,"options-alias":t.decisionsAliases,"is-required":!0,"radio-group-name":"Smoker",onChange:e[2]||(e[2]=c=>t.$emit("update:formData",t.updateProperty("smoker",c.target.value)))},null,8,["v-model","options","options-alias"])]),iV,te("div",aV,[lV,He(i,{id:"Stroke","v-model":t.formData.healthData.stroke,options:t.decisionsValues,"options-alias":t.decisionsAliases,"is-required":!0,"radio-group-name":"Stroke",onChange:e[3]||(e[3]=c=>t.$emit("update:formData",t.updateProperty("stroke",c.target.value)))},null,8,["v-model","options","options-alias"])]),cV,te("div",uV,[hV,He(i,{id:"PhysActivity","v-model":t.formData.healthData.physActivity,options:t.decisionsValues,"options-alias":t.decisionsAliases,"is-required":!0,"radio-group-name":"PhysActivity",onChange:e[4]||(e[4]=c=>t.$emit("update:formData",t.updateProperty("physActivity",c.target.value)))},null,8,["v-model","options","options-alias"])]),dV,te("div",fV,[pV,He(i,{id:"Fruits","v-model":t.formData.healthData.fruits,options:t.decisionsValues,"options-alias":t.decisionsAliases,"is-required":!0,"radio-group-name":"Fruits",onChange:e[5]||(e[5]=c=>t.$emit("update:formData",t.updateProperty("fruits",c.target.value)))},null,8,["v-model","options","options-alias"])]),mV,te("div",gV,[bV,He(i,{id:"Veggies","v-model":t.formData.healthData.veggies,options:t.decisionsValues,"options-alias":t.decisionsAliases,"is-required":!0,"radio-group-name":"Veggies",onChange:e[6]||(e[6]=c=>t.$emit("update:formData",t.updateProperty("veggies",c.target.value)))},null,8,["v-model","options","options-alias"])]),xV,te("div",yV,[vV,He(i,{id:"DiffWalk","v-model":t.formData.healthData.diffWalk,options:t.decisionsValues,"options-alias":t.decisionsAliases,"is-required":!0,"radio-group-name":"DiffWalk",onChange:e[7]||(e[7]=c=>t.$emit("update:formData",t.updateProperty("diffWalk",c.target.value)))},null,8,["v-model","options","options-alias"])]),wV,te("div",CV,[$V,te("div",IV,[te("input",{id:"BMI",type:"number",name:"BMI (Body Mass Index)",value:t.formData.healthData.bmi,class:"form-control",required:"",onInput:e[8]||(e[8]=c=>t.$emit("update:formData",t.updateProperty("bmi",c.target.value)))},null,40,_V),kV])]),EV,te("div",SV,[He(a,{id:"GenHlth","slider-text":"Would you say that in general your health is?","v-model":t.formData.healthData.genHlth,"bad-min-value-name":"Bad","good-max-value-name":"Very Good","is-required":!0,"min-value":1,"max-value":5,"step-value":1,onChange:e[9]||(e[9]=c=>t.$emit("update:formData",t.updateProperty("genHlth",c.target.value)))},null,8,["v-model"])]),TV,te("div",NV,[He(a,{id:"MentHlth","slider-text":`Now thinking about your mental health, which includes stress,\r
          depression, and problems with emotions, for how many days during the\r
          past 30 days was your mental health not good?`,"v-model":t.formData.healthData.mentHlth,"bad-min-value-name":"0 days","good-max-value-name":"All 30 days","is-required":!0,"min-value":1,"max-value":30,"step-value":1,onChange:e[10]||(e[10]=c=>t.$emit("update:formData",t.updateProperty("mentHlth",c.target.value)))},null,8,["v-model"])]),AV,te("div",RV,[He(a,{id:"PhysHlth","slider-text":`Now thinking about your physical health, which includes physical\r
          illness and injury, for how many days during the past 30 days was your\r
          physical health not good?`,"v-model":t.formData.healthData.physHlth,"bad-min-value-name":"0 days","good-max-value-name":"All 30 days","is-required":!0,"min-value":0,"max-value":30,"step-value":1,onChange:e[11]||(e[11]=c=>t.$emit("update:formData",t.updateProperty("physHlth",c.target.value)))},null,8,["v-model"])])]),He(l,{"next-model-value":t.nextChildModelValue,"onUpdate:next-model-value":e[12]||(e[12]=c=>t.nextChildModelValue=c),"previous-model-value":t.previousChildModelValue,"onUpdate:previous-model-value":e[13]||(e[13]=c=>t.previousChildModelValue=c),"next-form":t.nextForm,"previous-form":t.previousForm},null,8,["next-model-value","previous-model-value","next-form","previous-form"])])}const OV=rs(KB,[["render",DV]]),FV=_t({name:"VCheckPersonalForm",components:{VCheckStateHandler:uf},props:{formData:{type:Object,required:!0},nextModelValue:{type:String,default:""}},emits:["update:formData","update:nextModelValue"],data(){return{i_formData:this.formData,nextChildModelValue:""}},computed:{nextForm(){return Ft.General},previousForm(){return Ft.Explanation}},watch:{nextChildModelValue(t){this.$emit("update:nextModelValue",t)}},methods:{updateProperty(t,e){return this.i_formData.personalData[t]=e,this.formData}}}),LV=te("h2",{class:"fs-title"},"Personal Details",-1),PV=te("h3",{class:"fs-subtitle"},"Who are you?",-1),MV={class:"form-container"},BV={class:"col-lg-5"},VV=te("label",{class:"control-label col-sm label-left",for:"first-name"},"Your first name",-1),zV=["value"],WV={class:"col-lg-5"},UV=te("label",{class:"control-label col-sm label-left",for:"last-name"},"Your last name",-1),HV=["value"],GV={class:"col-lg-5"},jV=te("label",{class:"control-label col-sm label-left",for:"email"},"Your email (optional)",-1),qV=["value"];function KV(t,e,n,s,o,r){const i=js("VCheckStateHandler");return pt(),Vt("fieldset",null,[LV,PV,te("div",MV,[te("div",BV,[VV,te("input",{id:"first-name",type:"text",placeholder:"First Name",class:"form-control",value:t.formData.personalData.firstName,required:"",onChange:e[0]||(e[0]=a=>t.$emit("update:formData",t.updateProperty("firstName",a.target.value)))},null,40,zV)]),te("div",WV,[UV,te("input",{id:"last-name",type:"text",placeholder:"Last Name",value:t.formData.personalData.lastName,class:"form-control",required:"",onChange:e[1]||(e[1]=a=>t.$emit("update:formData",t.updateProperty("lastName",a.target.value)))},null,40,HV)]),te("div",GV,[jV,te("input",{id:"email",type:"email",placeholder:"Email",value:t.formData.personalData.emailAddress,class:"form-control",required:"",onChange:e[2]||(e[2]=a=>t.$emit("update:formData",t.updateProperty("emailAddress",a.target.value)))},null,40,qV)])]),He(i,{"next-model-value":t.nextChildModelValue,"onUpdate:next-model-value":e[3]||(e[3]=a=>t.nextChildModelValue=a),"has-previous":!0,"next-form":t.nextForm,"previous-form":t.previousForm},null,8,["next-model-value","next-form","previous-form"])])}const XV=rs(FV,[["render",KV]]),YV=_t({name:"VCheckProgressBar",props:{currentForm:{type:String,default:""}},computed:{isHealth(){return this.currentForm===Ft.Health||this.currentForm===Ft.Result?"active":""},isGeneral(){return this.currentForm===Ft.General||this.currentForm===Ft.Health||this.currentForm===Ft.Result?"active":""},isPersonal(){return this.currentForm===Ft.General||this.currentForm===Ft.Health||this.currentForm===Ft.Result||this.currentForm===Ft.Personal?"active":""},isResult(){return this.currentForm===Ft.Result?"active":""}}}),ZV={key:0,id:"progressbar"},QV=te("li",{class:"active"},"Information",-1);function JV(t,e,n,s,o,r){return t.isResult?Jo("",!0):(pt(),Vt("ul",ZV,[QV,te("li",{class:Sr(t.isPersonal)},"Personal Details",2),te("li",{class:Sr(t.isGeneral)},"General Info",2),te("li",{class:Sr(t.isHealth)},"Health Details",2),te("li",{class:Sr(t.isResult)},"Result",2)]))}const ez=rs(YV,[["render",JV]]);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tz=1e-7,nz=1e-4;class MI{constructor(e,n){this.backend=e,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,n){this.dataIdsCount++,this.data.set(e,n)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class qb{refCount(e){return ws("refCount")}incRef(e){return ws("incRef")}timerAvailable(){return!0}time(e){return ws("time")}read(e){return ws("read")}readSync(e){return ws("readSync")}readToGPU(e,n){return ws("readToGPU")}numDataIds(){return ws("numDataIds")}disposeData(e,n){return ws("disposeData")}write(e,n,s){return ws("write")}move(e,n,s,o,r){return ws("move")}memory(){return ws("memory")}floatPrecision(){return ws("floatPrecision")}epsilon(){return this.floatPrecision()===32?tz:nz}dispose(){return ws("dispose")}}function ws(t){throw new Error(`'${t}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sz(t){let e=t.length,n=0;for(;e>0;)n=Math.random()*e|0,e--,Oa(t,e,n)}function Ui(t,e,n){return Math.max(t,Math.min(e,n))}function Kb(t){return t%2===0?t:t+1}function Oa(t,e,n){const s=t[e];t[e]=t[n],t[n]=s}function oz(t){let e=0;for(let n=0;n<t.length;n++)e+=t[n];return e}function T(t,e){if(!t)throw new Error(typeof e=="string"?e:e())}function Ys(t,e,n=""){T(bt(t,e),()=>n+` Shapes ${t} and ${e} must match`)}function BI(t){T(t!=null,()=>"The input to the tensor constructor must be a non-null value.")}function sl(t,e=[],n=!1){if(e==null&&(e=[]),Array.isArray(t)||Wo(t)&&!n)for(let s=0;s<t.length;++s)sl(t[s],e,n);else e.push(t);return e}function ae(t){if(t.length===0)return 1;let e=t[0];for(let n=1;n<t.length;n++)e*=t[n];return e}function bt(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function ol(t){return t%1===0}function Rg(t){const e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function Ga(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function ww(t,e=s=>0,n){return new Promise((s,o)=>{let r=0;const i=()=>{if(t()){s();return}r++;const a=e(r);if(n!=null&&r>=n){o();return}setTimeout(i,a)};i()})}function VI(t,e){let n=1,s=-1;for(let r=0;r<t.length;++r)if(t[r]>=0)n*=t[r];else if(t[r]===-1){if(s!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${s} and dim ${r}`);s=r}else if(t[r]<0)throw Error(`Shapes can not be < 0. Found ${t[r]} at dim ${r}`);if(s===-1){if(e>0&&e!==n)throw Error(`Size(${e}) must match the product of shape ${t}`);return t}if(n===0)throw Error(`Cannot infer the missing size in [${t}] when there are 0 elements`);if(e%n!==0)throw Error(`The implicit shape can't be a fractional number. Got ${e} / ${n}`);const o=t.slice();return o[s]=e/n,o}function st(t,e){const n=e.length;return t=t==null?e.map((s,o)=>o):[].concat(t),T(t.every(s=>s>=-n&&s<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${t}`),T(t.every(s=>ol(s)),()=>`All values in axis param must be integers but got axis ${t}`),t.map(s=>s<0?n+s:s)}function Gr(t,e){const n=[],s=[],o=e!=null&&Array.isArray(e)&&e.length===0,r=e==null||o?null:st(e,t).sort();let i=0;for(let a=0;a<t.length;++a){if(r!=null){if(r[i]===a&&t[a]!==1)throw new Error(`Can't squeeze axis ${a} since its dim '${t[a]}' is not 1`);(r[i]==null||r[i]>a)&&t[a]===1&&(n.push(t[a]),s.push(a)),r[i]<=a&&i++}t[a]!==1&&(n.push(t[a]),s.push(a))}return{newShape:n,keptDims:s}}function $n(t,e){let n=null;if(t==null||t==="float32")n=new Float32Array(e);else if(t==="int32")n=new Int32Array(e);else if(t==="bool")n=new Uint8Array(e);else throw new Error(`Unknown data type ${t}`);return n}function An(t,e){let n=null;if(t==null||t==="float32")n=new Float32Array(e);else if(t==="int32")n=new Int32Array(e);else if(t==="bool")n=new Uint8Array(e);else if(t==="string")n=new Array(e);else throw new Error(`Unknown data type ${t}`);return n}function rz(t,e){for(let n=0;n<t.length;n++){const s=t[n];if(isNaN(s)||!isFinite(s))throw Error(`A tensor of type ${e} being uploaded contains ${s}.`)}}function iz(t){return t==="bool"||t==="complex64"||t==="float32"||t==="int32"||t==="string"}function zI(t,e){return!(e==="complex64"||e==="float32"&&t!=="complex64"||e==="int32"&&t!=="float32"&&t!=="complex64"||e==="bool"&&t==="bool")}function Wo(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray}function Dg(t){if(t==="float32"||t==="int32")return 4;if(t==="complex64")return 8;if(t==="bool")return 1;throw new Error(`Unknown dtype ${t}`)}function az(t){if(t==null)return 0;let e=0;return t.forEach(n=>e+=n.length),e}function Mc(t){return typeof t=="string"||t instanceof String}function lz(t){return typeof t=="boolean"}function Og(t){return typeof t=="number"}function Bc(t){return Array.isArray(t)?Bc(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray?"int32":Og(t)?"float32":Mc(t)?"string":lz(t)?"bool":"float32"}function Fg(t){return!!(t&&t.constructor&&t.call&&t.apply)}function Lg(t,e){for(let n=e;n<t;++n)if(t%n===0)return n;return t}function Ue(t){const e=t.length;if(e<2)return[];const n=new Array(e-1);n[e-2]=t[e-1];for(let s=e-3;s>=0;--s)n[s]=n[s+1]*t[s+1];return n}function WI(t,e,n,s=!1){const o=new Array;if(e.length===1){const r=e[0]*(s?2:1);for(let i=0;i<r;i++)o[i]=n[t+i]}else{const r=e[0],i=e.slice(1),a=i.reduce((l,c)=>l*c)*(s?2:1);for(let l=0;l<r;l++)o[l]=WI(t+l*a,i,n,s)}return o}function po(t,e,n=!1){if(t.length===0)return e[0];const s=t.reduce((o,r)=>o*r)*(n?2:1);if(s===0)return[];if(s!==e.length)throw new Error(`[${t}] does not match the input size ${e.length}${n?" for a complex tensor":""}.`);return WI(0,t,e,n)}function Xb(t,e){const n=Ln(t,e);for(let s=0;s<n.length;s++)n[s]=1;return n}function Ln(t,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool")return new Uint8Array(t);throw new Error(`Unknown data type ${e}`)}function UI(t,e){const n=t.reduce((s,o)=>s*o,1);if(e==null||e==="float32")return po(t,new Float32Array(n));if(e==="int32")return po(t,new Int32Array(n));if(e==="bool")return po(t,new Uint8Array(n));throw new Error(`Unknown data type ${e}`)}function HI(t){t.forEach(e=>{T(Number.isInteger(e)&&e>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${t}].`)})}function Fo(t,e,n){if(e===0)return 0;if(e===1)return t[0];let s=t[t.length-1];for(let o=0;o<t.length-1;++o)s+=n[o]*t[o];return s}function Vc(t,e,n){if(e===0)return[];if(e===1)return[t];const s=new Array(e);for(let o=0;o<s.length-1;++o)s[o]=Math.floor(t/n[o]),t-=s[o]*n[o];return s[s.length-1]=t,s}function GI(t){return t&&t.then&&typeof t.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cw="tfjsflags";class cz{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=uz,this.populateURLFlags()}setPlatform(e,n){this.platform!=null&&(se().getBool("IS_TEST")||se().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=n}registerFlag(e,n,s){if(this.flagRegistry[e]={evaluationFn:n,setHook:s},this.urlFlags[e]!=null){const o=this.urlFlags[e];se().getBool("IS_TEST")||se().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${o}.`),this.set(e,o)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];const n=this.evaluateFlag(e);if(GI(n))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=n,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,n){if(this.flagRegistry[e]==null)throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=n,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(n)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const e=this.getQueryParams(this.global.location.search);Cw in e&&e[Cw].split(",").forEach(s=>{const[o,r]=s.split(":");this.urlFlags[o]=dz(o,r)})}}function uz(t){const e={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(n,...s)=>(hz(e,s[0],s[1]),s.join("="))),e}function hz(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}function dz(t,e){if(e=e.toLowerCase(),e==="true"||e==="false")return e==="true";if(`${+e}`===e)return+e;throw new Error(`Could not parse value flag value ${e} for flag ${t}.`)}function se(){return jI}let jI=null;function fz(t){jI=t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Um;function qI(){if(Um==null){let t;if(typeof window<"u")t=window;else if(typeof global<"u")t=global;else if(typeof process<"u")t=process;else if(typeof self<"u")t=self;else throw new Error("Could not find a global object");Um=t}return Um}function pz(){const t=qI();return t._tfGlobals==null&&(t._tfGlobals=new Map),t._tfGlobals}function Yb(t,e){const n=pz();if(n.has(t))return n.get(t);{const s=e();return n.set(t,s),n.get(t)}}const hf="Abs",zc="Acos",Wc="Acosh",$l="Add",Zb="AddN",Qb="All",Jb="Any",df="ArgMax",ff="ArgMin",Uc="Asin",Hc="Asinh",Gc="Atan",jc="Atanh",qc="Atan2",pf="AvgPool",ex="AvgPoolGrad",mf="AvgPool3D",tx="AvgPool3DGrad",gf="BatchMatMul",bf="BatchToSpaceND",nx="Bincount",mz="BroadcastTo",KI="BroadcastArgs",Kc="Cast",Xc="Ceil",Yc="ClipByValue",sx="Complex",xf="ComplexAbs",yf="Concat",vf="Conv2D",ox="Conv2DBackpropFilter",wf="Conv2DBackpropInput",Cf="Conv3D",rx="Conv3DBackpropFilterV2",ix="Conv3DBackpropInputV2",Zc="Cos",Qc="Cosh",ax="Cumprod",$f="Cumsum",lx="CropAndResize",XI="DenseBincount",cx="DepthToSpace",If="DepthwiseConv2dNative",ux="DepthwiseConv2dNativeBackpropFilter",hx="DepthwiseConv2dNativeBackpropInput",YI="Diag",_f="Dilation2D",Pg="Dilation2DBackpropInput",Mg="Dilation2DBackpropFilter",Jc="RealDiv",ZI="Einsum",eu="Elu",dx="EluGrad",tu="Erf",kf="Equal",nu="Exp",Ef="ExpandDims",su="Expm1",fx="FFT",px="Fill",mx="FlipLeftRight",ou="Floor",ru="FloorDiv",Sf="FusedBatchNorm",Tf="GatherV2",QI="GatherNd",Nf="Greater",iu="GreaterEqual",au="Identity",gx="IFFT",bx="Imag",lu="IsFinite",cu="IsInf",uu="IsNan",Af="LeakyRelu",Rf="Less",Df="LessEqual",JI="LinSpace",hu="Log",du="Log1p",Of="LogicalAnd",Ff="LogicalNot",Lf="LogicalOr",gz="LogSoftmax",Pf="LRN",xx="LRNGrad",Mf="Max",fu="Maximum",Bf="MaxPool",yx="MaxPoolGrad",Vf="MaxPool3D",vx="MaxPool3DGrad",e_="MaxPoolWithArgmax",zf="Mean",Wf="Min",pu="Minimum",Uf="MirrorPad",mu="Mod",t_="Multinomial",gu="Multiply",Hf="Neg",Gf="NotEqual",wx="NonMaxSuppressionV3",Cx="NonMaxSuppressionV4",$x="NonMaxSuppressionV5",jf="OnesLike",qf="OneHot",Kf="Pack",Xf="PadV2",bu="Pow",Yf="Prelu",Zf="Prod",n_="RaggedTensorToTensor",Ix="Range",_x="Real",xu="Reciprocal",yu="Relu",Qf="Reshape",Jf="ResizeNearestNeighbor",kx="ResizeNearestNeighborGrad",ep="ResizeBilinear",Ex="ResizeBilinearGrad",vu="Relu6",tp="Reverse",wu="Round",Cu="Rsqrt",s_="ScatterNd",o_="SearchSorted",np="Select",$u="Selu",sp="Slice",Iu="Sin",_u="Sinh",ku="Sign",Eu="Sigmoid",Su="Softplus",Tu="Sqrt",op="Sum",rp="SpaceToBatchND",ip="SplitV",ap="Softmax",Sx="SparseFillEmptyRows",Tx="SparseReshape",Nx="SparseSegmentMean",Ax="SparseSegmentSum",r_="SparseToDense",Nu="SquaredDifference",Rx="Square",Dx="StridedSlice",Ox="StringNGrams",Fx="StringSplit",Lx="StringToHashBucketFast",Au="Sub",Ru="Tan",Du="Tanh",Ou="Tile",Px="TopK",Mx="Transform",ja="Transpose",Bx="Unique",lp="Unpack",cp="UnsortedSegmentSum",up="ZerosLike",Fu="Step",bz="FromPixels",Vx="RotateWithOffset",bd="_FusedMatMul",xd="FusedConv2D",i_="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cs(...t){se().getBool("IS_TEST")||se().getBool("PROD")||console.warn(...t)}function xz(...t){se().getBool("IS_TEST")||se().getBool("PROD")||console.log(...t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yd=Yb("kernelRegistry",()=>new Map),Bg=Yb("gradRegistry",()=>new Map);function $w(t,e){const n=l_(t,e);return yd.get(n)}function Iw(t){return Bg.get(t)}function _w(t){const e=yd.entries(),n=[];for(;;){const{done:s,value:o}=e.next();if(s)break;const[r,i]=o,[a]=r.split("_");a===t&&n.push(i)}return n}function a_(t){const{kernelName:e,backendName:n}=t,s=l_(e,n);yd.has(s)&&Cs(`The kernel '${e}' for backend '${n}' is already registered`),yd.set(s,t)}function yz(t){const{kernelName:e}=t;Bg.has(e)&&se().getBool("DEBUG")&&Cs(`Overriding the gradient for '${e}'`),Bg.set(e,t)}function l_(t,e){return`${e}_${t}`}var jr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function vz(t){var e=t.default;if(typeof e=="function"){var n=function(){return e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(s){var o=Object.getOwnPropertyDescriptor(t,s);Object.defineProperty(n,s,o.get?o:{enumerable:!0,get:function(){return t[s]}})}),n}var Vg=Pt,Vs=null;try{Vs=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function Pt(t,e,n){this.low=t|0,this.high=e|0,this.unsigned=!!n}Pt.prototype.__isLong__;Object.defineProperty(Pt.prototype,"__isLong__",{value:!0});function gs(t){return(t&&t.__isLong__)===!0}Pt.isLong=gs;var kw={},Ew={};function sa(t,e){var n,s,o;return e?(t>>>=0,(o=0<=t&&t<256)&&(s=Ew[t],s)?s:(n=Mt(t,(t|0)<0?-1:0,!0),o&&(Ew[t]=n),n)):(t|=0,(o=-128<=t&&t<128)&&(s=kw[t],s)?s:(n=Mt(t,t<0?-1:0,!1),o&&(kw[t]=n),n))}Pt.fromInt=sa;function zs(t,e){if(isNaN(t))return e?Ti:Ws;if(e){if(t<0)return Ti;if(t>=c_)return d_}else{if(t<=-Tw)return us;if(t+1>=Tw)return h_}return t<0?zs(-t,e).neg():Mt(t%rl|0,t/rl|0,e)}Pt.fromNumber=zs;function Mt(t,e,n){return new Pt(t,e,n)}Pt.fromBits=Mt;var vd=Math.pow;function zx(t,e,n){if(t.length===0)throw Error("empty string");if(t==="NaN"||t==="Infinity"||t==="+Infinity"||t==="-Infinity")return Ws;if(typeof e=="number"?(n=e,e=!1):e=!!e,n=n||10,n<2||36<n)throw RangeError("radix");var s;if((s=t.indexOf("-"))>0)throw Error("interior hyphen");if(s===0)return zx(t.substring(1),e,n).neg();for(var o=zs(vd(n,8)),r=Ws,i=0;i<t.length;i+=8){var a=Math.min(8,t.length-i),l=parseInt(t.substring(i,i+a),n);if(a<8){var c=zs(vd(n,a));r=r.mul(c).add(zs(l))}else r=r.mul(o),r=r.add(zs(l))}return r.unsigned=e,r}Pt.fromString=zx;function vo(t,e){return typeof t=="number"?zs(t,e):typeof t=="string"?zx(t,e):Mt(t.low,t.high,typeof e=="boolean"?e:t.unsigned)}Pt.fromValue=vo;var Sw=1<<16,wz=1<<24,rl=Sw*Sw,c_=rl*rl,Tw=c_/2,Nw=sa(wz),Ws=sa(0);Pt.ZERO=Ws;var Ti=sa(0,!0);Pt.UZERO=Ti;var Ma=sa(1);Pt.ONE=Ma;var u_=sa(1,!0);Pt.UONE=u_;var zg=sa(-1);Pt.NEG_ONE=zg;var h_=Mt(-1,2147483647,!1);Pt.MAX_VALUE=h_;var d_=Mt(-1,-1,!0);Pt.MAX_UNSIGNED_VALUE=d_;var us=Mt(0,-2147483648,!1);Pt.MIN_VALUE=us;var Ee=Pt.prototype;Ee.toInt=function(){return this.unsigned?this.low>>>0:this.low};Ee.toNumber=function(){return this.unsigned?(this.high>>>0)*rl+(this.low>>>0):this.high*rl+(this.low>>>0)};Ee.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(us)){var n=zs(e),s=this.div(n),o=s.mul(n).sub(this);return s.toString(e)+o.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var r=zs(vd(e,6),this.unsigned),i=this,a="";;){var l=i.div(r),c=i.sub(l.mul(r)).toInt()>>>0,u=c.toString(e);if(i=l,i.isZero())return u+a;for(;u.length<6;)u="0"+u;a=""+u+a}};Ee.getHighBits=function(){return this.high};Ee.getHighBitsUnsigned=function(){return this.high>>>0};Ee.getLowBits=function(){return this.low};Ee.getLowBitsUnsigned=function(){return this.low>>>0};Ee.getNumBitsAbs=function(){if(this.isNegative())return this.eq(us)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,n=31;n>0&&(e&1<<n)==0;n--);return this.high!=0?n+33:n+1};Ee.isZero=function(){return this.high===0&&this.low===0};Ee.eqz=Ee.isZero;Ee.isNegative=function(){return!this.unsigned&&this.high<0};Ee.isPositive=function(){return this.unsigned||this.high>=0};Ee.isOdd=function(){return(this.low&1)===1};Ee.isEven=function(){return(this.low&1)===0};Ee.equals=function(e){return gs(e)||(e=vo(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low};Ee.eq=Ee.equals;Ee.notEquals=function(e){return!this.eq(e)};Ee.neq=Ee.notEquals;Ee.ne=Ee.notEquals;Ee.lessThan=function(e){return this.comp(e)<0};Ee.lt=Ee.lessThan;Ee.lessThanOrEqual=function(e){return this.comp(e)<=0};Ee.lte=Ee.lessThanOrEqual;Ee.le=Ee.lessThanOrEqual;Ee.greaterThan=function(e){return this.comp(e)>0};Ee.gt=Ee.greaterThan;Ee.greaterThanOrEqual=function(e){return this.comp(e)>=0};Ee.gte=Ee.greaterThanOrEqual;Ee.ge=Ee.greaterThanOrEqual;Ee.compare=function(e){if(gs(e)||(e=vo(e)),this.eq(e))return 0;var n=this.isNegative(),s=e.isNegative();return n&&!s?-1:!n&&s?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};Ee.comp=Ee.compare;Ee.negate=function(){return!this.unsigned&&this.eq(us)?us:this.not().add(Ma)};Ee.neg=Ee.negate;Ee.add=function(e){gs(e)||(e=vo(e));var n=this.high>>>16,s=this.high&65535,o=this.low>>>16,r=this.low&65535,i=e.high>>>16,a=e.high&65535,l=e.low>>>16,c=e.low&65535,u=0,h=0,d=0,f=0;return f+=r+c,d+=f>>>16,f&=65535,d+=o+l,h+=d>>>16,d&=65535,h+=s+a,u+=h>>>16,h&=65535,u+=n+i,u&=65535,Mt(d<<16|f,u<<16|h,this.unsigned)};Ee.subtract=function(e){return gs(e)||(e=vo(e)),this.add(e.neg())};Ee.sub=Ee.subtract;Ee.multiply=function(e){if(this.isZero())return Ws;if(gs(e)||(e=vo(e)),Vs){var n=Vs.mul(this.low,this.high,e.low,e.high);return Mt(n,Vs.get_high(),this.unsigned)}if(e.isZero())return Ws;if(this.eq(us))return e.isOdd()?us:Ws;if(e.eq(us))return this.isOdd()?us:Ws;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(Nw)&&e.lt(Nw))return zs(this.toNumber()*e.toNumber(),this.unsigned);var s=this.high>>>16,o=this.high&65535,r=this.low>>>16,i=this.low&65535,a=e.high>>>16,l=e.high&65535,c=e.low>>>16,u=e.low&65535,h=0,d=0,f=0,p=0;return p+=i*u,f+=p>>>16,p&=65535,f+=r*u,d+=f>>>16,f&=65535,f+=i*c,d+=f>>>16,f&=65535,d+=o*u,h+=d>>>16,d&=65535,d+=r*c,h+=d>>>16,d&=65535,d+=i*l,h+=d>>>16,d&=65535,h+=s*u+o*c+r*l+i*a,h&=65535,Mt(f<<16|p,h<<16|d,this.unsigned)};Ee.mul=Ee.multiply;Ee.divide=function(e){if(gs(e)||(e=vo(e)),e.isZero())throw Error("division by zero");if(Vs){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var n=(this.unsigned?Vs.div_u:Vs.div_s)(this.low,this.high,e.low,e.high);return Mt(n,Vs.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?Ti:Ws;var s,o,r;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return Ti;if(e.gt(this.shru(1)))return u_;r=Ti}else{if(this.eq(us)){if(e.eq(Ma)||e.eq(zg))return us;if(e.eq(us))return Ma;var i=this.shr(1);return s=i.div(e).shl(1),s.eq(Ws)?e.isNegative()?Ma:zg:(o=this.sub(e.mul(s)),r=s.add(o.div(e)),r)}else if(e.eq(us))return this.unsigned?Ti:Ws;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();r=Ws}for(o=this;o.gte(e);){s=Math.max(1,Math.floor(o.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(s)/Math.LN2),l=a<=48?1:vd(2,a-48),c=zs(s),u=c.mul(e);u.isNegative()||u.gt(o);)s-=l,c=zs(s,this.unsigned),u=c.mul(e);c.isZero()&&(c=Ma),r=r.add(c),o=o.sub(u)}return r};Ee.div=Ee.divide;Ee.modulo=function(e){if(gs(e)||(e=vo(e)),Vs){var n=(this.unsigned?Vs.rem_u:Vs.rem_s)(this.low,this.high,e.low,e.high);return Mt(n,Vs.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};Ee.mod=Ee.modulo;Ee.rem=Ee.modulo;Ee.not=function(){return Mt(~this.low,~this.high,this.unsigned)};Ee.and=function(e){return gs(e)||(e=vo(e)),Mt(this.low&e.low,this.high&e.high,this.unsigned)};Ee.or=function(e){return gs(e)||(e=vo(e)),Mt(this.low|e.low,this.high|e.high,this.unsigned)};Ee.xor=function(e){return gs(e)||(e=vo(e)),Mt(this.low^e.low,this.high^e.high,this.unsigned)};Ee.shiftLeft=function(e){return gs(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?Mt(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):Mt(0,this.low<<e-32,this.unsigned)};Ee.shl=Ee.shiftLeft;Ee.shiftRight=function(e){return gs(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?Mt(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):Mt(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};Ee.shr=Ee.shiftRight;Ee.shiftRightUnsigned=function(e){if(gs(e)&&(e=e.toInt()),e&=63,e===0)return this;var n=this.high;if(e<32){var s=this.low;return Mt(s>>>e|n<<32-e,n>>>e,this.unsigned)}else return e===32?Mt(n,0,this.unsigned):Mt(n>>>e-32,0,this.unsigned)};Ee.shru=Ee.shiftRightUnsigned;Ee.shr_u=Ee.shiftRightUnsigned;Ee.toSigned=function(){return this.unsigned?Mt(this.low,this.high,!1):this};Ee.toUnsigned=function(){return this.unsigned?this:Mt(this.low,this.high,!0)};Ee.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};Ee.toBytesLE=function(){var e=this.high,n=this.low;return[n&255,n>>>8&255,n>>>16&255,n>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};Ee.toBytesBE=function(){var e=this.high,n=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,n>>>24,n>>>16&255,n>>>8&255,n&255]};Pt.fromBytes=function(e,n,s){return s?Pt.fromBytesLE(e,n):Pt.fromBytesBE(e,n)};Pt.fromBytesLE=function(e,n){return new Pt(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,n)};Pt.fromBytesBE=function(e,n){return new Pt(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],n)};const Cz=AO({__proto__:null,default:Vg},[Vg]);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ki=Vg||Cz;function hp(t){return ki.fromString(t,!0,16)}const f_=hp("c3a5c85c97cb3127"),$i=hp("b492b66fbe98f273"),Bn=hp("9ae16a3b2f90404f");function Wg(t){return t.xor(t.shru(47))}function p_(t,e,n){const s=t.slice(e,e+n);return ki.fromBytes(Array.from(s),!0,!0)}function Tt(t,e){return p_(t,e,8)}function Aw(t,e){return p_(t,e,4)}function fn(t,e){return e===0?t:t.shru(e).or(t.shl(64-e))}function Dr(t,e,n=hp("9ddfea08eb382d69")){let s=t.xor(e).mul(n);s=s.xor(s.shru(47));let o=e.xor(s).mul(n);return o=o.xor(o.shru(47)),o=o.mul(n),o}function $z(t,e,n,s,o,r){o=o.add(t),r=fn(r.add(o).add(s),21);const i=o;return o=o.add(e),o=o.add(n),r=r.add(fn(o,44)),[o.add(s),r.add(i)]}function Ph(t,e,n,s){return $z(Tt(t,e),Tt(t,e+8),Tt(t,e+16),Tt(t,e+24),n,s)}function Iz(t,e=t.length){if(e>=8){const n=Bn.add(e*2),s=Tt(t,0).add(Bn),o=Tt(t,e-8),r=fn(o,37).mul(n).add(s),i=fn(s,25).add(o).mul(n);return Dr(r,i,n)}if(e>=4){const n=Bn.add(e*2),s=Aw(t,0);return Dr(s.shl(3).add(e),Aw(t,e-4),n)}if(e>0){const n=t[0],s=t[e>>1],o=t[e-1],r=n+(s<<8),i=e+(o<<2);return Wg(Bn.mul(r).xor(f_.mul(i))).mul(Bn)}return Bn}function _z(t,e=t.length){const n=Bn.add(e*2),s=Tt(t,0).mul($i),o=Tt(t,8),r=Tt(t,e-8).mul(n),i=Tt(t,e-16).mul(Bn);return Dr(fn(s.add(o),43).add(fn(r,30)).add(i),s.add(fn(o.add(Bn),18)).add(r),n)}function kz(t,e=t.length){const n=Bn.add(e*2),s=Tt(t,0).mul(Bn),o=Tt(t,8),r=Tt(t,e-8).mul(n),i=Tt(t,e-16).mul(Bn),a=fn(s.add(o),43).add(fn(r,30)).add(i),l=Dr(a,s.add(fn(o.add(Bn),18)).add(r),n),c=Tt(t,16).mul(n),u=Tt(t,24),h=a.add(Tt(t,e-32)).mul(n),d=l.add(Tt(t,e-24)).mul(n);return Dr(fn(c.add(u),43).add(fn(h,30)).add(d),c.add(fn(u.add(s),18)).add(h),n)}function Ez(t,e=t.length){const n=ki.fromNumber(81,!0);if(e<=32)return e<=16?Iz(t,e):_z(t,e);if(e<=64)return kz(t,e);let s=n,o=n.mul($i).add(113),r=Wg(o.mul(Bn).add(113)).mul(Bn),i=[ki.UZERO,ki.UZERO],a=[ki.UZERO,ki.UZERO];s=s.mul(Bn).add(Tt(t,0));let l=0;const c=(e-1>>6)*64,u=c+(e-1&63)-63;do s=fn(s.add(o).add(i[0]).add(Tt(t,l+8)),37).mul($i),o=fn(o.add(i[1]).add(Tt(t,l+48)),42).mul($i),s=s.xor(a[1]),o=o.add(i[0]).add(Tt(t,l+40)),r=fn(r.add(a[0]),33).mul($i),i=Ph(t,l,i[1].mul($i),s.add(a[0])),a=Ph(t,l+32,r.add(a[1]),o.add(Tt(t,l+16))),[r,s]=[s,r],l+=64;while(l!==c);const h=$i.add(r.and(255).shl(1));return l=u,a[0]=a[0].add(e-1&63),i[0]=i[0].add(a[0]),a[0]=a[0].add(i[0]),s=fn(s.add(o).add(i[0]).add(Tt(t,l+8)),37).mul(h),o=fn(o.add(i[1]).add(Tt(t,l+48)),42).mul(h),s=s.xor(a[1].mul(9)),o=o.add(i[0].mul(9).add(Tt(t,l+40))),r=fn(r.add(a[0]),33).mul(h),i=Ph(t,l,i[1].mul(h),s.add(a[0])),a=Ph(t,l+32,r.add(a[1]),o.add(Tt(t,l+16))),[r,s]=[s,r],Dr(Dr(i[0],a[0],h).add(Wg(o).mul(f_)).add(r),Dr(i[1],a[1],h).add(s),h)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qr(t,e){return e==="string"?Or(t):oa([t],e)}function Sz(t,e){return t instanceof Float32Array&&e==="float32"||t instanceof Int32Array&&e==="int32"||t instanceof Uint8Array&&e==="bool"}function oa(t,e){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=sl(t)),se().getBool("DEBUG")&&rz(t,e),Sz(t,e))return t;if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool"){const n=new Uint8Array(t.length);for(let s=0;s<n.length;++s)Math.round(t[s])!==0&&(n[s]=1);return n}else throw new Error(`Unknown data type ${e}`)}function Zn(){return se().platform.now()}function Or(t,e="utf-8"){return e=e||"utf-8",se().platform.encode(t,e)}function Mr(t,e="utf-8"){return e=e||"utf-8",se().platform.decode(t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Tz{constructor(e,n){this.backendTimer=e,this.logger=n,n==null&&(this.logger=new Az)}profileKernel(e,n,s){let o;const r=()=>{o=s()};let i;const a=Zn();if(this.backendTimer.timerAvailable())i=this.backendTimer.time(r);else{r();for(const c of o)c.dataSync();i=Promise.resolve({kernelMs:Zn()-a})}if(se().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let c=0;c<o.length;c++){const u=o[c];u.data().then(h=>{Nz(h,u.dtype,e)})}return{kernelName:e,outputs:o,inputs:n,timeMs:i.then(c=>c.kernelMs),extraInfo:i.then(c=>c.getExtraProfileInfo!=null?c.getExtraProfileInfo():"")}}logKernelProfile(e){const{kernelName:n,outputs:s,timeMs:o,inputs:r,extraInfo:i}=e;s.forEach(a=>{Promise.all([a.data(),o,i]).then(l=>{this.logger.logKernelProfile(n,a,l[0],l[1],r,l[2])})})}}function Nz(t,e,n){if(e!=="float32")return!1;for(let s=0;s<t.length;s++){const o=t[s];if(isNaN(o)||!isFinite(o))return console.warn(`Found ${o} in the result of '${n}'`),!0}return!1}class Az{logKernelProfile(e,n,s,o,r,i){const a=typeof o=="number"?Ga(`${o}ms`,9):o.error,l=Ga(e,25),c=n.rank,u=n.size,h=Ga(n.shape.toString(),14);let d="";for(const f in r){const p=r[f];if(p!=null){const g=p.shape||n.shape,b=g.length;d+=`${f}: ${b}D ${b>0?g:""} `}}console.log(`%c${l}	%c${a}	%c${c}D ${h}	%c${u}	%c${d}	%c${i}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rz(t,e,n){const s={},o={};for(let l=0;l<e.length;l++)s[e[l].id]=!0;for(let l=0;l<t.length;l++){const c=t[l],u=c.inputs;for(const h in u){const d=u[h];let f=!1;for(let p=0;p<e.length;p++)if(s[d.id]){c.outputs.forEach(g=>s[g.id]=!0),f=!0,o[c.id]=!0;break}if(f)break}}const r={};r[n.id]=!0;const i={};for(let l=t.length-1;l>=0;l--){const c=t[l],u=c.inputs;for(let h=0;h<c.outputs.length;h++)if(r[c.outputs[h].id]){for(const d in u)r[u[d].id]=!0,i[c.id]=!0;break}}const a=[];for(let l=0;l<t.length;l++){const c=t[l];if(o[c.id]&&i[c.id]){const u={};for(const d in c.inputs){const f=c.inputs[d];s[f.id]&&(u[d]=f)}const h=Object.assign({},c);h.inputs=u,h.outputs=c.outputs,a.push(h)}}return a}function Dz(t,e,n,s){for(let o=e.length-1;o>=0;o--){const r=e[o],i=[];if(r.outputs.forEach(l=>{const c=t[l.id];c!=null?i.push(c):i.push(null)}),r.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${r.kernelName}.`);const a=r.gradient(i);for(const l in r.inputs){if(!(l in a))throw new Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(a)}.`);const c=n(()=>a[l]());if(c.dtype!=="float32")throw new Error(`Error in gradient for op ${r.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${c.dtype}'`);const u=r.inputs[l];if(!bt(c.shape,u.shape))throw new Error(`Error in gradient for op ${r.kernelName}. The gradient of input '${l}' has shape '${c.shape}', which does not match the shape of the input '${u.shape}'`);if(t[u.id]==null)t[u.id]=c;else{const h=t[u.id];t[u.id]=s(h,c),h.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rw=20,Yl=3,Hm=7;function Oz(t,e,n,s){const o=Ue(e),r=Fz(t,e,n,o),i=e.length,a=nd(t,e,n,o,r),l=["Tensor"];return s&&(l.push(`  dtype: ${n}`),l.push(`  rank: ${i}`),l.push(`  shape: [${e}]`),l.push("  values:")),l.push(a.map(c=>"    "+c).join(`
`)),l.join(`
`)}function Fz(t,e,n,s){const o=ae(e),r=s[s.length-1],i=new Array(r).fill(0),a=e.length,l=n==="complex64"?nc(t):t;if(a>1)for(let c=0;c<o/r;c++){const u=c*r;for(let h=0;h<r;h++)i[h]=Math.max(i[h],tc(l[u+h],0,n).length)}return i}function tc(t,e,n){let s;return Array.isArray(t)?s=`${parseFloat(t[0].toFixed(Hm))} + ${parseFloat(t[1].toFixed(Hm))}j`:Mc(t)?s=`'${t}'`:n==="bool"?s=m_(t):s=parseFloat(t.toFixed(Hm)).toString(),Ga(s,e)}function m_(t){return t===0?"false":"true"}function nd(t,e,n,s,o,r=!0){const i=n==="complex64"?2:1,a=e[0],l=e.length;if(l===0){if(n==="complex64"){const g=nc(t);return[tc(g[0],0,n)]}return n==="bool"?[m_(t[0])]:[t[0].toString()]}if(l===1){if(a>Rw){const b=Yl*i;let x=Array.from(t.slice(0,b)),y=Array.from(t.slice((a-Yl)*i,a*i));return n==="complex64"&&(x=nc(x),y=nc(y)),["["+x.map((w,v)=>tc(w,o[v],n)).join(", ")+", ..., "+y.map((w,v)=>tc(w,o[a-Yl+v],n)).join(", ")+"]"]}const g=n==="complex64"?nc(t):Array.from(t);return["["+g.map((b,x)=>tc(b,o[x],n)).join(", ")+"]"]}const c=e.slice(1),u=s.slice(1),h=s[0]*i,d=[];if(a>Rw){for(let g=0;g<Yl;g++){const b=g*h,x=b+h;d.push(...nd(t.slice(b,x),c,n,u,o,!1))}d.push("...");for(let g=a-Yl;g<a;g++){const b=g*h,x=b+h;d.push(...nd(t.slice(b,x),c,n,u,o,g===a-1))}}else for(let g=0;g<a;g++){const b=g*h,x=b+h;d.push(...nd(t.slice(b,x),c,n,u,o,g===a-1))}const f=l===2?",":"";d[0]="["+d[0]+f;for(let g=1;g<d.length-1;g++)d[g]=" "+d[g]+f;let p=`,
`;for(let g=2;g<l;g++)p+=`
`;return d[d.length-1]=" "+d[d.length-1]+"]"+(r?"":p),d}function nc(t){const e=[];for(let n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Rn{constructor(e,n,s){if(this.dtype=n,this.shape=e.slice(),this.size=ae(e),s!=null){const o=s.length;T(o===this.size,()=>`Length of values '${o}' does not match the size inferred by the shape '${this.size}'.`)}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=s||An(n,this.size),this.strides=Ue(e)}set(e,...n){n.length===0&&(n=[0]),T(n.length===this.rank,()=>`The number of provided coordinates (${n.length}) must match the rank (${this.rank})`);const s=this.locToIndex(n);this.values[s]=e}get(...e){e.length===0&&(e=[0]);let n=0;for(const o of e){if(o<0||o>=this.shape[n]){const r=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(r)}n++}let s=e[e.length-1];for(let o=0;o<e.length-1;++o)s+=this.strides[o]*e[o];return this.values[s]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let n=e[e.length-1];for(let s=0;s<e.length-1;++s)n+=this.strides[s]*e[s];return n}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];const n=new Array(this.shape.length);for(let s=0;s<n.length-1;++s)n[s]=Math.floor(e/this.strides[s]),e-=n[s]*this.strides[s];return n[n.length-1]=e,n}get rank(){return this.shape.length}toTensor(){return ao().makeTensor(this.values,this.shape,this.dtype)}}let ao=null,Fa=null;function Lz(t){ao=t}function Pz(t){Fa=t}class tn{constructor(e,n,s,o){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=n||"float32",this.size=ae(e),this.strides=Ue(e),this.dataId=s,this.id=o,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return Fa.buffer(this.shape,this.dtype,e)}bufferSync(){return Fa.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return po(this.shape,e,this.dtype==="complex64")}arraySync(){return po(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const e=ao().read(this.dataId);if(this.dtype==="string"){const n=await e;try{return n.map(s=>Mr(s))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),ao().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=ao().readSync(this.dataId);if(this.dtype==="string")try{return e.map(n=>Mr(n))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await ao().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(ao().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return Fa.print(this,e)}clone(){return this.throwIfDisposed(),Fa.clone(this)}toString(e=!1){const n=this.dataSync();return Oz(n,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),Fa.cast(this,e)}variable(e=!0,n,s){return this.throwIfDisposed(),ao().makeVariable(this,e,n,s)}}Object.defineProperty(tn,Symbol.hasInstance,{value:t=>!!t&&t.data!=null&&t.dataSync!=null&&t.throwIfDisposed!=null});function oe(){return Yb("Tensor",()=>tn)}oe();class wd extends tn{constructor(e,n,s,o){super(e.shape,e.dtype,e.dataId,o),this.trainable=n,this.name=s}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!bt(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);ao().disposeTensor(this),this.dataId=e.dataId,ao().incRef(this,null)}dispose(){ao().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(wd,Symbol.hasInstance,{value:t=>t instanceof tn&&t.assign!=null&&t.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Dw;(function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"})(Dw||(Dw={}));var Ug;(function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"})(Ug||(Ug={}));var Hg;(function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"})(Hg||(Hg={}));var Gg;(function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"})(Gg||(Gg={}));var jg;(function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"})(jg||(jg={}));const Mz={float32:Gg,int32:Ug,bool:Hg,complex64:jg};function ds(t,e){if(t==="string"||e==="string"){if(t==="string"&&e==="string")return"string";throw new Error(`Can not upcast ${t} with ${e}`)}return Mz[t][e]}function Wx(t){return ds(t,"int32")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xt(t,e){if(t.dtype===e.dtype)return[t,e];const n=ds(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function g_(t){const e=[];return b_(t,e,new Set),e}function b_(t,e,n){if(t==null)return;if(t instanceof tn){e.push(t);return}if(!Bz(t))return;const s=t;for(const o in s){const r=s[o];n.has(r)||(n.add(r),b_(r,e,n))}}function Bz(t){return Array.isArray(t)||typeof t=="object"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gm(t){return t.kernelName!=null}class Ow{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class il{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new Ow}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const s=e[n];if(await this.initializeBackend(s).success){await this.setBackend(s);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:e,asyncInit:n}=this.initializeBackendsAndReturnBest();if(n)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){const{asyncInit:n}=this.initializeBackend(e);if(n)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,n,s=1){return e in this.registryFactory?(Cs(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:n,priority:s},!0)}async setBackend(e){if(this.registryFactory[e]==null)throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;const{success:n,asyncInit:s}=this.initializeBackend(e);if(!(s?await n:n))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new Tz(this.backendInstance),!0}setupRegisteredKernels(){_w(this.backendName).forEach(n=>{n.setupFunc!=null&&n.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){_w(e).forEach(s=>{s.disposeFunc!=null&&s.disposeFunc(this.registry[e])})}initializeBackend(e){const n=this.registryFactory[e];if(n==null)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const s=n.factory();if(s&&!(s instanceof qb)&&typeof s.then=="function"){const o=++this.pendingBackendInitId,r=s.then(i=>o<this.pendingBackendInitId?!1:(this.registry[e]=i,this.pendingBackendInit=null,!0)).catch(i=>(o<this.pendingBackendInitId||(this.pendingBackendInit=null,Cs(`Initialization of backend ${e} failed`),Cs(i.stack||i.message)),!1));return this.pendingBackendInit=r,{success:r,asyncInit:!0}}else return this.registry[e]=s,{success:!0,asyncInit:!1}}catch(s){return Cs(`Initialization of backend ${e} failed`),Cs(s.stack||s.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,n)=>this.registryFactory[n].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const s=e[n],{success:o,asyncInit:r}=this.initializeBackend(s);if(r||o)return{name:s,asyncInit:r}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,n){const s=this.state.tensorInfo.get(n),o=s.backend,r=this.readSync(n),i=o.refCount(n);o.disposeData(n,!0),s.backend=e,e.move(n,r,s.shape,s.dtype,i),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,n){let s=null;if(n==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");n=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");s=e}let o;return this.scopedRun(()=>this.startScope(s),()=>this.endScope(o),()=>(o=n(),o instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),o))}scopedRun(e,n,s){e();try{const o=s();return n(),o}catch(o){throw n(),o}}nextTensorId(){return il.nextTensorId++}nextVariableId(){return il.nextVariableId++}clone(e){const n=W.runKernel(au,{x:e}),s={x:e},o=i=>({x:()=>{const a="float32",l={x:i},c={dtype:a};return W.runKernel(Kc,l,c)}}),r=[];return this.addTapeNode(this.state.activeScope.name,s,[n],o,r,{}),n}runKernel(e,n,s){if(this.backendName==null&&this.backend,!($w(e,this.backendName)!=null))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:n,attrs:s})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,n,s){const o=this.backend.numDataIds();let r=0;s.forEach(l=>{r+=l.dtype==="complex64"?3:1});const i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],a=o-n-r-i;if(a>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${a} data ids) after running '${e}'`)}runKernelFunc(e){let n,s=[];const o=this.isTapeOn(),r=this.state.numBytes,i=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let a;this.backendName==null&&this.backend;let l;const c=Gm(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(Gm(e)){const{kernelName:p,inputs:g,attrs:b}=e;this.backendName==null&&this.backend;const x=$w(p,this.backendName);T(x!=null,()=>`Cannot find registered kernel '${p}' for backend '${this.backendName}'`),a=()=>{const y=this.backend.numDataIds();l=x.kernelFunc({inputs:g,attrs:b,backend:this.backend});const w=Array.isArray(l)?l:[l];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(p,y,w);const v=w.map($=>$.rank!=null?$:this.makeTensorFromTensorInfo($));if(o){const $=this.getTensorsForGradient(p,g,v);s=this.saveTensorsForBackwardMode($)}return v}}else{const{forwardFunc:p}=e,g=b=>{!o||(s=b.map(x=>this.keep(this.clone(x))))};a=()=>{const b=this.backend.numDataIds();l=this.tidy(()=>p(this.backend,g));const x=Array.isArray(l)?l:[l];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(c,b,x),x}}const{inputs:u,attrs:h}=e,d=Gm(e)?null:e.backwardsFunc;let f;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?n=a():(f=this.profiler.profileKernel(c,u,()=>a()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(f),n=f.outputs)}),o&&this.addTapeNode(c,u,n,d,s,h),this.state.profiling&&this.state.activeProfile.kernels.push({name:c,bytesAdded:this.state.numBytes-r,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-i,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(u).map(p=>u[p]!=null?u[p].shape:null),outputShapes:n.map(p=>p.shape),kernelTimeMs:f.timeMs,extraInfo:f.extraInfo}),Array.isArray(l)?n:n[0]}saveTensorsForBackwardMode(e){return e.map(s=>this.keep(this.clone(s)))}getTensorsForGradient(e,n,s){const o=Iw(e);if(o!=null){const r=o.inputsToSave||[],i=o.outputsToSave||[];let a;o.saveAllInputs?(T(Array.isArray(n),()=>"saveAllInputs is true, expected inputs to be an array."),a=Object.keys(n).map(c=>n[c])):a=r.map(c=>n[c]);const l=s.filter((c,u)=>i[u]);return a.concat(l)}return[]}makeTensor(e,n,s,o){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");s=s||"float32",o=o||this.backend;let r=e;s==="string"&&Mc(e[0])&&(r=e.map(l=>Or(l)));const i=o.write(r,n,s),a=new tn(n,s,i,this.nextTensorId());if(this.trackTensor(a,o),s==="string"){const l=this.state.tensorInfo.get(i),c=az(r);this.state.numBytes+=c-l.bytes,l.bytes=c}return a}makeTensorFromDataId(e,n,s,o){s=s||"float32";const r={dataId:e,shape:n,dtype:s};return this.makeTensorFromTensorInfo(r,o)}makeTensorFromTensorInfo(e,n){const{dataId:s,shape:o,dtype:r}=e,i=new tn(o,r,s,this.nextTensorId());return this.trackTensor(i,n),i}makeVariable(e,n=!0,s,o){s=s||this.nextVariableId().toString(),o!=null&&o!==e.dtype&&(e=e.cast(o));const r=new wd(e,n,s,this.nextTensorId());if(this.state.registeredVariables[r.name]!=null)throw new Error(`Variable with name ${r.name} was already registered`);return this.state.registeredVariables[r.name]=r,this.incRef(r,this.backend),r}trackTensor(e,n){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let s=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(s=e.size*Dg(e.dtype)),this.state.numBytes+=s,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:n||this.backend,dtype:e.dtype,shape:e.shape,bytes:s})),e instanceof wd||this.track(e)}incRef(e,n){this.trackTensor(e,n),this.backend.incRef(e.dataId)}removeDataId(e,n){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===n&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const n=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=n.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){const s=e.size*Dg(e.dtype);this.state.numBytes-=s}n.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,n.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const n=this.state.registeredVariables[e];this.disposeVariable(n)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const n=this.state.numBytes,s=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(o=>o.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-s;for(const o of this.state.activeProfile.kernels)o.kernelTimeMs=await o.kernelTimeMs,o.extraInfo=await o.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,n,s,o,r,i){const a={id:this.state.nextTapeNodeId++,kernelName:e,inputs:n,outputs:s,saved:r},l=Iw(e);l!=null&&(o=l.gradFunc),o!=null&&(a.gradient=c=>(c=c.map((u,h)=>{if(u==null){const d=s[h],f=Ln(d.size,d.dtype);return this.makeTensor(f,d.shape,d.dtype)}return u}),o(c.length>1?c:c[0],r,i))),this.state.activeTape.push(a)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(n.name=e),this.state.scopeStack.push(n),this.state.activeScope=n}endScope(e){const n=g_(e),s=new Set(n.map(r=>r.id));for(let r=0;r<this.state.activeScope.track.length;r++){const i=this.state.activeScope.track[r];!i.kept&&!s.has(i.id)&&i.dispose()}const o=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach(r=>{!r.kept&&r.scopeId===o.id&&this.track(r)})}gradients(e,n,s,o=!1){if(T(n.length>0,()=>"gradients() received an empty list of xs."),s!=null&&s.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${s.dtype}'`);const r=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));T(r instanceof tn,()=>"The result y returned by f() must be a tensor.");const i=Rz(this.state.activeTape,n,r);if(!o&&i.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const a={};a[r.id]=s==null?Vz(r.shape):s,Dz(a,i,c=>this.tidy(c),zz);const l=n.map(c=>a[c.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(c=>{for(const u of c.saved)u.dispose()}),this.state.activeTape=null),{value:r,grads:l}})}customGrad(e){return T(Fg(e),()=>"The f passed in customGrad(f) must be a function."),(...n)=>{T(n.every(a=>a instanceof tn),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let s;const o={};n.forEach((a,l)=>{o[l]=a});const r=(a,l)=>(s=e(...n,l),T(s.value instanceof tn,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),T(Fg(s.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),s.value),i=(a,l)=>{const c=s.gradFunc(a,l),u=Array.isArray(c)?c:[c];T(u.length===n.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),T(u.every(d=>d instanceof tn),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const h={};return u.forEach((d,f)=>{h[f]=()=>d}),h};return this.runKernelFunc({forwardFunc:r,backwardsFunc:i,inputs:o})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,n){return this.state.tensorInfo.get(e).backend.readToGPU(e,n)}async time(e){const n=Zn(),s=await this.backend.time(e);return s.wallMs=Zn()-n,s}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new Ow;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}il.nextTensorId=0;il.nextVariableId=0;function Vz(t){const e=Xb(ae(t),"float32");return W.makeTensor(e,t,"float32")}function x_(){const t=qI();if(t._tfengine==null){const e=new cz(t);t._tfengine=new il(e)}return fz(t._tfengine.ENV),Lz(()=>t._tfengine),t._tfengine}const W=x_();function zz(t,e){const n={a:t,b:e};return W.runKernel($l,n)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wz(){return typeof navigator<"u"&&navigator!=null}function y_(t){if(t||Wz()){if(t||(t=navigator),t.product==="ReactNative")return!0;const e=t.userAgent||t.vendor||(typeof window<"u"?window.opera:"");if(!e){const n=t;return n.userAgentData&&n.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function v_(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Es=se();Es.registerFlag("DEBUG",()=>!1,t=>{t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});Es.registerFlag("IS_BROWSER",()=>v_());Es.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");Es.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));Es.registerFlag("PROD",()=>!1);Es.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>Es.getBool("DEBUG"));Es.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);Es.registerFlag("IS_TEST",()=>!1);Es.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>!0);Es.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);Es.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);Es.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dp(t,e){let n=t;if(Wo(t))return e==="string"?[]:[t.length];if(!Array.isArray(t))return[];const s=[];for(;Array.isArray(n)||Wo(n)&&e!=="string";)s.push(n.length),n=n[0];return Array.isArray(t)&&se().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&w_(t,s,[]),s}function w_(t,e,n){if(n=n||[],!Array.isArray(t)&&!Wo(t)){T(e.length===0,()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`);return}T(e.length>0,()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${t.length} elements`),T(t.length===e[0],()=>`Element arr[${n.join("][")}] should have ${e[0]} elements, but has ${t.length} elements`);const s=e.slice(1);for(let o=0;o<t.length;++o)w_(t[o],s,n.concat(o))}function Fw(t,e,n,s){if(t!=="string_or_numeric"){if(t==null)throw new Error("Expected dtype cannot be null.");if(t!=="numeric"&&t!==e||t==="numeric"&&e==="string")throw new Error(`Argument '${n}' passed to '${s}' must be ${t} tensor, but got ${e} tensor`)}}function R(t,e,n,s="numeric"){if(t instanceof tn)return Fw(s,t.dtype,e,n),t;let o=Bc(t);if(o!=="string"&&["bool","int32","float32"].indexOf(s)>=0&&(o=s),Fw(s,o,e,n),t==null||!Wo(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string"){const l=t==null?"null":t.constructor.name;throw new Error(`Argument '${e}' passed to '${n}' must be a Tensor or TensorLike, but got '${l}'`)}const r=dp(t,o);!Wo(t)&&!Array.isArray(t)&&(t=[t]);const a=o!=="string"?oa(t,o):sl(t,[],!0);return W.makeTensor(a,r,o)}function C_(t,e,n,s="numeric"){if(!Array.isArray(t))throw new Error(`Argument ${e} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return t.map((r,i)=>R(r,`${e}[${i}]`,n,s))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uz="__op";function U(t){const e=Object.keys(t);if(e.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${e.length} keys.`);let n=e[0];const s=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n=n+Uz;const o=(...r)=>{W.startScope(n);try{const i=s(...r);return GI(i)&&console.error("Cannot return a Promise inside of tidy."),W.endScope(i),i}catch(i){throw W.endScope(null),i}};return Object.defineProperty(o,"name",{value:n,configurable:!0}),o}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hz(t,e){const n=R(t,"real","complex"),s=R(e,"imag","complex");Ys(n.shape,s.shape,`real and imag shapes, ${n.shape} and ${s.shape}, must match in call to tf.complex().`);const o={real:n,imag:s};return W.runKernel(sx,o)}const Hi=U({complex_:Hz});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fp(t,e,n,s){if(s==null&&(s=Bc(t)),s==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!Wo(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){HI(e);const o=ae(e),r=ae(n);T(o===r,()=>`Based on the provided shape, [${e}], the tensor should have ${o} values but has ${r}`);for(let i=0;i<n.length;++i){const a=n[i],l=i===n.length-1?a!==ae(e.slice(i)):!0;T(n[i]===e[i]||!l,()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${e}). `)}}return!Wo(t)&&!Array.isArray(t)&&(t=[t]),e=e||n,t=s!=="string"?oa(t,s):sl(t,[],!0),W.makeTensor(t,e,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sd(t,e,n){const s=dp(t,n);return fp(t,e,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lw={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cd=4;async function Pw(t,e){const n=[],s=[],o=Array.isArray(t)?t.map(i=>i.name):Object.keys(t);for(let i=0;i<o.length;++i){const a=o[i],l=Array.isArray(t)?t[i].tensor:t[a];if(l.dtype!=="float32"&&l.dtype!=="int32"&&l.dtype!=="bool"&&l.dtype!=="string"&&l.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${a}': ${l.dtype}`);const c={name:a,shape:l.shape,dtype:l.dtype};if(l.dtype==="string"){const u=new Promise(async h=>{const d=await l.bytes(),f=d.reduce((b,x)=>b+x.length,0)+Cd*d.length,p=new Uint8Array(f);let g=0;for(let b=0;b<d.length;b++){const x=d[b],y=new Uint8Array(new Uint32Array([x.length]).buffer);p.set(y,g),g+=Cd,p.set(x,g),g+=x.length}h(p)});s.push(u)}else s.push(l.data());e!=null&&(c.group=e),n.push(c)}const r=await Promise.all(s);return{data:jz(r),specs:n}}function Gz(t,e){const n={};let s,o=0;for(const r of e){const i=r.name,a=r.dtype,l=r.shape,c=ae(l);let u;if("quantization"in r){const h=r.quantization;if(h.dtype==="uint8"||h.dtype==="uint16"){if(!("min"in h&&"scale"in h))throw new Error(`Weight ${r.name} with quantization ${h.dtype} doesn't have corresponding metadata min and scale.`)}else if(h.dtype==="float16"){if(a!=="float32")throw new Error(`Weight ${r.name} is quantized with ${h.dtype} which only supports weights of type float32 not ${a}.`)}else throw new Error(`Weight ${r.name} has unknown quantization dtype ${h.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);const d=Lw[h.dtype],f=t.slice(o,o+c*d),p=h.dtype==="uint8"?new Uint8Array(f):new Uint16Array(f);if(a==="float32")if(h.dtype==="uint8"||h.dtype==="uint16"){u=new Float32Array(p.length);for(let g=0;g<p.length;g++){const b=p[g];u[g]=b*h.scale+h.min}}else if(h.dtype==="float16")s===void 0&&(s=Jz()),u=s(p);else throw new Error(`Unsupported quantization type ${h.dtype} for weight type float32.`);else if(a==="int32"){if(h.dtype!=="uint8"&&h.dtype!=="uint16")throw new Error(`Unsupported quantization type ${h.dtype} for weight type int32.`);u=new Int32Array(p.length);for(let g=0;g<p.length;g++){const b=p[g];u[g]=Math.round(b*h.scale+h.min)}}else throw new Error(`Unsupported dtype in weight '${i}': ${a}`);o+=c*d}else if(a==="string"){const h=ae(r.shape);u=[];for(let d=0;d<h;d++){const f=new Uint32Array(t.slice(o,o+Cd))[0];o+=Cd;const p=new Uint8Array(t.slice(o,o+f));u.push(p),o+=f}}else{const h=Lw[a],d=t.slice(o,o+c*h);if(a==="float32")u=new Float32Array(d);else if(a==="int32")u=new Int32Array(d);else if(a==="bool")u=new Uint8Array(d);else if(a==="complex64"){u=new Float32Array(d);const f=new Float32Array(u.length/2),p=new Float32Array(u.length/2);for(let x=0;x<f.length;x++)f[x]=u[x*2],p[x]=u[x*2+1];const g=sd(f,l,"float32"),b=sd(p,l,"float32");n[i]=Hi(g,b),g.dispose(),b.dispose()}else throw new Error(`Unsupported dtype in weight '${i}': ${a}`);o+=c*h}a!=="complex64"&&(n[i]=sd(u,l,a))}return n}function jz(t){if(t===null)throw new Error(`Invalid input value: ${JSON.stringify(t)}`);let e=0;const n=[];t.forEach(r=>{if(e+=r.byteLength,n.push(r.byteLength===r.buffer.byteLength?r:new r.constructor(r)),!(r instanceof Float32Array||r instanceof Int32Array||r instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${r.constructor.name}`)});const s=new Uint8Array(e);let o=0;return n.forEach(r=>{s.set(new Uint8Array(r.buffer),o),o+=r.byteLength}),s.buffer}const Ux=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function Mw(t){return Ux?Buffer.byteLength(t):new Blob([t]).size}function qz(t){if(Ux)return Buffer.from(t).toString("base64");const e=new Uint8Array(t);let n="";for(let s=0,o=e.length;s<o;s++)n+=String.fromCharCode(e[s]);return btoa(n)}function Kz(t){if(Ux){const s=Buffer.from(t,"base64");return s.buffer.slice(s.byteOffset,s.byteOffset+s.byteLength)}const e=atob(t),n=new Uint8Array(e.length);for(let s=0;s<e.length;++s)n.set([e.charCodeAt(s)],s);return n.buffer}function $_(t){if(t.length===1)return t[0];let e=0;t.forEach(o=>{e+=o.byteLength});const n=new Uint8Array(e);let s=0;return t.forEach(o=>{n.set(new Uint8Array(o),s),s+=o.byteLength}),n.buffer}function I_(t,e){const n={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:e};return t.signature!=null&&(n.signature=t.signature),t.userDefinedMetadata!=null&&(n.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(n.modelInitializer=t.modelInitializer),t.trainingConfig!=null&&(n.trainingConfig=t.trainingConfig),n}async function Xz(t,e){const n={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy};if(t.trainingConfig!=null&&(n.trainingConfig=t.trainingConfig),t.weightsManifest!=null){const[s,o]=await e(t.weightsManifest);n.weightSpecs=s,n.weightData=o}return t.signature!=null&&(n.signature=t.signature),t.userDefinedMetadata!=null&&(n.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(n.modelInitializer=t.modelInitializer),n}function pp(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:t.modelTopology==null?0:Mw(JSON.stringify(t.modelTopology)),weightSpecsBytes:t.weightSpecs==null?0:Mw(JSON.stringify(t.weightSpecs)),weightDataBytes:t.weightData==null?0:t.weightData.byteLength}}function Yz(){const t=n=>{let s=n<<13,o=0;for(;(s&8388608)===0;)o-=8388608,s<<=1;return s&=-8388609,o+=947912704,s|o},e=new Uint32Array(2048);e[0]=0;for(let n=1;n<1024;n++)e[n]=t(n);for(let n=1024;n<2048;n++)e[n]=939524096+(n-1024<<13);return e}function Zz(){const t=new Uint32Array(64);t[0]=0,t[31]=1199570944,t[32]=2147483648,t[63]=3347054592;for(let e=1;e<31;e++)t[e]=e<<23;for(let e=33;e<63;e++)t[e]=2147483648+(e-32<<23);return t}function Qz(){const t=new Uint32Array(64);for(let e=0;e<64;e++)t[e]=1024;return t[0]=t[32]=0,t}function Jz(){const t=Yz(),e=Zz(),n=Qz();return s=>{const o=new ArrayBuffer(4*s.length),r=new Uint32Array(o);for(let i=0;i<s.length;i++){const a=s[i],l=t[n[a>>10]+(a&1023)]+e[a>>10];r[i]=l}return new Float32Array(o)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sn{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return sn.instance==null&&(sn.instance=new sn),sn.instance}static registerSaveRouter(e){sn.getInstance().saveRouters.push(e)}static registerLoadRouter(e){sn.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return sn.getHandlers(e,"save")}static getLoadHandlers(e,n){return sn.getHandlers(e,"load",n)}static getHandlers(e,n,s){const o=[];return(n==="load"?sn.getInstance().loadRouters:sn.getInstance().saveRouters).forEach(i=>{const a=i(e,s);a!==null&&o.push(a)}),o}}const eW=t=>sn.getSaveHandlers(t),tW=(t,e)=>sn.getLoadHandlers(t,e);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qg="tensorflowjs",Kg=1,Ni="models_store",Tr="model_info_store";function __(){if(!se().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const t=typeof window>"u"?self:window,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function Xg(t){const e=t.result;e.createObjectStore(Ni,{keyPath:"modelPath"}),e.createObjectStore(Tr,{keyPath:"modelPath"})}class Gi{constructor(e){if(this.indexedDB=__(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,n){return new Promise((s,o)=>{const r=this.indexedDB.open(qg,Kg);r.onupgradeneeded=()=>Xg(r),r.onsuccess=()=>{const i=r.result;if(n==null){const a=i.transaction(Ni,"readonly"),c=a.objectStore(Ni).get(this.modelPath);c.onsuccess=()=>{if(c.result==null)return i.close(),o(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));s(c.result.modelArtifacts)},c.onerror=u=>(i.close(),o(c.error)),a.oncomplete=()=>i.close()}else{const a=pp(n),l=i.transaction(Tr,"readwrite");let c=l.objectStore(Tr);const u=c.put({modelPath:this.modelPath,modelArtifactsInfo:a});let h;u.onsuccess=()=>{h=i.transaction(Ni,"readwrite");const f=h.objectStore(Ni).put({modelPath:this.modelPath,modelArtifacts:n,modelArtifactsInfo:a});f.onsuccess=()=>s({modelArtifactsInfo:a}),f.onerror=p=>{c=l.objectStore(Tr);const g=c.delete(this.modelPath);g.onsuccess=()=>(i.close(),o(f.error)),g.onerror=b=>(i.close(),o(f.error))}},u.onerror=d=>(i.close(),o(u.error)),l.oncomplete=()=>{h==null?i.close():h.oncomplete=()=>i.close()}}},r.onerror=i=>o(r.error)})}}Gi.URL_SCHEME="indexeddb://";const k_=t=>se().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Gi.URL_SCHEME)?nW(t.slice(Gi.URL_SCHEME.length)):null;sn.registerSaveRouter(k_);sn.registerLoadRouter(k_);function nW(t){return new Gi(t)}function sW(t){return t.startsWith(Gi.URL_SCHEME)?t.slice(Gi.URL_SCHEME.length):t}class oW{constructor(){this.indexedDB=__()}async listModels(){return new Promise((e,n)=>{const s=this.indexedDB.open(qg,Kg);s.onupgradeneeded=()=>Xg(s),s.onsuccess=()=>{const o=s.result,r=o.transaction(Tr,"readonly"),a=r.objectStore(Tr).getAll();a.onsuccess=()=>{const l={};for(const c of a.result)l[c.modelPath]=c.modelArtifactsInfo;e(l)},a.onerror=l=>(o.close(),n(a.error)),r.oncomplete=()=>o.close()},s.onerror=o=>n(s.error)})}async removeModel(e){return e=sW(e),new Promise((n,s)=>{const o=this.indexedDB.open(qg,Kg);o.onupgradeneeded=()=>Xg(o),o.onsuccess=()=>{const r=o.result,i=r.transaction(Tr,"readwrite"),a=i.objectStore(Tr),l=a.get(e);let c;l.onsuccess=()=>{if(l.result==null)return r.close(),s(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{const u=a.delete(e),h=()=>{c=r.transaction(Ni,"readwrite");const f=c.objectStore(Ni).delete(e);f.onsuccess=()=>n(l.result.modelArtifactsInfo),f.onerror=p=>s(l.error)};u.onsuccess=h,u.onerror=d=>(h(),r.close(),s(l.error))}},l.onerror=u=>(r.close(),s(l.error)),i.oncomplete=()=>{c==null?r.close():c.oncomplete=()=>r.close()}},o.onerror=r=>s(o.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nr="/",La="tensorflowjs_models",E_="info",rW="model_topology",iW="weight_specs",aW="weight_data",lW="model_metadata";function S_(t){return{info:[La,t,E_].join(nr),topology:[La,t,rW].join(nr),weightSpecs:[La,t,iW].join(nr),weightData:[La,t,aW].join(nr),modelMetadata:[La,t,lW].join(nr)}}function T_(t){for(const e of Object.values(t))window.localStorage.removeItem(e)}function cW(t){const e=t.split(nr);if(e.length<3)throw new Error(`Invalid key format: ${t}`);return e.slice(1,e.length-1).join(nr)}function uW(t){return t.startsWith(ji.URL_SCHEME)?t.slice(ji.URL_SCHEME.length):t}class ji{constructor(e){if(!se().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=S_(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(e.modelTopology),s=JSON.stringify(e.weightSpecs),o=pp(e);try{this.LS.setItem(this.keys.info,JSON.stringify(o)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,s),this.LS.setItem(this.keys.weightData,qz(e.weightData));const r={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(r)),{modelArtifactsInfo:o}}catch{throw T_(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${o.modelTopologyBytes}, weightSpecsBytes=${o.weightSpecsBytes}, weightDataBytes=${o.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const n={},s=JSON.parse(this.LS.getItem(this.keys.topology));if(s==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);n.modelTopology=s;const o=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(o==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);n.weightSpecs=o;const r=this.LS.getItem(this.keys.modelMetadata);if(r!=null){const a=JSON.parse(r);n.format=a.format,n.generatedBy=a.generatedBy,n.convertedBy=a.convertedBy,a.signature!=null&&(n.signature=a.signature),a.userDefinedMetadata!=null&&(n.userDefinedMetadata=a.userDefinedMetadata),a.modelInitializer!=null&&(n.modelInitializer=a.modelInitializer),a.trainingConfig!=null&&(n.trainingConfig=a.trainingConfig)}const i=this.LS.getItem(this.keys.weightData);if(i==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return n.weightData=Kz(i),n}}ji.URL_SCHEME="localstorage://";const N_=t=>se().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(ji.URL_SCHEME)?hW(t.slice(ji.URL_SCHEME.length)):null;sn.registerSaveRouter(N_);sn.registerLoadRouter(N_);function hW(t){return new ji(t)}class dW{constructor(){T(se().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),T(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const e={},n=La+nr,s=nr+E_;for(let o=0;o<this.LS.length;++o){const r=this.LS.key(o);if(r.startsWith(n)&&r.endsWith(s)){const i=cW(r);e[i]=JSON.parse(this.LS.getItem(r))}}return e}async removeModel(e){e=uW(e);const n=S_(e);if(this.LS.getItem(n.info)==null)throw new Error(`Cannot find model at path '${e}'`);const s=JSON.parse(this.LS.getItem(n.info));return T_(n),s}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bw="://";class ko{constructor(){this.managers={}}static getInstance(){return ko.instance==null&&(ko.instance=new ko),ko.instance}static registerManager(e,n){T(e!=null,()=>"scheme must not be undefined or null."),e.endsWith(Bw)&&(e=e.slice(0,e.indexOf(Bw))),T(e.length>0,()=>"scheme must not be an empty string.");const s=ko.getInstance();T(s.managers[e]==null,()=>`A model store manager is already registered for scheme '${e}'.`),s.managers[e]=n}static getManager(e){const n=ko.getInstance().managers[e];if(n==null)throw new Error(`Cannot find model manager for scheme '${e}'`);return n}static getSchemes(){return Object.keys(ko.getInstance().managers)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fW{fetch(e,n){return fetch(e,n)}now(){return performance.now()}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${n}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,n){return new TextDecoder(n).decode(e)}}if(se().get("IS_BROWSER")){se().setPlatform("browser",new fW);try{ko.registerManager(ji.URL_SCHEME,new dW)}catch{}try{ko.registerManager(Gi.URL_SCHEME,new oW)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pW={importFetch:()=>require("node-fetch")};let jm;class mW{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(e,n){return se().global.fetch!=null?se().global.fetch(e,n):(jm==null&&(jm=pW.importFetch()),jm(e,n))}now(){const e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${n}`);return this.textEncoder.encode(e)}decode(e,n){return e.length===0?"":new this.util.TextDecoder(n).decode(e)}}se().get("IS_NODE")&&!se().get("IS_BROWSER")&&se().setPlatform("node",new mW);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nt(t,e="float32",n){return e=e||"float32",HI(t),new Rn(t,e,n)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gW(t,e){const n=R(t,"x","cast");if(!iz(e))throw new Error(`Failed to cast to unknown dtype ${e}`);if(e==="string"&&n.dtype!=="string"||e!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");const s={x:n},o={dtype:e};return W.runKernel(Kc,s,o)}const Ae=U({cast_:gW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bW(t){const n={x:R(t,"x","clone","string_or_numeric")};return W.runKernel(au,n)}const Mi=U({clone_:bW});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xW(t,e=!1){console.log(t.toString(e))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */x_();const yW={buffer:nt,cast:Ae,clone:Mi,print:xW};Pz(yW);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vW="model",wW=".json",CW=".weights.bin";function Vw(t){return new Promise(e=>setTimeout(e)).then(t)}class qi{constructor(e){if(!se().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(qi.URL_SCHEME)&&(e=e.slice(qi.URL_SCHEME.length)),(e==null||e.length===0)&&(e=vW),this.modelJsonFileName=e+wW,this.weightDataFileName=e+CW}async save(e){if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");const n=window.URL.createObjectURL(new Blob([e.weightData],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const s=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],o=I_(e,s),r=window.URL.createObjectURL(new Blob([JSON.stringify(o)],{type:"application/json"})),i=this.modelJsonAnchor==null?document.createElement("a"):this.modelJsonAnchor;if(i.download=this.modelJsonFileName,i.href=r,await Vw(()=>i.dispatchEvent(new MouseEvent("click"))),e.weightData!=null){const a=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;a.download=this.weightDataFileName,a.href=n,await Vw(()=>a.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:pp(e)}}}}qi.URL_SCHEME="downloads://";const $W=t=>se().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(qi.URL_SCHEME)?IW(t.slice(qi.URL_SCHEME.length)):null;sn.registerSaveRouter($W);function IW(t="model"){return new qi(t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zw(t,e,n,s){i(t),n=n==null?0:n,s=s==null?1:s,a(n,s);let o=0;const r=l=>(l.then(c=>{const u=n+ ++o/t.length*(s-n);return e(u),c}),l);function i(l){T(l!=null&&Array.isArray(l)&&l.length>0,()=>"promises must be a none empty array")}function a(l,c){T(l>=0&&l<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${l}`),T(c>=0&&c<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${c}`),T(c>=l,()=>`startFraction must be no more than endFraction, but got startFraction ${l} and endFraction ${c}`)}return Promise.all(t.map(r))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function _W(t,e){e==null&&(e={});const n=e.fetchFunc==null?se().platform.fetch:e.fetchFunc,s=t.map(h=>n(h,e.requestInit,{isBinary:!0})),o=0,r=.5,a=(e.onProgress==null?await Promise.all(s):await zw(s,e.onProgress,o,r)).map(h=>h.arrayBuffer()),l=.5,c=1;return e.onProgress==null?await Promise.all(a):await zw(a,e.onProgress,l,c)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kW="application/octet-stream",EW="application/json";class Hx{constructor(e,n){if(this.DEFAULT_METHOD="POST",n==null&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.onProgress=n.onProgress,this.weightUrlConverter=n.weightUrlConverter,n.fetchFunc!=null?(T(typeof n.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=n.fetchFunc):this.fetch=se().platform.fetch,T(e!=null&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&T(e.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`),this.path=e,n.requestInit!=null&&n.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{}}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);n.body=new FormData;const s=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],o=I_(e,s);n.body.append("model.json",new Blob([JSON.stringify(o)],{type:EW}),"model.json"),e.weightData!=null&&n.body.append("model.weights.bin",new Blob([e.weightData],{type:kW}),"model.weights.bin");const r=await this.fetch(this.path,n);if(r.ok)return{modelArtifactsInfo:pp(e),responses:[r]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${r.status}.`)}async load(){const e=await this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error(`Request to ${this.path} failed with status code ${e.status}. Please verify this URL points to the model JSON of the model to load.`);let n;try{n=await e.json()}catch{let i=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?i+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":i+=" Please make sure the server is serving valid JSON for this request.",new Error(i)}const s=n.modelTopology,o=n.weightsManifest;if(s==null&&o==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return Xz(n,r=>this.loadWeights(r))}async loadWeights(e){const n=Array.isArray(this.path)?this.path[1]:this.path,[s,o]=SW(n),r=this.weightPathPrefix||s,i=[];for(const u of e)i.push(...u.weights);const a=[],l=[];for(const u of e)for(const h of u.paths)this.weightUrlConverter!=null?l.push(this.weightUrlConverter(h)):a.push(r+h+o);this.weightUrlConverter&&a.push(...await Promise.all(l));const c=await _W(a,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress});return[i,$_(c)]}}Hx.URL_SCHEME_REGEX=/^https?:\/\//;function SW(t){const e=t.lastIndexOf("/"),n=t.lastIndexOf("?"),s=t.substring(0,e),o=n>e?t.substring(n):"";return[s+"/",o]}function Ww(t){return t.match(Hx.URL_SCHEME_REGEX)!=null}const A_=(t,e)=>{if(typeof fetch>"u"&&(e==null||e.fetchFunc==null))return null;{let n=!0;if(Array.isArray(t)?n=t.every(s=>Ww(s)):n=Ww(t),n)return R_(t,e)}return null};sn.registerSaveRouter(A_);sn.registerLoadRouter(A_);function R_(t,e){return new Hx(t,e)}function TW(t,e){return R_(t,e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NW(t,e,n=!1,s=!1){let o=R(t,"a","matMul"),r=R(e,"b","matMul");[o,r]=Xt(o,r);const i={a:o,b:r},a={transposeA:n,transposeB:s};return W.runKernel(gf,i,a)}const gt=U({matMul_:NW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AW(t,e,n=1,s=0,o="int32"){if(e<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${e}`);const i={indices:R(t,"indices","oneHot","int32")},a={dtype:o,depth:e,onValue:n,offValue:s};return W.runKernel(qf,i,a)}const D_=U({oneHot_:AW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Er(){return W}function Yg(){return W.memory()}function J(t,e){return W.tidy(t,e)}function tt(t){g_(t).forEach(n=>n.dispose())}function Uo(t){return W.keep(t)}function O_(t,e,n=1){return W.registerBackend(t,e,n)}function RW(){return W.backend}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DW(t){const n={input:R(t,"input","imag")};return W.runKernel(bx,n)}const Gx=U({imag_:DW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OW(t){const n={x:R(t,"x","neg")};return W.runKernel(Hf,n)}const Gt=U({neg_:OW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FW(t){const n={input:R(t,"input","real")};return W.runKernel(_x,n)}const $d=U({real_:FW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LW(t,e,n){const s=R(t,"x","transpose");if(e==null&&(e=s.shape.map((i,a)=>a).reverse()),T(s.rank===e.length,()=>`Error in transpose: rank of input ${s.rank} must match length of perm ${e}.`),e.forEach(i=>{T(i>=0&&i<s.rank,()=>`All entries in 'perm' must be between 0 and ${s.rank-1} but got ${e}`)}),s.rank<=1)return s.clone();const o={x:s},r={perm:e};return s.dtype==="complex64"?J(()=>{let i=$d(s),a=Gx(s);return i=W.runKernel(ja,{x:i},r),a=W.runKernel(ja,{x:a},r),n&&(a=Gt(a)),Hi(i,a)}):W.runKernel(ja,o,r)}const lt=U({transpose_:LW});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function al(t,e){const n=t.length,s=[];for(let o=0;o<n;o++){const r=n-1-o,i=t[r]||1;(e[e.length-1-o]||1)>1&&i===1&&s.unshift(r)}return s}function un(t,e){const n=[];for(let s=0;s<e.length;s++){const o=t[t.length-s-1],r=e.length-s-1,i=e[r];(o==null||o===1&&i>1)&&n.unshift(r)}return n}function Ye(t,e){const n=[],s=Math.max(t.length,e.length);for(let o=0;o<s;o++){let r=t[t.length-o-1];r==null&&(r=1);let i=e[e.length-o-1];if(i==null&&(i=1),r===1)n.unshift(i);else if(i===1)n.unshift(r);else if(r!==i){const a=`Operands could not be broadcast together with shapes ${t} and ${e}.`;throw Error(a)}else n.unshift(r)}return n}function jx(t,e){const n=t.shape.length,s=e.shape.length;if(n<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(s<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${s}.`);if(e.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.shape[s-1]>n)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${e.shape[s-1]} vs. ${n}`);if(ae(t.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${t.shape}.`);const o=e.shape,r=o[o.length-1];let i=1;for(let h=0;h<o.length-1;++h)i*=o[h];const a=t.shape,l=o.slice();l.pop();let c=1;for(let h=r;h<n;++h)c*=a[h],l.push(a[h]);const u=[...Ue(t.shape).map(h=>h/c),1].slice(0,r);return[l,i,c,u]}function F_(t,e,n){const s=e.rank>1?e.shape[e.rank-1]:1,o=e.rank>1?e.rank-1:1,r=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${e.shape}, shape: ${t}, sliceDim: ${s}, and batchDim: ${o}.`;if(n.rank<o)throw new Error(r+` update.rank < ${o}. `);if(t.length<s+(n.rank-o))throw new Error(r+` Output shape length < ${s+(n.rank-o)}`);if(n.rank!==o+t.length-s)throw new Error(r+` update.rank != ${o+t.length-s}`);for(let i=0;i<o;++i)if(n.shape[i]!==e.shape[i])throw new Error(r+` updates.shape[${i}] (${n.shape[i]}) != indices.shape[${i}] (${e.shape[i]}).`);for(let i=0;i<n.rank-o;++i)if(n.shape[i+o]!==t[i+s])throw new Error(r+` updates.shape[${i+o}] (${n.shape[i+o]}) != shape[${i+o}] (${t[i+o]})`)}function PW(t,e,n){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(t.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${t.rank}.`);if(e.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${e.dtype}`);if(n.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(n.length===0){if(e.size===0)throw new Error(`Indices specified for empty output. indices shape: ${e.shape}`);if(t.size===0)throw new Error(`Updates specified for empty output. updates shape: ${t.shape}`)}F_(n,e,t)}function Lu(t,e,n){const s=e.shape.length,o=s>1?e.shape[s-1]:1,r=n.length;let i=1;for(let h=o;h<r;++h)i*=n[h];const a=o<1?1:o,l=ae(e.shape)/a,c=[...Ue(n.slice(0,o)),1],u=ae(n);return{sliceRank:o,numUpdates:l,sliceSize:i,strides:c,outputSize:u}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zg=-2,MW=-1;function qx(t,e,n){const s=t.shape.length;T(s===e.length,()=>`Error in slice${s}D: Length of begin ${e} must match the rank of the array (${s}).`),T(s===n.length,()=>`Error in slice${s}D: Length of size ${n} must match the rank of the array (${s}).`);for(let o=0;o<s;++o)T(e[o]+n[o]<=t.shape[o],()=>`Error in slice${s}D: begin[${o}] + size[${o}] (${e[o]+n[o]}) would overflow input.shape[${o}] (${t.shape[o]})`)}function BW(t){const e=[];let n=0;for(;t>0;)t&1&&e.push(n),t/=2,n++;return e}function Kx(t,e,n){const s=[];for(let o=0;o<t.length;o++)s[o]=Math.ceil((e[o]-t[o])/n[o]);return s}function L_(t,e,n,s){const o=[...t];for(let r=o.length;r<s.length;r++)o.push(1);for(let r=0;r<n;r++)r===0?o[e]=1:(o.splice(e,0,1),o.pop());return o}function P_(t,e,n){return n<=t?n:n-(e-1)}function M_(t,e){const n=[];for(let s=0;s<t;s++)n.push(e+s);return n}function VW(t,e,n,s,o,r,i,a,l){const c=t.length;let u=new Array(c),h=new Array(c),d=new Array(c);if(e.length&&n>0){const f=e[0],p=n+1;u=B_(i,f,p,s,t),h=V_(a,f,p,o,t),d=L_(r,f,p,t)}else for(let f=0;f<c;f++)u[f]=W_(i,s,r,t,f,l),h[f]=U_(a,o,r,t,f,l),d[f]=z_(r,f,l);return{begin:u,end:h,strides:d}}function B_(t,e,n,s,o){const r=[...o],i=M_(n,e);for(let a=0;a<r.length;a++)if(i.indexOf(a)>-1)r[a]=0;else{const l=P_(e,n,a);let c=s[l];t&1<<l&&(c=0),r[a]=c}return r}function V_(t,e,n,s,o){const r=[...o],i=M_(n,e);for(let a=0;a<r.length;a++)if(i.indexOf(a)>-1)r[a]=Number.MAX_SAFE_INTEGER;else{const l=P_(e,n,a);let c=s[l];t&1<<l&&(c=Number.MAX_SAFE_INTEGER),r[a]=c}for(let a=0;a<r.length;a++){const l=o[a];r[a]<0&&(r[a]+=l),r[a]=Ui(0,r[a],o[a])}return r}function z_(t,e,n){let s=t[e];return(n&1<<e||s==null)&&(s=1),s}function W_(t,e,n,s,o,r){let i=e[o];const a=n[o]||1;(t&1<<o||r&1<<o||i==null)&&(a>0?i=Number.MIN_SAFE_INTEGER:i=Number.MAX_SAFE_INTEGER);const l=s[o];return i<0&&(i+=l),i=Ui(0,i,l-1),i}function U_(t,e,n,s,o,r){let i=e[o];const a=n[o]||1;(t&1<<o||r&1<<o||i==null)&&(a>0?i=Number.MAX_SAFE_INTEGER:i=Number.MIN_SAFE_INTEGER);const l=s[o];return i<0&&(i+=l),a>0?i=Ui(0,i,l):i=Ui(-1,i,l-1),i}function Xx(t,e,n){let s=n.length;for(let o=0;o<n.length;o++)if(n[o]>1){s=o;break}for(let o=s+1;o<n.length;o++)if(e[o]>0||n[o]!==t[o])return!1;return!0}function Yx(t,e){let n=t.length>0?t[t.length-1]:1;for(let s=0;s<t.length-1;s++)n+=t[s]*e[s];return n}function mp(t,e,n){let s;const o=t.shape.length;typeof e=="number"?s=[e,...new Array(o-1).fill(0)]:e.length<o?s=e.concat(new Array(o-e.length).fill(0)):s=e.slice(),s.forEach(i=>{T(i!==-1,()=>"slice() does not support negative begin indexing.")});let r;return n==null?r=new Array(o).fill(-1):typeof n=="number"?r=[n,...new Array(o-1).fill(-1)]:n.length<o?r=n.concat(new Array(o-n.length).fill(-1)):r=n,r=r.map((i,a)=>i>=0?i:(T(i===-1,()=>`Negative size values should be exactly -1 but got ${i} for the slice() size at index ${a}.`),t.shape[a]-s[a])),[s,r]}function Zx(t,e,n,s,o,r,i,a,l){let c;if(s==null?(c=new Array(e.length),c.fill(1)):c=s,i!=null&&(i&i-1)!==0)throw new Error("Multiple ellipses in slice is not allowed.");let u=!1;const h={dims:c.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:n.slice(),strides:c.slice(),beginMask:o,endMask:r,ellipsisMask:i,newAxisMask:a,shrinkAxisMask:l};for(let w=0;w<h.dims;w++)u&&(1<<w&a)!==0&&h.numAddAxisAfterEllipsis++,1<<w&i&&(u=!0);u||(h.ellipsisMask|=1<<h.dims,h.dims++);const d={dims:t.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};zW(h,d);let f=!0,p=!0,g=!0;const b=[],x=[];for(let w=0;w<t.length;++w){if(d.strides[w]===0)throw Error(`strides[${w}] must be non-zero`);const v=!!(d.shrinkAxisMask&1<<w),$=t[w];if($===-1){b.push(v?1:-1);continue}const _=[d.beginMask&1<<w,d.endMask&1<<w],E=[d.strides[w]>0?0:-1,d.strides[w]>0?$:$-1];if(v&&d.strides[w]<=0)throw Error("only stride 1 allowed on non-range indexing.");g=g&&d.strides[w]===1;const k=!!(d.beginMask&1<<w&&d.endMask&1<<w);if(d.beginValid&&d.endValid){if(v){const L=d.begin[w]<0?$+d.begin[w]:d.begin[w];if(d.begin[w]=L,d.end[w]=d.begin[w]+1,L<0||L>=$)throw Error(`slice index ${d.begin[w]} of dimension ${w} out of bounds.`)}else d.begin[w]=Uw(d.begin[w],0,d.strides[w],$,_,E),d.end[w]=Uw(d.end[w],1,d.strides[w],$,_,E);const F=d.strides[w]===1&&d.begin[w]===0&&d.end[w]===$;f=f&&F,p=p&&(w===0&&d.strides[w]===1||F)}else f=f&&d.strides[w]===1&&k,p=p&&(w===0&&d.strides[w]===1||k);let N,A=!1;if(d.beginValid&&d.endValid?(N=d.end[w]-d.begin[w],A=!0):v?(N=1,A=!0):k&&$>=0&&(d.strides[w]<0?N=-$:N=$,A=!0),A){let F;N===0||N<0!=d.strides[w]<0?F=0:F=Math.trunc(N/d.strides[w])+(N%d.strides[w]!==0?1:0),b.push(F)}else b.push(-1)}for(let w=0;w<d.finalShapeGatherIndices.length;++w){const v=d.finalShapeGatherIndices[w];v>=0?x.push(b[v]):v===Zg&&x.push(1)}return{finalShapeSparse:x.filter((w,v)=>d.finalShapeGatherIndices[v]!==Zg),finalShape:x,isIdentity:f,sliceDim0:p,isSimpleSlice:g,begin:d.begin,end:d.end,strides:d.strides}}function zW(t,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let n=0;e.beginValid=t.begin!=null,e.endValid=t.end!=null,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let s=0;s<t.dims;s++)if(1<<s&t.ellipsisMask){const o=Math.min(e.dims-(t.dims-s)+1+t.numAddAxisAfterEllipsis,e.dims);for(;n<o;n++)e.begin[n]=0,e.end[n]=0,e.strides[n]=1,e.beginMask|=1<<n,e.endMask|=1<<n,e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[n]=s}else if(1<<s&t.newAxisMask)e.finalShapeGatherIndices.push(Zg),e.finalShapeGatherIndicesSparse.push(-1);else{if(n===e.begin.length)throw Error(`Index out of range using input dim ${n}; input has only ${e.dims} dims, ${e.begin.length}.`);t.begin!=null&&(e.begin[n]=t.begin[s]),t.end!=null&&(e.end[n]=t.end[s]),e.strides[n]=t.strides[s],t.beginMask&1<<s&&(e.beginMask|=1<<n),t.endMask&1<<s&&(e.endMask|=1<<n),t.shrinkAxisMask&1<<s?(e.finalShapeGatherIndices.push(MW),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<n):(e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(s)),e.inputShapeGatherIndicesSparse[n]=s,n++}}function Uw(t,e,n,s,o,r){if(o[e])return n>0?r[e]:r[e+1&1];{const i=t<0?s+t:t;return i<r[0]?r[0]:i>r[1]?r[1]:i}}const WW=Object.freeze(Object.defineProperty({__proto__:null,assertParamsValid:qx,maskToAxes:BW,computeOutShape:Kx,stridesWithElidedDims:L_,getNormalizedAxes:VW,startIndicesWithElidedDims:B_,stopIndicesWithElidedDims:V_,stridesForAxis:z_,startForAxis:W_,stopForAxis:U_,isSliceContinous:Xx,computeFlatOffset:Yx,parseSliceParams:mp,sliceInfo:Zx},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Il{getClassName(){return this.constructor.className}static fromConfig(e,n){return new e(n)}}class Ms{constructor(){this.classNameMap={}}static getMap(){return Ms.instance==null&&(Ms.instance=new Ms),Ms.instance}static register(e){Ms.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function ge(t){T(t.className!=null,()=>"Class being registered does not have the static className property defined."),T(typeof t.className=="string",()=>"className is required to be a string, but got type "+typeof t.className),T(t.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),Ms.register(t)}/** @license See the LICENSE file. *//**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UW(t,e){let n=R(t,"a","add"),s=R(e,"b","add");[n,s]=Xt(n,s);const o={a:n,b:s};return W.runKernel($l,o)}const ye=U({add_:UW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HW(t,e){let n=R(t,"a","floorDiv"),s=R(e,"b","floorDiv");[n,s]=Xt(n,s);const o={a:n,b:s};return W.runKernel(ru,o)}const H_=U({floorDiv_:HW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GW(t,e){let n=R(t,"a","div"),s=R(e,"b","div");if([n,s]=Xt(n,s),n.dtype==="int32"&&s.dtype==="int32")return H_(n,s);const o={a:n,b:s},r={};return W.runKernel(Jc,o,r)}const ze=U({div_:GW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jW(t,e){let n=R(t,"a","mul"),s=R(e,"b","mul");[n,s]=Xt(n,s);const o={a:n,b:s};return W.runKernel(gu,o)}const V=U({mul_:jW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qW(t){const e=R(t,"x","abs");if(e.dtype==="complex64"){const n={x:e};return W.runKernel(xf,n)}else{const n={x:e};return W.runKernel(hf,n)}}const dn=U({abs_:qW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KW(t){const n={x:R(t,"x","acos")};return W.runKernel(zc,n)}const XW=U({acos_:KW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YW(t){const n={x:R(t,"x","acosh")};return W.runKernel(Wc,n)}const ZW=U({acosh_:YW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QW(t,e=null,n=!1){const o={x:R(t,"x","all","bool")},r={axis:e,keepDims:n};return W.runKernel(Qb,o,r)}const G_=U({all_:QW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JW(t,e=null,n=!1){const o={x:R(t,"x","any","bool")},r={axis:e,keepDims:n};return W.runKernel(Jb,o,r)}const Qg=U({any_:JW});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e4(t,e=0){const s={x:R(t,"x","argMax")},o={axis:e};return W.runKernel(df,s,o)}const _c=U({argMax_:e4});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t4(t,e=0){const s={x:R(t,"x","argMin")},o={axis:e};return W.runKernel(ff,s,o)}const n4=U({argMin_:t4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s4(t){const n={x:R(t,"x","asin")};return W.runKernel(Uc,n)}const o4=U({asin_:s4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r4(t){const n={x:R(t,"x","asinh")};return W.runKernel(Hc,n)}const i4=U({asinh_:r4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a4(t){const n={x:R(t,"x","atan")};return W.runKernel(Gc,n)}const l4=U({atan_:a4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c4(t,e){let n=R(t,"a","atan2"),s=R(e,"b","atan2");[n,s]=Xt(n,s);const o={a:n,b:s};return W.runKernel(qc,o)}const u4=U({atan2_:c4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h4(t){const n={x:R(t,"x","atanh")};return W.runKernel(jc,n)}const d4=U({atanh_:h4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pu(t,e,n,s,o="NHWC",r){const i=t[3],a=[...e,i],l=hr(o);return In(t,a,n,r,s,null,null,l)}function Zs(t,e,n,s,o,r,i="channelsLast"){const[a,l]=Id(e);let c;if(i==="channelsLast")c=[a,l,t[3],t[3]];else if(i==="channelsFirst")c=[a,l,t[1],t[1]];else throw new Error(`Unknown dataFormat ${i}`);return In(t,c,n,s,o,r,!1,i)}function ur(t,e,n,s,o,r,i="NDHWC"){const[a,l,c]=Jg(e);let u,h;if(i==="NDHWC")h="channelsLast",u=[a,l,c,t[4],t[4]];else if(i==="NCDHW")h="channelsFirst",u=[a,l,c,t[1],t[1]];else throw new Error(`Unknown dataFormat ${i}`);return Kr(t,u,n,s,o,!1,h,r)}function In(t,e,n,s,o,r,i=!1,a="channelsLast"){let[l,c,u,h]=[-1,-1,-1,-1];if(a==="channelsLast")[l,c,u,h]=t;else if(a==="channelsFirst")[l,h,c,u]=t;else throw new Error(`Unknown dataFormat ${a}`);const[d,f,,p]=e,[g,b]=Id(n),[x,y]=Id(s),w=qa(d,x),v=qa(f,y),{padInfo:$,outHeight:_,outWidth:E}=m4(o,c,u,g,b,w,v,r,a),k=i?p*h:p;let N;return a==="channelsFirst"?N=[l,k,_,E]:a==="channelsLast"&&(N=[l,_,E,k]),{batchSize:l,dataFormat:a,inHeight:c,inWidth:u,inChannels:h,outHeight:_,outWidth:E,outChannels:k,padInfo:$,strideHeight:g,strideWidth:b,filterHeight:d,filterWidth:f,effectiveFilterHeight:w,effectiveFilterWidth:v,dilationHeight:x,dilationWidth:y,inShape:t,outShape:N,filterShape:e}}function Kr(t,e,n,s,o,r=!1,i="channelsLast",a){let[l,c,u,h,d]=[-1,-1,-1,-1,-1];if(i==="channelsLast")[l,c,u,h,d]=t;else if(i==="channelsFirst")[l,d,c,u,h]=t;else throw new Error(`Unknown dataFormat ${i}`);const[f,p,g,,b]=e,[x,y,w]=Jg(n),[v,$,_]=Jg(s),E=qa(f,v),k=qa(p,$),N=qa(g,_),{padInfo:A,outDepth:F,outHeight:L,outWidth:H}=g4(o,c,u,h,x,y,w,E,k,N,a),M=r?b*d:b;let K;return i==="channelsFirst"?K=[l,M,F,L,H]:i==="channelsLast"&&(K=[l,F,L,H,M]),{batchSize:l,dataFormat:i,inDepth:c,inHeight:u,inWidth:h,inChannels:d,outDepth:F,outHeight:L,outWidth:H,outChannels:M,padInfo:A,strideDepth:x,strideHeight:y,strideWidth:w,filterDepth:f,filterHeight:p,filterWidth:g,effectiveFilterDepth:E,effectiveFilterHeight:k,effectiveFilterWidth:N,dilationDepth:v,dilationHeight:$,dilationWidth:_,inShape:t,outShape:K,filterShape:e}}function f4(t,e,n,s,o){s==null&&(s=Qx(t,e,n));const r=t[0],i=t[1],a=Bi((r-e+2*s)/n+1,o),l=Bi((i-e+2*s)/n+1,o);return[a,l]}function p4(t,e,n,s,o,r){o==null&&(o=Qx(t,e,s));const i=t[0],a=t[1],l=t[2],c=Bi((i-e+2*o)/s+1,r),u=Bi((a-e+2*o)/s+1,r),h=Bi((l-e+2*o)/s+1,r);return[c,u,h,n]}function Qx(t,e,n,s=1){const o=qa(e,s);return Math.floor((t[0]*(n-1)-n+o)/2)}function Id(t){return typeof t=="number"?[t,t,t]:t.length===2?[t[0],t[1],1]:t}function Jg(t){return typeof t=="number"?[t,t,t]:t}function qa(t,e){return e<=1?t:t+(t-1)*(e-1)}function m4(t,e,n,s,o,r,i,a,l){let c,u,h;if(typeof t=="number"){c={top:t,bottom:t,left:t,right:t,type:t===0?"VALID":"NUMBER"};const f=f4([e,n],r,s,t,a);u=f[0],h=f[1]}else if(t==="same"){u=Math.ceil(e/s),h=Math.ceil(n/o);const d=Math.max(0,(u-1)*s+r-e),f=Math.max(0,(h-1)*o+i-n),p=Math.floor(d/2),g=d-p,b=Math.floor(f/2),x=f-b;c={top:p,bottom:g,left:b,right:x,type:"SAME"}}else if(t==="valid")c={top:0,bottom:0,left:0,right:0,type:"VALID"},u=Math.ceil((e-r+1)/s),h=Math.ceil((n-i+1)/o);else if(typeof t=="object"){const d=l==="channelsLast"?t[1][0]:t[2][0],f=l==="channelsLast"?t[1][1]:t[2][1],p=l==="channelsLast"?t[2][0]:t[3][0],g=l==="channelsLast"?t[2][1]:t[3][1];c={top:d,bottom:f,left:p,right:g,type:d===0&&f===0&&p===0&&g===0?"VALID":"EXPLICIT"},u=Bi((e-r+d+f)/s+1,a),h=Bi((n-i+p+g)/o+1,a)}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:c,outHeight:u,outWidth:h}}function g4(t,e,n,s,o,r,i,a,l,c,u){let h,d,f,p;if(typeof t=="number"){h={top:t,bottom:t,left:t,right:t,front:t,back:t,type:t===0?"VALID":"NUMBER"};const b=p4([e,n,s,1],a,1,o,t,u);d=b[0],f=b[1],p=b[2]}else if(t==="same"){d=Math.ceil(e/o),f=Math.ceil(n/r),p=Math.ceil(s/i);const g=(d-1)*o+a-e,b=(f-1)*r+l-n,x=(p-1)*i+c-s,y=Math.floor(g/2),w=g-y,v=Math.floor(b/2),$=b-v,_=Math.floor(x/2),E=x-_;h={top:v,bottom:$,left:_,right:E,front:y,back:w,type:"SAME"}}else if(t==="valid")h={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},d=Math.ceil((e-a+1)/o),f=Math.ceil((n-l+1)/r),p=Math.ceil((s-c+1)/i);else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:h,outDepth:d,outHeight:f,outWidth:p}}function Bi(t,e){if(!e)return Math.trunc(t);switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error(`Unknown roundingMode ${e}`)}}function Ki(t){const[e,n,s]=Id(t);return e===1&&n===1&&s===1}function Pn(t,e){return Ki(t)||Ki(e)}function hr(t){if(t==="NHWC")return"channelsLast";if(t==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${t}`)}function is(t,e,n){if(n!=null){if(typeof e=="string")throw Error(`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);if(typeof e=="number")T(ol(e),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);else if(typeof e=="object")e.forEach(s=>{s.forEach(o=>{T(ol(o),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${o}.`)})});else throw Error(`Error in ${t}: Unknown padding parameter: ${e}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b4(t,e){const s={x:R(t,"x","reshape","string_or_numeric")},o={shape:e};return W.runKernel(Qf,s,o)}const j=U({reshape_:b4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x4(t,e,n,s,o){const r=R(t,"x","avgPool","float32"),i=1;T(Pn(n,i),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`);let a=r,l=!1;r.rank===3&&(l=!0,a=j(r,[1,r.shape[0],r.shape[1],r.shape[2]])),T(a.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${a.rank}.`),is("avgPool",s,o);const c={x:a},u={filterSize:e,strides:n,pad:s,dimRoundingMode:o};let h=W.runKernel(pf,c,u);return h=Ae(h,r.dtype),l?j(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const Jx=U({avgPool_:x4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y4(t,e,n,s,o,r="NDHWC"){const i=R(t,"x","avgPool3d","float32");let a=i,l=!1;i.rank===4&&(l=!0,a=j(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),T(a.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${a.rank}.`),T(r==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${r}`),is("avgPool3d",s,o);const c={x:a},u={filterSize:e,strides:n,pad:s,dimRoundingMode:o,dataFormat:r};let h=W.runKernel(mf,c,u);return h=Ae(h,a.dtype),l?j(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const v4=U({avgPool3d_:y4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w4(t,e=0){T(t.length>=1,()=>"Pass at least one tensor to concat");const n=C_(t,"tensors","concat","string_or_numeric");if(n[0].dtype==="complex64"&&n.forEach(r=>{if(r.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${r.dtype}. `)}),n.length===1)return Mi(n[0]);const s=n,o={axis:e};return W.runKernel(yf,s,o)}const Dn=U({concat_:w4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C4(t){const n={x:R(t,"x","sigmoid","float32")};return W.runKernel(Eu,n)}const _l=U({sigmoid_:C4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $4(t,e,n){const s=R(t,"x","slice","string_or_numeric");if(s.rank===0)throw new Error("Slicing scalar is not possible");const o={x:s},r={begin:e,size:n};return W.runKernel(sp,o,r)}const $t=U({slice_:$4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I4(t){const n={x:R(t,"x","tanh","float32")};return W.runKernel(Du,n)}const ey=U({tanh_:I4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _4(t,e,n){const s=R(t,"x","batchToSpaceND"),o=e.reduce((a,l)=>a*l);T(s.rank>=1+e.length,()=>`input rank is ${s.rank} but should be > than blockShape.length ${e.length}`),T(n.length===e.length,()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${e.length}`),T(s.shape[0]%o===0,()=>`input tensor batch is ${s.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${o}`);const r={x:s},i={blockShape:e,crops:n};return W.runKernel(bf,r,i)}const ty=U({batchToSpaceND_:_4});function k4(t){let e;return t.rank===0||t.rank===1?e=j(t,[1,1,1,t.size]):t.rank===2?e=j(t,[1,1,t.shape[0],t.shape[1]]):t.rank===3?e=j(t,[1,t.shape[0],t.shape[1],t.shape[2]]):e=t,e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E4(t,e,n,s,o,r){r==null&&(r=.001);const i=R(t,"x","batchNorm"),a=R(e,"mean","batchNorm"),l=R(n,"variance","batchNorm");let c;o!=null&&(c=R(o,"scale","batchNorm"));let u;s!=null&&(u=R(s,"offset","batchNorm")),T(a.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),T(u==null||a.rank===u.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),T(c==null||a.rank===c.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const d={x:k4(i),scale:c,offset:u,mean:a,variance:l},f={varianceEpsilon:r},p=W.runKernel(Sf,d,f);return j(p,i.shape)}const gp=U({batchNorm_:E4});function S4(t,e,n,s,o,r){const i=R(t,"x","batchNorm"),a=R(e,"mean","batchNorm"),l=R(n,"variance","batchNorm");let c;o!=null&&(c=R(o,"scale","batchNorm"));let u;return s!=null&&(u=R(s,"offset","batchNorm")),T(i.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${i.rank}.`),T(a.rank===2||a.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${a.rank}.`),T(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`),c!=null&&T(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${c.rank}.`),u!=null&&T(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${u.rank}.`),gp(i,a,l,u,c,r)}const T4=U({batchNorm2d_:S4});function N4(t,e,n,s,o,r){const i=R(t,"x","batchNorm"),a=R(e,"mean","batchNorm"),l=R(n,"variance","batchNorm");let c;o!=null&&(c=R(o,"scale","batchNorm"));let u;return s!=null&&(u=R(s,"offset","batchNorm")),T(i.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${i.rank}.`),T(a.rank===3||a.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${a.rank}.`),T(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`),c!=null&&T(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${c.rank}.`),u!=null&&T(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${u.rank}.`),gp(i,a,l,u,c,r)}const A4=U({batchNorm3d_:N4});function R4(t,e,n,s,o,r){const i=R(t,"x","batchNorm"),a=R(e,"mean","batchNorm"),l=R(n,"variance","batchNorm");let c;o!=null&&(c=R(o,"scale","batchNorm"));let u;return s!=null&&(u=R(s,"offset","batchNorm")),T(i.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${i.rank}.`),T(a.rank===4||a.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${a.rank}.`),T(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`),c!=null&&T(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${c.rank}.`),u!=null&&T(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${u.rank}.`),gp(i,a,l,u,c,r)}const D4=U({batchNorm4d_:R4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O4(t,e,n){const s=R(t,"x","bincount"),o=R(e,"weights","bincount");T(s.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${s.dtype}`),T(n>=0,()=>`size must be non-negative, but got ${n}.`),T(o.size===s.size||o.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${s.shape}, weights shape: ${o.shape}.`);const r={x:s,weights:o},i={size:n};return W.runKernel(nx,r,i)}const F4=U({bincount_:O4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L4(t,e){let n=R(t,"broadcastTo","x");const s=n.shape;if(e.some(c=>!(c>0)||c%1!==0))throw new Error(`broadcastTo(): Invalid broadcast shape [${e}].`);if(e.length<n.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${n.rank}.`);if(e.length>n.rank){const c=n.shape.slice();for(;c.length<e.length;)c.unshift(1);n=j(n,c)}const o=n.shape,r=Array.from(e);for(let c=e.length-1;c>=0;c--)if(o[c]===e[c])r[c]=1;else if(n.shape[c]!==1)throw new Error(`broadcastTo(): [${s}] cannot be broadcast to [${e}].`);if(r.map((c,u)=>c>1?u:-1).filter(c=>c>=0).length===0)return Mi(n);const a={x:n},l={reps:r};return W.runKernel(Ou,a,l)}const mc=U({broadcastTo_:L4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P4(t){const n={x:R(t,"x","ceil","float32")};return W.runKernel(Xc,n)}const M4=U({ceil_:P4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B4(t,e,n){const s=R(t,"x","clipByValue");T(e<=n,()=>`Error in clip: min (${e}) must be less than or equal to max (${n}).`);const o={x:s},r={clipValueMin:e,clipValueMax:n};return W.runKernel(Yc,o,r)}const Ss=U({clipByValue_:B4});function V4(t){return Dn(t,0)}const z4=U({concat1d_:V4});function W4(t,e){return Dn(t,e)}const U4=U({concat2d_:W4});function H4(t,e){return Dn(t,e)}const G4=U({concat3d_:H4});function j4(t,e){return Dn(t,e)}const q4=U({concat4d_:j4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K4(t,e,n,s,o="NHWC",r=[1,1],i){const a=R(t,"x","conv2d","float32"),l=R(e,"filter","conv2d","float32");let c=a,u=!1;a.rank===3&&(u=!0,c=j(a,[1,a.shape[0],a.shape[1],a.shape[2]])),T(c.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${c.rank}.`),T(l.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`),is("conv2d",s,i);const h=o==="NHWC"?c.shape[3]:c.shape[1];T(h===l.shape[2],()=>`Error in conv2d: depth of input (${h}) must match input depth for filter ${l.shape[2]}.`),T(Pn(n,r),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${r}'`);const d={x:c,filter:l},f={strides:n,pad:s,dataFormat:o,dilations:r,dimRoundingMode:i},p=W.runKernel(vf,d,f);return u?j(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const Xi=U({conv2d_:K4});function X4(t,e,n,s,o="NWC",r=1,i){const a=R(t,"x","conv1d"),l=R(e,"filter","conv1d");let c=a,u=!1;a.rank===2&&(u=!0,c=j(a,[1,a.shape[0],a.shape[1]])),T(c.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${c.rank}.`),T(l.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`),is("conv1d",s,i),T(c.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${c.shape[2]}) must match input depth for filter ${l.shape[1]}.`),T(Pn(n,r),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${r}'`),T(o==="NWC",()=>`Error in conv1d: got dataFormat of ${o} but only NWC is currently supported.`);const h=j(l,[1,l.shape[0],l.shape[1],l.shape[2]]),d=j(c,[c.shape[0],1,c.shape[1],c.shape[2]]),b=Xi(d,h,[1,n],s,"NHWC",[1,r],i);return u?j(b,[b.shape[2],b.shape[3]]):j(b,[b.shape[0],b.shape[2],b.shape[3]])}const j_=U({conv1d_:X4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y4(t,e,n,s,o,r="NHWC",i){T(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let a=t,l=e,c=!1;e.rank===3&&(c=!0,l=j(e,[1,e.shape[0],e.shape[1],e.shape[2]]),a=[1,t[0],t[1],t[2]]),T(a.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${a.length}.`),T(l.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`),T(n.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`);const u=r==="NHWC"?a[3]:a[1],h=r==="NHWC"?l.shape[3]:l.shape[1];T(u===n.shape[2],()=>`Error in conv2dDerInput: depth of input (${u}) must match input depth for filter ${n.shape[2]}.`),T(h===n.shape[3],()=>`Error in conv2dDerInput: depth of output (${h}) must match output depth for filter ${n.shape[3]}.`),is("conv2dDerInput",o,i);const d={dy:l,filter:n},f={strides:s,pad:o,dataFormat:r,dimRoundingMode:i,inputShape:a},p=W.runKernel(wf,d,f);return c?j(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const ny=U({conv2DBackpropInput_:Y4});function Z4(t,e,n,s,o,r){const i=R(t,"x","conv2dTranspose"),a=R(e,"filter","conv2dTranspose");return ny(n,i,a,s,o,"NHWC",r)}const q_=U({conv2dTranspose_:Z4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q4(t,e,n,s,o="NDHWC",r=[1,1,1]){const i=R(t,"x","conv3d"),a=R(e,"filter","conv3d");let l=i,c=!1;i.rank===4&&(c=!0,l=j(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),T(l.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),T(a.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${a.rank}.`),T(l.shape[4]===a.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${a.shape[3]}.`),T(Pn(n,r),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${r}'`),T(o==="NDHWC",()=>`Error in conv3d: got dataFormat of ${o} but only NDHWC is currently supported.`);const u={x:l,filter:a},h={strides:n,pad:s,dataFormat:o,dilations:r},d=W.runKernel(Cf,u,h);return c?j(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const J4=U({conv3d_:Q4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eU(t,e,n,s,o){T(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let r=t,i=e,a=!1;e.rank===4&&(a=!0,i=j(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),r=[1,t[0],t[1],t[2],t[3]]);const l=r[4],c=i.shape[4];T(r.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${r.length}.`),T(i.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${i.rank}`),T(n.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${n.rank}`),T(l===n.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${n.shape[3]}.`),T(c===n.shape[4],()=>`Error in conv3dDerInput: depth of output (${c}) must match output depth for filter ${n.shape[4]}.`);const u={dy:i,filter:n},h={pad:o,strides:s,inputShape:r},d=W.runKernel(ix,u,h);return a?j(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const K_=U({conv3DBackpropInput_:eU});function tU(t,e,n,s,o){const r=R(t,"x","conv3dTranspose"),i=R(e,"filter","conv3dTranspose");return K_(n,r,i,s,o)}const nU=U({conv3dTranspose_:tU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sU(t){const n={x:R(t,"x","cos","float32")};return W.runKernel(Zc,n)}const sy=U({cos_:sU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oU(t){const n={x:R(t,"x","cosh","float32")};return W.runKernel(Qc,n)}const X_=U({cosh_:oU});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rU(t,e=0,n=!1,s=!1){const r={x:R(t,"x","cumprod")},i={axis:e,exclusive:n,reverse:s};return W.runKernel(ax,r,i)}const eb=U({cumprod_:rU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iU(t,e=0,n=!1,s=!1){const r={x:R(t,"x","cumsum")},i={axis:e,exclusive:n,reverse:s};return W.runKernel($f,r,i)}const Y_=U({cumsum_:iU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aU(t,e,n="NHWC"){const s=R(t,"x","depthToSpace","float32"),o=n==="NHWC"?s.shape[1]:s.shape[2],r=n==="NHWC"?s.shape[2]:s.shape[3],i=n==="NHWC"?s.shape[3]:s.shape[1];T(e>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`),T(o*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${o} and ${e}  for depthToSpace with input shape
    ${s.shape}`),T(r*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${r} and ${e} for depthToSpace with input shape
        ${s.shape}`),T(i%(e*e)===0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${i} for depthToSpace with input shape ${s.shape}`);const a={x:s},l={blockSize:e,dataFormat:n};return W.runKernel(cx,a,l)}const lU=U({depthToSpace_:aU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cU(t,e,n,s,o="NHWC",r=[1,1],i){const a=R(t,"x","depthwiseConv2d","float32"),l=R(e,"filter","depthwiseConv2d","float32");let c=a,u=!1;a.rank===3&&(u=!0,c=j(a,[1,a.shape[0],a.shape[1],a.shape[2]])),T(c.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${c.rank}.`),T(l.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`);const h=o==="NHWC"?c.shape[3]:c.shape[1];T(h===l.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${h}) must match the inChannels dimension in filter ${l.shape[2]}.`),is("depthwiseConv2d",s,i);const d={x:c,filter:l},f={strides:n,pad:s,dataFormat:o,dilations:r,dimRoundingMode:i},p=W.runKernel(If,d,f);return u?j(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const oy=U({depthwiseConv2d_:cU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uU(t,e,n,s,o=[1,1],r="NHWC"){const i=R(t,"x","dilation2d"),a=R(e,"filter","dilation2d");T(i.rank===3||i.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${i.rank}.`),T(a.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${a.rank}.`),T(r==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${r}`);let l=i,c=!1;i.rank===3&&(l=j(i,[1,i.shape[0],i.shape[1],i.shape[2]]),c=!0);const u={x:l,filter:a},h={strides:n,pad:s,dilations:o},d=W.runKernel(_f,u,h);return c?j(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const hU=U({dilation2d_:uU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dU(t,e){let n=R(t,"a","equal","string_or_numeric"),s=R(e,"b","equal","string_or_numeric");[n,s]=Xt(n,s),Ye(n.shape,s.shape);const o={a:n,b:s};return W.runKernel(kf,o)}const Ho=U({equal_:dU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fU(t,e,n){const s=R(e,"a","where"),o=R(n,"b","where"),r=R(t,"condition","where","bool"),i=Ye(Ye(r.shape,s.shape),o.shape),a=mc(r,i),l=mc(s,i),c=mc(o,i),u={condition:a,t:l,e:c};return W.runKernel(np,u)}const fs=U({where_:fU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pU(t){const n={x:R(t,"x","zerosLike")};return W.runKernel(up,n)}const ut=U({zerosLike_:pU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mU(t,e){let n=R(t,"a","div"),s=R(e,"b","div");[n,s]=Xt(n,s);const o=ze(n,s),r=ut(o),i=Ho(s,r);return fs(i,r,o)}const gU=U({divNoNan_:mU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bU(t,e){const n=R(t,"t1","dot"),s=R(e,"t2","dot");T((n.rank===1||n.rank===2)&&(s.rank===1||s.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${s.rank}.`);const o=n.rank===1?n.size:n.shape[1],r=s.rank===1?s.size:s.shape[0];if(T(o===r,()=>`Error in dot: inner dimensions of inputs must match, but got ${o} and ${r}.`),n.rank===1&&s.rank===1){const i=j(n,[1,-1]),a=j(s,[-1,1]),l=gt(i,a);return j(l,[])}else if(n.rank===1&&s.rank===2){const i=j(n,[1,-1]),a=j(s,[s.shape[0],s.shape[1]]),l=gt(i,a);return j(l,[l.size])}else if(n.rank===2&&s.rank===1){const i=j(s,[-1,1]),a=gt(n,i);return j(a,[a.size])}else{const i=j(s,[s.shape[0],s.shape[1]]);return gt(n,i)}}const xU=U({dot_:bU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yU(t){const n={x:R(t,"x","elu","float32")};return W.runKernel(eu,n)}const bp=U({elu_:yU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vU(t){let e=R(t,"x","erf");T(e.dtype==="int32"||e.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),e.dtype==="int32"&&(e=Ae(e,"float32"));const n={x:e};return W.runKernel(tu,n)}const wU=U({erf_:vU});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ry(t,e){for(let n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function Z_(t,e,n){const s=t.length+e.length,o=[];let r=0,i=0;for(let a=0;a<s;a++)n.indexOf(a)===-1?o.push(t[r++]):o.push(e[i++]);return o}function yn(t,e){const n=[],s=t.length;for(let r=0;r<s;r++)e.indexOf(r)===-1&&n.push(t[r]);const o=e.map(r=>t[r]);return[n,o]}function Yt(t,e){const n=e.map(s=>1);return Z_(t,n,e)}function _n(t,e,n){T(ry(e,n),()=>`${t} supports only inner-most axes for now. Got axes ${e} and rank-${n} input.`)}function jt(t,e){if(ry(t,e))return null;const n=[];for(let s=0;s<e;++s)t.indexOf(s)===-1&&n.push(s);return t.forEach(s=>n.push(s)),n}function Xr(t){return t.map((e,n)=>[n,e]).sort((e,n)=>e[1]-n[1]).map(e=>e[0])}function Zt(t,e){const n=[];for(let s=e-t;s<e;++s)n.push(s);return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CU(t,e=null,n=!1){const o={x:R(t,"x","max")},r={reductionIndices:e,keepDims:n};return W.runKernel(Mf,o,r)}const Lo=U({max_:CU});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $U(t,e=null,n=!1){const o={x:R(t,"x","min")},r={axis:e,keepDims:n};return W.runKernel(Wf,o,r)}const tb=U({min_:$U});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IU(t,e){let n=R(t,"base","pow"),s=R(e,"exp","pow");[n,s]=Xt(n,s);const o={a:n,b:s};return W.runKernel(bu,o)}const ll=U({pow_:IU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ge(t,e){if((Wo(t)&&e!=="string"||Array.isArray(t))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&Wo(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return fp(t,[],[],e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _U(t){const n={x:R(t,"x","sqrt","float32")};return W.runKernel(Tu,n)}const Wn=U({sqrt_:_U});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kU(t){const e=R(t,"x","square"),n={};return W.runKernel("Square",{x:e},n)}const Nt=U({square_:kU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EU(t,e=null,n=!1){let s=R(t,"x","sum");s.dtype==="bool"&&(s=Ae(s,"int32"));const o={x:s},r={axis:e,keepDims:n};return W.runKernel(op,o,r)}const Le=U({sum_:EU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SU(t,e="euclidean",n=null,s=!1){t=R(t,"x","norm");const o=Q_(t,e,n);let r=o.shape;if(s){const i=st(n,t.shape);r=Yt(o.shape,i)}return j(o,r)}function Q_(t,e,n=null){if(t.rank===0)return dn(t);if(t.rank!==1&&n===null)return Q_(j(t,[-1]),e,n);if(t.rank===1||typeof n=="number"||Array.isArray(n)&&n.length===1){if(e===1)return Le(dn(t),n);if(e===1/0)return Lo(dn(t),n);if(e===-1/0)return tb(dn(t),n);if(e==="euclidean"||e===2)return Wn(Le(ll(dn(t),Ge(2,"int32")),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}if(Array.isArray(n)&&n.length===2){if(e===1)return Lo(Le(dn(t),n[0]),n[1]-1);if(e===1/0)return Lo(Le(dn(t),n[1]),n[0]);if(e===-1/0)return tb(Le(dn(t),n[1]),n[0]);if(e==="fro"||e==="euclidean")return Wn(Le(Nt(t),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}throw new Error(`Error in norm: invalid axis: ${n}`)}const xp=U({norm_:SU});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TU(t,e=null,n=!1){return xp(t,"euclidean",e,n)}const NU=U({euclideanNorm_:TU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AU(t){const n={x:R(t,"x","exp")};return W.runKernel(nu,n)}const qs=U({exp_:AU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RU(t,e=0){const n=R(t,"x","expandDims","string_or_numeric");T(e<=n.rank,()=>"Axis must be <= rank of the tensor");const s={input:n},o={dim:e};return W.runKernel(Ef,s,o)}const Ps=U({expandDims_:RU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DU(t){const n={x:R(t,"x","expm1")};return W.runKernel(su,n)}const OU=U({expm1_:DU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FU(t,e){const n=R(t,"x","tile","string_or_numeric");T(n.rank===e.length,()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${e}.`);const s={x:n},o={reps:e};return W.runKernel(Ou,s,o)}const ho=U({tile_:FU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LU(t,e,n,s="float32"){e==null&&(e=t);const o=nt([t,e],s),r=t<=e?t:e;for(let a=0;a<r;++a)o.set(1,a,a);const i=j(o.toTensor(),[t,e]);if(n==null)return i;if(n.length===1)return ho(Ps(i,0),[n[0],1,1]);if(n.length===2)return ho(Ps(Ps(i,0),0),[n[0],n[1],1,1]);if(n.length===3)return ho(Ps(Ps(Ps(i,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}const J_=U({eye_:LU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yp(t,e,n){const s={shape:t,value:e,dtype:n};return W.runKernel(px,{},s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PU(t){const n={x:R(t,"x","floor","float32")};return W.runKernel(ou,n)}const vp=U({floor_:PU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MU(t,e,n=0,s=0){const o=R(t,"x","gather"),r=R(e,"indices","gather","int32"),i={x:o,indices:r},a={axis:n,batchDims:s};return W.runKernel(Tf,i,a)}const iy=U({gather_:MU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BU(t,e){let n=R(t,"a","greater","string_or_numeric"),s=R(e,"b","greater","string_or_numeric");[n,s]=Xt(n,s),Ye(n.shape,s.shape);const o={a:n,b:s};return W.runKernel(Nf,o)}const Qs=U({greater_:BU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VU(t,e){let n=R(t,"a","greaterEqual","string_or_numeric"),s=R(e,"b","greaterEqual","string_or_numeric");[n,s]=Xt(n,s),Ye(n.shape,s.shape);const o={a:n,b:s};return W.runKernel(iu,o)}const kl=U({greaterEqual_:VU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zU(t){const n={x:R(t,"x","isFinite")};return W.runKernel(lu,n)}const WU=U({isFinite_:zU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UU(t){const n={x:R(t,"x","isInf")};return W.runKernel(cu,n)}const HU=U({isInf_:UU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GU(t){const n={x:R(t,"x","isNaN")};return W.runKernel(uu,n)}const jU=U({isNaN_:GU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qU(t,e=.2){const s={x:R(t,"x","leakyRelu")},o={alpha:e};return W.runKernel(Af,s,o)}const ay=U({leakyRelu_:qU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KU(t,e){let n=R(t,"a","less","string_or_numeric"),s=R(e,"b","less","string_or_numeric");[n,s]=Xt(n,s),Ye(n.shape,s.shape);const o={a:n,b:s};return W.runKernel(Rf,o)}const ek=U({less_:KU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XU(t,e){let n=R(t,"a","lessEqual","string_or_numeric"),s=R(e,"b","lessEqual","string_or_numeric");[n,s]=Xt(n,s),Ye(n.shape,s.shape);const o={a:n,b:s};return W.runKernel(Df,o)}const El=U({lessEqual_:XU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YU(t,e=5,n=1,s=1,o=.5){const r=R(t,"x","localResponseNormalization");T(r.rank===4||r.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${r.rank}.`),T(ol(e),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`);let i=r,a=!1;r.rank===3&&(a=!0,i=j(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const l={x:i},c={depthRadius:e,bias:n,alpha:s,beta:o},u=W.runKernel(Pf,l,c);return a?j(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const ZU=U({localResponseNormalization_:YU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QU(t){const n={x:R(t,"x","log","float32")};return W.runKernel(hu,n)}const Ks=U({log_:QU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JU(t){const n={x:R(t,"x","log1p")};return W.runKernel(du,n)}const ly=U({log1p_:JU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eH(t,e){T(Fg(t),()=>"The f passed in variableGrads(f) must be a function"),T(e==null||Array.isArray(e)&&e.every(c=>c instanceof wd),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const n=e!=null;if(!n){e=[];for(const c in W.registeredVariables)e.push(W.registeredVariables[c])}const s=n?e.filter(c=>!c.trainable):null,o=e.length;e=e.filter(c=>c.trainable),T(e.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${o} variables is trainable.`);const r=!0,{value:i,grads:a}=W.gradients(t,e,null,r);T(a.some(c=>c!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),T(i.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${i.rank} tensor`);const l={};return e.forEach((c,u)=>{a[u]!=null&&(l[c.name]=a[u])}),s!=null&&s.forEach(c=>l[c.name]=null),{value:i,grads:l}}function Yi(t){return W.customGrad(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tH(t){const n={x:R(t,"x","softplus")};return W.runKernel(Su,n)}const Mu=U({softplus_:tH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nH(t){const e=R(t,"x","logSigmoid");return Yi(s=>({value:Gt(Mu(Gt(s))),gradFunc:i=>V(i,_l(Gt(s)))}))(e)}const sH=U({logSigmoid_:nH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oH(t,e){let n=R(t,"a","sub"),s=R(e,"b","sub");[n,s]=Xt(n,s);const o={a:n,b:s};return W.runKernel(Au,o)}const Pe=U({sub_:oH});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rH(t,e=-1){const n=R(t,"logits","logSoftmax");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${e}`);return Yi((o,r)=>{const a=Lo(o,e,!0),l=Pe(o,a),c=Pe(Ae(l,"float32"),Ks(Le(qs(l),e,!0)));return r([c]),{value:c,gradFunc:(h,d)=>{const[f]=d,p=!0,g=qs(f);return Pe(h,V(Le(h,e,p),g))}}})(n)}const tk=U({logSoftmax_:rH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iH(t,e=null,n=!1){const s=R(t,"x","logSumExp"),o=st(e,s.shape),r=Lo(s,o,!0),i=Pe(s,r),a=qs(i),l=Le(a,o),c=Ks(l),u=ye(j(r,c.shape),c);if(n){const h=Yt(u.shape,o);return j(u,h)}return u}const nk=U({logSumExp_:iH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aH(t,e){const n=R(t,"a","logicalAnd","bool"),s=R(e,"b","logicalAnd","bool");Ye(n.shape,s.shape);const o={a:n,b:s};return W.runKernel(Of,o)}const ir=U({logicalAnd_:aH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lH(t){const n={x:R(t,"x","logicalNot","bool")};return W.runKernel(Ff,n)}const cy=U({logicalNot_:lH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cH(t,e){const n=R(t,"a","logicalOr","bool"),s=R(e,"b","logicalOr","bool");Ye(n.shape,s.shape);const o={a:n,b:s};return W.runKernel(Lf,o)}const sk=U({logicalOr_:cH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uH(t,e){const n=R(t,"a","logicalXor","bool"),s=R(e,"b","logicalXor","bool");return Ye(n.shape,s.shape),ir(sk(t,e),cy(ir(t,e)))}const hH=U({logicalXor_:uH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dH(t,e,n,s,o){const r=R(t,"x","maxPool"),i=1;let a=r,l=!1;r.rank===3&&(l=!0,a=j(r,[1,r.shape[0],r.shape[1],r.shape[2]])),T(a.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${a.rank}.`),T(Pn(n,i),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),is("maxPool",s,o);const c={x:a},u={filterSize:e,strides:n,pad:s,dimRoundingMode:o},h=W.runKernel(Bf,c,u);return l?j(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const uy=U({maxPool_:dH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fH(t,e=[1,1,1],n,s,o,r="NDHWC"){const i=R(t,"x","maxPool3d");let a=i,l=!1;i.rank===4&&(l=!0,a=j(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),T(a.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${a.rank}.`),T(r==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${r}`),is("maxPool3d",s,o);const c={x:a},u={filterSize:e,strides:n,pad:s,dimRoundingMode:o,dataFormat:r},h=W.runKernel(Vf,c,u);return l?j(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const pH=U({maxPool3d_:fH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mH(t,e){let n=R(t,"a","maximum"),s=R(e,"b","maximum");[n,s]=Xt(n,s),n.dtype==="bool"&&(n=Ae(n,"int32"),s=Ae(s,"int32")),Ye(n.shape,s.shape);const o={a:n,b:s};return W.runKernel(fu,o)}const Yr=U({maximum_:mH});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gH(t,e=null,n=!1){const o={x:R(t,"x","mean")},r={axis:e,keepDims:n};return W.runKernel(zf,o,r)}const Kt=U({mean_:gH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gn(t,e="float32"){if(e==="complex64"){const s=gn(t,"float32"),o=gn(t,"float32");return Hi(s,o)}const n=Ln(ae(t),e);return W.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zr(t,e="float32"){if(e==="complex64"){const s=Zr(t,"float32"),o=gn(t,"float32");return Hi(s,o)}const n=Xb(ae(t),e);return W.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bH(t,e){let n=R(t,"a","minimum"),s=R(e,"b","minimum");[n,s]=Xt(n,s),n.dtype==="bool"&&(n=Ae(n,"int32"),s=Ae(s,"int32")),Ye(n.shape,s.shape);const o={a:n,b:s};return W.runKernel(pu,o)}const wp=U({minimum_:bH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xH(t,e,n){T(n==="reflect"||n==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`);const s=R(t,"x","mirrorPad");if(s.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");T(e.length===s.rank,()=>`Padding doesn't match input. Must be ${s.rank}. Got ${e.length}.`);const o=n==="reflect"?1:0;for(let a=0;a<s.rank;a++)T(e[a].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),T(e[a][0]>=0&&e[a][0]<=s.shape[a]-o&&e[a][1]>=0&&e[a][1]<=s.shape[a]-o,()=>`Padding in dimension ${a} cannot be greater than or equal to ${s.shape[a]-o} or less than 0 for input of shape ${s.shape}`);const r={paddings:e,mode:n},i={x:s};return W.runKernel(Uf,i,r)}const yH=U({mirrorPad_:xH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vH(t,e){let n=R(t,"a","mod"),s=R(e,"b","mod");[n,s]=Xt(n,s);const o={a:n,b:s};return W.runKernel(mu,o)}const wH=U({mod_:vH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CH(t,e=null,n=!1){t=R(t,"x","moments");const s=st(e,t.shape),o=Kt(t,s,n);let r=o.shape;n||(r=Yt(o.shape,s));const i=Nt(Pe(Ae(t,"float32"),j(o,r))),a=Kt(i,s,n);return{mean:o,variance:a}}const hy=U({moments_:CH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $H(t,e){let n=R(t,"a","notEqual","string_or_numeric"),s=R(e,"b","notEqual","string_or_numeric");[n,s]=Xt(n,s),Ye(n.shape,s.shape);const o={a:n,b:s};return W.runKernel(Gf,o)}const kc=U({notEqual_:$H});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IH(t){const n={x:R(t,"x","onesLike")};return W.runKernel(jf,n)}const Xs=U({onesLike_:IH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _H(t,e,n=0){const s=R(t,"x","pad");if(s.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const o={paddings:e,constantValue:n},r={x:s};return W.runKernel(Xf,r,o)}const dy=U({pad_:_H});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kH(t,e,n){const s=R(t,"x","spaceToBatchND");T(s.rank>=1+e.length,()=>`input rank ${s.rank} should be > than [blockShape] ${e.length}`),T(n.length===e.length,()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${e.length}`),T(s.shape.reduce((i,a,l)=>l>0&&l<=e.length?i&&(a+n[l-1][0]+n[l-1][1])%e[l-1]===0:i,!0),()=>`input spatial dimensions ${s.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${e.toString()}`);const o={x:s},r={blockShape:e,paddings:n};return W.runKernel(rp,o,r)}const fy=U({spaceToBatchND_:kH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EH(t,e,n,s,o,r,i){o==null&&(o=[1,1]),r==null&&(r=1),s===0&&(s="valid");const a=R(t,"x","maxPool");let l=a,c=!1;a.rank===3&&(c=!0,l=j(a,[1,a.shape[0],a.shape[1],a.shape[2]])),T(Pn(r,o),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${r} and dilations '${o}'`);const u=Zs(l.shape,e,r,o,s),h=[u.dilationHeight,u.dilationWidth];let d;s==="same"?d=TH([u.filterHeight,u.filterWidth],h):d=[[0,0],[0,0]];const f=h[0]===1&&h[1]===1,[p,g]=SH([u.inHeight,u.inWidth],h,d),b=f?s:"valid",x=f?l:fy(l,h,p),w=(n==="avg"?()=>Jx(x,e,r,b,i):()=>uy(x,e,r,b,i))(),v=f?w:ty(w,h,g);return c?j(v,[v.shape[1],v.shape[2],v.shape[3]]):v}function SH(t,e,n){const s=n.map(u=>u[0]),o=n.map(u=>u[1]),r=t.concat(s,o),i=e.map((u,h)=>(u-r[h]%u)%u),a=o.map((u,h)=>u+i[h]),l=e.map((u,h)=>[s[h],a[h]]),c=e.map((u,h)=>[0,i[h]]);return[l,c]}function TH(t,e){const s=t.map((i,a)=>i+(i-1)*(e[a]-1)).map(i=>i-1),o=s.map(i=>Math.floor(i/2)),r=s.map((i,a)=>i-o[a]);return s.map((i,a)=>[o[a],r[a]])}const NH=U({pool_:EH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AH(t,e){const n=R(t,"x","prelu"),s=R(e,"alpha","prelu"),o={x:n,alpha:s};return W.runKernel(Yf,o)}const py=U({prelu_:AH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RH(t,e=null,n=!1){let s=R(t,"x","prod");s.dtype==="bool"&&(s=Ae(s,"int32"));const o={x:s},r={axis:e,keepDims:n};return W.runKernel(Zf,o,r)}const DH=U({prod_:RH});var ok={exports:{}};(function(t){(function(e,n,s){function o(l){var c=this,u=a();c.next=function(){var h=2091639*c.s0+c.c*23283064365386963e-26;return c.s0=c.s1,c.s1=c.s2,c.s2=h-(c.c=h|0)},c.c=1,c.s0=u(" "),c.s1=u(" "),c.s2=u(" "),c.s0-=u(l),c.s0<0&&(c.s0+=1),c.s1-=u(l),c.s1<0&&(c.s1+=1),c.s2-=u(l),c.s2<0&&(c.s2+=1),u=null}function r(l,c){return c.c=l.c,c.s0=l.s0,c.s1=l.s1,c.s2=l.s2,c}function i(l,c){var u=new o(l),h=c&&c.state,d=u.next;return d.int32=function(){return u.next()*4294967296|0},d.double=function(){return d()+(d()*2097152|0)*11102230246251565e-32},d.quick=d,h&&(typeof h=="object"&&r(h,u),d.state=function(){return r(u,{})}),d}function a(){var l=4022871197,c=function(u){u=String(u);for(var h=0;h<u.length;h++){l+=u.charCodeAt(h);var d=.02519603282416938*l;l=d>>>0,d-=l,d*=l,l=d>>>0,d-=l,l+=d*4294967296}return(l>>>0)*23283064365386963e-26};return c}n&&n.exports?n.exports=i:s&&s.amd?s(function(){return i}):this.alea=i})(jr,t,!1)})(ok);var rk={exports:{}};(function(t){(function(e,n,s){function o(a){var l=this,c="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var h=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^h^h>>>8},a===(a|0)?l.x=a:c+=a;for(var u=0;u<c.length+64;u++)l.x^=c.charCodeAt(u)|0,l.next()}function r(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l}function i(a,l){var c=new o(a),u=l&&l.state,h=function(){return(c.next()>>>0)/4294967296};return h.double=function(){do var d=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(d+f)/(1<<21);while(p===0);return p},h.int32=c.next,h.quick=h,u&&(typeof u=="object"&&r(u,c),h.state=function(){return r(c,{})}),h}n&&n.exports?n.exports=i:s&&s.amd?s(function(){return i}):this.xor128=i})(jr,t,!1)})(rk);var ik={exports:{}};(function(t){(function(e,n,s){function o(a){var l=this,c="";l.next=function(){var h=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(h^h<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,a===(a|0)?l.x=a:c+=a;for(var u=0;u<c.length+64;u++)l.x^=c.charCodeAt(u)|0,u==c.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function r(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l.v=a.v,l.d=a.d,l}function i(a,l){var c=new o(a),u=l&&l.state,h=function(){return(c.next()>>>0)/4294967296};return h.double=function(){do var d=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(d+f)/(1<<21);while(p===0);return p},h.int32=c.next,h.quick=h,u&&(typeof u=="object"&&r(u,c),h.state=function(){return r(c,{})}),h}n&&n.exports?n.exports=i:s&&s.amd?s(function(){return i}):this.xorwow=i})(jr,t,!1)})(ik);var ak={exports:{}};(function(t){(function(e,n,s){function o(a){var l=this;l.next=function(){var u=l.x,h=l.i,d,f;return d=u[h],d^=d>>>7,f=d^d<<24,d=u[h+1&7],f^=d^d>>>10,d=u[h+3&7],f^=d^d>>>3,d=u[h+4&7],f^=d^d<<7,d=u[h+7&7],d=d^d<<13,f^=d^d<<9,u[h]=f,l.i=h+1&7,f};function c(u,h){var d,f=[];if(h===(h|0))f[0]=h;else for(h=""+h,d=0;d<h.length;++d)f[d&7]=f[d&7]<<15^h.charCodeAt(d)+f[d+1&7]<<13;for(;f.length<8;)f.push(0);for(d=0;d<8&&f[d]===0;++d);for(d==8?f[7]=-1:f[d],u.x=f,u.i=0,d=256;d>0;--d)u.next()}c(l,a)}function r(a,l){return l.x=a.x.slice(),l.i=a.i,l}function i(a,l){a==null&&(a=+new Date);var c=new o(a),u=l&&l.state,h=function(){return(c.next()>>>0)/4294967296};return h.double=function(){do var d=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(d+f)/(1<<21);while(p===0);return p},h.int32=c.next,h.quick=h,u&&(u.x&&r(u,c),h.state=function(){return r(c,{})}),h}n&&n.exports?n.exports=i:s&&s.amd?s(function(){return i}):this.xorshift7=i})(jr,t,!1)})(ak);var lk={exports:{}};(function(t){(function(e,n,s){function o(a){var l=this;l.next=function(){var u=l.w,h=l.X,d=l.i,f,p;return l.w=u=u+1640531527|0,p=h[d+34&127],f=h[d=d+1&127],p^=p<<13,f^=f<<17,p^=p>>>15,f^=f>>>12,p=h[d]=p^f,l.i=d,p+(u^u>>>16)|0};function c(u,h){var d,f,p,g,b,x=[],y=128;for(h===(h|0)?(f=h,h=null):(h=h+"\0",f=0,y=Math.max(y,h.length)),p=0,g=-32;g<y;++g)h&&(f^=h.charCodeAt((g+32)%h.length)),g===0&&(b=f),f^=f<<10,f^=f>>>15,f^=f<<4,f^=f>>>13,g>=0&&(b=b+1640531527|0,d=x[g&127]^=f+b,p=d==0?p+1:0);for(p>=128&&(x[(h&&h.length||0)&127]=-1),p=127,g=4*128;g>0;--g)f=x[p+34&127],d=x[p=p+1&127],f^=f<<13,d^=d<<17,f^=f>>>15,d^=d>>>12,x[p]=f^d;u.w=b,u.X=x,u.i=p}c(l,a)}function r(a,l){return l.i=a.i,l.w=a.w,l.X=a.X.slice(),l}function i(a,l){a==null&&(a=+new Date);var c=new o(a),u=l&&l.state,h=function(){return(c.next()>>>0)/4294967296};return h.double=function(){do var d=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(d+f)/(1<<21);while(p===0);return p},h.int32=c.next,h.quick=h,u&&(u.X&&r(u,c),h.state=function(){return r(c,{})}),h}n&&n.exports?n.exports=i:s&&s.amd?s(function(){return i}):this.xor4096=i})(jr,t,!1)})(lk);var ck={exports:{}};(function(t){(function(e,n,s){function o(a){var l=this,c="";l.next=function(){var h=l.b,d=l.c,f=l.d,p=l.a;return h=h<<25^h>>>7^d,d=d-f|0,f=f<<24^f>>>8^p,p=p-h|0,l.b=h=h<<20^h>>>12^d,l.c=d=d-f|0,l.d=f<<16^d>>>16^p,l.a=p-h|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,a===Math.floor(a)?(l.a=a/4294967296|0,l.b=a|0):c+=a;for(var u=0;u<c.length+20;u++)l.b^=c.charCodeAt(u)|0,l.next()}function r(a,l){return l.a=a.a,l.b=a.b,l.c=a.c,l.d=a.d,l}function i(a,l){var c=new o(a),u=l&&l.state,h=function(){return(c.next()>>>0)/4294967296};return h.double=function(){do var d=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(d+f)/(1<<21);while(p===0);return p},h.int32=c.next,h.quick=h,u&&(typeof u=="object"&&r(u,c),h.state=function(){return r(c,{})}),h}n&&n.exports?n.exports=i:s&&s.amd?s(function(){return i}):this.tychei=i})(jr,t,!1)})(ck);var uk={exports:{}};const OH={},FH=Object.freeze(Object.defineProperty({__proto__:null,default:OH},Symbol.toStringTag,{value:"Module"})),LH=vz(FH);(function(t){(function(e,n,s){var o=256,r=6,i=52,a="random",l=s.pow(o,r),c=s.pow(2,i),u=c*2,h=o-1,d;function f(v,$,_){var E=[];$=$==!0?{entropy:!0}:$||{};var k=x(b($.entropy?[v,w(n)]:v==null?y():v,3),E),N=new p(E),A=function(){for(var F=N.g(r),L=l,H=0;F<c;)F=(F+H)*o,L*=o,H=N.g(1);for(;F>=u;)F/=2,L/=2,H>>>=1;return(F+H)/L};return A.int32=function(){return N.g(4)|0},A.quick=function(){return N.g(4)/4294967296},A.double=A,x(w(N.S),n),($.pass||_||function(F,L,H,M){return M&&(M.S&&g(M,N),F.state=function(){return g(N,{})}),H?(s[a]=F,L):F})(A,k,"global"in $?$.global:this==s,$.state)}function p(v){var $,_=v.length,E=this,k=0,N=E.i=E.j=0,A=E.S=[];for(_||(v=[_++]);k<o;)A[k]=k++;for(k=0;k<o;k++)A[k]=A[N=h&N+v[k%_]+($=A[k])],A[N]=$;(E.g=function(F){for(var L,H=0,M=E.i,K=E.j,q=E.S;F--;)L=q[M=h&M+1],H=H*o+q[h&(q[M]=q[K=h&K+L])+(q[K]=L)];return E.i=M,E.j=K,H})(o)}function g(v,$){return $.i=v.i,$.j=v.j,$.S=v.S.slice(),$}function b(v,$){var _=[],E=typeof v,k;if($&&E=="object")for(k in v)try{_.push(b(v[k],$-1))}catch{}return _.length?_:E=="string"?v:v+"\0"}function x(v,$){for(var _=v+"",E,k=0;k<_.length;)$[h&k]=h&(E^=$[h&k]*19)+_.charCodeAt(k++);return w($)}function y(){try{var v;return d&&(v=d.randomBytes)?v=v(o):(v=new Uint8Array(o),(e.crypto||e.msCrypto).getRandomValues(v)),w(v)}catch{var $=e.navigator,_=$&&$.plugins;return[+new Date,e,_,e.screen,w(n)]}}function w(v){return String.fromCharCode.apply(0,v)}if(x(s.random(),n),t.exports){t.exports=f;try{d=LH}catch{}}else s["seed"+a]=f})(typeof self<"u"?self:jr,[],Math)})(uk);var PH=ok.exports,MH=rk.exports,BH=ik.exports,VH=ak.exports,zH=lk.exports,WH=ck.exports,ra=uk.exports;ra.alea=PH;ra.xor128=MH;ra.xorwow=BH;ra.xorshift7=VH;ra.xor4096=zH;ra.tychei=WH;var my=ra;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hk{constructor(e,n,s,o,r){this.mean=e,this.stdDev=n,this.dtype=s,this.nextVal=NaN,this.truncated=o,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const i=r||Math.random();this.random=my.alea(i.toString())}nextValue(){if(!isNaN(this.nextVal)){const o=this.nextVal;return this.nextVal=NaN,o}let e,n,s=!1;for(;!s;){let o,r,i;do o=2*this.random()-1,r=2*this.random()-1,i=o*o+r*r;while(i>=1||i===0);const a=Math.sqrt(-2*Math.log(i)/i);e=this.mean+this.stdDev*o*a,n=this.mean+this.stdDev*r*a,(!this.truncated||this.isValidTruncated(e))&&(s=!0)}return(!this.truncated||this.isValidTruncated(n))&&(this.nextVal=this.convertValue(n)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class UH{constructor(e=0,n=1,s,o){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=n-e,this.dtype=s,o==null&&(o=Math.random()),typeof o=="number"&&(o=o.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${n} <= 1 and dtype is not float`);this.random=my.alea(o)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HH(t,e=0,n=1,s,o){if(s!=null&&s==="bool")throw new Error(`Unsupported data type ${s}`);const r=new hk(e,n,s,!1,o),i=nt(t,s);for(let a=0;a<i.values.length;a++)i.values[a]=r.nextValue();return i.toTensor()}const GH=U({randomNormal_:HH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jH(t,e=0,n=1,s="float32",o){const r=nt(t,s),i=new UH(e,n,null,o);for(let a=0;a<r.values.length;a++)r.values[a]=i.nextValue();return r.toTensor()}const Cp=U({randomUniform_:jH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _d(t,e,n=1,s="float32"){if(n===0)throw new Error("Cannot have a step of zero");const o={start:t,stop:e,step:n,dtype:s};return W.runKernel(Ix,{},o)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qH(t){const n={x:R(t,"x","reciprocal")};return W.runKernel(xu,n)}const KH=U({reciprocal_:qH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XH(t){const n={x:R(t,"x","relu")};return W.runKernel(yu,n)}const dr=U({relu_:XH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YH(t){const n={x:R(t,"x","relu6")};return W.runKernel(vu,n)}const dk=U({relu6_:YH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZH(t,e){const s={x:R(t,"x","reverse")},o={dims:e};return W.runKernel(tp,s,o)}const Zi=U({reverse_:ZH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QH(t){const n={x:R(t,"x","round")};return W.runKernel(wu,n)}const fk=U({round_:QH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JH(t){const n={x:R(t,"x","rsqrt","float32")};return W.runKernel(Cu,n)}const pk=U({rsqrt_:JH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eG(t){const n={x:R(t,"x","selu")};return W.runKernel($u,n)}const mk=U({selu_:eG});function tG(t,e,n,s,o,r=[1,1],i="NHWC"){const a=R(t,"x","separableConv2d"),l=R(e,"depthwiseFilter","separableConv2d"),c=R(n,"pointwiseFilter","separableConv2d");let u=a,h=!1;if(a.rank===3&&(h=!0,u=j(a,[1,a.shape[0],a.shape[1],a.shape[2]])),i==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");T(u.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${u.rank}.`),T(l.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`),T(c.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`),T(c.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${c.shape[0]}.`),T(c.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${c.shape[1]}.`);const d=l.shape[2],f=l.shape[3];T(c.shape[2]===d*f,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${d*f}, but got ${c.shape[2]}.`);const p=oy(u,l,s,o,i,r),b=Xi(p,c,1,"valid",i);return h?j(b,[b.shape[1],b.shape[2],b.shape[3]]):b}const gk=U({separableConv2d_:tG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nG(t){const n={x:R(t,"x","sign")};return W.runKernel(ku,n)}const sG=U({sign_:nG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oG(t){const n={x:R(t,"x","sin","float32")};return W.runKernel(Iu,n)}const bk=U({sin_:oG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rG(t){const n={x:R(t,"x","sinh")};return W.runKernel(_u,n)}const xk=U({sinh_:rG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iG(t,e,n){const s=R(t,"x","slice1d");return T(s.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${s.rank} tensor`),$t(s,[e],[n])}const gy=U({slice1d_:iG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aG(t,e,n){const s=R(t,"x","slice2d");return T(s.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${s.rank} tensor`),$t(s,e,n)}const yk=U({slice2d_:aG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lG(t,e,n){const s=R(t,"x","slice3d");return T(s.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${s.rank} tensor`),$t(s,e,n)}const by=U({slice3d_:lG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cG(t,e,n){const s=R(t,"x","slice4d");return T(s.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${s.rank} tensor`),$t(s,e,n)}const kd=U({slice4d_:cG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uG(t,e=-1){const n=R(t,"logits","softmax","float32");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${e}`);const s={logits:n},o={dim:e};return W.runKernel(ap,s,o)}const xy=U({softmax_:uG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hG(t){T(t.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${t.dtype}.`);const e={input:t};return W.runKernel(fx,e)}const vk=U({fft_:hG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dG(t){T(t.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${t.dtype}.`);const e={input:t};return W.runKernel(gx,e)}const nb=U({ifft_:dG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fG(t){const e=t.shape[t.shape.length-1],n=t.size/e;let s;if(e<=2){const o=j(t,[n,e]);s=nb(o)}else{const o=[n,2*(e-1)],r=j($d(t),[n,e]),i=j(Gx(t),[n,e]),a=Zi($t(r,[0,1],[n,e-2]),1),l=V(Zi($t(i,[0,1],[n,e-2]),1),Ge(-1)),c=Dn([r,a],1),u=Dn([i,l],1),h=j(Hi(c,u),[o[0],o[1]]);s=nb(h)}if(s=$d(s),t.rank===3&&t.shape[0]!==0){const o=s,r=t.shape[0];s=j(s,[r,s.shape[0]/r,s.shape[1]]),o.dispose()}return s}const pG=U({irfft_:fG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mG(t,e,n=0){const o={x:R(t,"x","split")},r={numOrSizeSplits:e,axis:n};return W.runKernel(ip,o,r)}const _s=U({split_:mG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gG(t,e){T(t.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${t.dtype}`);let n=t.shape[t.shape.length-1];const s=t.size/n;let o;if(e!=null&&e<n){const p=t.shape.map(b=>0),g=t.shape.map(b=>b);g[t.shape.length-1]=e,o=$t(t,p,g),n=e}else if(e!=null&&e>n){const p=t.shape.map(g=>g);p[t.shape.length-1]=e-n,o=Dn([t,gn(p)],t.shape.length-1),n=e}else o=t;const r=ut(o),i=j(Hi(o,r),[s,n]),a=vk(i),l=Math.floor(n/2)+1,c=$d(a),u=Gx(a),h=_s(c,[l,n-l],c.shape.length-1),d=_s(u,[l,n-l],u.shape.length-1),f=o.shape.slice();return f[o.shape.length-1]=l,j(Hi(h[0],d[0]),f)}const wk=U({rfft_:gG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bG(t,e){let n=R(t,"a","squaredDifference"),s=R(e,"b","squaredDifference");[n,s]=Xt(n,s),Ye(n.shape,s.shape);const o={a:n,b:s},r={};return W.runKernel(Nu,o,r)}const Ck=U({squaredDifference_:bG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xG(t,e){const n=R(t,"x","squeeze","string_or_numeric");return j(n,Gr(n.shape,e).newShape)}const Bu=U({squeeze_:xG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yG(t,e=0){const n=C_(t,"tensors","stack","string_or_numeric");T(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&T(e<=n[0].rank,()=>"Axis must be <= rank of the tensor");const s=n,o={axis:e};return W.runKernel(Kf,s,o)}const Qi=U({stack_:yG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vG(t,e=0){const s={x:R(t,"x","step")},o={alpha:e};return W.runKernel(Fu,s,o)}const Vu=U({step_:vG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wG(t,e,n,s,o=0,r=0,i=0,a=0,l=0){const u={x:R(t,"x","stridedSlice","string_or_numeric")},h={begin:e,end:n,strides:s,beginMask:o,endMask:r,ellipsisMask:i,newAxisMask:a,shrinkAxisMask:l};return W.runKernel(Dx,u,h)}const CG=U({stridedSlice_:wG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $G(t){const n={x:R(t,"x","tan","float32")};return W.runKernel(Ru,n)}const IG=U({tan_:$G});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hs(t,e){BI(t);const n=dp(t,e);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return fp(t,null,n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gc(t,e,n){if(BI(t),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const s=dp(t,n);if(s.length!==2&&s.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return fp(t,e,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _G(t,e=1,n=!0){const s=R(t,"x","topk");if(s.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const o=s.shape[s.shape.length-1];if(e<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${e}`);if(e>o)throw new Error(`'k' passed to topk() must be <= the last dimension (${o}) but got ${e}`);const r={x:s},i={k:e,sorted:n},[a,l]=W.runKernel(Px,r,i);return{values:a,indices:l}}const kG=U({topk_:_G});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EG(t,e=0,n=1,s,o){if(s!=null&&s==="bool")throw new Error("Unsupported data type $ { dtype }");const r=new hk(e,n,s,!0,o),i=nt(t,s);for(let a=0;a<i.values.length;a++)i.values[a]=r.nextValue();return i.toTensor()}const $k=U({truncatedNormal_:EG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SG(t,e=0){const n=R(t,"x","unique","string_or_numeric");T(n.rank>0,()=>"The input tensor must be at least 1D");const s={x:n},o={axis:e},[r,i]=W.runKernel(Bx,s,o);return{values:r,indices:i}}const TG=U({unique_:SG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NG(t,e,n){const s=R(t,"x","unsortedSegmentSum"),o=R(e,"segmentIds","unsortedSegmentSum","int32");T(ol(n),()=>"numSegments must be of dtype int");const r={x:s,segmentIds:o},i={numSegments:n};return W.runKernel(cp,r,i)}const Ik=U({unsortedSegmentSum_:NG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AG(t,e=0){const n=R(t,"x","unstack","string_or_numeric");T(e>=-n.shape.length&&e<n.shape.length,()=>`Axis = ${e} is not in [-${n.shape.length}, ${n.shape.length})`);const s={value:n},o={axis:e};return W.runKernel(lp,s,o)}const cl=U({unstack_:AG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RG(t,e=!0,n,s){return W.makeVariable(t,e,n,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _k(t,e){const n=[];for(let r=0;r<e.length;r++)e[r]&&n.push(r);const s=nt(t,"int32"),o=nt([n.length,t.length],"int32");for(let r=0;r<n.length;r++){const i=s.indexToLoc(n[r]),a=r*t.length;o.values.set(i,a)}return o.toTensor()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DG(t,e){if(e==null)return t.shape.slice();if(bt(t.shape,e))return e;if(t.shape.length===e.length){const n=[];for(let s=0;s<t.shape.length;s++)e[s]==null&&t.shape[s]!=null?n.push(t.shape[s]):n.push(e[s]);return n}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OG(t,e,n,s){const o=R(t,"x","dropout");if(T(o.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${o.dtype} tensor instead.`),T(e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),e===0)return t instanceof tn?o.clone():o;const r=DG(o,n),i=1-e,a=ze(vp(ye(Cp(r,0,1,"float32",s),i)),i);return V(o,a)}const FG=U({dropout_:OG});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LG(t){return Math.floor(Math.pow(2,Math.ceil(Math.log(t)/Math.log(2))))}function kk(t,e,n){const s=1-t%2,o=new Float32Array(t);for(let r=0;r<t;++r){const i=2*Math.PI*r/(t+s-1);o[r]=e-n*Math.cos(i)}return hs(o,"float32")}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PG(t,e,n,s,o,r="NHWC",i){let a=t;t.rank===3&&(a=j(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;l.rank===3&&(l=j(e,[1,e.shape[0],e.shape[1],e.shape[2]])),T(a.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${a.shape}.`),T(l.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`),T(n.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`);const c=r==="NHWC"?a.shape[3]:a.shape[1],u=r==="NHWC"?l.shape[3]:l.shape[1];T(c===n[2],()=>`Error in conv2dDerFilter: depth of input ${c}) must match input depth in filter (${n[2]}.`),T(u===n[3],()=>`Error in conv2dDerFilter: depth of dy (${u}) must match output depth for filter (${n[3]}).`),is("conv2dDerFilter",o,i);const h={x:a,dy:l},d={strides:s,pad:o,dataFormat:r,dimRoundingMode:i,filterShape:n};return W.runKernel(ox,h,d)}const yy=U({conv2DBackpropFilter_:PG});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vy(t,e,n){if(n==null||n==="linear")return t;if(n==="relu")return V(t,Vu(e));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function wy(t,e){let n=e;const s=un(t.shape,e.shape);return s.length>0&&(n=Le(n,s)),j(n,t.shape)}function Cy(t,e,n,s){if(e==="linear")return t;if(e==="relu")return dr(t);if(e==="elu")return bp(t);if(e==="relu6")return dk(t);if(e==="prelu")return py(t,n);if(e==="leakyrelu")return ay(t,s);if(e==="sigmoid")return _l(t);throw new Error(`Unknown fused activation ${e}.`)}const $y=(t,e)=>!(t>0)||e==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MG({x:t,filter:e,strides:n,pad:s,dataFormat:o="NHWC",dilations:r=[1,1],dimRoundingMode:i,bias:a,activation:l="linear",preluActivationWeights:c,leakyreluAlpha:u}){if(l=l||"linear",$y(W.state.gradientDepth,l)===!1){T(o==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${o} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let _=Xi(t,e,n,s,o,r,i);return a!=null&&(_=ye(_,a)),Cy(_,l,c,u)}const h=R(t,"x","conv2d","float32"),d=R(e,"filter","conv2d","float32");let f=h,p=!1;h.rank===3&&(p=!0,f=j(h,[1,h.shape[0],h.shape[1],h.shape[2]])),T(f.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${f.rank}.`),T(d.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${d.rank}.`),is("fused conv2d",s,i);const g=o==="NHWC"?f.shape[3]:f.shape[1];T(d.shape[2]===g,()=>`Error in conv2d: depth of input (${g}) must match input depth for filter ${d.shape[2]}.`),T(Pn(n,r),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${r}'`);const b=In(f.shape,d.shape,n,r,s,i);let x;a!=null&&(x=R(a,"bias","fused conv2d"),[x]=Xt(x,h),o==="NHWC"?Ye(b.outShape,x.shape):(T(x.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${x.shape.length}.`),T(x.shape.length===0||x.shape[0]===b.outChannels||x.shape[0]===1,()=>`Error in fused conv2d: bias shape (${x.shape}) is not compatible with the number of output channels (${b.outChannels})`)));let y;if(c!=null){const _=c.shape;if(T(_.length<=1||_.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${_.length}.`),_.length===1)T(_[0]===1||_[0]===b.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${_}) is not compatible with the number of output channels (${b.outChannels}).`);else if(_.length===3)try{Ye(_,b.outShape)}catch{const k=`Error in fused conv2d: PReLU activation weights (${_}) is not compatible with the output shape of the conv2d (${b.outShape}).`;throw Error(k)}y=R(c,"prelu weights","fused conv2d")}const w=(_,E)=>{T(o==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${o} but only NHWC is currently supported.`);const[k,N,A,F]=E,L=vy(_,A,l);T(Ki(r),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${r}'`);const H=ny(N.shape,L,k,n,s),M=yy(N,L,k.shape,n,s),K=[H,M];if(F!=null){const q=wy(F,L);K.push(q)}return K},v={x:f,filter:d,bias:x,preluActivationWeights:y},$={strides:n,pad:s,dataFormat:o,dilations:r,dimRoundingMode:i,activation:l,leakyreluAlpha:u};return a==null?Yi((E,k,N)=>{let A=W.runKernel(xd,v,$);return N([k,E,A]),p&&(A=j(A,[A.shape[1],A.shape[2],A.shape[3]])),{value:A,gradFunc:w}})(f,d):Yi((E,k,N,A)=>{let F=W.runKernel(xd,v,$);return A([k,E,F,N]),p&&(F=j(F,[F.shape[1],F.shape[2],F.shape[3]])),{value:F,gradFunc:w}})(f,d,x)}const BG=U({fusedConv2d_:MG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VG(t,e,n,s,o,r=[1,1],i){let a=t;t.rank===3&&(a=j(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;l.rank===3&&(l=j(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const c={x:a,dy:l},u={strides:s,pad:o,dimRoundingMode:i,dilations:r,filterShape:n};return W.runKernel(ux,c,u)}const zG=U({depthwiseConv2dNativeBackpropFilter_:VG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WG(t,e,n,s,o,r=[1,1],i){let a=e,l=!1;e.rank===3&&(l=!0,a=j(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const c={dy:a,filter:n},u={strides:s,pad:o,dimRoundingMode:i,dilations:r,inputShape:t},h=W.runKernel(hx,c,u);return l?j(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const UG=U({depthwiseConv2dNativeBackpropInput_:WG});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HG({a:t,b:e,transposeA:n=!1,transposeB:s=!1,bias:o,activation:r="linear",preluActivationWeights:i,leakyreluAlpha:a=.2}){if($y(W.state.gradientDepth,r)===!1){let F=gt(t,e,n,s);return o!=null&&(F=ye(F,o)),Cy(F,r,i,a)}let l=R(t,"a","fused matMul"),c=R(e,"b","fused matMul");[l,c]=Xt(l,c);const u=n?l.shape[l.rank-2]:l.shape[l.rank-1],h=s?c.shape[c.rank-1]:c.shape[c.rank-2],d=n?l.shape[l.rank-1]:l.shape[l.rank-2],f=s?c.shape[c.rank-2]:c.shape[c.rank-1],p=l.shape.slice(0,-2),g=c.shape.slice(0,-2),b=ae(p),x=ae(g);T(u===h,()=>`Error in fused matMul: inner shapes (${u}) and (${h}) of Tensors with shapes ${l.shape} and ${c.shape} and transposeA=${n} and transposeB=${s} must match.`);const w=Ye(l.shape.slice(0,-2),c.shape.slice(0,-2)).concat([d,f]),v=n?j(l,[b,u,d]):j(l,[b,d,u]),$=s?j(c,[x,f,h]):j(c,[x,h,f]);let _;o!=null&&(_=R(o,"bias","fused matMul"),[_]=Xt(_,l),Ye(w,_.shape));let E;i!=null&&(E=R(i,"prelu weights","fused matMul"));const k=(F,L)=>{const[H,M,K,q]=L,Q=vy(j(F,K.shape),K,r);let Y,ie;if(!n&&!s?(Y=gt(Q,M,!1,!0),ie=gt(H,Q,!0,!1)):!n&&s?(Y=gt(Q,M,!1,!1),ie=gt(Q,H,!0,!1)):n&&!s?(Y=gt(M,Q,!1,!0),ie=gt(H,Q,!1,!1)):(Y=gt(M,Q,!0,!0),ie=gt(Q,H,!0,!0)),o!=null){const pe=wy(q,Q);return[Y,ie,pe]}else return[Y,ie]},N={a:v,b:$,bias:_,preluActivationWeights:E},A={transposeA:n,transposeB:s,activation:r,leakyreluAlpha:a};return o==null?Yi((L,H,M)=>{const K=W.runKernel(bd,N,A);return M([L,H,K]),{value:j(K,w),gradFunc:k}})(v,$):Yi((L,H,M,K)=>{const q=W.runKernel(bd,N,A);return K([L,H,q,M]),{value:j(q,w),gradFunc:k}})(v,$,_)}const Hw=U({fusedMatMul_:HG});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GG(t){return kk(t,.54,.46)}const Yhe=U({hammingWindow_:GG});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jG(t){return kk(t,.5,.5)}const qG=U({hannWindow_:jG});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KG(t,e,n,s=!1,o=0){let r=0;const i=[];for(;r+e<=t.size;)i.push($t(t,r,e)),r+=n;if(s)for(;r<t.size;){const a=r+e-t.size,l=Dn([$t(t,r,e-a),yp([a],o)]);i.push(l),r+=n}return i.length===0?gc([],[0,e]):j(Dn(i),[i.length,e])}const XG=U({frame_:KG});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YG(t,e,n,s,o=qG){s==null&&(s=LG(e));const r=XG(t,e,n),i=V(r,o(e));return wk(i,s)}const Zhe=U({stft_:YG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZG(t,e,n,s,o="bilinear",r=0){const i=R(t,"image","cropAndResize"),a=R(e,"boxes","cropAndResize","float32"),l=R(n,"boxInd","cropAndResize","int32"),c=a.shape[0];T(i.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${i.rank}.`),T(a.rank===2&&a.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${c},4] but had shape ${a.shape}.`),T(l.rank===1&&l.shape[0]===c,()=>`Error in cropAndResize: boxInd must be have size [${c}] but had shape ${a.shape}.`),T(s.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${s.length}.`),T(s[0]>=1&&s[1]>=1,()=>`cropSize must be atleast [1,1], but was ${s}`),T(o==="bilinear"||o==="nearest",()=>`method must be bilinear or nearest, but was ${o}`);const u={image:i,boxes:a,boxInd:l},h={method:o,extrapolationValue:r,cropSize:s};return W.runKernel(lx,u,h)}const QG=U({cropAndResize_:ZG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JG(t){const e=R(t,"image","flipLeftRight","float32");T(e.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${e.rank}.`);const n={image:e};return W.runKernel(mx,n,{})}const ej=U({flipLeftRight_:JG});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tj(t){const e=R(t,"image","grayscaleToRGB"),n=e.rank-1,s=e.shape[n];T(e.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${e.rank}.`),T(s===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${s}.`);const o=new Array(e.rank);return o.fill(1,0,n),o[n]=3,ho(e,o)}const nj=U({grayscaleToRGB_:tj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sj(t,e,n=0,s=.5){const o=R(t,"image","rotateWithOffset","float32");T(o.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${o.rank}.`);const r={image:o},i={radians:e,fillValue:n,center:s};return W.runKernel(Vx,r,i)}const oj=U({rotateWithOffset_:sj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sl(t,e,n,s,o,r){s==null&&(s=.5),o==null&&(o=Number.NEGATIVE_INFINITY),r==null&&(r=0);const i=t.shape[0];return n=Math.min(n,i),T(0<=s&&s<=1,()=>`iouThreshold must be in [0, 1], but was '${s}'`),T(t.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${t.rank}'`),T(t.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${t.shape[1]}`),T(e.rank===1,()=>"scores must be a 1D tensor"),T(e.shape[0]===i,()=>`scores has incompatible shape with boxes. Expected ${i}, but was ${e.shape[0]}`),T(0<=r&&r<=1,()=>`softNmsSigma must be in [0, 1], but was '${r}'`),{maxOutputSize:n,iouThreshold:s,scoreThreshold:o,softNmsSigma:r}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rj(t,e,n,s=.5,o=Number.NEGATIVE_INFINITY){const r=R(t,"boxes","nonMaxSuppression","float32"),i=R(e,"scores","nonMaxSuppression","float32"),a=Sl(r,i,n,s,o);n=a.maxOutputSize,s=a.iouThreshold,o=a.scoreThreshold;const l={maxOutputSize:n,iouThreshold:s,scoreThreshold:o};return W.runKernel(wx,{boxes:r,scores:i},l)}const ij=U({nonMaxSuppression_:rj});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aj(t,e,n){const s=lj(t,e,n),o=s<0?-(s+1):s;t.splice(o,0,e)}function lj(t,e,n){return uj(t,e,n||cj)}function cj(t,e){return t>e?1:t<e?-1:0}function uj(t,e,n){let s=0,o=t.length,r=0,i=!1;for(;s<o;){r=s+(o-s>>>1);const a=n(e,t[r]);a>0?s=r+1:(o=r,i=!a)}return i?s:-s-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iy(t,e,n,s,o){return Ey(t,e,n,s,o,0)}function _y(t,e,n,s,o,r){return Ey(t,e,n,s,o,0,!1,r,!0)}function ky(t,e,n,s,o,r){return Ey(t,e,n,s,o,r,!0)}function Ey(t,e,n,s,o,r,i=!1,a=!1,l=!1){const c=[];for(let b=0;b<e.length;b++)e[b]>o&&c.push({score:e[b],boxIndex:b,suppressBeginIndex:0});c.sort(Gw);const u=r>0?-.5/r:0,h=[],d=[];for(;h.length<n&&c.length>0;){const b=c.pop(),{score:x,boxIndex:y,suppressBeginIndex:w}=b;if(x<o)break;let v=!1;for(let $=h.length-1;$>=w;--$){const _=hj(t,y,h[$]);if(_>=s){v=!0;break}if(b.score=b.score*dj(s,u,_),b.score<=o)break}b.suppressBeginIndex=h.length,v||(b.score===x?(h.push(y),d.push(b.score)):b.score>o&&aj(c,b,Gw))}const f=h.length,p=n-f;a&&p>0&&(h.push(...new Array(p).fill(0)),d.push(...new Array(p).fill(0)));const g={selectedIndices:h};return i&&(g.selectedScores=d),l&&(g.validOutputs=f),g}function hj(t,e,n){const s=t.subarray(e*4,e*4+4),o=t.subarray(n*4,n*4+4),r=Math.min(s[0],s[2]),i=Math.min(s[1],s[3]),a=Math.max(s[0],s[2]),l=Math.max(s[1],s[3]),c=Math.min(o[0],o[2]),u=Math.min(o[1],o[3]),h=Math.max(o[0],o[2]),d=Math.max(o[1],o[3]),f=(a-r)*(l-i),p=(h-c)*(d-u);if(f<=0||p<=0)return 0;const g=Math.max(r,c),b=Math.max(i,u),x=Math.min(a,h),y=Math.min(l,d),w=Math.max(x-g,0)*Math.max(y-b,0);return w/(f+p-w)}function dj(t,e,n){const s=Math.exp(e*n*n);return n<=t?s:0}function Gw(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function fj(t,e,n,s=.5,o=Number.NEGATIVE_INFINITY){const r=R(t,"boxes","nonMaxSuppressionAsync"),i=R(e,"scores","nonMaxSuppressionAsync"),a=Sl(r,i,n,s,o);n=a.maxOutputSize,s=a.iouThreshold,o=a.scoreThreshold;const l=await Promise.all([r.data(),i.data()]),c=l[0],u=l[1],{selectedIndices:h}=Iy(c,u,n,s,o);return r!==t&&r.dispose(),i!==e&&i.dispose(),hs(h,"int32")}const pj=fj;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mj(t,e,n,s=.5,o=Number.NEGATIVE_INFINITY,r=0){const i=R(t,"boxes","nonMaxSuppression"),a=R(e,"scores","nonMaxSuppression"),l=Sl(i,a,n,s,o,r);n=l.maxOutputSize,s=l.iouThreshold,o=l.scoreThreshold,r=l.softNmsSigma;const c={boxes:i,scores:a},u={maxOutputSize:n,iouThreshold:s,scoreThreshold:o,softNmsSigma:r},h=W.runKernel($x,c,u);return{selectedIndices:h[0],selectedScores:h[1]}}const gj=U({nonMaxSuppressionWithScore_:mj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function bj(t,e,n,s=.5,o=Number.NEGATIVE_INFINITY,r=0){const i=R(t,"boxes","nonMaxSuppressionAsync"),a=R(e,"scores","nonMaxSuppressionAsync"),l=Sl(i,a,n,s,o,r);n=l.maxOutputSize,s=l.iouThreshold,o=l.scoreThreshold,r=l.softNmsSigma;const c=await Promise.all([i.data(),a.data()]),u=c[0],h=c[1],{selectedIndices:d,selectedScores:f}=ky(u,h,n,s,o,r);return i!==t&&i.dispose(),a!==e&&a.dispose(),{selectedIndices:hs(d,"int32"),selectedScores:hs(f)}}const xj=bj;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yj(t,e,n,s=.5,o=Number.NEGATIVE_INFINITY,r=!1){const i=R(t,"boxes","nonMaxSuppression"),a=R(e,"scores","nonMaxSuppression"),l=Sl(i,a,n,s,o,null),c=l.maxOutputSize,u=l.iouThreshold,h=l.scoreThreshold,d={boxes:i,scores:a},f={maxOutputSize:c,iouThreshold:u,scoreThreshold:h,padToMaxOutputSize:r},p=W.runKernel(Cx,d,f);return{selectedIndices:p[0],validOutputs:p[1]}}const vj=U({nonMaxSuppressionPadded_:yj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function wj(t,e,n,s=.5,o=Number.NEGATIVE_INFINITY,r=!1){const i=R(t,"boxes","nonMaxSuppressionAsync"),a=R(e,"scores","nonMaxSuppressionAsync"),l=Sl(i,a,n,s,o,null),c=l.maxOutputSize,u=l.iouThreshold,h=l.scoreThreshold,[d,f]=await Promise.all([i.data(),a.data()]),{selectedIndices:p,validOutputs:g}=_y(d,f,c,u,h,r);return i!==t&&i.dispose(),a!==e&&a.dispose(),{selectedIndices:hs(p,"int32"),validOutputs:Ge(g,"int32")}}const Cj=wj;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $j(t,e,n=!1,s=!1){const o=R(t,"images","resizeBilinear");T(o.rank===3||o.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${o.rank}.`),T(e.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${e}.`),T(s===!1||n===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let r=o,i=!1;o.rank===3&&(i=!0,r=j(o,[1,o.shape[0],o.shape[1],o.shape[2]]));const a={images:r},l={alignCorners:n,halfPixelCenters:s,size:e},c=W.runKernel(ep,a,l);return i?j(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const Ek=U({resizeBilinear_:$j});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ij(t,e,n=!1,s=!1){const o=R(t,"images","resizeNearestNeighbor");T(o.rank===3||o.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${o.rank}.`),T(e.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${e}.`),T(o.dtype==="float32"||o.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),T(s===!1||n===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let r=o,i=!1;o.rank===3&&(i=!0,r=j(o,[1,o.shape[0],o.shape[1],o.shape[2]]));const a={images:r},l={alignCorners:n,halfPixelCenters:s,size:e},c=W.runKernel(Jf,a,l);return i?j(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const Sk=U({resizeNearestNeighbor_:Ij});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _j(t,e="binary",n=!1,s=.5){const o=R(t,"image","threshold"),r=.2989,i=.587,a=.114,l=o.shape[0]*o.shape[1];let c=V(hs([s]),255),u,h,d,f;if(T(o.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${o.rank}.`),T(o.shape[2]===3||o.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${o.shape[2]}.`),T(o.dtype==="int32"||o.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${o.dtype}.`),T(e==="otsu"||e==="binary",()=>`Method must be binary or otsu, but was ${e}`),o.shape[2]===3){[u,h,d]=_s(o,[1,1,1],-1);const b=V(u,r),x=V(h,i),y=V(d,a);f=ye(ye(b,x),y)}else f=t;if(e==="otsu"){const b=F4(Ae(fk(f),"int32"),sd([]),256);c=kj(b,l)}const p=n?El(f,c):Qs(f,c);return Ae(V(p,255),"int32")}function kj(t,e){let n=hs([-1]),s=hs([0]),o=hs([0]),r,i,a,l,c,u;for(let h=0;h<t.size-1;h++){r=$t(t,0,h+1),i=$t(t,h+1),c=ze(Le(r),e),u=ze(Le(i),e);const d=Le(V(r,_d(0,r.size)));a=ze(d,Le(r));const f=yp(i.shape,r.size),p=ye(_d(0,i.size),f),g=V(i,p);l=ze(Le(g),Le(i));const b=Pe(a,l),x=Pe(a,l),y=V(c,u);o=V(V(y,b),x);const w=Qs(o,s);s=fs(w,o,s),n=fs(w,hs([h]),n)}return n}const Ej=U({threshold_:_j});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sj(t,e,n="nearest",s="constant",o=0,r){const i=R(t,"image","transform","float32"),a=R(e,"transforms","transform","float32");T(i.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${i.rank}.`),T(a.rank===2&&(a.shape[0]===i.shape[0]||a.shape[0]===1)&&a.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),T(r==null||r.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${r}.`);const l={image:i,transforms:a},c={interpolation:n,fillMode:s,fillValue:o,outputShape:r};return W.runKernel(Mx,l,c)}const Tj=U({transform_:Sj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nj(t,e,n){T(e%1===0,()=>`bandPart(): numLower must be an integer, got ${e}.`),T(n%1===0,()=>`bandPart(): numUpper must be an integer, got ${n}.`);const s=R(t,"a","bandPart");T(s.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${s.rank}.`);const o=s.shape,[r,i]=s.shape.slice(-2);if(!(e<=r))throw new Error(`bandPart(): numLower (${e}) must not be greater than the number of rows (${r}).`);if(!(n<=i))throw new Error(`bandPart(): numUpper (${n}) must not be greater than the number of columns (${i}).`);e<0&&(e=r),n<0&&(n=i);const a=j(_d(0,r,1,"int32"),[-1,1]),l=_d(0,i,1,"int32"),c=Pe(a,l),u=ir(El(c,Ge(+e,"int32")),kl(c,Ge(-n,"int32"))),h=gn([r,i],s.dtype);return j(Qi(cl(j(s,[-1,r,i])).map(d=>fs(u,d,h))),o)}const Aj=U({bandPart_:Nj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rj(t){let e;if(Array.isArray(t)){e=!1,T(t!=null&&t.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const o=t[0].shape[0];for(let r=1;r<t.length;++r)T(t[r].shape[0]===o,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${t[r].shape[0]} vs. ${o})`)}else e=!0,t=_s(t,t.shape[0],0).map(o=>Bu(o,[0]));T(t.length<=t[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${t.length}) exceeds number of dimensions (${t[0].shape[0]}).`);const n=[],s=t;for(let o=0;o<t.length;++o)n.push(W.tidy(()=>{let r=s[o];if(o>0)for(let i=0;i<o;++i){const a=V(Le(V(n[i],r)),n[i]);r=Pe(r,a)}return ze(r,xp(r,"euclidean"))}));return e?Qi(n,0):n}const Dj=U({gramSchmidt_:Rj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oj(t,e=!1){if(T(t.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${t.rank}`),t.rank===2)return jw(t,e);{const n=t.shape.slice(0,t.shape.length-2).reduce((l,c)=>l*c),s=cl(j(t,[n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),o=[],r=[];s.forEach(l=>{const[c,u]=jw(l,e);o.push(c),r.push(u)});const i=j(Qi(o,0),t.shape),a=j(Qi(r,0),t.shape);return[i,a]}}function jw(t,e=!1){return W.tidy(()=>{T(t.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${t.shape.length}D Tensor.`);const n=t.shape[0],s=t.shape[1];let o=J_(n),r=Mi(t);const i=gc([[1]],[1,1]);let a=Mi(i);const l=n>=s?s:n;for(let c=0;c<l;++c){const u=r,h=a,d=o;[a,r,o]=W.tidy(()=>{const f=$t(r,[c,c],[n-c,1]),p=xp(f),g=$t(r,[c,c],[1,1]),b=fs(Qs(g,0),gc([[-1]]),gc([[1]])),x=Pe(g,V(b,p)),y=ze(f,x);y.shape[0]===1?a=Mi(i):a=Dn([i,$t(y,[1,0],[y.shape[0]-1,y.shape[1]])],0);const w=Gt(ze(gt(b,x),p)),v=$t(r,[c,0],[n-c,s]),$=V(w,a),_=lt(a);if(c===0)r=Pe(v,gt($,gt(_,v)));else{const N=Pe(v,gt($,gt(_,v)));r=Dn([$t(r,[0,0],[c,s]),N],0)}const E=lt($),k=$t(o,[0,c],[n,o.shape[1]-c]);if(c===0)o=Pe(k,gt(gt(k,a),E));else{const N=Pe(k,gt(gt(k,a),E));o=Dn([$t(o,[0,0],[n,c]),N],1)}return[a,r,o]}),tt([u,h,d])}return!e&&n>s&&(o=$t(o,[0,0],[n,s]),r=$t(r,[0,0],[s,s])),[o,r]})}const Fj=U({qr_:Oj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var es;(function(t){t[t.NONE=0]="NONE",t[t.MEAN=1]="MEAN",t[t.SUM=2]="SUM",t[t.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(es||(es={}));function Lj(t,e,n=es.SUM_BY_NONZERO_WEIGHTS){const s=R(t,"losses","computeWeightedLoss");let o=null;e!=null&&(o=R(e,"weights","computeWeightedLoss"));const r=o==null?s:V(s,o);if(n===es.NONE)return r;if(n===es.SUM)return Le(r);if(n===es.MEAN){if(o==null)return Kt(r);{const i=s.size/o.size,a=ze(Le(r),Le(o));return i>1?ze(a,Ge(i)):a}}if(n===es.SUM_BY_NONZERO_WEIGHTS){if(o==null)return ze(Le(r),Ge(s.size));{const i=V(o,Zr(s.shape)),a=Ae(Le(kc(i,Ge(0))),"float32");return ze(Le(r),a)}}throw Error(`Unknown reduction: ${n}`)}const Qr=U({computeWeightedLoss_:Lj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pj(t,e,n,s=es.SUM_BY_NONZERO_WEIGHTS){const o=R(t,"labels","absoluteDifference"),r=R(e,"predictions","absoluteDifference");let i=null;n!=null&&(i=R(n,"weights","absoluteDifference")),Ys(o.shape,r.shape,"Error in absoluteDifference: ");const a=dn(Pe(o,r));return Qr(a,i,s)}const Qhe=U({absoluteDifference_:Pj});function Mj(t,e,n,s,o=es.SUM_BY_NONZERO_WEIGHTS){const r=R(t,"labels","cosineDistance"),i=R(e,"predictions","cosineDistance");let a=null;s!=null&&(a=R(s,"weights","cosineDistance")),Ys(r.shape,i.shape,"Error in cosineDistance: ");const l=Ge(1),c=Pe(l,Le(V(r,i),n,!0));return Qr(c,a,o)}const Jhe=U({cosineDistance_:Mj});function Bj(t,e,n,s=es.SUM_BY_NONZERO_WEIGHTS){let o=R(t,"labels","hingeLoss");const r=R(e,"predictions","hingeLoss");let i=null;n!=null&&(i=R(n,"weights","hingeLoss")),Ys(o.shape,r.shape,"Error in hingeLoss: ");const a=Ge(1);o=Pe(V(Ge(2),o),a);const l=dr(Pe(a,V(o,r)));return Qr(l,i,s)}const ede=U({hingeLoss_:Bj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vj(t,e,n,s=1,o=es.SUM_BY_NONZERO_WEIGHTS){const r=R(t,"labels","huberLoss"),i=R(e,"predictions","huberLoss");let a=null;n!=null&&(a=R(n,"weights","huberLoss")),Ys(r.shape,i.shape,"Error in huberLoss: ");const l=Ge(s),c=dn(Pe(i,r)),u=wp(c,l),h=Pe(c,u),d=ye(V(Ge(.5),Nt(u)),V(l,h));return Qr(d,a,o)}const tde=U({huberLoss_:Vj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zj(t,e,n,s=1e-7,o=es.SUM_BY_NONZERO_WEIGHTS){const r=R(t,"labels","logLoss"),i=R(e,"predictions","logLoss");let a=null;n!=null&&(a=R(n,"weights","logLoss")),Ys(r.shape,i.shape,"Error in logLoss: ");const l=Ge(1),c=Ge(s),u=Gt(V(r,Ks(ye(i,c)))),h=V(Pe(l,r),Ks(ye(Pe(l,i),c))),d=Pe(u,h);return Qr(d,a,o)}const nde=U({logLoss_:zj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wj(t,e,n,s=es.SUM_BY_NONZERO_WEIGHTS){const o=R(t,"labels","meanSquaredError"),r=R(e,"predictions","meanSquaredError");let i=null;n!=null&&(i=R(n,"weights","meanSquaredError")),Ys(o.shape,r.shape,"Error in meanSquaredError: ");const a=Ck(o,r);return Qr(a,i,s)}const sde=U({meanSquaredError_:Wj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uj(t,e){const n=R(t,"labels","sigmoidCrossEntropyWithLogits"),s=R(e,"logits","sigmoidCrossEntropyWithLogits");Ys(n.shape,s.shape,"Error in sigmoidCrossEntropyWithLogits: ");const o=dr(s),r=V(s,n),i=ly(qs(Gt(dn(s))));return ye(Pe(o,r),i)}function Hj(t,e,n,s=0,o=es.SUM_BY_NONZERO_WEIGHTS){let r=R(t,"multiClassLabels","sigmoidCrossEntropy");const i=R(e,"logits","sigmoidCrossEntropy");let a=null;if(n!=null&&(a=R(n,"weights","sigmoidCrossEntropy")),Ys(r.shape,i.shape,"Error in sigmoidCrossEntropy: "),s>0){const c=Ge(s),u=Ge(1),h=Ge(.5);r=ye(V(r,Pe(u,c)),V(h,c))}const l=Uj(r,i);return Qr(l,a,o)}const ode=U({sigmoidCrossEntropy_:Hj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gj(t,e,n=-1){if(n===-1&&(n=e.rank-1),n!==e.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${e.rank} and dim was ${n}`);return Yi((o,r,i)=>{const l=nk(r,[n],!0),c=Pe(Ae(r,"float32"),l);i([o,c]);const u=Gt(V(c,o));return{value:Le(u,[n]),gradFunc:(f,p)=>{const[g,b]=p,x=Yt(f.shape,[n]);return[V(j(f,x),Pe(Ae(g,"float32"),qs(b))),V(j(f,x),Pe(qs(b),Ae(g,"float32")))]}}})(t,e)}function jj(t,e,n,s=0,o=es.SUM_BY_NONZERO_WEIGHTS){let r=R(t,"onehotLabels","softmaxCrossEntropy");const i=R(e,"logits","softmaxCrossEntropy");let a=null;if(n!=null&&(a=R(n,"weights","softmaxCrossEntropy")),Ys(r.shape,i.shape,"Error in softmaxCrossEntropy: "),s>0){const c=Ge(s),u=Ge(1),h=Ge(r.shape[1]);r=ye(V(r,Pe(u,c)),ze(c,h))}const l=Gj(r,i);return Qr(l,a,o)}const rde=U({softmaxCrossEntropy_:jj});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qj(t,e,n,s){const o=R(t,"indices","sparseFillEmptyRows","int32"),r=R(e,"values","sparseFillEmptyRows"),i=R(n,"denseShape","sparseFillEmptyRows","int32"),a=R(s,"defaultValue","sparseFillEmptyRows",r.dtype);if(o.rank!==2)throw new Error(`Indices should be Tensor2D but received shape
        ${o.shape}`);if(r.rank!==1)throw new Error(`Values should be Tensor1D but received shape ${r.shape}`);if(i.rank!==1)throw new Error(`Dense shape should be Tensor1D but received shape ${i.shape}`);if(a.rank!==0)throw new Error(`Default value should be a scalar but received shape ${a.shape}`);const l={indices:o,values:r,denseShape:i,defaultValue:a},c=W.runKernel(Sx,l);return{outputIndices:c[0],outputValues:c[1],emptyRowIndicator:c[2],reverseIndexMap:c[3]}}const ide=U({sparseFillEmptyRows_:qj});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kj(t,e,n){const s=R(t,"inputIndices","sparseReshape","int32"),o=R(e,"inputShape","sparseReshape","int32"),r=R(n,"newShape","sparseReshape","int32");if(s.rank!==2)throw new Error(`Input indices should be Tensor2D but received shape
        ${s.shape}`);if(o.rank!==1)throw new Error(`Input shape should be Tensor1D but received shape ${o.shape}`);if(r.rank!==1)throw new Error(`New shape should be Tensor1D but received shape ${r.shape}`);const i={inputIndices:s,inputShape:o,newShape:r},a=W.runKernel(Tx,i);return{outputIndices:a[0],outputShape:a[1]}}const ade=U({sparseReshape_:Kj});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xj(t,e,n){const s=R(t,"data","sparseSegmentMean"),o=R(e,"indices","sparseSegmentMean","int32"),r=R(n,"segmentIds","sparseSegmentMean","int32");if(s.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(o.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
          ${o.shape}`);if(r.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
          ${r.shape}`);const i={data:s,indices:o,segmentIds:r};return W.runKernel(Nx,i)}const lde=U({sparseSegmentMean_:Xj});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yj(t,e,n){const s=R(t,"data","sparseSegmentSum"),o=R(e,"indices","sparseSegmentSum","int32"),r=R(n,"segmentIds","sparseSegmentSum","int32");if(s.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(o.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
         ${o.shape}`);if(r.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
         ${r.shape}`);const i={data:s,indices:o,segmentIds:r};return W.runKernel(Ax,i)}const cde=U({sparseSegmentSum_:Yj});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zj(t,e,n,s,o,r,i,a){const l=R(t,"data","stringNGrams","string");if(l.dtype!=="string")throw new Error("Data must be of datatype string");if(l.shape.length!==1)throw new Error(`Data must be a vector, saw: ${l.shape}`);const c=R(e,"dataSplits","stringNGrams");if(c.dtype!=="int32")throw new Error("Data splits must be of datatype int32");const u={separator:n,nGramWidths:s,leftPad:o,rightPad:r,padWidth:i,preserveShortSequences:a},h={data:l,dataSplits:c},d=W.runKernel(Ox,h,u);return{nGrams:d[0],nGramsSplits:d[1]}}const ude=U({stringNGrams_:Zj});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qj(t,e,n=!0){const s=R(t,"input","stringSplit","string"),o=R(e,"delimiter","stringSplit","string");if(s.rank!==1)throw new Error(`Input should be Tensor1D but received shape ${s.shape}`);if(o.rank!==0)throw new Error(`Delimiter should be a scalar but received shape ${o.shape}`);const r={skipEmpty:n},i={input:s,delimiter:o},a=W.runKernel(Fx,i,r);return{indices:a[0],values:a[1],shape:a[2]}}const hde=U({stringSplit_:Qj});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jj(t,e){const n=R(t,"input","stringToHashBucketFast","string"),s={numBuckets:e};if(e<=0)throw new Error("Number of buckets must be at least 1");const o={input:n};return W.runKernel(Lx,o,s)}const dde=U({stringToHashBucketFast_:Jj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mh={flipLeftRight:ej,grayscaleToRGB:nj,resizeNearestNeighbor:Sk,resizeBilinear:Ek,rotateWithOffset:oj,cropAndResize:QG,nonMaxSuppression:ij,nonMaxSuppressionAsync:pj,nonMaxSuppressionWithScore:gj,nonMaxSuppressionWithScoreAsync:xj,nonMaxSuppressionPadded:vj,nonMaxSuppressionPaddedAsync:Cj,threshold:Ej,transform:Tj},eq={bandPart:Aj,gramSchmidt:Dj,qr:Fj};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jr extends Il{minimize(e,n=!1,s){const{value:o,grads:r}=this.computeGradients(e,s);if(s!=null){const i=s.map(a=>({name:a.name,tensor:r[a.name]}));this.applyGradients(i)}else this.applyGradients(r);return tt(r),n?o:(o.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,n){return eH(e,n)}dispose(){this.iterations_!=null&&tt(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:Ge(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(Jr,Symbol.hasInstance,{value:t=>t.minimize!=null&&t.computeGradients!=null&&t.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Sy extends Jr{constructor(e,n,s=null){super(),this.learningRate=e,this.rho=n,this.epsilon=s,this.accumulatedGrads=[],this.accumulatedUpdates=[],s==null&&(this.epsilon=W.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,o)=>{const r=W.registeredVariables[s],i=!1;this.accumulatedGrads[o]==null&&(this.accumulatedGrads[o]={originalName:`${s}/accum_grad`,variable:J(()=>ut(r).variable(i))}),this.accumulatedUpdates[o]==null&&(this.accumulatedUpdates[o]={originalName:`${s}/accum_var`,variable:J(()=>ut(r).variable(i))});const a=Array.isArray(e)?e[o].tensor:e[s];if(a==null)return;const l=this.accumulatedGrads[o].variable,c=this.accumulatedUpdates[o].variable;J(()=>{const u=ye(V(l,this.rho),V(Nt(a),1-this.rho)),h=V(ze(Wn(ye(c,this.epsilon)),Wn(ye(l,this.epsilon))),a),d=ye(V(c,this.rho),V(Nt(h),1-this.rho));l.assign(u),c.assign(d);const f=ye(V(h,-this.learningRate),r);r.assign(f)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(tt(this.accumulatedGrads.map(e=>e.variable)),tt(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=e.length/2,s=!1;this.accumulatedGrads=e.slice(0,n).map(o=>({originalName:o.name,variable:o.tensor.variable(s)})),this.accumulatedUpdates=e.slice(n,n*2).map(o=>({originalName:o.name,variable:o.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.rho,n.epsilon)}}Sy.className="Adadelta";ge(Sy);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ty extends Jr{constructor(e,n=.1){super(),this.learningRate=e,this.initialAccumulatorValue=n,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,o)=>{const r=W.registeredVariables[s];this.accumulatedGrads[o]==null&&(this.accumulatedGrads[o]={originalName:`${s}/accumulator`,variable:J(()=>yp(r.shape,this.initialAccumulatorValue).variable(!1))});const i=Array.isArray(e)?e[o].tensor:e[s];if(i==null)return;const a=this.accumulatedGrads[o].variable;J(()=>{const l=ye(a,Nt(i));a.assign(l);const c=ye(V(ze(i,Wn(ye(l,W.backend.epsilon()))),-this.learningRate),r);r.assign(c)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&tt(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulatedGrads=e.map(s=>({originalName:s.name,variable:s.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,n){return new e(n.learningRate,n.initialAccumulatorValue)}}Ty.className="Adagrad";ge(Ty);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ny extends Jr{constructor(e,n,s,o=null){super(),this.learningRate=e,this.beta1=n,this.beta2=s,this.epsilon=o,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],J(()=>{this.accBeta1=Ge(n).variable(),this.accBeta2=Ge(s).variable()}),o==null&&(this.epsilon=W.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(s=>s.name):Object.keys(e);J(()=>{const s=Pe(1,this.accBeta1),o=Pe(1,this.accBeta2);n.forEach((r,i)=>{const a=W.registeredVariables[r],l=!1;this.accumulatedFirstMoment[i]==null&&(this.accumulatedFirstMoment[i]={originalName:`${r}/m`,variable:J(()=>ut(a).variable(l))}),this.accumulatedSecondMoment[i]==null&&(this.accumulatedSecondMoment[i]={originalName:`${r}/v`,variable:J(()=>ut(a).variable(l))});const c=Array.isArray(e)?e[i].tensor:e[r];if(c==null)return;const u=this.accumulatedFirstMoment[i].variable,h=this.accumulatedSecondMoment[i].variable,d=ye(V(u,this.beta1),V(c,1-this.beta1)),f=ye(V(h,this.beta2),V(Nt(c),1-this.beta2)),p=ze(d,s),g=ze(f,o);u.assign(d),h.assign(f);const b=ye(V(ze(p,ye(Wn(g),this.epsilon)),-this.learningRate),a);a.assign(b)}),this.accBeta1.assign(V(this.accBeta1,this.beta1)),this.accBeta2.assign(V(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&tt(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&tt(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e),J(()=>{this.accBeta1.assign(ll(this.beta1,this.iterations_+1)),this.accBeta2.assign(ll(this.beta2,this.iterations_+1))});const n=e.length/2,s=!1;this.accumulatedFirstMoment=e.slice(0,n).map(o=>({originalName:o.name,variable:o.tensor.variable(s)})),this.accumulatedSecondMoment=e.slice(n,n*2).map(o=>({originalName:o.name,variable:o.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon)}}Ny.className="Adam";ge(Ny);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ay extends Jr{constructor(e,n,s,o=null,r=0){super(),this.learningRate=e,this.beta1=n,this.beta2=s,this.epsilon=o,this.decay=r,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],J(()=>{this.iteration=Ge(0).variable(),this.accBeta1=Ge(n).variable()}),o==null&&(this.epsilon=W.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(s=>s.name):Object.keys(e);J(()=>{const s=Pe(1,this.accBeta1),o=ze(-this.learningRate,ye(V(this.iteration,this.decay),1));n.forEach((r,i)=>{const a=W.registeredVariables[r],l=!1;this.accumulatedFirstMoment[i]==null&&(this.accumulatedFirstMoment[i]={originalName:`${r}/m`,variable:ut(a).variable(l)}),this.accumulatedWeightedInfNorm[i]==null&&(this.accumulatedWeightedInfNorm[i]={originalName:`${r}/v`,variable:ut(a).variable(l)});const c=Array.isArray(e)?e[i].tensor:e[r];if(c==null)return;const u=this.accumulatedFirstMoment[i].variable,h=this.accumulatedWeightedInfNorm[i].variable,d=ye(V(u,this.beta1),V(c,1-this.beta1)),f=V(h,this.beta2),p=dn(c),g=Yr(f,p);u.assign(d),h.assign(g);const b=ye(V(ze(o,s),ze(d,ye(g,this.epsilon))),a);a.assign(b)}),this.iteration.assign(ye(this.iteration,1)),this.accBeta1.assign(V(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&tt(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&tt(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon,n.decay)}}Ay.className="Adamax";ge(Ay);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $p extends Jr{constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,o)=>{const r=Array.isArray(e)?e[o].tensor:e[s];if(r==null)return;const i=W.registeredVariables[s];J(()=>{const a=ye(V(this.c,r),i);i.assign(a)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=Uo(Ge(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(e=await this.extractIterations(e),e.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,n){return new e(n.learningRate)}}$p.className="SGD";ge($p);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ry extends $p{constructor(e,n,s=!1){super(e),this.learningRate=e,this.momentum=n,this.useNesterov=s,this.accumulations=[],this.m=Ge(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,o)=>{const r=W.registeredVariables[s];this.accumulations[o]==null&&(this.accumulations[o]={originalName:`${s}/momentum`,variable:J(()=>ut(r).variable(!1))});const i=this.accumulations[o].variable,a=Array.isArray(e)?e[o].tensor:e[s];a!=null&&J(()=>{let l;const c=ye(V(this.m,i),a);this.useNesterov?l=ye(V(this.c,ye(a,V(c,this.m))),r):l=ye(V(this.c,c),r),i.assign(c),r.assign(l)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&tt(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulations=e.map(s=>({originalName:s.name,variable:s.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,n){return new e(n.learningRate,n.momentum,n.useNesterov)}}Ry.className="Momentum";ge(Ry);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Dy extends Jr{constructor(e,n=.9,s=0,o=null,r=!1){if(super(),this.learningRate=e,this.decay=n,this.momentum=s,this.epsilon=o,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=r,o==null&&(this.epsilon=W.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,o)=>{const r=W.registeredVariables[s],i=!1;this.accumulatedMeanSquares[o]==null&&(this.accumulatedMeanSquares[o]={originalName:`${s}/rms`,variable:J(()=>ut(r).variable(i))}),this.accumulatedMoments[o]==null&&(this.accumulatedMoments[o]={originalName:`${s}/momentum`,variable:J(()=>ut(r).variable(i))}),this.accumulatedMeanGrads[o]==null&&this.centered&&(this.accumulatedMeanGrads[o]={originalName:`${s}/mg`,variable:J(()=>ut(r).variable(i))});const a=Array.isArray(e)?e[o].tensor:e[s];if(a==null)return;const l=this.accumulatedMeanSquares[o].variable,c=this.accumulatedMoments[o].variable;J(()=>{const u=ye(V(l,this.decay),V(Nt(a),1-this.decay));if(this.centered){const h=this.accumulatedMeanGrads[o].variable,d=ye(V(h,this.decay),V(a,1-this.decay)),f=ze(V(a,this.learningRate),Wn(Pe(u,ye(Nt(d),this.epsilon)))),p=ye(V(c,this.momentum),f);l.assign(u),h.assign(d),c.assign(p);const g=Pe(r,p);r.assign(g)}else{const h=ye(V(l,this.decay),V(Nt(a),1-this.decay)),d=ye(V(c,this.momentum),ze(V(a,this.learningRate),Wn(ye(h,this.epsilon))));l.assign(h),c.assign(d);const f=Pe(r,d);r.assign(f)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&tt(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&tt(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&tt(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=this.centered?e.length/3:e.length/2,s=!1;this.accumulatedMeanSquares=e.slice(0,n).map(o=>({originalName:o.name,variable:o.tensor.variable(s)})),this.accumulatedMoments=e.slice(n,n*2).map(o=>({originalName:o.name,variable:o.tensor.variable(s)})),this.centered&&(this.accumulatedMeanGrads=e.slice(n*2,n*3).map(o=>({originalName:o.name,variable:o.tensor.variable(s)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,n){return new e(n.learningRate,n.decay,n.momentum,n.epsilon,n.centered)}}Dy.className="RMSProp";ge(Dy);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yi{static sgd(e){return new $p(e)}static momentum(e,n,s=!1){return new Ry(e,n,s)}static rmsprop(e,n=.9,s=0,o=null,r=!1){return new Dy(e,n,s,o,r)}static adam(e=.001,n=.9,s=.999,o=null){return new Ny(e,n,s,o)}static adadelta(e=.001,n=.95,s=null){return new Sy(e,n,s)}static adamax(e=.002,n=.9,s=.999,o=null,r=0){return new Ay(e,n,s,o,r)}static adagrad(e,n=.1){return new Ty(e,n)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ta={sgd:yi.sgd,momentum:yi.momentum,adadelta:yi.adadelta,adagrad:yi.adagrad,rmsprop:yi.rmsprop,adamax:yi.adamax,adam:yi.adam};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tq=(()=>typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:t=>t())();function Tk(){return new Promise(t=>tq(()=>t()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oy(t,e){const n=t[0].length;t.forEach((o,r)=>{T(o.length===n,()=>`Error in concat${n}D: rank of tensors[${r}] must be the same as the rank of the rest (${n})`)}),T(e>=0&&e<n,()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`);const s=t[0];t.forEach((o,r)=>{for(let i=0;i<n;i++)T(i===e||o[i]===s[i],()=>`Error in concat${n}D: Shape of tensors[${r}] (${o}) does not match the shape of the rest (${s}) along the non-concatenated axis ${r}.`)})}function Po(t,e){const n=t[0].slice();for(let s=1;s<t.length;s++)n[e]+=t[s][e];return n}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var lo;(function(t){t[t.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",t[t.VALUE_ROWIDS=1]="VALUE_ROWIDS",t[t.ROW_LENGTHS=2]="ROW_LENGTHS",t[t.ROW_SPLITS=3]="ROW_SPLITS",t[t.ROW_LIMITS=4]="ROW_LIMITS",t[t.ROW_STARTS=5]="ROW_STARTS"})(lo||(lo={}));function Nk(t,e,n){let s=new Array;if(n==null&&e==null)return s;if(e==null)for(;s.length<t+n.length;)s.push(-1);else s=e.slice();if(n==null)return s;if(t+n.length!==s.length)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.rank = ${t+n.length}, but shape.rank = ${s.length}`);for(let o=1;o<n.length;++o){const r=n[o],i=s[s.length-n.length+o],a=s[i];if(r>=0)if(a>=0){if(a!==r)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.shape[${o+t}] = ${r} but shape[${o+t}] = ${a}`)}else s[i]=r}return s}function Ak(t){const e={FIRST_DIM_SIZE:lo.FIRST_DIM_SIZE,VALUE_ROWIDS:lo.VALUE_ROWIDS,ROW_LENGTHS:lo.ROW_LENGTHS,ROW_SPLITS:lo.ROW_SPLITS,ROW_LIMITS:lo.ROW_LIMITS,ROW_STARTS:lo.ROW_STARTS},n=[];for(const s of t)if(s in e)n.push(e[s]);else break;return n}function Rk(t){return t.length===0?0:t[0]===lo.FIRST_DIM_SIZE?t.length-1:t.length}function Dk(t,e){if(t==null||e==null)return;const n=t.length,s=e.length;if(n>=s)throw new Error(`defaultValue.shape=${t} and ragged tensor flatValues.shape=${e}, are incompatible: defaultValue.rank = ${n} must be less than ragged tensor input flatValues.rank = ${s})`);for(let o=0;o<Math.min(n,s-1);++o){const r=t[o],i=e[o+1];if(r>=0&&i>=0&&r!==1&&r!==i)throw new Error(`defaultValue.shape=${t}, and ragged tensor input flatValues.shape=${e} are incompatible: defaultValue.shape[${o-t.length}] = ${r} but ragged tensor input.flatValues.shape[${o-t.length}] = ${i}`)}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fy=30;function Ip(t){return t<=Fy?t:Lg(t,Math.floor(Math.sqrt(t)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ly(t,e,n){const s=n*(typeof t=="number"?t:t[0]),o=e*(typeof t=="number"?t:t[1]);return[s,o]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zu(t,e,n,s=!0){let o=[];if(s)o=o.concat(e.slice(0)),o.push(t[0]/n),o=o.concat(t.slice(1));else{o=o.concat(t[0]);const r=e.length;for(let i=0;i<r;++i)o=o.concat([t[i+1]/e[i],e[i]]);o=o.concat(t.slice(r+1))}return o}function Wu(t,e,n=!0){const s=[];if(n){s.push(e);for(let o=e+1;o<t;++o)o<=2*e?(s.push(o),s.push(o-(e+1))):s.push(o)}else{const o=[],r=[];for(let i=1;i<t;++i)i>=e*2+1||i%2===1?r.push(i):o.push(i);s.push(...o),s.push(0),s.push(...r)}return s}function Uu(t,e,n,s=!0){const o=[];s?o.push(t[0]/n):o.push(t[0]*n);for(let r=1;r<t.length;++r)r<=e.length?s?o.push(e[r-1]*t[r]):o.push(t[r]/e[r-1]):o.push(t[r]);return o}function Py(t,e){const n=[0];for(let s=0;s<e;++s)n.push(t[s][0]);return n}function My(t,e,n){const s=t.slice(0,1);for(let o=0;o<n;++o)s.push(t[o+1]-e[o][0]-e[o][1]);return s}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _p=1.7580993408473768,kp=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const By=.3275911,Vy=.254829592,zy=-.284496736,Wy=1.421413741,Uy=-1.453152027,Hy=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ar(t,e){if(t.length!==e.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${t.length}, imag: ${e.length}.`);const n=new Float32Array(t.length*2);for(let s=0;s<n.length;s+=2)n[s]=t[s/2],n[s+1]=e[s/2];return n}function Ok(t){const e=new Float32Array(t.length/2),n=new Float32Array(t.length/2);for(let s=0;s<t.length;s+=2)e[s/2]=t[s],n[s/2]=t[s+1];return{real:e,imag:n}}function Fk(t){const e=Math.ceil(t.length/4),n=new Float32Array(e),s=new Float32Array(e);for(let o=0;o<t.length;o+=4)n[Math.floor(o/4)]=t[o],s[Math.floor(o/4)]=t[o+1];return{real:n,imag:s}}function Lk(t){const e=Math.floor(t.length/4),n=new Float32Array(e),s=new Float32Array(e);for(let o=2;o<t.length;o+=4)n[Math.floor(o/4)]=t[o],s[Math.floor(o/4)]=t[o+1];return{real:n,imag:s}}function Gy(t,e){const n=t[e*2],s=t[e*2+1];return{real:n,imag:s}}function Pk(t,e,n,s){t[s*2]=e,t[s*2+1]=n}function Mk(t,e){const n=new Float32Array(t/2),s=new Float32Array(t/2);for(let o=0;o<Math.ceil(t/2);o++){const r=(e?2:-2)*Math.PI*(o/t);n[o]=Math.cos(r),s[o]=Math.sin(r)}return{real:n,imag:s}}function Bk(t,e,n){const s=(n?2:-2)*Math.PI*(t/e),o=Math.cos(s),r=Math.sin(s);return{real:o,imag:r}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qm="->",nq=/->/g,qw=",",Kw="...";function jy(t,e){t=t.replace(/\s/g,"");const n=(t.length-t.replace(nq,"").length)/qm.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error(`Equation must contain exactly one arrow ("${qm}").`);const[s,o]=t.split(qm);T(s.indexOf(Kw)===-1,()=>`The ellipsis notation ("${Kw}") is not supported yet.`);const r=s.split(qw),i=r.length;if(e!==i)throw new Error(`Expected ${i} input tensors, received ${e}`);if(i>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const a=[];for(let d=0;d<o.length;++d){const f=o[d];if(!r.some(p=>p.indexOf(f)!==-1))throw new Error(`Output subscripts contain the label ${f} not present in the input subscripts.`);a.indexOf(f)===-1&&a.push(f)}for(let d=0;d<s.length;++d){const f=s[d];a.indexOf(f)===-1&&f!==qw&&a.push(f)}const l=new Array(r.length);for(let d=0;d<i;++d){if(new Set(r[d].split("")).size!==r[d].length)throw new Error(`Found duplicate axes in input component ${r[d]}. Support for duplicate axes in input is not implemented yet.`);l[d]=[];for(let f=0;f<r[d].length;++f)l[d].push(a.indexOf(r[d][f]))}const c=a.length,u=o.length,h=[];for(let d=u;d<c;++d)h.push(d);return{allDims:a,summedDims:h,idDims:l}}function qy(t,e){let n=new Array(t);n.fill(-1);for(let o=0;o<e.length;++o)n[e[o]]=o;const s=[];for(let o=0;o<t;++o)n[o]===-1&&s.push(o);return n=n.filter(o=>o!==-1),{permutationIndices:n,expandDims:s}}function Ky(t,e,n){const s=new Array(t);for(let o=0;o<n.length;++o){const r=n[o].shape;for(let i=0;i<e[o].length;++i)s[e[o][i]]===void 0?s[e[o][i]]=r[i]:T(s[e[o][i]]===r[i],()=>`Expected dimension ${s[e[o][i]]} at axis ${i} of input shaped ${JSON.stringify(r)}, but got dimension ${r[i]}`)}}function Xy(t,e){const n=t,s=[];let o=0;t.length===0&&n.push(-1),o=t.length+1;for(let i=0;i<o;++i)s.push([]);const r=[];for(let i=0;i<n.length;++i){const a=n[i],l=sq(e,a);for(const c of l)r.indexOf(c)===-1&&(s[i].push(c),r.push(c))}return{path:n,steps:s}}function Yy(t){return t.every((e,n)=>e===n)}function sq(t,e){const n=[];for(let s=0;s<t.length;++s)(t[s].length===0||t[s].indexOf(e)!==-1||e===-1)&&n.push(s);return n}function Zy(t,e,n=0){let s=[];if(typeof e=="number")T(t.shape[n]%e===0,()=>"Number of splits must evenly divide the axis."),s=new Array(e).fill(t.shape[n]/e);else{const o=e.reduce((i,a)=>(a===-1&&(i+=1),i),0);T(o<=1,()=>"There should be only one negative value in split array.");const r=e.indexOf(-1);if(r!==-1){const i=e.reduce((a,l)=>l>0?a+l:a);e[r]=t.shape[n]-i}T(t.shape[n]===e.reduce((i,a)=>i+a),()=>"The sum of sizes must match the size of the axis dimension."),s=e}return s}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vk(t){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${t}`}function zk(t,e){return`indices(${t}, 0) is invalid: ${e} < 0`}function Wk(t,e,n){return`indices(${t}, 0) is invalid: ${e} >= ${n}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uk(t,e){return`only one output dimension may be -1, not both ${t} and ${e}`}function Hk(t,e){return`size ${t} must be non-negative, not ${e}`}function Gk(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function jk(t,e){const n=ae(t),s=ae(e);return`Input to reshape is a SparseTensor with ${n}
  dense values, but the requested shape requires a multiple of ${s}. inputShape=${t} outputShape= ${e}`}function qk(t,e){const n=ae(t),s=ae(e);return`Input to reshape is a tensor with ${n} dense values, but the requested shape has ${s}. inputShape=${t} outputShape=${e}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sb(){return"segment ids must be >= 0"}function Kk(){return"segment ids are not increasing"}function Xk(t,e){return`Segment id ${t} out of range [0, ${e}), possibly because segmentIds input is not sorted.`}function Yk(t,e,n){return`Bad: indices[${t}] == ${e} out of range [0, ${n})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zk(t,e){let n=!1,s;for(t<=Fy?(s=t,n=!0):s=Lg(t,Math.floor(Math.sqrt(t)));!n;)s>e||s===t?n=!0:s=Lg(t,s+1);return s}function Qk(t,e,n){const s=[],o=t.length;for(let r=0;r<o;r++)r!==e?s.push(t[r]):s.push(n);return s}function Qy(t,e,n,s){const o=e.shape.length,r=t.shape.length;if(s!==0&&(s<-o||s>o))throw new Error(`Expect batchDims in the range of [-${o}, ${o}], but got ${s}`);if(s<0&&(s+=o),s>r)throw new Error(`batchDims (${s}) must be less than rank(x) (
    ${r}).`);if(n<s)throw new Error(`batchDims (${s}) must be less than or equal to axis (${n}).`);for(let h=0;h<s;++h)if(t.shape[h]!==e.shape[h])throw new Error(`x.shape[${h}]: ${t.shape[h]} should be equal to indices.shape[${h}]: ${e.shape[h]}.`);const i=t.shape[n],a=[];let l=1,c=1,u=1;for(let h=0;h<s;++h)a.push(t.shape[h]),l*=t.shape[h];for(let h=s;h<n;h++)a.push(t.shape[h]),c*=t.shape[h];for(let h=s;h<o;h++)a.push(e.shape[h]);for(let h=n+1;h<r;h++)a.push(t.shape[h]),u*=t.shape[h];return{batchSize:l,sliceSize:u,outerSize:c,dimSize:i,outputShape:a}}const oq=Object.freeze(Object.defineProperty({__proto__:null,segOpComputeOptimalWindowSize:Zk,computeOutShape:Qk,collectGatherOpShapeInfo:Qy},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ji(t){try{return t.map(e=>Mr(e))}catch(e){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${e}`)}}function Jk(t){return t.map(e=>Or(e))}const rq=Object.freeze(Object.defineProperty({__proto__:null,slice_util:WW,segment_util:oq,fromUint8ToStringArray:Ji,fromStringArrayToUint8:Jk,upcastType:ds,axesAreInnerMostDims:ry,combineLocations:Z_,computeOutAndReduceShapes:yn,expandShapeToKeepDim:Yt,assertAxesAreInnerMostDims:_n,getAxesPermutation:jt,getUndoAxesPermutation:Xr,getInnerMostAxes:Zt,getBroadcastDims:al,getReductionAxes:un,assertAndGetBroadcastShape:Ye,assertParamsConsistent:Oy,computeOutShape:Po,computeDilation2DInfo:Pu,computePool2DInfo:Zs,computePool3DInfo:ur,computeConv2DInfo:In,computeConv3DInfo:Kr,computeDefaultPad:Qx,tupleValuesAreOne:Ki,eitherStridesOrDilationsAreOne:Pn,convertConv2DDataFormat:hr,checkPadOnDimRoundingMode:is,getFusedDyActivation:vy,getFusedBiasGradient:wy,applyActivation:Cy,shouldFuse:$y,get RowPartitionType(){return lo},combineRaggedTensorToTensorShapes:Nk,getRowPartitionTypesHelper:Ak,getRaggedRank:Rk,validateDefaultValueShape:Dk,PARALLELIZE_THRESHOLD:Fy,computeOptimalWindowSize:Ip,getImageCenter:Ly,getReshaped:zu,getPermuted:Wu,getReshapedPermuted:Uu,getSliceBeginCoords:Py,getSliceSize:My,prepareAndValidate:jx,validateUpdateShape:F_,validateInput:PW,calculateShapes:Lu,SELU_SCALEALPHA:_p,SELU_SCALE:kp,ERF_P:By,ERF_A1:Vy,ERF_A2:zy,ERF_A3:Wy,ERF_A4:Uy,ERF_A5:Hy,warn:Cs,log:xz,mergeRealAndImagArrays:ar,splitRealAndImagArrays:Ok,complexWithEvenIndex:Fk,complexWithOddIndex:Lk,getComplexWithIndex:Gy,assignToTypedArray:Pk,exponents:Mk,exponent:Bk,decodeEinsumEquation:jy,getEinsumPermutation:qy,checkEinsumDimSizes:Ky,getEinsumComputePath:Xy,isIdentityPermutation:Yy,prepareSplitSize:Zy,getSparseFillEmptyRowsIndicesDenseShapeMismatch:Vk,getSparseFillEmptyRowsNegativeIndexErrorMessage:zk,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:Wk,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:Uk,getSparseReshapeNegativeOutputDimErrorMessage:Hk,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:Gk,getSparseReshapeInputOutputMultipleErrorMessage:jk,getSparseReshapeInputOutputMismatchErrorMessage:qk,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:sb,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:Kk,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:Xk,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:Yk},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eE={kernelName:hf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>V(t,Vu(Ae(n,"float32"),-1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iq={kernelName:zc,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=Nt(Ae(n,"float32")),o=Wn(Pe(Ge(1),s));return Gt(ze(t,o))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aq={kernelName:Wc,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=Wn(Pe(Nt(Ae(n,"float32")),1));return ze(t,s)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lq={kernelName:$l,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,o=Ye(n.shape,s.shape);return{a:()=>{let a=t;const l=un(n.shape,o);return l.length>0&&(a=Le(a,l)),j(a,n.shape)},b:()=>{let a=t;const l=un(s.shape,o);return l.length>0&&(a=Le(a,l)),j(a,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cq={kernelName:Zb,saveAllInputs:!0,gradFunc:(t,e)=>{const n={};return e.forEach((s,o)=>{n[o]=()=>t.clone()}),n}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uq={kernelName:df,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ut(n)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hq={kernelName:ff,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ut(n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dq={kernelName:Uc,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ze(t,Wn(Pe(Ge(1),Nt(Ae(n,"float32")))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fq={kernelName:Hc,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=Wn(ye(Ge(1),Nt(Ae(n,"float32"))));return ze(t,s)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pq={kernelName:qc,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,o=Ye(n.shape,s.shape);return{a:()=>{const a=ye(Nt(n),Nt(s));let l=V(t,ze(s,a));const c=un(n.shape,o);return c.length>0&&(l=Le(l,c)),j(l,n.shape)},b:()=>{const a=ye(Nt(n),Nt(s));let l=Gt(V(t,ze(n,a)));const c=un(s.shape,o);return c.length>0&&(l=Le(l,c)),j(l,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mq={kernelName:Gc,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ze(t,ye(Nt(Ae(n,"float32")),1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gq={kernelName:jc,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ze(t,Pe(Ge(1),Nt(Ae(n,"float32"))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bq(t,e,n,s,o,r){const i=R(t,"dy","avgPool3dGrad"),a=R(e,"input","avgPool3dGrad");let l=i,c=a,u=!1;a.rank===4&&(u=!0,l=j(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]]),c=j(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),T(l.rank===5,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${l.rank}.`),T(c.rank===5,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${c.rank}.`),is("avgPool3dGrad",o,r);const h={dy:l,input:c},d={filterSize:n,strides:s,pad:o,dimRoundingMode:r},f=W.runKernel(tx,h,d);return u?j(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const xq=U({avgPool3dGrad_:bq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yq={kernelName:mf,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{filterSize:o,strides:r,pad:i,dimRoundingMode:a}=n;return{x:()=>xq(t,s,o,r,i,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vq(t,e,n,s,o){const r=R(t,"dy","avgPoolGrad"),i=R(e,"input","avgPoolGrad");T(i.rank===r.rank,()=>`Rank of input (${i.rank}) does not match rank of dy (${r.rank})`);let a=i,l=r,c=!1;i.rank===3&&(c=!0,a=j(i,[1,i.shape[0],i.shape[1],i.shape[2]]),l=j(r,[1,r.shape[0],r.shape[1],r.shape[2]])),T(l.rank===4,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${l.rank}.`),T(a.rank===4,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${a.rank}.`);const u={dy:l,input:a},h={filterSize:n,strides:s,pad:o},d=W.runKernel(ex,u,h);return c?j(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const wq=U({avgPoolGrad_:vq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cq={kernelName:pf,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{filterSize:o,strides:r,pad:i}=n;return{x:()=>wq(t,s,o,r,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $q={kernelName:gf,inputsToSave:["a","b"],gradFunc:(t,e,n)=>{const[s,o]=e,{transposeA:r,transposeB:i}=n;return!r&&!i?{a:()=>gt(t,o,!1,!0),b:()=>gt(s,t,!0,!1)}:!r&&i?{a:()=>gt(t,o,!1,!1),b:()=>gt(t,s,!0,!1)}:r&&!i?{a:()=>gt(o,t,!1,!0),b:()=>gt(s,t,!1,!1)}:{a:()=>gt(o,t,!0,!0),b:()=>gt(t,s,!0,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Iq={kernelName:bf,gradFunc:(t,e,n)=>{const{blockShape:s,crops:o}=n;return{x:()=>fy(t,s,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _q={kernelName:mz,gradFunc:(t,e,n)=>{const s=n,o=s.inputShape,r=s.shape,i=Array.from(r);for(let l=o.length-1;l>=0;l--)if(o[l]===r[l])i[l]=1;else if(o[l]!==1)throw new Error(`broadcastTo(): [${o}] cannot be broadcast to [${r}].`);const a=[];for(let l=0;l<i.length;l++)i[l]>1&&a.push(l);return{x:()=>Le(t,a,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kq={kernelName:Kc,gradFunc:t=>({x:()=>t.clone()})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Eq={kernelName:Xc,gradFunc:t=>({x:()=>ut(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sq={kernelName:Yc,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{clipValueMin:o,clipValueMax:r}=n;return{x:()=>fs(ir(kl(s,o),El(s,r)),t,ut(t))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tq={kernelName:xf,inputsToSave:["x"],gradFunc:eE.gradFunc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nq={kernelName:yf,saveAllInputs:!0,gradFunc:(t,e,n)=>{const s=e.map(l=>l.shape),{axis:o}=n,r=st(o,e[0].shape)[0],i=s.map(l=>l[r]);return _s(t,i,r).map(l=>()=>l)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Aq={kernelName:vf,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[s,o]=e,{dilations:r,strides:i,pad:a,dataFormat:l}=n;return T(Ki(r),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${r}'`),{x:()=>ny(s.shape,t,o,i,a,l),filter:()=>yy(s,t,o.shape,i,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rq={kernelName:wf,inputsToSave:["dy","filter"],gradFunc:(t,e,n)=>{const[s,o]=e,{strides:r,pad:i,dataFormat:a,dimRoundingMode:l}=n;return{dy:()=>Xi(t,o,r,i,a,1,l),filter:()=>yy(t,s,o.shape,r,i,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dq(t,e,n,s,o){let r=t;t.rank===4&&(r=j(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]));let i=e;i.rank===4&&(i=j(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]])),T(r.rank===5,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${r.shape}.`),T(i.rank===5,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${i.shape}.`),T(n.length===5,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${n}.`),T(r.shape[4]===n[3],()=>`Error in conv3dDerFilter: depth of input ${r.shape[4]}) must match input depth in filter (${n[3]}.`),T(i.shape[4]===n[4],()=>`Error in conv3dDerFilter: depth of dy (${i.shape[4]}) must match output depth for filter (${n[4]}).`);const a={x:r,dy:i},l={strides:s,pad:o,filterShape:n};return W.runKernel(rx,a,l)}const Oq=U({conv3DBackpropFilter_:Dq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fq={kernelName:Cf,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:s,strides:o,pad:r}=n;T(Ki(s),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`);const[i,a]=e;return{x:()=>K_(i.shape,t,a,o,r),filter:()=>Oq(i,t,a.shape,o,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lq={kernelName:Zc,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>V(Gt(bk(Ae(n,"float32"))),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pq={kernelName:Qc,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>V(xk(Ae(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mq={kernelName:$f,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{axis:o,exclusive:r,reverse:i}=n;return{x:()=>{const a=jt([o],s.rank);let l=Y_(t,o,r,!i);return a!=null&&(l=lt(l,a)),l}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bq={kernelName:If,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:s,strides:o,pad:r,dimRoundingMode:i}=n,a=s==null?[1,1]:s;T(Ki(a),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${a}'`);const[l,c]=e;return T(l.rank===4,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${l.rank}.`),T(c.rank===4,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${c.rank}.`),T(l.shape[3]===c.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${l.shape[3]}) must match the inChannels dimension in filter ${c.shape[2]}.`),T(Pn(o,a),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${o} and dilations '${a}'.`),is("depthwiseConv2d",r,i),{x:()=>UG(l.shape,t,c,o,r,a,i),filter:()=>zG(l,t,c.shape,o,r,a,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vq={kernelName:_f,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[s,o]=e,r={x:s,filter:o,dy:t},i={x:s,filter:o,dy:t};return{x:()=>W.runKernel(Pg,r,n),filter:()=>W.runKernel(Mg,i,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zq={kernelName:eu,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e,s={dy:t,y:n};return{x:()=>W.runKernel(dx,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wq={kernelName:tu,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,s=V(qs(Gt(Nt(n))),2/Math.sqrt(Math.PI));return{x:()=>V(t,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uq={kernelName:nu,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>V(t,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hq={kernelName:Ef,inputsToSave:["input"],gradFunc:(t,e)=>{const[n]=e;return{input:()=>j(t,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gq={kernelName:su,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>V(t,qs(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jq={kernelName:ou,gradFunc:t=>({x:()=>ut(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qq={kernelName:ru,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,o=Ye(n.shape,s.shape);return{a:()=>{const a=ze(t,Ae(s,"float32")),l=un(n.shape,o);return l.length>0?j(Le(a,l),n.shape):a},b:()=>{let a=V(t,Ae(n,"float32"));const l=un(s.shape,o);l.length>0&&(a=j(Le(a,l),s.shape));const c=Nt(s);return Gt(ze(a,Ae(c,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kq={kernelName:Sf,inputsToSave:["x","mean","variance","scale"],gradFunc:(t,e,n)=>{const{varianceEpsilon:s}=n,[o,r,i,a]=e,l=a==null?Ge(1):a,c=un(r.shape,o.shape),u=[];if(r.rank===1){for(let v=0;v<o.shape.length-1;++v)u.push(o.shape[v]);u.push(1)}const h=Pe(o,r),d=V(t,l),f=pk(ye(i,Ge(s))),p=V(V(V(f,f),f),Ge(-.5));return{x:()=>r.rank===1?j(V(V(t,ho(j(f,[1,1,1,r.shape[0]]),u)),l),o.shape):j(V(V(t,f),l),o.shape),mean:()=>{let v=V(V(f,Ge(-1)),d);return r.rank===1&&(v=Le(v,c)),j(v,r.shape)},variance:()=>{let v=V(V(p,h),d);return r.rank===1&&(v=Le(v,c)),j(v,r.shape)},scale:()=>{const v=V(h,f);let $=V(t,v);return r.rank===1&&($=Le($,c)),j($,r.shape)},offset:()=>{let v=t;return r.rank===1&&(v=Le(v,c)),j(v,r.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xq={kernelName:Tf,inputsToSave:["x","indices"],gradFunc:(t,e,n)=>{const[s,o]=e,{axis:r}=n,i=st(r,s.shape)[0];return{x:()=>{const l=s.shape,c=o.size,u=l.slice(0,i),h=u.length,d=l.slice(r,l.length).slice(1),f=d.length,p=Xw(0,h),g=Xw(h+1,h+1+f),b=Yw([u,[c],d]),x=j(t,b),y=j(o,[c]),w=Yw([[h],p,g]),v=lt(x,w);let $=Ik(v,y,s.shape[i]);const _=Xr(w);return $=lt($,_),$},indices:()=>o}}};function Xw(t,e){const n=[];for(let s=t;s<e;++s)n.push(s);return n}function Yw(t){const e=[];for(let n=0;n<t.length;++n)for(let s=0;s<t[n].length;++s)e.push(t[n][s]);return e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yq={kernelName:iu,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e;return{a:()=>ut(n),b:()=>ut(s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zq={kernelName:au,gradFunc:t=>({x:()=>Ae(t,"float32")})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qq={kernelName:lu,gradFunc:t=>({x:()=>ut(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jq={kernelName:cu,gradFunc:t=>({x:()=>ut(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eK={kernelName:uu,gradFunc:t=>({x:()=>ut(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tK={kernelName:Af,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{alpha:o}=n,r=Qs(s,0);return{x:()=>fs(r,t,V(t,o))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nK={kernelName:du,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ze(t,ye(n,1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sK={kernelName:hu,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ze(t,Ae(n,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oK={kernelName:gz,inputsToSave:[],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s]=e,{axis:o}=n;return{logits:()=>{const i=qs(s);return Pe(t,V(Le(t,o,!0),i))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rK(t,e,n,s=5,o=1,r=1,i=.5){const a={x:t,y:e,dy:n},l={depthRadius:s,bias:o,alpha:r,beta:i};return W.runKernel(xx,a,l)}const iK=U({localResponseNormalizationBackprop_:rK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aK={kernelName:Pf,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s,o]=e,{depthRadius:r,bias:i,alpha:a,beta:l}=n;return{x:()=>iK(s,o,t,r,i,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tE(t,e,n,s){return e.rank<n.rank&&(e=j(e,Yt(e.shape,s))),t.rank<n.rank&&(t=j(t,Yt(t.shape,s))),{x:()=>V(t,Ae(Ho(n,e),t.dtype))}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zw={kernelName:Mf,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const s=n,{reductionIndices:o}=s,r=e[0],i=e[1],a=st(o,r.shape),l=tE(t,i,r,a);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lK={kernelName:fu,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e;return{a:()=>V(t,Ae(kl(n,s),"float32")),b:()=>V(t,Ae(ek(n,s),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cK(t,e,n,s,o,r,i){const a=R(t,"dy","maxPool3dGrad"),l=R(e,"input","maxPool3dGrad"),c=R(n,"output","maxPool3dGrad");let u=a,h=l,d=c,f=!1;l.rank===4&&(f=!0,u=j(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]]),h=j(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),d=j(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]])),T(u.rank===5,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${u.rank}.`),T(h.rank===5,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${h.rank}.`),T(d.rank===5,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${d.rank}.`),is("maxPool3dGrad",r,i);const p={dy:u,input:h,output:d},g={filterSize:s,strides:o,pad:r,dimRoundingMode:i},b=W.runKernel(vx,p,g);return f?j(b,[b.shape[1],b.shape[2],b.shape[3],b.shape[4]]):b}const uK=U({maxPool3dGrad_:cK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hK={kernelName:Vf,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s,o]=e,{filterSize:r,strides:i,pad:a,dimRoundingMode:l}=n;return{x:()=>uK(t,s,o,r,i,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dK(t,e,n,s,o,r,i){const a=R(t,"dy","maxPoolGrad"),l=R(e,"input","maxPoolGrad"),c=R(n,"output","maxPoolGrad");T(l.rank===a.rank,()=>`Rank of input (${l.rank}) does not match rank of dy (${a.rank})`),T(a.rank===4,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${a.rank}.`),T(l.rank===4,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${l.rank}.`),is("maxPoolGrad",r,i);const u={dy:a,input:l,output:c},h={filterSize:s,strides:o,pad:r,dimRoundingMode:i};return W.runKernel(yx,u,h)}const fK=U({maxPoolGrad_:dK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pK={kernelName:Bf,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s,o]=e,{filterSize:r,strides:i,pad:a}=n;return{x:()=>fK(t,s,o,r,i,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mK={kernelName:zf,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{axis:o}=n,r=st(o,s.shape),a=yn(s.shape,r)[1],l=ae(a);return{x:()=>{const u=s.shape.slice();r.forEach(f=>{u[f]=1});const h=j(t,u);return ze(V(h,Zr(s.shape,"float32")),l)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gK={kernelName:Wf,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const s=n,{axis:o}=s,[r,i]=e,a=st(o,r.shape),l=tE(t,i,r,a);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bK={kernelName:pu,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e;return{a:()=>V(t,Ae(El(n,s),"float32")),b:()=>V(t,Ae(Qs(n,s),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xK={kernelName:Uf,inputsToSave:["x"],gradFunc:(t,e,n)=>{const s=e[0],{paddings:o}=n,r=o.map(i=>i[0]);return{x:()=>$t(t,r,s.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yK={kernelName:mu,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,o=Ye(n.shape,s.shape);return{a:()=>{const a=un(n.shape,o);return a.length>0?j(Le(t,a),n.shape):t},b:()=>{const a=V(t,Gt(vp(ze(n,s)))),l=un(s.shape,o);return l.length>0?j(Le(a,l),s.shape):a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vK={kernelName:gu,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,o=Ye(n.shape,s.shape);return{a:()=>{const a=V(t,Ae(s,"float32")),l=un(n.shape,o);return l.length>0?j(Le(a,l),n.shape):a},b:()=>{const a=V(t,Ae(n,"float32")),l=un(s.shape,o);return l.length>0?j(Le(a,l),s.shape):a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wK={kernelName:Hf,gradFunc:t=>({x:()=>Gt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CK={kernelName:qf,inputsToSave:["indices"],gradFunc:(t,e)=>{const n=e[0];return{indices:()=>gn(n.shape,"float32")}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $K={kernelName:jf,gradFunc:t=>({x:()=>ut(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IK={kernelName:Kf,saveAllInputs:!0,gradFunc:(t,e,n)=>{const{axis:s}=n;return cl(t,s).map(r=>()=>r)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qw={kernelName:Xf,inputsToSave:["x"],gradFunc:(t,e,n)=>{const s=e[0],{paddings:o}=n,r=o.map(i=>i[0]);return{x:()=>$t(t,r,s.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _K={kernelName:bu,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(t,e)=>{const[n,s,o]=e,r=n,i=s,a=Ye(r.shape,i.shape);return{a:()=>{const u=Ae(i,"float32");let h=V(t,V(u,ll(r,Pe(u,Ge(1)))));const d=un(r.shape,a);return d.length>0&&(h=Le(h,d)),j(h,r.shape)},b:()=>{const u=Qs(r,0),h=fs(u,Ks(r),ut(r));let d=V(t,V(o,h));const f=un(i.shape,a);return f.length>0&&(d=Le(d,f)),j(d,i.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kK={kernelName:Yf,inputsToSave:["x","alpha"],gradFunc:(t,e)=>{const[n,s]=e,o=Qs(n,0);return{x:()=>fs(o,t,V(t,s)),alpha:()=>{let r=fs(o,ut(t),V(t,n));const i=un(s.shape,t.shape);return i.length>0&&(r=Le(r,i)),j(r,s.shape)}}}};/**
 * @license
 * Copyright 2022 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EK(t,e,n){const s=t.shape.slice();s[n]=1;const o=j(e,s),r=eb(t,n,!0,!1),i=eb(t,n,!0,!0),a=V(r,i);return V(o,a)}function SK(t,e,n){const s=t.shape.length,o=s-n.length,r=jt(n,s);let i=t;r!=null&&(i=lt(t,r));const a=i.shape.slice(),c=a.splice(s-n.length,n.length).reduce((d,f)=>d*f,1);a.push(c);const u=i.reshape(a);let h=EK(u,e,o);if(h=h.reshape(i.shape),r!=null){const d=Xr(r);h=lt(h,d)}return h}const TK={kernelName:Zf,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{axis:o}=n;let r=[];return o==null?r=s.shape.map((i,a)=>a):typeof o=="number"?r=[o]:r=o,{x:()=>SK(s,t,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NK={kernelName:Jc,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,o=Ye(n.shape,s.shape);return{a:()=>{const a=ze(t,Ae(s,"float32")),l=un(n.shape,o);return l.length>0?j(Le(a,l),n.shape):a},b:()=>{let a=V(t,Ae(n,"float32"));const l=un(s.shape,o);l.length>0&&(a=j(Le(a,l),s.shape));const c=Nt(s);return Gt(ze(a,Ae(c,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AK={kernelName:xu,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ze(t,Gt(Nt(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RK={kernelName:vu,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,s=V(El(n,6),Vu(n));return{x:()=>V(t,Ae(s,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DK={kernelName:yu,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>V(t,Ae(Vu(n),"float32"))}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OK={kernelName:Qf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>j(t,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FK={kernelName:ep,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[s]=e,o={dy:t,images:s};return{images:()=>W.runKernel(Ex,o,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LK={kernelName:Jf,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[s]=e,o={dy:t,images:s};return{images:()=>W.runKernel(kx,o,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PK={kernelName:tp,gradFunc:(t,e,n)=>{const{dims:s}=n,o=st(s,t.shape);return{x:()=>Zi(t,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MK={kernelName:wu,gradFunc:t=>({x:()=>ut(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BK={kernelName:Cu,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Gt(ze(t,V(ll(n,1.5),2)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VK={kernelName:np,inputsToSave:["condition"],gradFunc:(t,e)=>{const[n]=e;return{condition:()=>Ae(ut(n),"float32"),t:()=>V(t,Ae(n,t.dtype)),e:()=>V(t,Ae(cy(n),t.dtype))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zK={kernelName:$u,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=Qs(n,Ge(0)),o=Ge(_p),r=Ge(kp),i=V(t,r),a=V(V(t,o),qs(Ae(n,"float32")));return fs(s,i,a)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WK={kernelName:Eu,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>V(t,V(n,Pe(Ge(1),n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UK={kernelName:ku,gradFunc:t=>({x:()=>ut(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HK={kernelName:Iu,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>V(sy(Ae(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GK={kernelName:_u,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>V(X_(Ae(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jK={kernelName:sp,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{begin:o,size:r}=n,i=s.shape,[a,l]=mp(s,o,r),c=[];for(let u=0;u<t.rank;u++)c.push([a[u],i[u]-a[u]-l[u]]);return{x:()=>dy(t,c)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qK={kernelName:ap,outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s]=e,{dim:o}=n,r=!0,i=V(t,s);return{logits:()=>Pe(i,V(Le(i,[o],r),s))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KK={kernelName:Su,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>V(t,_l(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jw={kernelName:rp,gradFunc:(t,e,n)=>{const{blockShape:s,paddings:o}=n;return{x:()=>ty(t,s,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eC={kernelName:ip,gradFunc:(t,e,n)=>{const{axis:s}=n;return{x:()=>Dn(t,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XK={kernelName:Tu,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ze(t,V(Wn(Ae(n,"float32")),2))}}};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YK={kernelName:Rx,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>V(t,V(Ae(n,"float32"),2))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZK={kernelName:Nu,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,o=Ge(2);return{a:()=>V(t,V(o,Pe(n,s))),b:()=>V(t,V(o,Pe(s,n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QK={kernelName:Fu,gradFunc:t=>({x:()=>ut(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JK={kernelName:Au,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,o=Ye(n.shape,s.shape);return{a:()=>{let a=t;const l=un(n.shape,o);return l.length>0&&(a=Le(a,l)),j(a,n.shape)},b:()=>{let a=t;const l=un(s.shape,o);return l.length>0&&(a=Le(a,l)),j(Gt(a),s.shape)}}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const e6={kernelName:op,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,o=s.shape.slice(),{axis:r}=n;st(r,s.shape).forEach(c=>{o[c]=1});const a=j(t,o),l=V(a,Zr(s.shape,"float32"));return{x:()=>l}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const t6={kernelName:Ru,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ze(t,Nt(sy(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n6={kernelName:Du,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>V(Pe(Ge(1),Nt(n)),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s6={kernelName:Ou,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{reps:o}=n;return{x:()=>{let i=ut(s);if(s.rank===1)for(let a=0;a<o[0];++a)i=ye(i,$t(t,[a*s.shape[0]],[s.shape[0]]));else if(s.rank===2)for(let a=0;a<o[0];++a)for(let l=0;l<o[1];++l)i=ye(i,$t(t,[a*s.shape[0],l*s.shape[1]],[s.shape[0],s.shape[1]]));else if(s.rank===3)for(let a=0;a<o[0];++a)for(let l=0;l<o[1];++l)for(let c=0;c<o[2];++c)i=ye(i,$t(t,[a*s.shape[0],l*s.shape[1],c*s.shape[2]],[s.shape[0],s.shape[1],s.shape[2]]));else if(s.rank===4)for(let a=0;a<o[0];++a)for(let l=0;l<o[1];++l)for(let c=0;c<o[2];++c)for(let u=0;u<o[3];++u)i=ye(i,$t(t,[a*s.shape[0],l*s.shape[1],c*s.shape[2],u*s.shape[3]],[s.shape[0],s.shape[1],s.shape[2],s.shape[3]]));else throw new Error(`Gradient for tile operation is not implemented for rank-${s.rank} tensors yet.`);return i}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const o6={kernelName:ja,gradFunc:(t,e,n)=>{const s=n,{perm:o}=s,r=Xr(o);return{x:()=>lt(t,r)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r6={kernelName:lp,gradFunc:(t,e,n)=>{const s=n,{axis:o}=s;return{value:()=>Qi(t,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i6={kernelName:cp,inputsToSave:["segmentIds"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>a6(t,n)}}};function a6(t,e){const n=Yr(e,ut(e)),s=iy(t,n);let o=kl(e,Ge(0,"int32"));const r=s.rank-o.rank;for(let a=0;a<r;++a)o=Ps(o,a+1);o=ir(o,Zr(s.shape,"bool"));const i=ut(s);return fs(o,s,i)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l6={kernelName:up,gradFunc:t=>({x:()=>ut(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c6=[eE,iq,aq,lq,cq,uq,hq,dq,fq,pq,mq,gq,yq,Cq,$q,Iq,_q,kq,Eq,Sq,Tq,Nq,Rq,Aq,Fq,Lq,Pq,Mq,Bq,Vq,NK,zq,Wq,Uq,Hq,Gq,qq,jq,Kq,Xq,Yq,Zq,Qq,Jq,eK,tK,nK,sK,oK,aK,Zw,Zw,lK,hK,pK,mK,gK,bK,xK,yK,vK,wK,CK,$K,IK,Qw,Qw,_K,kK,TK,AK,RK,DK,OK,FK,LK,PK,MK,BK,VK,zK,WK,UK,HK,GK,jK,qK,KK,Jw,Jw,eC,eC,XK,ZK,YK,QK,JK,e6,t6,n6,s6,o6,r6,i6,l6];for(const t of c6)yz(t);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.abs=function(){return this.throwIfDisposed(),dn(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.acos=function(){return this.throwIfDisposed(),XW(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.acosh=function(){return this.throwIfDisposed(),ZW(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.add=function(t){return this.throwIfDisposed(),ye(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.all=function(t,e){return this.throwIfDisposed(),G_(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.any=function(t,e){return this.throwIfDisposed(),Qg(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.argMax=function(t){return this.throwIfDisposed(),_c(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.argMin=function(t){return this.throwIfDisposed(),n4(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.asScalar=function(){return this.throwIfDisposed(),T(this.size===1,()=>"The array must have only 1 element."),j(this,[])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.asType=function(t){return this.throwIfDisposed(),Ae(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.as1D=function(){return this.throwIfDisposed(),j(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.as2D=function(t,e){return this.throwIfDisposed(),j(this,[t,e])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.as3D=function(t,e,n){return this.throwIfDisposed(),j(this,[t,e,n])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.as4D=function(t,e,n,s){return this.throwIfDisposed(),j(this,[t,e,n,s])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.as5D=function(t,e,n,s,o){return this.throwIfDisposed(),j(this,[t,e,n,s,o])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.asin=function(){return this.throwIfDisposed(),o4(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.asinh=function(){return this.throwIfDisposed(),i4(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.atan=function(){return this.throwIfDisposed(),l4(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.atan2=function(t){return this.throwIfDisposed(),u4(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.atanh=function(){return this.throwIfDisposed(),d4(this)};oe().prototype.avgPool=function(t,e,n,s){return this.throwIfDisposed(),Jx(this,t,e,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),ty(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.batchNorm=function(t,e,n,s,o){return this.throwIfDisposed(),gp(this,t,e,n,s,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.broadcastTo=function(t){return this.throwIfDisposed(),mc(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.cast=function(t){return this.throwIfDisposed(),Ae(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.ceil=function(){return this.throwIfDisposed(),M4(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.clipByValue=function(t,e){return this.throwIfDisposed(),Ss(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.concat=function(t,e){return this.throwIfDisposed(),t instanceof tn&&(t=[t]),Dn([this,...t],e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.conv1d=function(t,e,n,s,o,r){return this.throwIfDisposed(),j_(this,t,e,n,s,o,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.conv2dTranspose=function(t,e,n,s,o){return this.throwIfDisposed(),q_(this,t,e,n,s,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.conv2d=function(t,e,n,s,o,r){return this.throwIfDisposed(),Xi(this,t,e,n,s,o,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.cos=function(){return this.throwIfDisposed(),sy(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.cosh=function(){return this.throwIfDisposed(),X_(this)};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.cumprod=function(t,e,n){return this.throwIfDisposed(),eb(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.cumsum=function(t,e,n){return this.throwIfDisposed(),Y_(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),lU(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.depthwiseConv2d=function(t,e,n,s,o,r){return this.throwIfDisposed(),oy(this,t,e,n,s,o,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.dilation2d=function(t,e,n,s,o){return this.throwIfDisposed(),hU(this,t,e,n,s,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.divNoNan=function(t){return this.throwIfDisposed(),gU(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.div=function(t){return this.throwIfDisposed(),ze(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.dot=function(t){return this.throwIfDisposed(),xU(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.elu=function(){return this.throwIfDisposed(),bp(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.equal=function(t){return this.throwIfDisposed(),Ho(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.erf=function(){return this.throwIfDisposed(),wU(this)};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.euclideanNorm=function(t,e){return this.throwIfDisposed(),NU(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.exp=function(){return this.throwIfDisposed(),qs(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.expandDims=function(t){return this.throwIfDisposed(),Ps(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.expm1=function(){return this.throwIfDisposed(),OU(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.fft=function(){return this.throwIfDisposed(),vk(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.flatten=function(){return this.throwIfDisposed(),j(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.floor=function(){return this.throwIfDisposed(),vp(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.floorDiv=function(t){return this.throwIfDisposed(),H_(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.gather=function(t,e){return this.throwIfDisposed(),iy(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.greaterEqual=function(t){return this.throwIfDisposed(),kl(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.greater=function(t){return this.throwIfDisposed(),Qs(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.ifft=function(){return this.throwIfDisposed(),nb(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.irfft=function(){return this.throwIfDisposed(),pG(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.isFinite=function(){return this.throwIfDisposed(),WU(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.isInf=function(){return this.throwIfDisposed(),HU(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.isNaN=function(){return this.throwIfDisposed(),jU(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.leakyRelu=function(t){return this.throwIfDisposed(),ay(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.lessEqual=function(t){return this.throwIfDisposed(),El(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.less=function(t){return this.throwIfDisposed(),ek(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.localResponseNormalization=function(t,e,n,s){return this.throwIfDisposed(),ZU(this,t,e,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.logSigmoid=function(){return this.throwIfDisposed(),sH(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.logSoftmax=function(t){return this.throwIfDisposed(),tk(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.logSumExp=function(t,e){return this.throwIfDisposed(),nk(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.log=function(){return this.throwIfDisposed(),Ks(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.log1p=function(){return this.throwIfDisposed(),ly(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.logicalAnd=function(t){return this.throwIfDisposed(),ir(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.logicalNot=function(){return this.throwIfDisposed(),cy(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.logicalOr=function(t){return this.throwIfDisposed(),sk(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.logicalXor=function(t){return this.throwIfDisposed(),hH(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.matMul=function(t,e,n){return this.throwIfDisposed(),gt(this,t,e,n)};oe().prototype.maxPool=function(t,e,n,s){return this.throwIfDisposed(),uy(this,t,e,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.max=function(t,e){return this.throwIfDisposed(),Lo(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.maximum=function(t){return this.throwIfDisposed(),Yr(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.mean=function(t,e){return this.throwIfDisposed(),Kt(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.min=function(t,e){return this.throwIfDisposed(),tb(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.minimum=function(t){return this.throwIfDisposed(),wp(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.mirrorPad=function(t,e){return this.throwIfDisposed(),yH(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.mod=function(t){return this.throwIfDisposed(),wH(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.mul=function(t){return this.throwIfDisposed(),V(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.neg=function(){return this.throwIfDisposed(),Gt(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.norm=function(t,e,n){return this.throwIfDisposed(),xp(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.notEqual=function(t){return this.throwIfDisposed(),kc(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.oneHot=function(t,e=1,n=0){return this.throwIfDisposed(),D_(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.onesLike=function(){return this.throwIfDisposed(),Xs(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.pad=function(t,e){return this.throwIfDisposed(),dy(this,t,e)};oe().prototype.pool=function(t,e,n,s,o,r){return this.throwIfDisposed(),NH(this,t,e,n,s,o,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.pow=function(t){return this.throwIfDisposed(),ll(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.prelu=function(t){return this.throwIfDisposed(),py(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.prod=function(t,e){return this.throwIfDisposed(),DH(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.reciprocal=function(){return this.throwIfDisposed(),KH(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.relu=function(){return this.throwIfDisposed(),dr(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.relu6=function(){return this.throwIfDisposed(),dk(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.reshapeAs=function(t){return this.throwIfDisposed(),j(this,t.shape)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.reshape=function(t){return this.throwIfDisposed(),j(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.resizeBilinear=function(t,e,n){return this.throwIfDisposed(),Ek(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.resizeNearestNeighbor=function(t,e,n){return this.throwIfDisposed(),Sk(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.reverse=function(t){return this.throwIfDisposed(),Zi(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.rfft=function(){return this.throwIfDisposed(),wk(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.round=function(){return this.throwIfDisposed(),fk(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.rsqrt=function(){return this.throwIfDisposed(),pk(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.selu=function(){return this.throwIfDisposed(),mk(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.separableConv2d=function(t,e,n,s,o,r){return this.throwIfDisposed(),gk(this,t,e,n,s,o,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.sigmoid=function(){return this.throwIfDisposed(),_l(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.sign=function(){return this.throwIfDisposed(),sG(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.sin=function(){return this.throwIfDisposed(),bk(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.sinh=function(){return this.throwIfDisposed(),xk(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.slice=function(t,e){return this.throwIfDisposed(),$t(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.softmax=function(t){return this.throwIfDisposed(),xy(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.softplus=function(){return this.throwIfDisposed(),Mu(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),fy(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.split=function(t,e){return this.throwIfDisposed(),_s(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.sqrt=function(){return this.throwIfDisposed(),Wn(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.square=function(){return this.throwIfDisposed(),Nt(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.squaredDifference=function(t){return this.throwIfDisposed(),Ck(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.squeeze=function(t){return this.throwIfDisposed(),Bu(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.stack=function(t,e){this.throwIfDisposed();const n=t instanceof tn?[this,t]:[this,...t];return Qi(n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.step=function(t){return this.throwIfDisposed(),Vu(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.stridedSlice=function(t,e,n,s,o,r,i,a){return this.throwIfDisposed(),CG(this,t,e,n,s,o,r,i,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.sub=function(t){return this.throwIfDisposed(),Pe(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.sum=function(t,e){return this.throwIfDisposed(),Le(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.tan=function(){return this.throwIfDisposed(),IG(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.tanh=function(){return this.throwIfDisposed(),ey(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.tile=function(t){return this.throwIfDisposed(),ho(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.toBool=function(){return this.throwIfDisposed(),Ae(this,"bool")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.toFloat=function(){return this.throwIfDisposed(),Ae(this,"float32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.toInt=function(){return this.throwIfDisposed(),Ae(this,"int32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.topk=function(t,e){return this.throwIfDisposed(),kG(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.transpose=function(t){return this.throwIfDisposed(),lt(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.unique=function(t){return this.throwIfDisposed(),TG(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.unsortedSegmentSum=function(t,e){return this.throwIfDisposed(),Ik(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.unstack=function(t){return this.throwIfDisposed(),cl(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.where=function(t,e){return this.throwIfDisposed(),fs(t,this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.zerosLike=function(){return this.throwIfDisposed(),ut(this)};/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Eo extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Eo.prototype)}}class Us extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Us.prototype)}}class z extends Error{constructor(e){super(e),Object.setPrototypeOf(this,z.prototype)}}class Ze extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Ze.prototype)}}class Jy extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Jy.prototype)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class nE{constructor(e){this.maxEntries=e||100,this.cache=new Map}get(e){let n;return this.cache.has(e)&&(n=this.cache.get(e),this.cache.delete(e),this.cache.set(e,n)),n}put(e,n){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){const s=this.cache.keys().next().value;this.cache.delete(s)}this.cache.set(e,n)}getMaxEntries(){return this.maxEntries}setMaxEntries(e){if(e<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${e}.`);if(this.maxEntries>e)for(let n=0;n<this.maxEntries-e;n++){const s=this.cache.keys().next().value;this.cache.delete(s)}this.maxEntries=e}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ea(t,e){if(Array.isArray(t)){let n=[];for(let s=0;s<e;s++)n=n.concat(t);return n}else{const n=new Array(e);return n.fill(t),n}}function So(t,e){if(!t)throw new Jy(e)}function tC(t,e){let n=0;for(const s of t)s===e&&n++;return n}function Jn(t){return t.length===1?t[0]:t}function Ot(t){return Array.isArray(t)?t:[t]}function er(t){const n=t.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return n[0]!=="_"?n:"private"+n}function Ei(t){return t.length<=1||t.indexOf("_")===-1?t:t.replace(/[_]+(\w|$)/g,(e,n)=>n.toUpperCase())}let Ds={};function e0(t){if(t==null)return null;const e={};return e.className=t.getClassName(),e.config=t.getConfig(),e}function ob(t){if(!(t==null||typeof t!="object"))if(Array.isArray(t))t.forEach(e=>ob(e));else{const e=Object.keys(t);for(const n of e){const s=t[n];s!=null&&typeof s=="object"&&(!Array.isArray(s)&&s.type==="ndarray"&&typeof s.value=="number"?t[n]=s.value:ob(s))}}}function Hu(t,e={},n={},s="object",o=!1){if(typeof t=="string"){const r=t;let i;if(r in n)i=n[r];else if(r in Ds)i=Ds[r];else if(i=e[r],i==null)throw new z(`Unknown ${s}: ${t}. This may be due to one of the following reasons:
1. The ${s} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${s} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return i}else{const r=t;if(r.className==null||r.config==null)throw new z(`${s}: Improper config format: ${JSON.stringify(r)}.
'className' and 'config' must set.`);const i=r.className;let a,l;if(i in n?[a,l]=n[i]:i in Ds?[a,l]=Ds.className:i in e&&([a,l]=e[i]),a==null)throw new z(`Unknown ${s}: ${i}. This may be due to one of the following reasons:
1. The ${s} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${s} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(l!=null){const c={};for(const f of Object.keys(Ds))c[f]=Ds[f];for(const f of Object.keys(n))c[f]=n[f];const u=r.config;u.customObjects=c;const h=Object.assign({},Ds);for(const f of Object.keys(n))Ds[f]=n[f];ob(r.config);const d=l(a,r.config,n,o);return Ds=Object.assign({},h),d}else{const c=Object.assign({},Ds);for(const h of Object.keys(n))Ds[h]=n[h];const u=new a(r.config);return Ds=Object.assign({},c),u}}}function u6(t,e){return t<e?-1:t>e?1:0}function Bh(t,e){return-1*u6(t,e)}function Fr(t){if(t==null)return t;const e=[];for(const n of t)e.indexOf(n)===-1&&e.push(n);return e}function h6(t){if(t==null)throw new z(`Invalid value in obj: ${JSON.stringify(t)}`);for(const e in t)if(t.hasOwnProperty(e))return!1;return!0}function ia(t,e,n){if(n!=null&&t.indexOf(n)<0)throw new z(`${n} is not a valid ${e}.  Valid values are ${t} or null/undefined.`)}function t0(t,e,n=0,s=1/0){return So(n>=0),So(s>=n),Array.isArray(t)&&t.length>=n&&t.length<=s&&t.every(o=>typeof o===e)}function xn(t,e){Array.isArray(t)?(T(t.length>0,()=>`${e} is unexpectedly an empty array.`),t.forEach((n,s)=>xn(n,`element ${s+1} of ${e}`))):T(Number.isInteger(t)&&t>0,()=>`Expected ${e} to be a positive integer, but got ${sE(t)}.`)}function sE(t){return t===null?"null":Array.isArray(t)?"["+t.map(e=>sE(e)).join(",")+"]":typeof t=="string"?`"${t}"`:`${t}`}function d6(t,e,n){let s=n!=null?n():Zn(),o;return(...i)=>{const a=n!=null?n():Zn();return a-s<e||(s=a,o=t(...i)),o}}function oE(t){return t==="relu"?"relu":t==="linear"?"linear":t==="elu"?"elu":null}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let f6=0;function rE(){return f6++}const Vh={};function Ep(t=""){return t in Vh||(Vh[t]=0),Vh[t]+=1,t+Vh[t].toString()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const p6=["channelsFirst","channelsLast"],m6=["nearest","bilinear"],g6=["valid","same","causal"],b6=["max","avg"],x6=["sum","mul","concat","ave"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Na=new Map;function Qt(t){ia(p6,"DataFormat",t)}function y6(t){ia(m6,"InterpolationFormat",t)}function Ts(t){ia(g6,"PaddingMode",t)}function iE(t){ia(b6,"PoolMode",t)}const bc=[],nC="/";function Vi(t,e){bc.push(t);try{const n=e();return bc.pop(),n}catch(n){throw bc.pop(),n}}function v6(){return bc.length===0?"":bc.join(nC)+nC}function aE(t){if(!cE(t))throw new Error("Not a valid tensor name: '"+t+"'");return v6()+t}function lE(t){if(!cE(t))throw new Error("Not a valid tensor name: '"+t+"'");Na.has(t)||Na.set(t,0);const e=Na.get(t);if(Na.set(t,Na.get(t)+1),e>0){const n=`${t}_${e}`;return Na.set(n,1),n}else return t}const w6=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function cE(t){return!!t.match(w6)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function C6(t){return t===parseInt(t.toString(),10)}function Lr(t,e,n){e==null&&(e=0),n==null&&(n=t.length);let s=1;for(let o=e;o<n;++o)s*=t[o];return s}function ul(t){if(t.length===0)return Number.NaN;let e=Number.POSITIVE_INFINITY;for(let n=0;n<t.length;n++){const s=t[n];s<e&&(e=s)}return e}function Br(t){if(t.length===0)return Number.NaN;let e=Number.NEGATIVE_INFINITY;for(let n=0;n<t.length;n++){const s=t[n];s>e&&(e=s)}return e}function bo(t,e){if(e<t)throw new z(`end (${e}) < begin (${t}) is forbidden.`);const n=[];for(let s=t;s<e;++s)n.push(s);return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let Km;function on(){return Km==null&&(Km=RW().epsilon()),Km}function xo(){return"channelsLast"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Sp(t,e){return Ae(t,e)}function Gu(t,e=-1){const n=t.shape.slice();return e<0&&(e=n.length+e+1),n.splice(e,0,1),j(t,n)}function $6(t,e){return J(()=>{if(t.shape.length!==2)throw new z(`repeat() expects a rank-2 tensor, but received a rank-${t.shape.length} tensor.`);const n=Gu(t,1);return rb(n,[1,e,1])})}function I6(t){const e=[Lr(t.shape)];return j(t,e)}function _6(t){if(t.rank<=1)throw new z(`batchFlatten requires a minimum rank of 2. Got rank: ${t.rank}.`);const e=[t.shape[0],Lr(t.shape,1)];return j(t,e)}function zi(t,e,n){return J(()=>{switch(t.rank){case 1:return gy(t,e,n);case 2:return yk(t,[e,0],[n,t.shape[1]]);case 3:return by(t,[e,0,0],[n,t.shape[1],t.shape[2]]);case 4:return kd(t,[e,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3]]);case 5:return $t(t,[e,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4]]);case 6:return $t(t,[e,0,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4],t.shape[5]]);default:throw new z(`sliceAlongFirstAxis() received an unsupported tensor rank: ${t.rank}`)}})}function Xm(t,e,n){return J(()=>{switch(t.rank){case 1:return gy(t,e,n);case 2:return yk(t,[0,e],[t.shape[0],n]);case 3:return by(t,[0,0,e],[t.shape[0],t.shape[1],n]);case 4:return kd(t,[0,0,0,e],[t.shape[0],t.shape[1],t.shape[2],n]);default:throw new z(`sliceAlongLastAxis() received an unsupported tensor rank: ${t.rank}`)}})}function zh(t,e,n,s){return J(()=>{switch(t.rank){case 1:return gy(t,e,n);case 2:switch(s){case 1:return zi(t,e,n);case 2:return Xm(t,e,n);default:throw new z(`The axis is not within the rank of the tensor ${s}`)}case 3:switch(s){case 1:return zi(t,e,n);case 2:return by(t,[0,e,0],[t.shape[0],n,t.shape[2]]);case 3:return Xm(t,e,n);default:throw new z(`The axis is not within the rank of the tensor ${s}`)}case 4:switch(s){case 1:return zi(t,e,n);case 2:return kd(t,[0,e,0,0],[t.shape[0],n,t.shape[2],t.shape[3]]);case 3:return kd(t,[0,0,e,0],[t.shape[0],t.shape[1],n,t.shape[3]]);case 4:return Xm(t,e,n);default:throw new z(`The axis is not within the rank of the tensor ${s}`)}default:throw new z(`sliceAlongLastAxis() received an unsupported tensor rank: ${t.rank}`)}})}function n0(t,e=-1){let n;return e<0&&(n=t[0].rank,n!==0?e=n:e=0),e===t[0].rank&&(e=-1),Dn(t,e)}function sC(t,e){switch(t.rank){case 1:return z4([t,e]);case 2:return U4([t,e],0);case 3:return G4([t,e],0);case 4:return q4([t,e],0);default:throw new z(`concatAlongFirstAxis() received an unsupported tensor rank: ${t.rank}`)}}function rb(t,e){if(Array.isArray(e)||(e=[e]),t.rank!==e.length)throw new z(`The length of input n (${e.length}) does not match the number of dimensions in input x (${t.rank})`);return ho(t,e)}function Tp(t,e=0,n=1,s,o){return GH(t,e,n,s,o)}function Mo(t,e,n,s){if(t.rank<2||e.rank<2)throw new Ze(`dot requires both inputs to be rank >= 2 but got x shape = ${t.shape} and y shape = ${e.shape}`);if(e.rank>=3){const o=t.shape.slice(-1)[0],r=e.shape.slice(-2)[0];if(o!==r)throw new Ze(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${t.shape} and  y shape = ${e.shape}`)}if(t.rank===2&&e.rank===2)return Hw({a:t,b:e,transposeA:!1,transposeB:!1,bias:s?ib(t.rank,s,xo()):null,activation:n});{const o=t.shape.slice(),r=o.pop();t=j(t,[-1,r]);const i=e.shape.slice(),a=i.pop(),l=i.pop(),c=[...i,a],u=Array.from({length:e.rank},(p,g)=>g===0?e.rank-2:g<=e.rank-2?g-1:g);e=j(lt(e,u),[l,-1]);const h=[...o,...c];return j(Hw({a:t,b:e,transposeA:!1,transposeB:!1,bias:s?ib(t.rank,s,xo()):null,activation:n}),h)}}function uE(t,e,n){return J(()=>(Array.isArray(e)?e=hs(e,"int32"):e=Ae(e,"int32"),iy(t,e,n)))}function ju(t){return V(t,t)}function ib(t,e,n){const s=e.shape;if(e.rank!==1&&e.rank!==t)throw new z(`Unexpected bias dimensions: ${e.rank}; expected it to be 1 or ${t}`);if(t===5){if(n==="channelsFirst")return s.length===1?j(e,[1,s[0],1,1,1]):j(e,[1,s[3],s[0],s[1],s[2]]);if(n==="channelsLast")return s.length===1?j(e,[1,1,1,1,s[0]]):j(e,[1].concat(s))}else if(t===4){if(n==="channelsFirst")return s.length===1?j(e,[1,s[0],1,1]):j(e,[1,s[2],s[0],s[1]]);if(n==="channelsLast")return s.length===1?j(e,[1,1,1,s[0]]):j(e,[1].concat(s))}else if(t===3){if(n==="channelsFirst")return s.length===1?j(e,[1,s[0],1]):j(e,[1,s[1],s[0]]);if(n==="channelsLast")return s.length===1?j(e,[1,1,s[0]]):j(e,[1].concat(s))}else if(t<3)return e;throw new z(`Unsupported input rank by biasAdd: ${e.rank}`)}function wo(t,e,n){return J(()=>(n==null&&(n=xo()),Qt(n),ye(t,ib(t.rank,e,n))))}function k6(t,e=1){if(e!==1)throw new Ze(`Support for alpha values other than 1 (${e}) is not implemented yet.`);return bp(t)}function E6(t){return J(()=>ze(t,ye(dn(t),1)))}function hE(t,e,n,s){return J(()=>FG(t,e,n,s))}function S6(t){return J(()=>{const e=ye(.5,V(.2,t));return Ss(e,0,1)})}function qu(t,e,n=!1){return n?t():e()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const T6=["fanIn","fanOut","fanAvg"],N6=["normal","uniform","truncatedNormal"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function A6(t){ia(T6,"FanMode",t)}function R6(t){ia(N6,"Distribution",t)}class Js extends Il{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class dE extends Js{apply(e,n){return gn(e,n)}}dE.className="Zeros";ge(dE);class s0 extends Js{apply(e,n){return Zr(e,n)}}s0.className="Ones";ge(s0);class fE extends Js{constructor(e){if(super(),typeof e!="object")throw new z(`Expected argument of type ConstantConfig but got ${e}`);if(e.value===void 0)throw new z(`config must have value set but got ${e}`);this.value=e.value}apply(e,n){return J(()=>V(Ge(this.value),Zr(e,n)))}getConfig(){return{value:this.value}}}fE.className="Constant";ge(fE);class pE extends Js{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,n){return Cp(e,this.minval,this.maxval,n)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}pE.className="RandomUniform";ge(pE);class mE extends Js{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Ze(`randomNormal does not support dType ${n}.`);return Tp(e,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}mE.className="RandomNormal";ge(mE);class gE extends Js{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Ze(`truncatedNormal does not support dType ${n}.`);return $k(e,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}gE.className="TruncatedNormal";ge(gE);class bE extends Js{constructor(e){super(),this.gain=e.gain!=null?e.gain:1}apply(e,n){return J(()=>{if(e.length!==2||e[0]!==e[1])throw new z("Identity matrix initializer can only be used for 2D square matrices.");return V(this.gain,J_(e[0]))})}getConfig(){return{gain:this.gain}}}bE.className="Identity";ge(bE);function D6(t,e="channelsLast"){let n,s;if(Qt(e),t.length===2)n=t[0],s=t[1];else if([3,4,5].indexOf(t.length)!==-1){if(e==="channelsFirst"){const o=Lr(t,2);n=t[1]*o,s=t[0]*o}else if(e==="channelsLast"){const o=Lr(t,0,t.length-2);n=t[t.length-2]*o,s=t[t.length-1]*o}}else{const o=Lr(t);n=Math.sqrt(o),s=Math.sqrt(o)}return[n,s]}class ps extends Js{constructor(e){if(super(),e.scale<0)throw new z(`scale must be a positive float. Got: ${e.scale}`);this.scale=e.scale==null?1:e.scale,this.mode=e.mode==null?"fanIn":e.mode,A6(this.mode),this.distribution=e.distribution==null?"normal":e.distribution,R6(this.distribution),this.seed=e.seed}apply(e,n){const s=D6(e),o=s[0],r=s[1];let i=this.scale;if(this.mode==="fanIn"?i/=Math.max(1,o):this.mode==="fanOut"?i/=Math.max(1,r):i/=Math.max(1,(o+r)/2),this.distribution==="normal"){const a=Math.sqrt(i);if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Ze(`${this.getClassName()} does not support dType ${n}.`);return $k(e,0,a,n,this.seed)}else{const a=Math.sqrt(3*i);return Cp(e,-a,a,n)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}ps.className="VarianceScaling";ge(ps);class o0 extends ps{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return ps.className}}o0.className="GlorotUniform";ge(o0);class r0 extends ps{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return ps.className}}r0.className="GlorotNormal";ge(r0);class i0 extends ps{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return ps.className}}i0.className="HeNormal";ge(i0);class a0 extends ps{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return ps.className}}a0.className="HeUniform";ge(a0);class l0 extends ps{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return ps.className}}l0.className="LeCunNormal";ge(l0);class c0 extends ps{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return ps.className}}c0.className="LeCunNormal";ge(c0);class xE extends Js{constructor(e){if(super(),this.DEFAULT_GAIN=1,this.gain=e.gain==null?this.DEFAULT_GAIN:e.gain,this.seed=e.seed,this.seed!=null)throw new Ze("Random seed is not implemented for Orthogonal Initializer yet.")}apply(e,n){return J(()=>{if(e.length<2)throw new Ze("Shape must be at least 2D.");e[0]*e[1]>2e3&&console.warn(`Orthogonal initializer is being called on a matrix with more than 2000 (${e[0]*e[1]}) elements: Slowness may result.`);const s=e[0]>e[1]?[e[1],e[0]]:e,o=Tp(s,0,1,"float32");let r=eq.gramSchmidt(o);return e[0]>e[1]&&(r=lt(r)),V(this.gain,r)})}getConfig(){return{gain:this.gain,seed:this.seed}}}xE.className="Orthogonal";ge(xE);const oC={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function rC(t,e={}){return Hu(t,Ms.getMap().classNameMap,e,"initializer")}function Ht(t){return e0(t)}function zt(t){if(typeof t=="string"){const e=t in oC?oC[t]:t;if(e==="GlorotNormal")return new r0;if(e==="GlorotUniform")return new o0;if(e==="HeNormal")return new i0;if(e==="HeUniform")return new a0;if(e==="LeCunNormal")return new l0;if(e==="LeCunUniform")return new c0;{const n={};return n.className=e,n.config={},rC(n)}}else return t instanceof Js?t:rC(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ab(t){return Array.isArray(t)&&Array.isArray(t[0])}function Ed(t){return t.length===0?[]:Array.isArray(t[0])?t:[t]}function Je(t){let e;if(Array.isArray(t)){if(t.length!==1)throw new z(`Expected Tensor length to be 1; got ${t.length}`);e=t[0]}else e=t;return e}function vt(t){if(Array.isArray(t)&&Array.isArray(t[0])){if(t.length===1)return t=t,t[0];throw new z(`Expected exactly 1 Shape; got ${t.length}`)}else return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Sd(t){let e=0;for(const n of t)n.shape.length===0?e+=1:e+=n.shape.reduce((s,o)=>s*o);return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const iC="Variable";class O6{constructor(e,n="float32",s=iC,o=!0,r=null){this.dtype=n==null?"float32":n,this.shape=e.shape,this.id=rE(),s=s==null?iC:s,this.originalName=aE(s),this.name=lE(this.originalName),this.trainable_=o,this.constraint=r,this.val=RG(e,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(e){return this.assertNotDisposed(),F6(this.val,e),this.val.id!==e.id&&(this.val.assign(e),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(e){this.trainable_=e,this.val.trainable=e}}function F6(t,e){if(t.shape.toString()!==e.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(t.shape)+" vs. "+JSON.stringify(e.shape))}function lb(t){return t.map(e=>e.read())}function u0(t){t.forEach(e=>{e[0].write(e[1])})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class rn{constructor(e){this.dtype=e.dtype,this.shape=e.shape,e.shape!=null?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}}class Do{constructor(e,n,s,o,r,i,a){this.dtype=e,this.shape=n,this.sourceLayer=s,this.inputs=o,this.callArgs=r,this.outputTensorIndex=a,this.id=rE(),i!=null&&(this.originalName=aE(i),this.name=lE(this.originalName)),this.rank=n.length}}let L6=0;class Np{constructor(e,n){this.callArgs=n,this.id=L6++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(const s of e.inboundLayers)s!=null&&s.outboundNodes.push(this);e.outboundLayer.inboundNodes.push(this)}getConfig(){const e=[];for(const n of this.inboundLayers)n!=null?e.push(n.name):e.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}let P6=0;class ht extends Il{constructor(e={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=P6++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let n=e.name;if(!n){const s=this.getClassName();n=er(s)+"_"+Ep(s)}if(this.name=n,this.trainable_=e.trainable==null?!0:e.trainable,e.inputShape!=null||e.batchInputShape!=null){let s;if(e.batchInputShape!=null)s=e.batchInputShape;else if(e.inputShape!=null){let r=null;e.batchSize!=null&&(r=e.batchSize),s=[r].concat(e.inputShape)}this.batchInputShape=s;let o=e.dtype;o==null&&(o=e.inputDType),o==null&&(o="float32"),this.dtype=o}e.weights!=null?this.initialWeights=e.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(e,n){return e.name+"_ib-"+n.toString()}getNodeAtIndex(e,n){if(this.inboundNodes.length===0)throw new Us(`The layer has never been called and thus has no defined ${n}.`);if(this.inboundNodes.length<=e)throw new z(`Asked to get ${n} at node ${e}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[e]}getInputAt(e){return Jn(this.getNodeAtIndex(e,"input").inputTensors)}getOutputAt(e){return Jn(this.getNodeAtIndex(e,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new Eo(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(this.inboundNodes.length===0)throw new Eo(`Layer ${this.name} is not connected, no input to return.`);return Jn(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new Eo(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new Eo(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return Jn(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(e=>e())}get updates(){return this._updates}get built(){return this._built}set built(e){this._built=e}get trainable(){return this.trainable_}set trainable(e){this._trainableWeights.forEach(n=>n.trainable=e),this.trainable_=e}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(e=>e.trainable):[]}set trainableWeights(e){this._trainableWeights=e}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(e=>!e.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(e){this._nonTrainableWeights=e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(e){if(e=Ot(e),this.inputSpec==null||this.inputSpec.length===0)return;const n=Ot(this.inputSpec);if(e.length!==n.length)throw new z(`Layer ${this.name} expects ${n.length} inputs, but it received ${e.length} input tensors. Input received: ${e}`);for(let s=0;s<e.length;s++){const o=e[s],r=n[s];if(r==null)continue;const i=o.rank;if(r.ndim!=null&&i!==r.ndim)throw new z(`Input ${s} is incompatible with layer ${this.name}: expected ndim=${r.ndim}, found ndim=${i}`);if(r.maxNDim!=null&&i>r.maxNDim)throw new z(`Input ${s} is incompatible with layer ${this.name}: expected max_ndim=${r.maxNDim}, found ndim=${i}`);if(r.minNDim!=null&&i<r.minNDim)throw new z(`Input ${s} is incompatible with layer ${this.name}: expected min_ndim=${r.minNDim}, found ndim=${i}.`);if(r.dtype!=null&&o.dtype!==r.dtype)throw new z(`Input ${s} is incompatible with layer ${this.name} : expected dtype=${r.dtype}, found dtype=${o.dtype}.`);if(r.axes){const a=o.shape;for(const l in r.axes){const c=Number(l),u=r.axes[l],h=c>=0?a[c]:a[a.length+c];if(u!=null&&[u,null].indexOf(h)===-1)throw new z(`Input ${s} is incompatible with layer ${this.name}: expected axis ${c} of input shape to have value ${u} but got shape ${a}.`)}}if(r.shape!=null)for(let a=0;a<r.shape.length;++a){const l=r.shape[a],c=o.shape[a];if(l!=null&&c!=null&&l!==c)throw new z(`Input ${s} is incompatible with layer ${this.name}: expected shape=${r.shape}, found shape=${o.shape}.`)}}}call(e,n){return e}invokeCallHook(e,n){this._callHook!=null&&this._callHook(e,n)}setCallHook(e){this._callHook=e}clearCallHook(){this._callHook=null}apply(e,n){n=n||{},this.assertNotDisposed();const s=Ot(e);let o=!0;for(const i of s)if(!(i instanceof Do)){o=!1;break}let r=!0;for(const i of s)if(i instanceof Do){r=!1;break}if(o===r)throw new z("Arguments to apply() must be all SymbolicTensors or all Tensors");return Vi(this.name,()=>{if(!this.built){this.assertInputCompatibility(e);const i=[];for(const a of Ot(e))i.push(a.shape);this.build(Jn(i)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&r&&(this._refCount=1)}if(this.assertInputCompatibility(e),r){let i=this.call(e,n);const a=Ot(i),l=[];for(let c of a)s.indexOf(c)!==-1&&(c=c.clone()),l.push(c);if(i=Jn(l),this.activityRegularizer!=null)throw new Ze("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return i}else{const i=M6(e),a=this.computeOutputShape(i);let l;const c=B6(e);if(this.warnOnIncompatibleInputShape(Array.isArray(e)?i[0]:i),a!=null&&a.length>0&&Array.isArray(a[0])?l=a.map((u,h)=>new Do(c,u,this,Ot(e),n,this.name,h)):l=new Do(c,a,this,Ot(e),n,this.name),this.addInboundNode(e,l,null,null,i,a,n),this._refCount++,this.activityRegularizer!=null)throw new Ze("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return l}})}warnOnIncompatibleInputShape(e){if(this.batchInputShape!=null)if(e.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(e)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let n=!1;this.batchInputShape.forEach((s,o)=>{s!=null&&e[o]!=null&&e[o]!==s&&(n=!0)}),n&&console.warn(`The shape of the input tensor (${JSON.stringify(e)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new Eo(`The layer ${this.name} has never been called and thus has no defined output shape.`);const e=[];for(const n of this.inboundNodes){const s=JSON.stringify(n.outputShapes);e.indexOf(s)===-1&&e.push(s)}if(e.length===1){const n=this.inboundNodes[0].outputShapes;return Array.isArray(n)&&Array.isArray(n[0])&&n.length===1?n[0]:n}else throw new Eo(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new Us(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return Sd(this.weights)}build(e){this.built=!0}getWeights(e=!1){return lb(e?this.trainableWeights:this.weights)}setWeights(e){J(()=>{const n=this.weights;if(n.length!==e.length)throw new z(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${e.length}, but the layer was expecting ${n.length} weights. Provided weights: ${e}...`);if(n.length===0)return;const s=[],o=lb(n);for(let r=0;r<o.length;++r){const i=o[r],a=n[r],l=e[r];if(!bt(i.shape,l.shape))throw new z(`Layer weight shape ${i.shape} not compatible with provided weight shape ${l.shape}`);s.push([a,l])}u0(s)})}addWeight(e,n,s,o,r,i,a,l){if(this._addedWeightNames.indexOf(e)!==-1)throw new z(`Duplicate weight name ${e} for layer ${this.name}`);this._addedWeightNames.push(e),s==null&&(s="float32"),this.fastWeightInitDuringBuild&&(o=l!=null?l():zt("zeros"));const c=o.apply(n,s),u=new O6(c,s,e,i,a);return c.dispose(),r!=null&&this.addLoss(()=>r.apply(u.read())),i==null&&(i=!0),i?this._trainableWeights.push(u):this._nonTrainableWeights.push(u),u}setFastWeightInitDuringBuild(e){this.fastWeightInitDuringBuild=e}addLoss(e){e==null||Array.isArray(e)&&e.length===0||(e=Ot(e),this._losses!==void 0&&this._losses!==null&&this.losses.push(...e))}computeOutputShape(e){return e}computeMask(e,n){if(!this.supportsMasking){if(n!=null)if(Array.isArray(n))n.forEach(s=>{if(s!=null)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)});else throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);return null}return n}addInboundNode(e,n,s,o,r,i,a=null){const l=Ot(e);n=Ot(n),s=Ot(s),o=Ot(o),r=Ed(r),i=Ed(i);const c=[],u=[],h=[];for(const d of l)c.push(d.sourceLayer),u.push(d.nodeIndex),h.push(d.tensorIndex);new Np({outboundLayer:this,inboundLayers:c,nodeIndices:u,tensorIndices:h,inputTensors:l,outputTensors:n,inputMasks:s,outputMasks:o,inputShapes:r,outputShapes:i},a);for(let d=0;d<n.length;d++)n[d].sourceLayer=this,n[d].nodeIndex=this.inboundNodes.length-1,n[d].tensorIndex=d}getConfig(){const e={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(e.batchInputShape=this.batchInputShape),this.dtype!=null&&(e.dtype=this.dtype),e}disposeWeights(){return this.weights.forEach(e=>e.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(this._refCount===null)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let e=0;return--this._refCount===0&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}}function M6(t){t=Ot(t);const e=[];for(const n of t)e.push(n.shape);return Jn(e)}function B6(t){return"float32"}function yE(t,e,n){if((e==null||n!=null&&n>0)&&(e=t.sourceLayer,n=t.nodeIndex),e.inboundNodes.length===0)return[t];{const s=e.inboundNodes[n];if(s.inboundLayers.length===0)return s.inputTensors;{const o=[];for(let r=0;r<s.inboundLayers.length;r++){const i=s.inputTensors[r],a=s.inboundLayers[r],l=s.nodeIndices[r],c=yE(i,a,l);for(const u of c)o.indexOf(u)===-1&&o.push(u)}return o}}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Ku extends ht{constructor(e){if(super({dtype:e.dtype,name:e.name!=null?e.name:Ep("input").toString()}),e.batchSize==null&&(e.batchSize=null),e.sparse==null&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,e.inputShape!=null&&e.batchInputShape!=null)throw new z("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let n=e.batchInputShape;if(n==null){if(e.inputShape==null)throw new z("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");n=[e.batchSize].concat(e.inputShape)}else if(e.batchSize!=null)throw new z("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const s=e.dtype||"float32";this.batchInputShape=n,this.dtype=s,this.inputSpec=[{shape:n}];const o=new Do(this.dtype,this.batchInputShape,this,[],{},this.name);o.nodeIndex=0,o.tensorIndex=0,new Np({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[o],outputTensors:[o],inputMasks:[null],outputMasks:[null],inputShapes:[n],outputShapes:[n]})}apply(e,n){throw new z(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}Ku.className="InputLayer";ge(Ku);function V6(t){if(t.batchShape==null&&t.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(t.batchShape!=null&&t.shape!=null)throw new z("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let e=t.batchShape;t.shape!=null&&e==null&&(e=[null].concat(t.shape));let n=t.dtype;return n==null&&(n="float32"),new Ku({batchInputShape:e,name:t.name,dtype:n,sparse:t.sparse}).inboundNodes[0].outputTensors[0]}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function z6(t,e){if(t.dtype==null||t.dtype===e.dtype)return e;try{return Ae(e,t.dtype)}catch{throw new z(`The dtype of the feed (${e.dtype}) can not be cast to the dtype of the key '${t.name}' (${t.dtype}).`)}}class Nr{constructor(e){if(this.id2Value={},this.id2Mask={},this.name2Id={},e instanceof Nr)for(const n in e.id2Value)this.id2Value[n]=e.id2Value[n],n in e.id2Mask&&(this.id2Mask[n]=e.id2Mask[n]);else{if(e==null)return;for(const n of e)this.add(n.key,n.value)}}add(e,n,s){if(this.id2Value[e.id]==null)this.id2Value[e.id]=z6(e,n),this.name2Id[e.name]=e.id,s!=null&&(this.id2Mask[e.id]=s);else throw new z(`Duplicate key: name=${e.name}, id=${e.id}`);return this}addFeed(e){this.add(e.key,e.value)}hasKey(e){return this.id2Value[e.id]!=null}names(){return Object.keys(this.name2Id)}getValue(e){if(e instanceof Do){if(this.id2Value[e.id]==null)throw new z(`Nonexistent key: ${e.name}`);return this.id2Value[e.id]}else{const n=this.name2Id[e];if(n==null)throw new z(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Value[n]}}getMask(e){if(e instanceof Do){if(this.id2Value[e.id]==null)throw new z(`Nonexistent key: ${e.name}`);return this.id2Mask[e.id]}else{const n=this.name2Id[e];if(n==null)throw new z(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Mask[n]}}disposeMasks(){this.id2Mask!=null&&tt(this.id2Mask)}}const Td=new nE,Nd=new nE;function W6(t){Td!=null&&Td.setMaxEntries(t),Nd!=null&&Nd.setMaxEntries(t)}function sc(t,e,n,s){const o=n==null?!1:n.training,r=Array.isArray(t),i=r?t:[t],a=i.map(p=>p.name),l=[],c=e.names();for(const p of a)c.indexOf(p)!==-1?l.push(e.getValue(p)):l.push(null);s!=null&&(s.maxNumTensors=-1/0,s.minNumTensors=1/0);const u=a.join(",")+"|"+e.names().sort().join(",");let h=Td.get(u),d;if(h==null){const p=U6(i,e);h=p.sorted,d=p.recipientCounts,Td.put(u,h),Nd.put(u,d)}d={},o||Object.assign(d,Nd.get(u));const f=new Nr(e);for(let p=0;p<h.length;++p){if(s!=null){const N=Yg().numTensors;N>s.maxNumTensors&&(s.maxNumTensors=N),N<s.minNumTensors&&(s.minNumTensors=N)}const g=h[p],b=g.sourceLayer;if(b instanceof Ku)continue;const x=[],y=[],w=[];let v=!1;for(const N of g.inputs){const A=f.getValue(N),F=f.getMask(N);x.push(A),y.push(F),F!=null&&(v=!0),o||(d[N.name]--,d[N.name]===0&&!e.hasKey(N)&&a.indexOf(N.name)===-1&&!A.isDisposed&&N.sourceLayer.stateful!==!0&&w.push(A))}v&&(n=n||{},n.mask=y[0]);const $=Ot(b.apply(x,n));let _=null;b.supportsMasking&&(_=b.computeMask(x,y));const E=G6(g),k=Array.isArray(E)?E:[E];for(let N=0;N<k.length;++N){f.hasKey(k[N])||f.add(k[N],$[N],Array.isArray(_)?_[0]:_);const A=a.indexOf(k[N].name);A!==-1&&(l[A]=$[N])}o||tt(w)}return f.disposeMasks(),r?l:l[0]}function U6(t,e){T(t!=null&&t.length>0,()=>"Expected at least one fetch, got none");let n=[],s={};if(t.length===1){const o=aC(t[0],e);n=o.sorted,s=o.recipientMap}else{const o=new Set;for(const r of t){const{sorted:i,recipientMap:a}=aC(r,e);for(const l of i)o.has(l.name)||(n.push(l),o.add(l.name));for(const l in a)s[l]==null&&(s[l]=new Set),a[l].forEach(c=>s[l].add(c))}}return{sorted:n,recipientCounts:H6(s)}}function H6(t){const e={};for(const n in t)e[n]=t[n].size;return e}function aC(t,e){const n=new Set,s=[],o={};for(const a of e.names())n.add(a);const r=[],i=[];for(r.push(t);r.length>0;){const a=r[r.length-1];if(n.has(a.name)){r.pop();continue}const l=i[i.length-1]===r.length-1;if(a.inputs.length===0||l)r.pop(),s.push(a),n.add(a.name),l&&i.pop();else{i.push(r.length-1);for(const c of a.inputs)o[c.name]==null&&(o[c.name]=new Set),o[c.name].add(a.name),!n.has(c.name)&&r.push(c)}}return{sorted:s,recipientMap:o}}function G6(t){let e;if(t.sourceLayer.inboundNodes.length===1)e=t.sourceLayer.output;else{let n=null;for(let s=0;s<t.sourceLayer.inboundNodes.length;++s)for(const o of t.sourceLayer.inboundNodes[s].outputTensors)if(o.id===t.id){n=s;break}e=t.sourceLayer.getOutputAt(n)}return e}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j6=se();j6.registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,W6);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function h0(t,e){return J(()=>Wn(Le(V(t,t),e,!0)))}class Xu extends Il{getConfig(){return{}}}class vE extends Xu{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return J(()=>{const n=h0(e,this.axis),s=Ss(n,0,this.maxValue);return V(e,ze(s,ye(on(),n)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}vE.className="MaxNorm";ge(vE);class wE extends Xu{constructor(e){super(),this.defaultAxis=0,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return J(()=>ze(e,ye(on(),h0(e,this.axis))))}getConfig(){return{axis:this.axis}}}wE.className="UnitNorm";ge(wE);class CE extends Xu{apply(e){return dr(e)}}CE.className="NonNeg";ge(CE);class $E extends Xu{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=e.minValue!=null?e.minValue:this.defaultMinValue,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.rate=e.rate!=null?e.rate:this.defaultRate,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return J(()=>{const n=h0(e,this.axis),s=ye(V(this.rate,Ss(n,this.minValue,this.maxValue)),V(1-this.rate,n));return V(e,ze(s,ye(on(),n)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}$E.className="MinMaxNorm";ge($E);const lC={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function an(t){return e0(t)}function cC(t,e={}){return Hu(t,Ms.getMap().classNameMap,e,"constraint")}function ln(t){if(t==null)return null;if(typeof t=="string"){const n={className:t in lC?lC[t]:t,config:{}};return cC(n)}else return t instanceof Xu?t:cC(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function vi(t){if(t==null)return;const e=[],n=[],s=[];for(const o in t){const r=t[o];if(typeof r!="number"){const i=r;e.push(i.data()),n.push(o),s.push(i)}}if(e.length>0){const o=await Promise.all(e);for(let r=0;r<o.length;++r)t[n[r]]=o[r][0];tt(s)}}function IE(t){if(t!=null)for(const e in t){const n=t[e];typeof n!="number"&&n.dispose()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var uC;(function(t){t[t.SILENT=0]="SILENT",t[t.VERBOSE=1]="VERBOSE"})(uC||(uC={}));const q6=125;class Ec{constructor(){this.validationData=null}setParams(e){this.params=e}async onEpochBegin(e,n){}async onEpochEnd(e,n){}async onBatchBegin(e,n){}async onBatchEnd(e,n){}async onTrainBegin(e){}async onTrainEnd(e){}setModel(e){}}class K6{constructor(e,n=10){e==null&&(e=[]),this.callbacks=e,this.queueLength=n}append(e){this.callbacks.push(e)}setParams(e){for(const n of this.callbacks)n.setParams(e)}setModel(e){for(const n of this.callbacks)n.setModel(e)}async onEpochBegin(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onEpochBegin(e,n)}async onEpochEnd(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onEpochEnd(e,n)}async onBatchBegin(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onBatchBegin(e,n)}async onBatchEnd(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onBatchEnd(e,n)}async onTrainBegin(e){e==null&&(e={});for(const n of this.callbacks)await n.onTrainBegin(e)}async onTrainEnd(e){e==null&&(e={});for(const n of this.callbacks)await n.onTrainEnd(e)}}class X6 extends Ec{constructor(){super()}async onEpochBegin(e){this.seen=0,this.totals={}}async onBatchEnd(e,n){n==null&&(n={});const s=n.size==null?0:n.size;this.seen+=s;for(const o in n){const r=n[o];if(typeof r=="number")this.totals.hasOwnProperty(o)||(this.totals[o]=0),this.totals[o]=this.totals[o]+r*s;else{let i;o in this.totals?i=this.totals[o]:this.totals[o]=0;const a=J(()=>ye(this.totals[o],V(r,s)));this.totals[o]=a,i!=null&&i.dispose()}}}async onEpochEnd(e,n){if(n!=null)for(const s of this.params.metrics)this.totals[s]!=null&&(typeof this.totals[s]=="number"?n[s]=this.totals[s]/this.seen:J(()=>{const o=V(ze(1,this.seen),this.totals[s]);n[s]=o,this.totals[s].dispose(),Uo(n[s])}))}}class Y6 extends Ec{async onTrainBegin(e){this.epoch=[],this.history={}}async onEpochEnd(e,n){n==null&&(n={}),this.epoch.push(e);for(const s in n)this.history[s]==null&&(this.history[s]=[]),this.history[s].push(n[s])}async syncData(){const e=[],n=[],s=[];for(const r in this.history){const i=this.history[r];for(let a=0;a<i.length;++a)if(typeof i[a]!="number"){const l=i[a];e.push(l.data()),n.push(r),s.push(a)}}const o=await Promise.all(e);for(let r=0;r<o.length;++r)this.history[n[r]][s[r]].dispose(),this.history[n[r]][s[r]]=o[r][0]}}class Z6 extends Ec{constructor(e,n){if(super(),this.currentEpoch=0,this.nowFunc=e.nowFunc,this.nextFrameFunc=e.nextFrameFunc||Tk,this.yieldEvery=n||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=q6),this.yieldEvery==="never"&&e.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");Og(this.yieldEvery)&&(this.maybeWait=d6(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=e.onTrainBegin,this.trainEnd=e.onTrainEnd,this.epochBegin=e.onEpochBegin,this.epochEnd=e.onEpochEnd,this.batchBegin=e.onBatchBegin,this.batchEnd=e.onBatchEnd,this.yield=e.onYield}async maybeWait(e,n,s){const o=[];this.yield!=null&&(await vi(s),o.push(this.yield(e,n,s))),o.push(this.nextFrameFunc()),await Promise.all(o)}async onEpochBegin(e,n){this.currentEpoch=e,this.epochBegin!=null&&(await vi(n),await this.epochBegin(e,n))}async onEpochEnd(e,n){const s=[];this.epochEnd!=null&&(await vi(n),s.push(this.epochEnd(e,n))),this.yieldEvery==="epoch"&&s.push(this.nextFrameFunc()),await Promise.all(s)}async onBatchBegin(e,n){this.batchBegin!=null&&(await vi(n),await this.batchBegin(e,n))}async onBatchEnd(e,n){const s=[];this.batchEnd!=null&&(await vi(n),s.push(this.batchEnd(e,n))),this.yieldEvery==="batch"?s.push(this.nextFrameFunc()):Og(this.yieldEvery)&&s.push(this.maybeWait(this.currentEpoch,e,n)),await Promise.all(s)}async onTrainBegin(e){this.trainBegin!=null&&(await vi(e),await this.trainBegin(e))}async onTrainEnd(e){this.trainEnd!=null&&(await vi(e),await this.trainEnd(e))}}function _E(t,e){return t==null&&(t={}),t instanceof Ec?[t]:Array.isArray(t)&&t[0]instanceof Ec?t:Ot(t).map(s=>new Z6(s,e))}class Fs{constructor(){}static registerCallbackConstructor(e,n){T(e>=0&&Number.isInteger(e),()=>`Verbosity level is expected to be an integer >= 0, but got ${e}`),Fs.checkForDuplicate(n),Fs.constructors[e]==null&&(Fs.constructors[e]=[]),Fs.constructors[e].push(n)}static checkForDuplicate(e){for(const n in Fs.constructors)Fs.constructors[+n].forEach(o=>{if(o===e)throw new z("Duplicate callback constructor.")})}static clear(){Fs.constructors={}}static createCallbacks(e){const n=[];for(const s in Fs.constructors){const o=+s;e>=o&&n.push(...Fs.constructors[o])}return n.map(s=>new s)}}Fs.constructors={};function kE(t,e,n,s,o,r,i,a,l){const c=new Y6,u=[new X6,...Fs.createCallbacks(e)];t!=null&&u.push(...t),u.push(c);const h=new K6(u);return h.setParams({epochs:n,initialEpoch:s,samples:o,steps:r,batchSize:i,verbose:e,doValidation:a,metrics:l}),{callbackList:h,history:c}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Bo(t,e={},n=!1){return Hu(t,Ms.getMap().classNameMap,e,"layer",n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Ad(t,e){return J(()=>{t.dtype!=="float32"&&(t=Ae(t,"float32"));const n=Le(ju(t),e,!0),s=yp(n.shape,on()),o=Wn(Yr(n,s));return ze(t,o)})}function Ap(t,e){return J(()=>Kt(ju(Pe(e,t)),-1))}function d0(t,e){return J(()=>Kt(dn(Pe(e,t)),-1))}function f0(t,e){return J(()=>{const n=Pe(t,e),s=Ss(dn(t),on(),Number.MAX_VALUE),o=dn(ze(n,s));return V(100,Kt(o,-1))})}function Q6(t,e){return J(()=>{const n=Ss(e,on(),Number.MAX_VALUE),s=Ks(ye(1,n)),o=Ss(t,on(),Number.MAX_VALUE),r=Ks(ye(1,o));return Kt(ju(Pe(s,r)),-1)})}function J6(t,e){return J(()=>{const n=Yr(0,Pe(1,V(t,e)));return Kt(ju(n),-1)})}function eX(t,e){return J(()=>{const n=Yr(0,Pe(1,V(t,e)));return Kt(n,-1)})}function tX(t,e){return J(()=>{const n=Le(V(t,e),-1),s=Lo(V(Pe(1,t),e),-1);return Yr(0,ye(1,Pe(s,n)))})}function nX(t,e){return J(()=>{const n=Math.log(2),s=Pe(e,t),o=Pe(ye(s,Mu(V(-2,s))),n);return Kt(o,-1)})}function Sc(t,e,n=!1){return J(()=>{if(n)e=xy(e);else{const s=Le(e,e.shape.length-1,!0);e=ze(e,s)}return e=Ss(e,on(),1-on()),Gt(Le(V(Ae(t,"float32"),Ks(e)),e.shape.length-1))})}function Rd(t,e,n=!1){return J(()=>{const s=Ae(vp(I6(t)),"int32");e=Ss(e,on(),1-on());const o=e.shape,r=j(D_(s,o[o.length-1]),o);return Sc(r,e,n)})}function sX(t,e){if(!bt(t.shape,e.shape))throw new z(`logits and labels must have the same shape, but got shapes ${JSON.stringify(t.shape)} and ${JSON.stringify(e.shape)}`);return J(()=>{const n=dr(e),s=Gt(dn(e));return ye(Pe(n,V(e,t)),ly(qs(s)))})}function Rp(t,e){return J(()=>{let n;return n=Ss(e,on(),1-on()),n=Ks(ze(n,Pe(1,n))),Kt(sX(t,n),-1)})}function oX(t,e){return J(()=>{const n=Ss(t,on(),1),s=Ss(e,on(),1);return Le(V(t,Ks(ze(n,s))),-1)})}function rX(t,e){return J(()=>{const n=Ks(ye(on(),e));return Kt(Pe(e,V(t,n)),-1)})}function EE(t,e){return J(()=>{const n=Ad(t,-1),s=Ad(e,-1),o=V(n,s);return Gt(Le(o,-1))})}const Dd={meanSquaredError:Ap,meanAbsoluteError:d0,meanAbsolutePercentageError:f0,meanSquaredLogarithmicError:Q6,squaredHinge:J6,hinge:eX,categoricalHinge:tX,logcosh:nX,categoricalCrossentropy:Sc,sparseCategoricalCrossentropy:Rd,binaryCrossentropy:Rp,kullbackLeiblerDivergence:oX,poisson:rX,cosineProximity:EE};function Ym(t){if(typeof t=="string"){if(t in Dd)return Dd[t];let e=`Unknown loss ${t}`;throw t.toLowerCase().includes("softmaxcrossentropy")&&(e=`Unknown loss ${t}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new z(e)}else return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function SE(t,e){return J(()=>{const n=V(.5,Xs(e)),s=Sp(Qs(e,n),t.dtype);return Kt(Ho(t,s),-1)})}function TE(t,e){return J(()=>Sp(Ho(_c(t,-1),_c(e,-1)),"float32"))}function iX(t,e){return J(()=>Ae(Le(ir(Ho(t,1),Ho(e,1))),"float32"))}function aX(t,e){return J(()=>Ae(Le(ir(Ho(t,0),Ho(e,1))),"float32"))}function lX(t,e){return J(()=>{const n=iX(t,e),s=aX(t,e),o=ye(n,s);return Ae(fs(Qs(o,0),ze(n,o),0),"float32")})}function cX(t,e){return Rp(t,e)}function uX(t,e){return t.rank===e.rank&&(t=Bu(t,[t.rank-1])),e=_c(e,-1),e.dtype!==t.dtype&&(e=Ae(e,t.dtype)),Ae(Ho(t,e),"float32")}const hX=Ap,dX=Ap,fX=d0,pX=d0,mX=f0,gX=f0,NE=Sc,bX=EE,AE=Rd,Od={binaryAccuracy:SE,categoricalAccuracy:TE,precision:lX,categoricalCrossentropy:NE,sparseCategoricalCrossentropy:AE,mse:hX,MSE:dX,mae:fX,MAE:pX,mape:mX,MAPE:gX,cosine:bX};function xX(t){if(typeof t=="string"&&t in Od)return Od[t];if(typeof t!="string"&&t!=null)return t;throw new z(`Unknown metric ${t}`)}function Wh(t){if(So(t!==null,`Unknown LossOrMetricFn ${t}`),typeof t=="string")return t;{let e;for(const n of Object.keys(Dd))if(Dd[n]===t){e=n;break}if(e!==void 0)return e;for(const n of Object.keys(Od))if(Od[n]===t){e=n;break}return e!==void 0?e:t.name}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function yX(t){const e={Adagrad:()=>Ta.adagrad(.01),Adadelta:()=>Ta.adadelta(1,.95,on()),Adam:()=>Ta.adam(.001,.9,.999,on()),Adamax:()=>Ta.adamax(.002,.9,.999,on(),0),RMSProp:()=>Ta.rmsprop(.001,.9,0,on()),SGD:()=>Ta.sgd(.01)};if(e.adagrad=e.Adagrad,e.adadelta=e.Adadelta,e.adam=e.Adam,e.adamax=e.Adamax,e.rmsprop=e.RMSProp,e.sgd=e.SGD,t in e)return e[t]();throw new z(`Unknown Optimizer ${t}`)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const hC=1*1024*1024;function dC(t,e,n=!1){if(t==null||typeof t!="object"||Object.getPrototypeOf(t)!==Object.prototype||!cb(t))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){const s=JSON.stringify(t);s.length>hC&&console.warn(`User-defined metadata of model "${e}" is too large in size (length=${s.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= ${hC}.`)}}function cb(t){if(t===null)return!0;if(typeof t=="object")if(Object.getPrototypeOf(t)===Object.prototype){const e=Object.keys(t);for(const n of e)if(typeof n!="string"||!cb(t[n]))return!1;return!0}else if(Array.isArray(t)){for(const e of t)if(!cb(e))return!1;return!0}else return!1;else{const e=typeof t;return e==="string"||e==="number"||e==="boolean"}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function vX(t,e,n,s=console.log){const o=CX(t),r=["Layer (type)","Input Shape","Output shape","Param #"];o?(e=e||90,n=n||[.32,.61,.89,1]):(e=e||115,n=n||[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map(u=>Math.floor(e*u)));let i;if(!o){r.push("Receives inputs"),i=[];for(const u in t.nodesByDepth)i.push(...t.nodesByDepth[u])}s("_".repeat(e)),Fd(r,n,s),s("=".repeat(e));const a=t.layers;for(let u=0;u<a.length;++u)o?$X(a[u],n,s):IX(a[u],n,i,s),s((u===a.length-1?"=":"_").repeat(e));t.checkTrainableWeightsConsistency();const l=wX(t),c=Sd(t.nonTrainableWeights);s(`Total params: ${l+c}`),s(`Trainable params: ${l}`),s(`Non-trainable params: ${c}`),s("_".repeat(e))}function wX(t){let e;return t.collectedTrainableWeights!=null?e=Sd(t.collectedTrainableWeights):e=Sd(t.trainableWeights),e}function CX(t){let e=!0;const n=[],s=[];for(const o in t.nodesByDepth)n.push(t.nodesByDepth[o]);for(const o of n){if(o.length>1||o.length===1&&o[0].inboundLayers.length>1){e=!1;break}s.push(...o)}if(e)for(const o of t.layers){let r=!1;for(const i of o.inboundNodes)if(s.indexOf(i)!==-1)if(r){e=!1;break}else r=!0;if(!e)break}return e}function Fd(t,e,n=console.log){let s="";for(let o=0;o<t.length;++o)o>0&&(s=s.slice(0,s.length-1)+" "),s+=t[o],s=s.slice(0,e[o]),s+=" ".repeat(e[o]-s.length);n(s)}function $X(t,e,n){let s,o;try{o=t.inboundNodes.map(l=>JSON.stringify(l.inputShapes)).join(",")}catch{o="multiple"}try{s=JSON.stringify(t.outputShape)}catch{s="multiple"}const r=t.name,i=t.getClassName(),a=[`${r} (${i})`,o,s,t.countParams().toString()];Fd(a,e,n)}function IX(t,e,n,s){let o,r;try{r=t.inboundNodes.map(h=>JSON.stringify(h.inputShapes)).join(",")}catch{r="multiple"}try{o=JSON.stringify(t.outputShape)}catch{o="multiple"}const i=[];for(const h of t.inboundNodes)if(!(n!=null&&n.length>0&&n.indexOf(h)===-1))for(let d=0;d<h.inboundLayers.length;++d){const f=h.inboundLayers[d].name,p=h.nodeIndices[d],g=h.tensorIndices[d];i.push(`${f}[${p}][${g}]`)}const a=t.name,l=t.getClassName(),c=i.length===0?"":i[0],u=[`${a} (${l})`,r,o,t.countParams().toString(),c];Fd(u,e,s);for(let h=1;h<i.length;++h)Fd(["","","","",i[h]],e,s)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function RE(t,e,n){return(t==="inboundNodes"||t==="outputLayers"||t==="inputLayers")&&e===0&&typeof n=="string"}function Ld(t,e){if(t===null)return null;if(typeof t=="string")return Ei(t);if(typeof t=="number"||typeof t=="boolean")return t;if(t instanceof Array){const n=[],s=t.length;for(let o=0;o<s;++o){const r=t[o];RE(e,o,r)?n.push(r):n.push(Ld(r,e))}return n}else{const n={};for(const s of Object.keys(t)){const o=t[s];if(s==="name"&&typeof o=="string")n[s]=o;else{const r=Ei(s);n[r]=Ld(o,r)}}return n}}function ub(t,e){if(t==null)return null;if(typeof t=="string")return er(t);if(typeof t=="number"||typeof t=="boolean")return t;if(t instanceof Array){const n=[],s=t.length;for(let o=0;o<s;++o){const r=t[o];RE(e,o,r)?n.push(r):n.push(ub(r,e))}return n}else{const n={};for(const s of Object.keys(t)){const o=t[s],r=er(s);(s==="name"||s==="className")&&typeof o=="string"?n[r]=o:n[r]=ub(o,s)}return n}}/** @license See the LICENSE file. */const DE="3.20.0";/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class io extends ht{constructor(e){if(super({}),this.containerNodes=new Set,this.name=e.name,this.name==null){const y=this.getClassName().toLowerCase();this.name=Ep(y)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(e.inputs)?this.inputs=e.inputs.slice():this.inputs=[e.inputs],Array.isArray(e.outputs)?this.outputs=e.outputs.slice():this.outputs=[e.outputs],Fr(this.inputs).length!==this.inputs.length)throw new z(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(y=>y.name)}`);Fr(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(y=>y.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const y of this.outputs){const w=y.sourceLayer,v=y.nodeIndex,$=y.tensorIndex;this.outputLayers.push(w),this.outputLayersNodeIndices.push(v),this.outputLayersTensorIndices.push($)}for(const y of this.inputs){const w=y.sourceLayer,v=y.nodeIndex,$=y.tensorIndex;So(v===0,"input layer has >1 nodes"),So($===0,"input layer has >1 tensors"),this.inputLayers.push(w),this.inputLayersNodeIndices.push(v),this.inputLayersTensorIndices.push($)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let y=0;y<this.inputLayers.length;y++){const w=this.inputLayers[y];if(!(w instanceof Ku))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${e.inputs}. Input ${y} (0-based) originates from layer type ${w.getClassName()}.`);this.inputNames.push(w.name),this.feedInputShapes.push(w.batchInputShape),this.feedInputNames.push(w.name)}for(const y of this.outputLayers)this.outputNames.push(y.name);this.internalInputShapes=this.inputs.map(y=>y.shape),this.internalOutputShapes=this.outputs.map(y=>y.shape);const n={},s={},o={},r={},i={},a=[],l=(y,w,v,$,_,E)=>{($==null||_==null||E==null)&&($=y.sourceLayer,_=y.nodeIndex,E=y.tensorIndex);const k=$.inboundNodes[_];if(v.indexOf(k)!==-1)throw new Us(`The tensor ${y.name} at layer "${$.name}" is part of a cycle.`);if(w.indexOf(k)!==-1)return;this.containerNodes.add(io.nodeKey($,_)),$.id in i||(i[$.id]=Object.keys(i).length),v.indexOf(k)===-1&&v.push(k);const N=k.inboundLayers.length;for(let A=0;A<N;A++){const F=k.inputTensors[A],L=k.inboundLayers[A],H=k.nodeIndices[A],M=k.tensorIndices[A];l(F,w,v,L,H,M)}for(w.push(k);v.indexOf(k)>=0;)v.splice(v.indexOf(k),1);a.push(k)},c=[],u=[];for(const y of this.outputs)l(y,c,u);const h=a.slice().reverse();for(const y of h){s[y.id]=y,y.id in n||(n[y.id]=0);let w=n[y.id];const v=o[y.outboundLayer.id]==null?0:o[y.outboundLayer.id];w=Math.max(w,v),o[y.outboundLayer.id]=w,r[y.outboundLayer.id]=y.outboundLayer,n[y.id]=w;for(let $=0;$<y.inboundLayers.length;$++){const _=y.inboundLayers[$],E=y.nodeIndices[$],k=_.inboundNodes[E],N=n[k.id]==null?0:n[k.id];n[k.id]=Math.max(w+1,N),s[k.id]=k}}const d={};for(const y in n){const w=n[y];w in d||(d[w]=[]),d[w].push(s[y])}const f={};for(const y in o){const w=o[y];w in f||(f[w]=[]),f[w].push(r[y])}let p=Object.keys(f).map(y=>parseInt(y,10)).sort(Bh);this.layers=[];for(const y of p){const w=f[y];w.sort((v,$)=>{const _=i[v.id],E=i[$.id];return _<E?-1:_>E?1:0});for(const v of w)v instanceof io&&this.internalContainerRefs.push(v),this.layers.push(v)}this.layersByDepth=f,p=Object.keys(d).map(y=>parseInt(y,10)).sort(Bh);const g=this.inputs.slice(),b=[];for(const y of p)for(const w of d[y]){const v=w.outboundLayer;if(v!=null){for(const $ of w.inputTensors)if(g.indexOf($)===-1)throw new Us(`Graph disconnected: cannot obtain value for tensor ${$} at layer "${v.name}". The following previous layers were accessed without issue: ${b}`);for(const $ of w.outputTensors)g.push($);b.push(v.name)}}this.nodesByDepth=d;const x=this.layers.map(y=>y.name);for(const y of x){const w=x.filter(v=>v===y).length;if(w!==1)throw new Us(`The name "${y}" is used ${w} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(x))}this.outboundNodes=[],this.inboundNodes=[],new Np({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(y=>null),outputMasks:this.outputs.map(y=>null),inputShapes:this.inputs.map(y=>y.shape),outputShapes:this.outputs.map(y=>y.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const e={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount===0){for(const n of this.layers)e.numDisposedVariables+=n.dispose().numDisposedVariables;for(const n of this.internalContainerRefs)e.numDisposedVariables+=n.dispose().numDisposedVariables}return e.refCountAfterDispose=this._refCount,e}get trainable(){return this.trainable_}set trainable(e){this.layers.forEach(n=>{n._trainableWeights.forEach(s=>s.trainable=e)}),this.trainable_=e}get trainableWeights(){if(this._trainableWeights.length>0)throw new z("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let e=[];for(const n of this.layers)e=e.concat(n.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const n of this.layers)e.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const s of this.layers)n.push(...s.trainableWeights);return n.concat(e)}return e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(e,n=!0){const s={};let o=0;for(const i of this.layers)for(const a of i.weights){if(s[a.originalName]!=null)throw new z(`Duplicate weight name: ${a.originalName}`);s[a.originalName]=a,o++}const r=[];for(const i in e){let a=i;if(s[i]==null){const l=i.split("/");a=l.slice(0,-2).concat([l[l.length-1]]).join("/")}if(s[a]!=null)r.push([s[a],e[i]]);else if(n)throw new z(`Provided weight data has no target variable: ${i}`);delete s[a]}if(n){const i=[];for(const a in s)i.push(a);if(i.length>0)throw new z(`${i.length} of ${o} weights are not set: ${i}`)}u0(r)}updatedConfig(){const e=this.getConfig(),n={};return n.className=this.getClassName(),n.config=e,n.kerasVersion=`tfjs-layers ${DE}`,n.backend="TensorFlow.js",n}toJSON(e,n=!0){const s=ub(this.updatedConfig());return n?JSON.stringify(s):s}call(e,n){return J(()=>{e=Ot(e);const s=new Nr;for(let o=0;o<this.inputs.length;++o)s.add(this.inputs[o],e[o]);return sc(this.outputs,s,n)})}computeMask(e,n){return J(()=>{e=Ot(e);let s;return n==null?s=ea(null,e.length):s=Ot(n),this.runInternalGraph(e,s)[1]})}computeOutputShape(e){const n=Ed(e);if(n.length!==this.inputLayers.length)throw new z(`Invalid inputShape argument ${e}: model has ${this.inputLayers.length} tensor inputs.`);const s={};for(let a=0;a<n.length;a++){const l=this.inputLayers[a],c=n[a],u=l.name+"_0_0";s[u]=c}const o=Object.keys(this.nodesByDepth).map(a=>parseInt(a,10)).sort(Bh);if(o.length>1)for(const a of o){const l=this.nodesByDepth[a];for(const c of l){const u=c.outboundLayer;if(this.inputLayers.map(g=>g.id).indexOf(u.id)!==-1)continue;const h=[];for(let g=0;g<c.inboundLayers.length;g++){const b=c.inboundLayers[g],x=c.nodeIndices[g],y=c.tensorIndices[g],w=`${b.name}_${x}_${y}`,v=s[w];h.push(v)}const d=u.computeOutputShape(Jn(h)),f=Ed(d),p=u.inboundNodes.indexOf(c);for(let g=0;g<f.length;g++){const b=`${u.name}_${p}_${g}`;s[b]=f[g]}}}const r=[],i=[];for(let a=0;a<this.outputLayers.length;a++){const l=this.outputLayers[a],c=this.outputLayersNodeIndices[a],u=this.outputLayersTensorIndices[a],h=`${l.name}_${c}_${u}`;i.push(h)}for(let a=0;a<i.length;a++){const l=i[a];So(l in s),r.push(s[l])}return Jn(r)}runInternalGraph(e,n){n==null&&(n=ea(null,e.length));const s={};for(let l=0;l<this.inputs.length;++l){const c=this.inputs[l],u=e[l],h=n[l];s[c.id]=[u,h]}const o=Object.keys(this.nodesByDepth).map(l=>parseInt(l,10)).sort(Bh);for(const l of o){const c=this.nodesByDepth[l];for(const u of c){const h=u.outboundLayer,d=u.inputTensors,f=u.outputTensors,p=new Array;for(const g of d)g.id in s&&p.push(s[g.id]);if(p.length===d.length){let g={},b,x,y,w;if(u.callArgs!=null&&(g=u.callArgs),p.length===1){const[v,$]=p[0];g.mask==null&&(g.mask=$),y=Ot(h.call(v,g)),w=Ot(h.computeMask(v,$)),b=[v],x=[$]}else b=p.map(v=>v[0]),x=p.map(v=>v[1]),g.mask==null&&(g.mask=x),y=Ot(h.call(b,g)),w=Ot(h.computeMask(b,x));if(h.activityRegularizer)throw new Ze("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let v=0;v<f.length;++v){const $=f[v],_=y[v],E=w[v];s[$.id]=[_,E]}}}}const r=[],i=[],a=[];for(const l of this.outputs){So(l.id in s,`Could not compute output ${l.name} : ${l.id}`);const[c,u]=s[l.id];a.push(c.shape),r.push(c),i.push(u)}return[r,i,a]}buildNodeConversionMap(e){const n={};let s;for(const o of this.layers){s=o instanceof io?1:0;for(let r=0;r<o.inboundNodes.length;r++){const i=io.nodeKey(o,r);this.containerNodes.has(i)&&(n[i]=s,s+=1)}}return n}getLayer(e,n){if(n!=null){if(this.layers.length<=n)throw new z(`Was asked to retrieve layer at index ${n}, but model only has ${this.layers.length} layer(s).`);return this.layers[n]}else if(e==null)throw new z("Provide either a layer name or layer index");for(const s of this.layers)if(s.name===e)return s;throw new z(`No such layer: ${e}`)}calculateLosses(){return J(()=>{const e=[];for(const n of this.layers)for(let s=0;s<n.inboundNodes.length;++s){const o=io.nodeKey(n,s);this.containerNodes.has(o)&&e.push(...n.calculateLosses())}return e})}getConfig(){const e={name:this.name},n=this.buildNodeConversionMap(this.layers),s=[];for(const i of this.layers){const a=i.getClassName(),l=i.getConfig(),c=[];for(let h=0;h<i.inboundNodes.length;h++){const d=i.inboundNodes[h],f=io.nodeKey(i,h);let p={};if(this.containerNodes.has(f)){if(d.callArgs)try{JSON.stringify(d.callArgs),p=d.callArgs}catch{console.warn(`Layer ${i.name} was passed non-serializable keyword arguments: ${d.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),p={}}if(d.inboundLayers.length>0){const g=[];for(let b=0;b<d.inboundLayers.length;b++){const x=d.inboundLayers[b],y=d.nodeIndices[b],w=d.tensorIndices[b],v=io.nodeKey(x,y);let $=n[v];$==null&&($=0),g.push([x.name,$,w,p])}c.push(g)}}}const u={};u.name=i.name,u.className=a,u.config=l,u.inboundNodes=c,s.push(u)}e.layers=s;const o=[];for(let i=0;i<this.inputLayers.length;i++){const a=this.inputLayers[i],l=this.inputLayersNodeIndices[i],c=io.nodeKey(a,l);if(!this.containerNodes.has(c))continue;let u=n[c];u==null&&(u=0);const h=this.inputLayersTensorIndices[i];o.push([a.name,u,h])}e.inputLayers=o;const r=[];for(let i=0;i<this.outputLayers.length;i++){const a=this.outputLayers[i],l=this.outputLayersNodeIndices[i],c=io.nodeKey(a,l);if(!this.containerNodes.has(c))continue;let u=n[c];u==null&&(u=0);const h=this.outputLayersTensorIndices[i];r.push([a.name,u,h])}return e.outputLayers=r,e}static fromConfig(e,n,s={},o=!1){const r={},i={};function a(b,x){b.name in i?i[b.name].push(x):i[b.name]=[x]}function l(b,x){const y=[];let w;for(const v of x){const $=v[0],_=v[1],E=v[2];if(w=v[3]==null?{}:v[3],!($ in r)){a(b,x);return}const k=r[$];if(k.inboundNodes.length<=_){a(b,x);return}const N=k.inboundNodes[_];y.push(N.outputTensors[E])}y.length>0&&b.apply(Jn(y),w)}function c(b){const x=b.name,y=Bo(b,n.customObjects!=null?n.customObjects:{});y.setFastWeightInitDuringBuild(o),r[x]=y,b.inboundNodes.forEach(v=>{if(!(v instanceof Array))throw new z(`Corrupted configuration, expected array for nodeData: ${v}`);a(y,v)})}const u=n.name,h=n.layers;for(const b of h)c(b);for(;!h6(i);)for(const b of h){const x=r[b.name];if(x.name in i){const y=i[x.name];delete i[x.name];for(const w of y)l(x,w)}}const d=[],f=[],p=n.inputLayers;for(const b of p){const x=b[0],y=b[1],w=b[2];So(x in r);const $=r[x].inboundNodes[y].outputTensors;d.push($[w])}const g=n.outputLayers;for(const b of g){const x=b[0],y=b[1],w=b[2];So(x in r);const $=r[x].inboundNodes[y].outputTensors;f.push($[w])}return new e({inputs:d,outputs:f,name:u})}get stateful(){if(this._stateful)throw new z("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const e of this.layers)if(e.stateful)return!0;return!1}resetStates(){J(()=>{this.layers.forEach(e=>{e.stateful&&e.resetStates()})})}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function _X(t,e,n){const s=e.length;if(t==null||Array.isArray(t)&&t.length===0)return e.map(o=>null);if(s===1)return Array.isArray(t)&&t.length===1?t:typeof t=="object"&&e[0]in t?[t[e[0]]]:[t];if(Array.isArray(t)){if(t.length!==s)throw new Error(`Provided ${n} is an array of ${t.length} element(s), but the model has ${s} outputs. Make sure a set of weights is provided for each model output.`);return t}else if(typeof t=="object"&&Object.keys(t).length>0&&typeof t[Object.keys(t)[0]]=="object"){const o=[];return e.forEach(r=>{r in t?o.push(t[r]):o.push(null)}),o}else throw new Error(`The model has multiple (${s}) outputs, so ${n} must be either an array with ${s} elements or an object with ${e} keys. Provided ${n} not understood: ${JSON.stringify(t)}`)}function OE(t,e){return _X(t,e,"classWeight")}async function FE(t,e,n,s){if(e!=null||s!=null)throw new Error("Support sampleWeight is not implemented yet");if(n!=null){const o=J(()=>{if(t.shape.length===1)return Mi(t);if(t.shape.length===2){if(t.shape[1]>1)return _c(t,1);if(t.shape[1]===1)return j(t,[t.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${t.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}else throw new Error(`Unexpected rank of target (y) tensor (${t.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),r=Array.from(await o.data());tt(o);const i=[];return r.forEach(a=>{if(n[a]==null)throw new Error(`classWeight must contain all classes in the training data. The class ${a} exists in the data but not in classWeight`);i.push(n[a])}),hs(i,"float32")}else return null}function kX(t,e){return V(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const EX=32;function LE(t,e){let n,s;const o=e;n=o.xs,s=o.ys,T(n!=null&&s!=null,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${e}`);const r=fC("input",t.inputNames,n),i=fC("output",t.outputNames,s),a=r[0].shape[0];T(r.length===t.inputs.length,()=>`LayersModel has ${t.inputs.length} inputs, but the dataset provides ${r.length} inputs.  (Expected input keys: ${JSON.stringify(t.inputNames)})`),T(i.length===t.outputs.length,()=>`LayersModel has ${t.outputs.length} outputs, but the dataset provides ${i.length} outputs.  (Expected output keys: ${JSON.stringify(t.outputNames)})`);for(let l=0;l<r.length;l++)T(r[l].shape[0]===a,()=>`Batch size mismatch: input ${t.inputNames[l]} has ${r[l].shape[0]}; expected  ${a} based on input ${t.inputNames[0]}.`);for(let l=0;l<i.length;l++)T(i[l].shape[0]===a,()=>`Batch size mismatch: output ${t.outputNames[l]} has ${i[l].shape[0]}; expected  ${a} based on input ${t.inputNames[0]}.`);return{xs:r,ys:i}}function fC(t,e,n){if(n instanceof tn)return[n];if(Array.isArray(n))return T(n.length===e.length,()=>`Received an array of ${n.length} Tensors, but expected ${e.length} to match the ${t} keys ${e}.`),n;{const s=[];for(const o of e){if(n[o]==null)throw new z(`The feature data generated by the dataset lacks the required ${t} key '${o}'.`);s.push(n[o])}return s}}function SX(t){if(t.length===3)throw new Ze("Validation with sample weights is not implemented yet.");return{xs:t[0],ys:t[1]}}async function TX(t,e,n){const s=n.batchesPerEpoch!=null;if(T(t.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),T(n!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),T(n.epochs!=null&&n.epochs>0&&Number.isInteger(n.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${n.epochs}`),T(!s||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${n.batchesPerEpoch}`),T(n.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),t.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");t.isTraining=!0;try{const o=n.validationData!=null;let r,i;if(o)if(pC(n.validationData))T(n.validationBatches==null||n.validationBatches>0&&Number.isInteger(n.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${n.validationBatches}`);else{const b=SX(n.validationData);r=b.xs,i=b.ys}const a=t.makeTrainFunction(),l=t.getDedupedMetricsNames();let c;o?c=l.slice().concat(l.map(b=>"val_"+b)):c=l.slice();const u=_E(n.callbacks,n.yieldEvery),h=n.verbose==null?1:n.verbose,{callbackList:d,history:f}=kE(u,h,n.epochs,null,null,NX(e,n),null,o,c);d.setModel(t),t.history=f,await d.onTrainBegin(),t.stopTraining_=!1;let p=n.initialEpoch==null?0:n.initialEpoch,g=await e.iterator();for(;p<n.epochs;){const b={};await d.onEpochBegin(p);let x=0,y=0;for(s||(g=await e.iterator());!s||x<n.batchesPerEpoch;){const w=await g.next();if(s&&w.done){console.warn(`You provided \`batchesPerEpoch\` as ${n.batchesPerEpoch}, but your dataset iterator ran out of data after ${x} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${n.batchesPerEpoch*n.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if(w.value!=null){const{xs:v,ys:$}=LE(t,w.value),_={};_.batch=y,_.size=v[0].shape[0],await d.onBatchBegin(y,_);const E=[];if(n.classWeight!=null){const A=OE(n.classWeight,t.outputNames);for(let F=0;F<A.length;++F)E.push(await FE($[F],null,A[F]))}const k=v.concat($).concat(E),N=a(k);tt(k);for(let A=0;A<l.length;++A){const F=l[A],L=N[A];_[F]=L,Uo(L)}await d.onBatchEnd(y,_),IE(_),y++,x++}if(s?x>=n.batchesPerEpoch:w.done){if(o){let v;pC(n.validationData)?v=Ot(await t.evaluateDataset(n.validationData,{batches:n.validationBatches})):v=Ot(t.evaluate(r,i,{batchSize:n.validationBatchSize==null?EX:n.validationBatchSize,verbose:0}));for(let $=0;$<t.metricsNames.length;++$)b[`val_${t.metricsNames[$]}`]=v[$]}break}if(t.stopTraining_)break}if(await d.onEpochEnd(p,b),p++,t.stopTraining_)break}return await d.onTrainEnd(),await t.history.syncData(),t.history}finally{t.isTraining=!1}}function NX(t,e){let n=null;return e.batchesPerEpoch!=null?n=e.batchesPerEpoch:Number.isFinite(t.size)&&(n=t.size),n}function pC(t){return typeof t.iterator=="function"}function AX(t){return typeof t.next=="function"}async function RX(t,e,n){n=n||{};const s=n.batches!=null,o=t.testFunction;let r=[];if(n.verbose>0)throw new Ze("Verbose mode is not implemented yet.");T(!s||n.batches>0&&Number.isInteger(n.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(n.batches)}`);const i=AX(e)?e:await e.iterator();let a=0,l=0;for(;!s||l<n.batches;){const c=await i.next();if(r=J(()=>{if(c.value){const{xs:u,ys:h}=LE(t,c.value),d=u.concat(h),f=J(()=>o(d));if(tt(d),l===0)for(let g=0;g<f.length;++g)r.push(Ge(0));const p=d[0].shape[0];for(let g=0;g<f.length;++g){const b=f[g],x=r[g];r[g]=J(()=>ye(r[g],V(p,b))),l>0&&tt(x)}tt(f),a+=p,++l}return r}),c.done){s&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${n.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let c=0;c<r.length;++c){const u=r[c];r[c]=ze(r[c],a),tt(u)}return Jn(r)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function hb(t){T(t>0&&Number.isInteger(t),()=>`batchSize is required to be a positive integer, but got ${t}`)}function oc(t,e,n){return t==null?[null]:Array.isArray(t)?t.map(s=>zi(s,e,n-e)):zi(t,e,n-e)}function p0(t,e){return J(()=>t==null?null:Array.isArray(t)?t.map(n=>p0(n,e)):uE(t,e.dtype==="int32"?e:Ae(e,"int32")))}function db(t,e){const n=[];let s=0,o=null;for(;s<t;)o=s+e,o>=t&&(o=t),n.push([s,o]),s=o;return n}async function DX(t,e,n,s,o,r,i,a,l,c,u,h,d,f,p){o==null&&(o=32),r==null&&(r=1),u==null&&(u=!0),d==null&&(d=0);let g=!1;if(l!=null&&c!=null&&(g=!0),p!=null&&(g=!0,f==null))throw new z("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const b=t.checkNumSamples(n,o,f,"steps_per_epoch");let x;b!=null&&(x=bo(0,b)),i==null&&(i=1);const{callbackList:y,history:w}=kE(a,i,r,d,b,f,o,g,h);y.setModel(t),t.history=w,await y.onTrainBegin(),t.stopTraining_=!1;for(let v=d;v<r;++v){await y.onEpochBegin(v);const $={};if(f!=null)throw new Ze("stepsPerEpoch mode is not implemented yet.");{if(u==="batch")throw new Ze("batch shuffling is not implemneted yet");u&&sz(x);const _=hs(x),E=db(b,o);for(let k=0;k<E.length;++k){const N={};if(await y.onBatchBegin(k,N),J(()=>{const A=E[k][0],F=E[k][1],L=zi(_,A,F-A);N.batch=k,N.size=F-A;const H=p0(n,L),M=e(H);for(let K=0;K<s.length;++K){const q=s[K],Q=M[K];N[q]=Q,Uo(Q)}if(k===E.length-1&&g){const K=t.testLoop(l,c,o);for(let q=0;q<s.length;++q){const Q=s[q],Y=K[q];Uo(Y),$["val_"+Q]=Y}}}),await y.onBatchEnd(k,N),IE(N),t.stopTraining_)break}_.dispose()}if(await y.onEpochEnd(v,$),t.stopTraining_)break}return await y.onTrainEnd(),await t.history.syncData(),t.history}async function OX(t,e,n,s={}){if(t.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");t.isTraining=!0;let o,r,i,a,l,c,u,h,d;try{const f=s.batchSize==null?32:s.batchSize;hb(f);const p=!1,g=await t.standardizeUserData(e,n,s.sampleWeight,s.classWeight,p,f);o=g[0],r=g[1],d=g[2];let b=!1,x;if(s.validationData!=null&&s.validationData.length>0){if(b=!0,s.validationData.length===2)l=s.validationData[0],c=s.validationData[1];else throw s.validationData.length===3?new Ze("validationData including sample weights is not supported yet."):new z(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${s.validationData} is invalid.`);const N=!0,A=await t.standardizeUserData(l,c,null,null,N,f);u=A[0],h=A[1],x=u.concat(h)}else if(s.validationSplit!=null&&s.validationSplit>0&&s.validationSplit<1){b=!0;const N=Math.floor(o[0].shape[0]*(1-s.validationSplit)),A=o[0].shape[0];u=oc(o,N,A),i=o,o=oc(o,0,N),h=oc(r,N,A),a=r,r=oc(r,0,N),x=u.concat(h)}else s.validationSteps!=null&&(b=!0);const y=o.concat(r).concat(d);t.checkTrainableWeightsConsistency();const w=t.makeTrainFunction(),v=t.getDedupedMetricsNames();let $,_;b?(t.makeTestFunction(),$=t.testFunction,_=v.slice().concat(v.map(N=>"val_"+N))):($=null,x=[],_=v.slice());const E=_E(s.callbacks,s.yieldEvery);return await DX(t,w,y,v,f,s.epochs,s.verbose,E,$,x,s.shuffle,_,s.initialEpoch,null,null)}finally{t.isTraining=!1,co(o,e),co(r,n),co(i,e),co(a,n),co(u,l),co(h,c),d!=null&&tt(d)}}function PE(t){const e=[];t instanceof tn&&(t=[t]);for(let n=0;n<t.length;++n){const s=t[n];if(s.rank===1)e.push(Gu(s,1));else{if(s.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");e.push(s)}}return e}function co(t,e){if(t==null)return;const n=[];if(e instanceof tn)n.push(e.id);else if(Array.isArray(e))e.forEach(o=>n.push(o.id));else if(e!=null)for(const o in e){const r=e[o];n.push(r.id)}const s=[];if(t instanceof tn)n.indexOf(t.id)===-1&&s.push(t);else if(Array.isArray(t))t.forEach(o=>{n.indexOf(o.id)===-1&&s.push(o)});else if(t!=null)for(const o in t){const r=t[o];n.indexOf(r.id)===-1&&s.push(r)}s.forEach(o=>{o.isDisposed||o.dispose()})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function FX(t){return t instanceof tn}function fb(t){return Array.isArray(t)}function mC(t){return!FX(t)&&!fb(t)}function gC(t,e,n,s=!0,o=""){if(e==null||e.length===0){if(t!=null){let i=!1;if(fb(t)&&t.length>0)i=!0;else if(mC(t)){for(const a in t)if(t.hasOwnProperty(a)){i=!0;break}}else i=!0;if(i)throw new z(`Error when checking model ${o} expected no data, but got ${t}`)}return[]}if(t==null)return e.map(i=>null);let r;if(mC(t)){t=t,r=[];for(const i of e){if(t[i]==null)throw new z(`No data provided for "${i}". Need data for each key in: ${e}`);r.push(t[i])}}else if(fb(t)){if(t=t,t.length!==e.length)throw new z(`Error when checking model ${o}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${e.length} Tensor(s), but instead got the following list of Tensor(s): ${t}`);r=t}else{if(t=t,e.length>1)throw new z(`The model ${o} expects ${e.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${t.shape}`);r=[t]}if(r=PE(r),n!=null)for(let i=0;i<e.length;++i){if(n[i]==null)continue;const a=r[i];if(a.shape.length!==n[i].length)throw new z(`Error when checking ${o}: expected ${e[i]} to have ${n[i].length} dimension(s). but got array with shape ${a.shape}`);for(let l=0;l<n[i].length;++l){if(l===0&&!s)continue;const c=a.shape[l],u=n[i][l];if(u!=null&&u>=0&&c!==u)throw new z(`${o} expected a batch of elements where each example has shape [${n[i].slice(1,n[i].length)}] (i.e.,tensor shape [*,${n[i].slice(1,n[i].length)}]) but the ${o} received an input with ${a.shape[0]} examples, each with shape [${a.shape.slice(1,a.shape.length)}] (tensor shape [${a.shape}])`)}}return r}function LX(t,e,n){const s=Fr(t.map(r=>r.shape[0]));s.sort();const o=Fr(e.map(r=>r.shape[0]));if(o.sort(),s.length>1)throw new z(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(t.map(r=>r.shape))}`);if(o.length>1)throw new z(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(e.map(r=>r.shape))}`);if(s.length>0&&o.length>0&&!bt(s,o))throw new z(`Input Tensors should have the same number of samples as target Tensors. Found ${s[0]} input sample(s) and ${o[0]} target sample(s).`)}function PX(t,e,n){const s=[Ap,Rp,Sc];for(let o=0;o<t.length;++o){const r=t[o],i=e[o],a=n[o];if(i!=null){if(i===Sc&&r.shape[r.shape.length-1]===1)throw new z(`You are passing a target array of shape ${r.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(s.indexOf(i)!==-1){const l=r.shape.slice(1),c=a.slice(1);for(let u=0;u<l.length;++u){const h=l[u],d=c[u];if(d!=null&&h!==d)throw new z(`A target Tensor with shape ${r.shape} was passed for an output of shape ${a}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}function bC(t,e,n,s=!0,o=""){let r;if(Array.isArray(t)){if(t.length!==e.length)throw new z(`Error when checking model ${o}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${e.length} Tensor(s), but instead got ${t.length} Tensors(s).`);r=t}else{if(e.length>1)throw new z(`The model expects ${e.length} ${o} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(t.shape)}.`);r=[t]}if(n!=null)for(let i=0;i<e.length;++i){if(n[i]==null)continue;const a=r[i];if(a.shape.length!==n[i].length)throw new z(`Error when checking ${o}: expected ${e[i]} to have ${n[i].length} dimension(s), but got array with shape ${JSON.stringify(a.shape)}`);for(let l=0;l<n[i].length;++l){if(l===0&&!s)continue;const c=a.shape[l],u=n[i][l];if(u!=null&&u!==c)throw new z(`Error when checking ${o}: expected ${e[i]} to have shape ${JSON.stringify(n[i])} but got array with shape ${JSON.stringify(a.shape)}.`)}}}function MX(t,e){if(t==null||Array.isArray(t)&&t.length===0)return e.map(s=>[]);let n;if(typeof t=="string"||typeof t=="function")n=[t];else if(Array.isArray(t)||typeof t=="object")n=t;else throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${t}`);if(Array.isArray(n))return e.map(s=>n);{const s=[];for(const o of e){let r=n.hasOwnProperty(o)?n[o]:[];Array.isArray(r)||(r=[r]),s.push(r)}return s}}const BX="layers-model";class Ka extends io{constructor(e){super(e),this.isTraining=!1}summary(e,n,s=console.log){if(!this.built)throw new z("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");vX(this,e,n,s)}compile(e){if(e.loss==null&&(e.loss=[]),this.loss=e.loss,typeof e.optimizer=="string")this.optimizer_=yX(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof Jr))throw new z("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let n=[];if(!Array.isArray(e.loss)&&typeof e.loss!="string"&&typeof e.loss!="function"){e.loss=e.loss;for(const i in e.loss)if(this.outputNames.indexOf(i)===-1)throw new z(`Unknown entry in loss dictionary: "${i}". Only expected the following keys: ${this.outputNames}`);for(const i of this.outputNames)e.loss[i]==null&&console.warn(`Output "${i}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${i} during training`),n.push(Ym(e.loss[i]))}else if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new z(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${e.loss}.`);n=e.loss.map(a=>Ym(a))}else{const i=Ym(e.loss);this.outputs.forEach(a=>{n.push(i)})}this.lossFunctions=n,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let i=0;i<this.outputs.length;++i){const a=this.internalOutputShapes[i],l=this.outputNames[i];this.feedOutputNames.push(l),this.feedOutputShapes.push(a),this.feedLossFns.push(this.lossFunctions[i])}const s=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],Vi("loss",()=>{for(let i=0;i<this.outputs.length;++i){if(s.indexOf(i)!==-1)continue;const a=this.lossFunctions[i];this.outputs.length>1&&(this.metricsTensors.push([a,i]),this.metricsNames.push(this.outputNames[i]+"_loss"))}});const o=MX(e.metrics,this.outputNames),r=(i,a,l)=>{this.outputNames.length>1&&(a=this.outputNames[i]+"_"+a),this.metricsNames.push(a),this.metricsTensors.push([l,i])};Vi("metric",()=>{for(let i=0;i<this.outputs.length;++i){if(s.indexOf(i)!==-1)continue;const a=o[i];(c=>{const u="";let h,d,f;for(const p of c){if(typeof p=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(p)!==-1){const b=this.internalOutputShapes[i];b[b.length-1]===1||this.lossFunctions[i]===Rp?["accuracy","acc"].indexOf(p)!==-1?d=SE:["crossentropy","ce"].indexOf(p)!==-1&&(d=cX):this.lossFunctions[i]===Rd?["accuracy","acc"].indexOf(p)!==-1?d=uX:["crossentropy","ce"].indexOf(p)!==-1&&(d=AE):["accuracy","acc"].indexOf(p)!==-1?d=TE:["crossentropy","ce"].indexOf(p)!==-1&&(d=NE);let x;["accuracy","acc"].indexOf(p)!==-1?x="acc":["crossentropy","ce"].indexOf(p)!==-1&&(x="ce"),f=d,h=u+x}else f=xX(p),h=u+Wh(p);let g;Vi(h,()=>{g=f}),r(i,h,g)}})(a)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,n,s={}){const o=s.batchSize==null?32:s.batchSize;hb(o);const r=!0,i=this.standardizeUserDataXY(e,n,r,o);try{const a=i[0].concat(i[1]);this.makeTestFunction();const l=this.testFunction,c=this.testLoop(l,a,o,s.verbose,s.steps);return Jn(c)}finally{co(i[0],e),co(i[1],n)}}async evaluateDataset(e,n){return this.makeTestFunction(),RX(this,e,n)}checkNumSamples(e,n,s,o="steps"){let r;if(s!=null){if(r=null,n!=null)throw new z(`If ${o} is set, batchSize must be null or undefined.Got batchSize = ${n}`)}else if(e!=null)Array.isArray(e)?r=e[0].shape[0]:r=e.shape[0];else throw new z(`Either the input data should have a defined shape, or ${o} shoud be specified.`);return r}execute(e,n){if(Array.isArray(n)&&n.length===0)throw new z("`outputs` is an empty Array, which is not allowed.");const s=Array.isArray(n),o=s?n:[n],r=this.retrieveSymbolicTensors(o),i=new Nr;if(e instanceof tn&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new z(`The number of inputs provided (${e.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let l=0;l<this.inputs.length;++l)i.add(this.inputs[l],e[l])}else for(const l of this.inputs){const c=e[l.name];if(c==null)throw new z(`No value is provided for the model's input ${l.name}`);i.add(l,c)}const a=sc(r,i);return s?a:a[0]}retrieveSymbolicTensors(e){const n=ea(null,e.length);let s=e.length;for(const o of this.layers){const r=Array.isArray(o.output)?o.output:[o.output],i=r.map(a=>a.name);for(let a=0;a<e.length;++a){const l=i.indexOf(e[a]);if(l!==-1&&(n[a]=r[l],s--),s===0)break}if(s===0)break}if(s>0){const o=[];throw n.forEach((r,i)=>{r==null&&o.push(e[i])}),new z(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(o)}`)}return n}predictLoop(e,n=32,s=!1){return J(()=>{const o=this.checkNumSamples(e);if(s)throw new Ze("Verbose predictLoop() is not implemented yet.");const r=db(o,n),i=this.outputs.map(a=>[]);for(let a=0;a<r.length;++a)J(()=>{const c=r[a][0],u=r[a][1],h=oc(e,c,u),d=[];if(Array.isArray(h))for(let p=0;p<h.length;++p)d.push({key:this.inputs[p],value:h[p]});else d.push({key:this.inputs[0],value:h});const f=new Nr(d);return sc(this.outputs,f)}).forEach((c,u)=>i[u].push(c));return Jn(i.map(a=>Dn(a,0)))})}predict(e,n={}){const s=PE(e);bC(s,this.inputNames,this.feedInputShapes,!1);try{const o=n.batchSize==null?32:n.batchSize;return hb(o),this.predictLoop(s,o)}finally{co(s,e)}}predictOnBatch(e){bC(e,this.inputNames,this.feedInputShapes,!0);const n=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,n)}standardizeUserDataXY(e,n,s=!0,o){if(this.optimizer_==null)throw new Us("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const r=[];for(let i=0;i<this.feedOutputShapes.length;++i){const a=this.feedOutputShapes[i];this.feedLossFns[i]===Rd?r.push(a.slice(0,a.length-1).concat([1])):r.push(a)}if(e=gC(e,this.feedInputNames,this.feedInputShapes,!1,"input"),n=gC(n,this.feedOutputNames,r,!1,"target"),LX(e,n),PX(n,this.feedLossFns,this.feedOutputShapes),this.stateful&&o!=null&&o>0&&e[0].shape[0]%o!==0)throw new z(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${o}. Found: ${e[0].shape[0]} sample(s).`);return[e,n]}async standardizeUserData(e,n,s,o,r=!0,i){const[a,l]=this.standardizeUserDataXY(e,n,r,i);if(s!=null)throw new Error("sample weight is not supported yet.");let c=null;if(o!=null){const u=OE(o,this.outputNames);c=[];for(let h=0;h<u.length;++h)c.push(await FE(l[h],null,u[h]))}return[a,l,c]}testLoop(e,n,s,o=0,r){return J(()=>{const i=this.checkNumSamples(n,s,r,"steps"),a=[];if(o>0)throw new Ze("Verbose mode is not implemented yet.");if(r!=null)throw new Ze("steps mode in testLoop() is not implemented yet");{const l=db(i,s),c=hs(bo(0,i));for(let u=0;u<l.length;++u){const h=l[u][0],d=l[u][1],f=zi(c,h,d-h),p=p0(n,f),g=e(p);if(u===0)for(let b=0;b<g.length;++b)a.push(Ge(0));for(let b=0;b<g.length;++b){const x=g[b];a[b]=ye(a[b],V(d-h,x))}}for(let u=0;u<a.length;++u)a[u]=ze(a[u],i)}return a})}getDedupedMetricsNames(){const e=this.metricsNames,n=[];for(let s=0;s<e.length;++s){const o=e[s];let r=o;tC(e,o)>1&&(r+=`_${tC(e.slice(0,s),o)}`),n.push(r)}return n}makeTrainFunction(){return e=>{const n=[],s=e.slice(0,this.inputs.length),o=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),r=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),i=[],a=()=>{const h=[];for(let g=0;g<this.inputs.length;++g)h.push({key:this.inputs[g],value:s[g]});const d=new Nr(h),f=sc(this.outputs,d,{training:!0});let p;for(let g=0;g<this.lossFunctions.length;++g){const b=this.lossFunctions[g];let x=b(o[g],f[g]);r[g]!=null&&(x=kX(x,r[g]));const y=Kt(x);n.push(y),g===0?p=x:p=ye(p,x)}for(let g=0;g<this.metricsTensors.length;++g){let b;if(this.outputs.length>1&&g<this.outputs.length)b=n[g];else{const x=this.metricsTensors[g][0],y=this.metricsTensors[g][1];b=Kt(x(o[y],f[y]))}Uo(b),i.push(b)}return p=Kt(p),this.calculateLosses().forEach(g=>{p=ye(p,g)}),p},l=this.collectedTrainableWeights.map(h=>h.read()),c=!0;return[this.optimizer_.minimize(a,c,l)].concat(i)}}makeTestFunction(){this.testFunction=e=>J(()=>{const n=[];let s;const o=e.slice(0,this.inputs.length),r=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),i=[];for(let c=0;c<this.inputs.length;++c)i.push({key:this.inputs[c],value:o[c]});const a=new Nr(i),l=sc(this.outputs,a);for(let c=0;c<this.lossFunctions.length;++c){const u=this.lossFunctions[c],h=Kt(u(r[c],l[c]));c===0?s=h:s=ye(s,h),n.push(s)}for(let c=0;c<this.metricsTensors.length;++c){const u=this.metricsTensors[c][0],h=this.metricsTensors[c][1],d=Kt(u(r[h],l[h]));n.push(d)}return n})}async fit(e,n,s={}){return OX(this,e,n,s)}async fitDataset(e,n){return TX(this,e,n)}async trainOnBatch(e,n){const s=await this.standardizeUserData(e,n),o=s[0],r=s[1],a=this.makeTrainFunction()(o.concat(r)),l=[];for(const c of a){const u=await c.data();l.push(u[0])}return tt(a),co(s[0],e),co(s[1],n),Jn(l)}getNamedWeights(e){const n=[],s=e!=null&&e.trainableOnly,o=s?this.trainableWeights:this.weights,r=this.getWeights(s);for(let i=0;i<o.length;++i)s&&!o[i].trainable||n.push({name:o[i].originalName,tensor:r[i]});return n}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){const e=super.dispose();if(e.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){const n=Yg().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=n-Yg().numTensors}return e}getLossIdentifiers(){let e;if(typeof this.loss=="string")e=er(this.loss);else if(Array.isArray(this.loss)){for(const n of this.loss)if(typeof n!="string")throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map(n=>er(n))}else{const n=Object.keys(this.loss);e={};const s=this.loss;for(const o of n)if(typeof s[o]=="string")e[o]=er(s[o]);else throw new Error("Serialization of non-string loss is not supported.")}return e}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[er(Wh(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(e=>er(Wh(e)));{const e={};for(const n in this.metrics)e[n]=er(Wh(this.metrics[n]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(e.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(e.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(e.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");const n=Ld(e.optimizer_config),s=Bo(n);let o;if(typeof e.loss=="string")o=Ei(e.loss);else if(Array.isArray(e.loss))o=e.loss.map(i=>Ei(i));else if(e.loss!=null){o={};for(const i in e.loss)o[i]=Ei(e.loss[i])}let r;if(Array.isArray(e.metrics))r=e.metrics.map(i=>Ei(i));else if(e.metrics!=null){r={};for(const i in e.metrics)r[i]=Ei(e.metrics[i])}this.compile({loss:o,metrics:r,optimizer:s})}async save(e,n){if(typeof e=="string"){const c=eW(e);if(c.length===0)throw new z(`Cannot find any save handlers for URL '${e}'`);if(c.length>1)throw new z(`Found more than one (${c.length}) save handlers for URL '${e}'`);e=c[0]}if(e.save==null)throw new z("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const s=await Pw(this.getNamedWeights(n)),o=!1,r=null,a={modelTopology:this.toJSON(r,o),format:BX,generatedBy:`TensorFlow.js tfjs-layers v${DE}`,convertedBy:null};if((n==null?!1:n.includeOptimizer)&&this.optimizer!=null){a.trainingConfig=this.getTrainingConfig();const c="optimizer",{data:u,specs:h}=await Pw(await this.optimizer.getWeights(),c);s.specs.push(...h),s.data=$_([s.data,u])}return this.userDefinedMetadata!=null&&(dC(this.userDefinedMetadata,this.name,!0),a.userDefinedMetadata=this.userDefinedMetadata),a.weightData=s.data,a.weightSpecs=s.specs,e.save(a)}setUserDefinedMetadata(e){dC(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}}Ka.className="Model";ge(Ka);class ME extends Ka{}ME.className="Functional";ge(ME);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function VX(t,e){if(e==null&&(e={}),typeof t=="string"){const n=tW(t,e);if(n.length===0)n.push(TW(t,e));else if(n.length>1)throw new z(`Found more than one (${n.length}) load handlers for URL '${t}'`);t=n[0]}return zX(t,void 0,e)}async function zX(t,e,n){if(n==null&&(n={}),t.load==null)throw new z("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const s=await t.load();let o=s.modelTopology;o.model_config!=null&&(o=o.model_config);const r=n.strict==null?!0:n.strict,i=s.weightData!=null&&s.weightSpecs!=null&&r,a=Bo(Ld(o),e,i),l=s.trainingConfig;if(l!=null&&a.loadTrainingConfig(l),s.userDefinedMetadata!=null&&a.setUserDefinedMetadata(s.userDefinedMetadata),s.weightData!=null){if(s.weightSpecs==null)throw new z("LayersModel artifacts contains weight data, but not weight specs. Therefore loading of weights cannot proceed.");const{modelWeights:c,optimizerWeights:u}=WX(s.weightData,s.weightSpecs);a.loadWeights(c,r),a.optimizer!=null&&u.length>0&&await a.optimizer.setWeights(u),tt(c),tt(u.map(h=>h.tensor))}return a}function WX(t,e){const n=Gz(t,e),s={},o=[];return e.forEach(r=>{r.group==="optimizer"?o.push({name:r.name,tensor:n[r.name]}):s[r.name]=n[r.name]}),{modelWeights:s,optimizerWeights:o}}class Tc extends Ka{constructor(e){if(super({inputs:[],outputs:[]}),e=e||{},this.trainable=!0,this.built=!1,this.name=e.name!=null?e.name:Ep("sequential_"),e.layers!=null)for(const n of e.layers)this.add(n)}checkShape(e){if(e.inboundNodes[0].outputTensors[0].shape.some(s=>s<0))throw new z(`Negative dimension size caused by adding layer ${e.name} with input shape [${e.inboundNodes[0].inputTensors[0].shape}]`)}add(e){const n=e instanceof Tc||e instanceof Ka;let s;if(n){if(s=e,s.outputs.length!==1)throw new z("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(s.inputs.length!==1)throw new z("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(e.inboundNodes.length===0){if(e.batchInputShape==null)throw new z("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const o=V6({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(o)}if(n)this.outputs=s.outputs,this.inputs=s.inputs;else{if(e.inboundNodes.length!==1)throw new z(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${e.name} which has ${e.inboundNodes.length} pre-existing inbound connections.`);if(e.inboundNodes[0].outputTensors.length!==1)throw new z("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=yE(this.outputs[0])}this.inboundNodes=[],new Np({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:ea(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(o=>o.shape),outputShapes:this.outputs[0].shape})}else{const o=e.apply(this.outputs[0]);if(Array.isArray(o))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[o],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(e,n){return this.model==null&&this.build(),this.model.call(e,n)}build(e){if(vt(e),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new Ka({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(e,n,s=console.log){this.built||this.build(),super.summary(e,n,s)}setWeights(e){this.model==null&&this.build(),this.model.setWeights(e)}evaluate(e,n,s={}){if(!this.built)throw new Us("The model needs to be compiled before being used.");return this.model.evaluate(e,n,s)}async evaluateDataset(e,n){if(!this.built)throw new Us("The model needs to be compiled before being used.");return this.model.evaluateDataset(e,n)}predict(e,n={}){return this.model==null&&this.build(),this.model.predict(e,n)}predictOnBatch(e){return this.model==null&&this.build(),this.model.predictOnBatch(e)}compile(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(e){this.model.optimizer=e}async fit(e,n,s={}){if(!this.built)throw new Us("The model needs to be compiled before being used.");return this.model.fit(e,n,s)}async fitDataset(e,n){if(!this.built)throw new Us("The model needs to be compiled before being used.");return this.model.fitDataset(e,n)}async trainOnBatch(e,n){return this.model.trainOnBatch(e,n)}static fromConfig(e,n,s={},o=!1){let r,i={};if(n instanceof Array){if(n[0].className==null||n[0].className==="Merge")throw new z("Legacy serialization format not supported yet.");r=n}else T(n.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),r=n.layers,delete n.layers,i=n;const a=new e(i);if(!(a instanceof Tc))throw new Ze(`Sequential.fromConfig called on non-Sequential input: ${a}`);for(const l of r){const u=Bo(l,void 0,o);o&&u.setFastWeightInitDuringBuild(!0),a.add(u)}return a}set stopTraining(e){if(this.model==null)throw new z("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}get stopTraining(){if(this.model==null)throw new z("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const e=[];for(const n of this.layers){const s={};s.className=n.getClassName(),s.config=n.getConfig(),e.push(s)}return{name:this.name,layers:e}}}Tc.className="Sequential";ge(Tc);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function UX(t,e){return e==null&&(e={}),VX(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class as extends Il{getConfig(){return{}}}class BE extends as{apply(e,n=1){return k6(e,n)}}BE.className="elu";ge(BE);class VE extends as{apply(e){return mk(e)}}VE.className="selu";ge(VE);class zE extends as{apply(e){return dr(e)}}zE.className="relu";ge(zE);class WE extends as{apply(e){return J(()=>wp(6,dr(e)))}}WE.className="relu6";ge(WE);class UE extends as{apply(e){return e}}UE.className="linear";ge(UE);class HE extends as{apply(e){return _l(e)}}HE.className="sigmoid";ge(HE);class GE extends as{apply(e){return S6(e)}}GE.className="hardSigmoid";ge(GE);class jE extends as{apply(e){return Mu(e)}}jE.className="softplus";ge(jE);class qE extends as{apply(e){return E6(e)}}qE.className="softsign";ge(qE);class KE extends as{apply(e){return ey(e)}}KE.className="tanh";ge(KE);class m0 extends as{apply(e,n=-1){return xy(e,n)}}m0.className="softmax";ge(m0);class XE extends as{apply(e,n=-1){return tk(e,n)}}XE.className="logSoftmax";ge(XE);class YE extends as{apply(e,n=1){return J(()=>V(_l(V(e,n)),e))}}YE.className="swish";ge(YE);class ZE extends as{apply(e){return J(()=>V(e,ey(Mu(e))))}}ZE.className="mish";ge(ZE);function Vr(t){return t.getClassName()}function Zm(t,e={}){return Hu(t,Ms.getMap().classNameMap,e,"activation")}function zr(t){if(t==null){const e={};return e.className="linear",e.config={},Zm(e)}if(typeof t=="string"){const e={};return e.className=t,e.config={},Zm(e)}else return t instanceof as?t:Zm(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function HX(t){if(t!=null&&typeof t!="object")throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${t}`)}class QE extends Il{}class JE extends QE{constructor(e){super(),HX(e),this.l1=e==null||e.l1==null?.01:e.l1,this.l2=e==null||e.l2==null?.01:e.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(e){return J(()=>{let n=gn([1]);return this.hasL1&&(n=ye(n,Le(V(this.l1,dn(e))))),this.hasL2&&(n=ye(n,Le(V(this.l2,ju(e))))),j(n,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,n){return new e({l1:n.l1,l2:n.l2})}}JE.className="L1L2";ge(JE);const xC={l1l2:"L1L2"};function St(t){return e0(t)}function yC(t,e={}){return Hu(t,Ms.getMap().classNameMap,e,"regularizer")}function Wt(t){if(t==null)return null;if(typeof t=="string"){const n={className:t in xC?xC[t]:t,config:{}};return yC(n)}else return t instanceof QE?t:yC(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class eS extends ht{constructor(e){super(e==null?{}:e),this.supportsMasking=!0,e!=null&&(this.maxValue=e.maxValue)}call(e,n){e=Je(e);let s=dr(e);return this.maxValue!=null&&(s=Ss(s,0,this.maxValue)),s}computeOutputShape(e){return e}getConfig(){const e={maxValue:this.maxValue},n=super.getConfig();return Object.assign(e,n),e}}eS.className="ReLU";ge(eS);class tS extends ht{constructor(e){super(e==null?{}:e),this.DEFAULT_ALPHA=.3,e==null&&(e={}),this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,n){const s=Je(e);return ay(s,this.alpha)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},n=super.getConfig();return Object.assign(e,n),e}}tS.className="LeakyReLU";ge(tS);class nS extends ht{constructor(e){if(super(e==null?{}:e),this.DEFAULT_ALPHA_INITIALIZER="zeros",e==null&&(e={}),this.supportsMasking=!0,this.alphaInitializer=zt(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=Wt(e.alphaRegularizer),this.alphaConstraint=ln(e.alphaConstraint),e.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else if(typeof e.sharedAxes=="number")this.sharedAxes=[e.sharedAxes];else throw new z(`Expected sharedAxes to be a number or an array of numbers, but got ${e.sharedAxes}`)}build(e){e=vt(e);const n=e.slice(1);if(this.sharedAxes!=null)for(const o of this.sharedAxes)n[o-1]=1;this.alpha=this.addWeight("alpha",n,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const s={};if(this.sharedAxes!=null)for(let o=1;o<e.length;++o)s[o]=e[o];this.inputSpec=[new rn({ndim:e.length,axes:s})],this.built=!0}call(e,n){return e=Je(e),py(e,this.alpha.read())}getConfig(){const e={alphaInitializer:Ht(this.alphaInitializer),alphaRegularizer:St(this.alphaRegularizer),alphaConstraint:an(this.alphaConstraint),sharedAxes:this.sharedAxes},n=super.getConfig();return Object.assign(e,n),e}}nS.className="PReLU";ge(nS);class sS extends ht{constructor(e){if(super(e==null?{}:e),this.DEFAULT_ALPHA=1,e==null&&(e={}),e.alpha!=null&&e.alpha!==this.DEFAULT_ALPHA)throw new Ze(`Non-default alpha value (${e.alpha}) is not supported by the ELU layer yet.`);this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,n){const s=Je(e);return bp(s)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},n=super.getConfig();return Object.assign(e,n),e}}sS.className="ELU";ge(sS);class oS extends ht{constructor(e){super(e==null?{}:e),this.DEFAULT_THETA=1,e==null&&(e={}),this.theta=e.theta==null?this.DEFAULT_THETA:e.theta}call(e,n){const s=Je(e);return V(s,Ae(Qs(s,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){const e={theta:this.theta},n=super.getConfig();return Object.assign(e,n),e}}oS.className="ThresholdedReLU";ge(oS);class rS extends ht{constructor(e){super(e==null?{}:e),this.DEFAULT_AXIS=1,e==null&&(e={}),this.softmax=new m0().apply,this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis}call(e,n){const s=Je(e);return this.softmax(s,this.axis)}computeOutputShape(e){return e}getConfig(){const e={axis:this.axis},n=super.getConfig();return Object.assign(e,n),e}}rS.className="Softmax";ge(rS);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Xa(t,e,n){if(typeof t=="number")return ea(t,e);if(t.length!==e)throw new z(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${t.length} elements.`);for(let s=0;s<e;++s){const o=t[s];if(!C6(o))throw new z(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${JSON.stringify(t)} including a non-integer number ${o}`)}return t}function mo(t,e,n,s,o=1){if(t==null)return t;const r=e+(e-1)*(o-1);let i;return n==="same"?i=t:i=t-r+1,Math.floor((i+s-1)/s)}function To(t,e,n,s){if(t==null)return null;if(s==="valid")t=t*e+Br([n-e,0]);else if(s==="same")t=t*e;else throw new z(`Unsupport padding mode: ${s}.`);return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function g0(t,e){return J(()=>(Qt(e),e==="channelsFirst"?lt(t,[0,2,3,1]):t))}function iS(t,e){return J(()=>(Qt(e),e==="channelsFirst"?lt(t,[0,2,3,4,1]):t))}function GX(t,e,n,s=1,o="valid",r,i=1){return J(()=>{if(r==null&&(r=xo()),Qt(r),t.shape.length!==3)throw new z(`The input of a conv1dWithBias operation should be 3, but is ${t.shape.length} instead.`);if(e.shape.length!==3)throw new z(`The kernel for a conv1dWithBias operation should be 3, but is ${e.shape.length} instead`);if(n!=null&&n.shape.length!==1)throw new z(`The bias for a conv1dWithBias operation should be 1, but is ${e.shape.length} instead`);if(r==="channelsFirst"&&(t=lt(t,[0,2,1])),o==="causal")throw new Ze("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let a=j_(t,e,s,o==="same"?"same":"valid","NWC",i);return n!=null&&(a=wo(a,n)),a})}function vC(t,e,n,s=[1,1],o="valid",r,i,a=null){return J(()=>{if(r==null&&(r=xo()),Qt(r),t.rank!==3&&t.rank!==4)throw new z(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${t.rank}.`);if(e.rank!==3&&e.rank!==4)throw new z(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${t.rank}.`);let l=g0(t,r);if(o==="causal")throw new Ze("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return l=BG({x:l,filter:e,strides:s,pad:o==="same"?"same":"valid",dilations:i,dataFormat:"NHWC",bias:n,activation:a}),r==="channelsFirst"&&(l=lt(l,[0,3,1,2])),l})}function jX(t,e,n,s=[1,1,1],o="valid",r,i){return J(()=>{if(r==null&&(r=xo()),Qt(r),t.rank!==4&&t.rank!==5)throw new z(`conv3dWithBias expects input to be of rank 4 or 5, but received ${t.rank}.`);if(e.rank!==4&&e.rank!==5)throw new z(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${t.rank}.`);let a=iS(t,r);if(o==="causal")throw new Ze("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return a=J4(a,e,s,o==="same"?"same":"valid","NDHWC",i),n!=null&&(a=wo(a,n)),r==="channelsFirst"&&(a=lt(a,[0,4,1,2,3])),a})}class Dp extends ht{constructor(e,n){if(super(n),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",Dp.verifyArgs(n),this.rank=e,xn(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new Ze(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=Xa(n.kernelSize,e,"kernelSize"),this.strides=Xa(n.strides==null?1:n.strides,e,"strides"),this.padding=n.padding==null?"valid":n.padding,Ts(this.padding),this.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,Qt(this.dataFormat),this.activation=zr(n.activation),this.useBias=n.useBias==null?!0:n.useBias,this.biasInitializer=zt(n.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=ln(n.biasConstraint),this.biasRegularizer=Wt(n.biasRegularizer),this.activityRegularizer=Wt(n.activityRegularizer),this.dilationRate=Xa(n.dilationRate==null?1:n.dilationRate,e,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new z(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new z(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new z(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}}static verifyArgs(e){if(So("kernelSize"in e,"required key 'kernelSize' not in config"),typeof e.kernelSize!="number"&&!t0(e.kernelSize,"number",1,3))throw new z(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(e.kernelSize)}.`)}getConfig(){const e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:Vr(this.activation),useBias:this.useBias,biasInitializer:Ht(this.biasInitializer),biasRegularizer:St(this.biasRegularizer),activityRegularizer:St(this.activityRegularizer),biasConstraint:an(this.biasConstraint)},n=super.getConfig();return Object.assign(e,n),e}}class Tl extends Dp{constructor(e,n){super(e,n),this.kernel=null,Tl.verifyArgs(n),this.filters=n.filters,xn(this.filters,"filters"),this.kernelInitializer=zt(n.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=ln(n.kernelConstraint),this.kernelRegularizer=Wt(n.kernelRegularizer)}build(e){e=vt(e);const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new z(`The channel dimension of the input should be defined. Found ${e[n]}`);const s=e[n],o=this.kernelSize.concat([s,this.filters]);this.kernel=this.addWeight("kernel",o,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[n]:s}}],this.built=!0}call(e,n){return J(()=>{e=Je(e);let s;const o=this.bias==null?null:this.bias.read(),r=oE(this.activation.getClassName());if(r!=null&&this.rank===2)s=vC(e,this.kernel.read(),o,this.strides,this.padding,this.dataFormat,this.dilationRate,r);else{if(this.rank===1)s=GX(e,this.kernel.read(),o,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)s=vC(e,this.kernel.read(),o,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)s=jX(e,this.kernel.read(),o,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new Ze("convolutions greater than 3D are not implemented yet.");this.activation!=null&&(s=this.activation.apply(s))}return s})}computeOutputShape(e){e=vt(e);const n=[],s=this.dataFormat==="channelsLast"?e.slice(1,e.length-1):e.slice(2);for(let r=0;r<s.length;++r){const i=mo(s[r],this.kernelSize[r],this.padding,this.strides[r],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[r]);n.push(i)}let o=[e[0]];return this.dataFormat==="channelsLast"?(o=o.concat(n),o.push(this.filters)):(o.push(this.filters),o=o.concat(n)),o}getConfig(){const e={filters:this.filters,kernelInitializer:Ht(this.kernelInitializer),kernelRegularizer:St(this.kernelRegularizer),kernelConstraint:an(this.kernelConstraint)},n=super.getConfig();return Object.assign(e,n),e}static verifyArgs(e){if(!("filters"in e)||typeof e.filters!="number"||e.filters<1)throw new z(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(e.filters)}`)}}class Yu extends Tl{constructor(e){super(2,e),Yu.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!t0(e.kernelSize,"number",1,2))throw new z(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(e.kernelSize)}.`)}}Yu.className="Conv2D";ge(Yu);class Zu extends Tl{constructor(e){super(3,e),Zu.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!(Array.isArray(e.kernelSize)&&(e.kernelSize.length===1||e.kernelSize.length===3)))throw new z(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(e.kernelSize)}.`)}}Zu.className="Conv3D";ge(Zu);class aS extends Yu{constructor(e){if(super(e),this.inputSpec=[new rn({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new z(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=vt(e),e.length!==4)throw new z("Input should have rank 4; Received input shape: "+JSON.stringify(e));const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new z("The channel dimension of the inputs should be defined. Found `None`.");const s=e[n],o=this.kernelSize.concat([this.filters,s]);this.kernel=this.addWeight("kernel",o,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new rn({ndim:4,axes:{[n]:s}})],this.built=!0}call(e,n){return J(()=>{let s=Je(e);if(s.shape.length!==4)throw new z(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${s.shape.length}`);const o=s.shape,r=o[0];let i,a;this.dataFormat==="channelsFirst"?(i=2,a=3):(i=1,a=2);const l=o[i],c=o[a],u=this.kernelSize[0],h=this.kernelSize[1],d=this.strides[0],f=this.strides[1],p=To(l,d,u,this.padding),g=To(c,f,h,this.padding),b=[r,p,g,this.filters];this.dataFormat!=="channelsLast"&&(s=lt(s,[0,2,3,1]));let x=q_(s,this.kernel.read(),b,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(x=lt(x,[0,3,1,2])),this.bias!=null&&(x=wo(x,this.bias.read(),this.dataFormat)),this.activation!=null&&(x=this.activation.apply(x)),x})}computeOutputShape(e){e=vt(e);const n=e.slice();let s,o,r;this.dataFormat==="channelsFirst"?(s=1,o=2,r=3):(s=3,o=1,r=2);const i=this.kernelSize[0],a=this.kernelSize[1],l=this.strides[0],c=this.strides[1];return n[s]=this.filters,n[o]=To(n[o],l,i,this.padding),n[r]=To(n[r],c,a,this.padding),n}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}aS.className="Conv2DTranspose";ge(aS);class lS extends Zu{constructor(e){if(super(e),this.inputSpec=[new rn({ndim:5})],this.padding!=="same"&&this.padding!=="valid")throw new z(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=vt(e),e.length!==5)throw new z("Input should have rank 5; Received input shape: "+JSON.stringify(e));const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new z("The channel dimension of the inputs should be defined. Found `None`.");const s=e[n],o=this.kernelSize.concat([this.filters,s]);this.kernel=this.addWeight("kernel",o,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new rn({ndim:5,axes:{[n]:s}})],this.built=!0}call(e,n){return J(()=>{let s=Je(e);if(s.shape.length!==5)throw new z(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${s.shape.length}`);const o=s.shape,r=o[0];let i,a,l;this.dataFormat==="channelsFirst"?(l=2,i=3,a=4):(l=1,i=2,a=3);const c=o[l],u=o[i],h=o[a],d=this.kernelSize[0],f=this.kernelSize[1],p=this.kernelSize[2],g=this.strides[0],b=this.strides[1],x=this.strides[2],y=To(c,g,d,this.padding),w=To(u,b,f,this.padding),v=To(h,x,p,this.padding),$=[r,y,w,v,this.filters];this.dataFormat!=="channelsLast"&&(s=lt(s,[0,2,3,4,1]));let _=nU(s,this.kernel.read(),$,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(_=lt(_,[0,4,1,2,3])),this.bias!==null&&(_=wo(_,this.bias.read(),this.dataFormat)),this.activation!==null&&(_=this.activation.apply(_)),_})}computeOutputShape(e){e=vt(e);const n=e.slice();let s,o,r,i;this.dataFormat==="channelsFirst"?(s=1,o=2,r=3,i=4):(s=4,o=1,r=2,i=3);const a=this.kernelSize[0],l=this.kernelSize[1],c=this.kernelSize[2],u=this.strides[0],h=this.strides[1],d=this.strides[2];return n[s]=this.filters,n[o]=To(n[o],u,a,this.padding),n[r]=To(n[r],h,l,this.padding),n[i]=To(n[i],d,c,this.padding),n}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}lS.className="Conv3DTranspose";ge(lS);class cS extends Tl{constructor(e,n){if(super(e,n),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,n.filters==null)throw new z("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(n.kernelInitializer!=null||n.kernelRegularizer!=null||n.kernelConstraint!=null)throw new z("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(n.padding!=null&&n.padding!=="same"&&n.padding!=="valid")throw new z(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(n.padding)}`);this.depthMultiplier=n.depthMultiplier==null?1:n.depthMultiplier,this.depthwiseInitializer=zt(n.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=Wt(n.depthwiseRegularizer),this.depthwiseConstraint=ln(n.depthwiseConstraint),this.pointwiseInitializer=zt(n.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=Wt(n.pointwiseRegularizer),this.pointwiseConstraint=ln(n.pointwiseConstraint)}build(e){if(e=vt(e),e.length<this.rank+2)throw new z(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(e)}`);const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null||e[n]<0)throw new z(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(e[n])}`);const s=e[n],o=this.kernelSize.concat([s,this.depthMultiplier]),r=[];for(let a=0;a<this.rank;++a)r.push(1);r.push(s*this.depthMultiplier,this.filters);const i=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",o,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,i,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",r,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,i,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,i,this.biasConstraint):this.bias=null,this.inputSpec=[new rn({ndim:this.rank+2,axes:{[n]:s}})],this.built=!0}call(e,n){return J(()=>{e=Je(e);let s;if(this.rank===1)throw new Ze("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(e=lt(e,[0,2,3,1])),s=gk(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(s=wo(s,this.bias.read(),this.dataFormat)),this.activation!=null&&(s=this.activation.apply(s)),this.dataFormat==="channelsFirst"&&(s=lt(s,[0,3,1,2])),s})}getConfig(){const e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=Ht(this.depthwiseInitializer),e.pointwiseInitializer=Ht(this.pointwiseInitializer),e.depthwiseRegularizer=St(this.depthwiseRegularizer),e.pointwiseRegularizer=St(this.pointwiseRegularizer),e.depthwiseConstraint=an(this.depthwiseConstraint),e.pointwiseConstraint=an(this.pointwiseConstraint),e}}cS.className="SeparableConv";class uS extends cS{constructor(e){super(2,e)}}uS.className="SeparableConv2D";ge(uS);class Op extends Tl{constructor(e){super(1,e),Op.verifyArgs(e),this.inputSpec=[{ndim:3}]}getConfig(){const e=super.getConfig();return delete e.rank,delete e.dataFormat,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!t0(e.kernelSize,"number",1,1))throw new z(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(e.kernelSize)}.`)}}Op.className="Conv1D";ge(Op);class hS extends ht{constructor(e){super(e),typeof e.cropping=="number"?this.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:typeof e.cropping[0]=="number"?this.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:this.cropping=e.cropping,this.dataFormat=e.dataFormat===void 0?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return this.dataFormat==="channelsFirst"?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,n){return J(()=>{if(e=Je(e),this.dataFormat==="channelsLast"){const s=zh(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return zh(s,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{const s=zh(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return zh(s,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const e={cropping:this.cropping,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}hS.className="Cropping2D";ge(hS);class dS extends ht{constructor(e){super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=e.size==null?this.DEFAULT_SIZE:e.size,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Qt(this.dataFormat),this.interpolation=e.interpolation==null?"nearest":e.interpolation,y6(this.interpolation)}computeOutputShape(e){if(this.dataFormat==="channelsFirst"){const n=e[2]==null?null:this.size[0]*e[2],s=e[3]==null?null:this.size[1]*e[3];return[e[0],e[1],n,s]}else{const n=e[1]==null?null:this.size[0]*e[1],s=e[2]==null?null:this.size[1]*e[2];return[e[0],n,s,e[3]]}}call(e,n){return J(()=>{let s=Je(e);const o=s.shape;if(this.dataFormat==="channelsFirst"){s=lt(s,[0,2,3,1]);const r=this.size[0]*o[2],i=this.size[1]*o[3],a=this.interpolation==="nearest"?Mh.resizeNearestNeighbor(s,[r,i]):Mh.resizeBilinear(s,[r,i]);return lt(a,[0,3,1,2])}else{const r=this.size[0]*o[1],i=this.size[1]*o[2];return this.interpolation==="nearest"?Mh.resizeNearestNeighbor(s,[r,i]):Mh.resizeBilinear(s,[r,i])}})}getConfig(){const e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},n=super.getConfig();return Object.assign(e,n),e}}dS.className="UpSampling2D";ge(dS);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function qX(t,e,n=[1,1],s="valid",o,r){return J(()=>{o==null&&(o=xo()),Qt(o);let i=g0(t,o);if(t.rank!==4)throw new z(`Input for depthwiseConv2d is required to be 4-D, but is instead ${t.rank}-D`);if(e.rank!==4)throw new z(`depthwiseKernel is required to be 4-D, but is instead ${e.rank}-D`);return i=oy(i,e,n,s==="same"?"same":"valid","NHWC",r),o==="channelsFirst"&&(i=lt(i,[0,3,1,2])),i})}class fS extends Dp{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=e.depthMultiplier==null?1:e.depthMultiplier,this.depthwiseInitializer=zt(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=ln(e.depthwiseConstraint),this.depthwiseRegularizer=Wt(e.depthwiseRegularizer)}build(e){if(e=vt(e),e.length<4)throw new z(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(e)}.`);const n=this.dataFormat==="channelsFirst"?1:3;if(e[n]==null||e[n]<0)throw new z(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${e[n]}).`);const s=e[n],o=[this.kernelSize[0],this.kernelSize[1],s,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",o,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[s*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return J(()=>{e=Je(e);let s=qX(e,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(s=wo(s,this.bias.read(),this.dataFormat)),this.activation!=null&&(s=this.activation.apply(s)),s})}computeOutputShape(e){e=vt(e);const n=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2],o=this.dataFormat==="channelsFirst"?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,r=mo(n,this.kernelSize[0],this.padding,this.strides[0]),i=mo(s,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[e[0],o,r,i]:[e[0],r,i,o]}getConfig(){const e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=Ht(this.depthwiseInitializer),e.depthwiseRegularizer=St(this.depthwiseRegularizer),e.depthwiseConstraint=an(this.depthwiseRegularizer),e}}fS.className="DepthwiseConv2D";ge(fS);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function pS(t,e,n,s){if(Array.isArray(t)){if(e!=null||n!=null)throw new z("When inputs is an array, neither initialState or constants should be provided");s!=null&&(n=t.slice(t.length-s,t.length),t=t.slice(0,t.length-s)),t.length>1&&(e=t.slice(1,t.length)),t=t[0]}function o(r){return r==null||Array.isArray(r)?r:[r]}return e=o(e),n=o(n),{inputs:t,initialState:e,constants:n}}function mS(t,e,n,s=!1,o,r,i=!1,a=!1){return J(()=>{const l=e.shape.length;if(l<3)throw new z(`Input should be at least 3D, but is ${l}D.`);const c=[1,0].concat(bo(2,l));if(e=lt(e,c),r!=null)throw new Ze("The rnn() functoin of the deeplearn.js backend does not support constants yet.");i&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),o!=null&&(o=Ae(Ae(o,"bool"),"float32"),o.rank===l-1&&(o=Ps(o,-1)),o=lt(o,c)),s&&(e=Zi(e,0),o!=null&&(o=Zi(o,0)));const u=[];let h,d=n;const f=e.shape[0],p=cl(e);let g;o!=null&&(g=cl(o));for(let x=0;x<f;++x){const y=p[x],w=J(()=>t(y,d));if(o==null)h=w[0],d=w[1];else{const v=J(()=>{const $=g[x],_=Pe(Xs($),$),E=ye(V(w[0],$),V(d[0],_)),k=d.map((N,A)=>ye(V(w[1][A],$),V(N,_)));return{output:E,newStates:k}});h=v.output,d=v.newStates}a&&u.push(h)}let b;return a&&(b=Qi(u,1)),[h,b,d]})}class ei extends ht{constructor(e){super(e);let n;if(e.cell==null)throw new z("cell property is missing for the constructor of RNN.");if(Array.isArray(e.cell)?n=new y0({cells:e.cell}):n=e.cell,n.stateSize==null)throw new z("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=n,this.returnSequences=e.returnSequences==null?!1:e.returnSequences,this.returnState=e.returnState==null?!1:e.returnState,this.goBackwards=e.goBackwards==null?!1:e.goBackwards,this._stateful=e.stateful==null?!1:e.stateful,this.unroll=e.unroll==null?!1:e.unroll,this.supportsMasking=!0,this.inputSpec=[new rn({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return bo(0,e).map(n=>null)}else return this.states_}setStates(e){this.states_=e}computeOutputShape(e){ab(e)&&(e=e[0]),e=e;let n=this.cell.stateSize;Array.isArray(n)||(n=[n]);const s=n[0];let o;if(this.returnSequences?o=[e[0],e[1],s]:o=[e[0],s],this.returnState){const r=[];for(const i of n)r.push([e[0],i]);return[o].concat(r)}else return o}computeMask(e,n){return J(()=>{Array.isArray(n)&&(n=n[0]);const s=this.returnSequences?n:null;if(this.returnState){const o=this.states.map(r=>null);return[s].concat(o)}else return s})}get states(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,n=[];for(let s=0;s<e;++s)n.push(null);return n}else return this.states_}set states(e){this.states_=e}build(e){if(this.numConstants!=null)throw new Ze("Constants support is not implemented in RNN yet.");ab(e)&&(e=e[0]),e=e;const n=this.stateful?e[0]:null,s=e.slice(2);this.inputSpec[0]=new rn({shape:[n,null,...s]});const o=[e[0]].concat(e.slice(2));this.cell.build(o);let r;if(Array.isArray(this.cell.stateSize)?r=this.cell.stateSize:r=[this.cell.stateSize],this.stateSpec!=null){if(!bt(this.stateSpec.map(i=>i.shape[i.shape.length-1]),r))throw new z(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=r.map(i=>new rn({shape:[null,i]}));this.stateful&&this.resetStates()}resetStates(e,n=!1){J(()=>{if(!this.stateful)throw new Eo("Cannot call resetStates() on an RNN Layer that is not stateful.");const s=this.inputSpec[0].shape[0];if(s==null)throw new z("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(o=>gn([s,o])):this.states_=[gn([s,this.cell.stateSize])];else if(e==null)tt(this.states_),this.keptStates!=null&&(tt(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(o=>gn([s,o])):this.states_[0]=gn([s,this.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new z(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);n===!0?this.keptStates.push(this.states_.slice()):tt(this.states_);for(let o=0;o<this.states_.length;++o){const r=e[o],i=Array.isArray(this.cell.stateSize)?this.cell.stateSize[o]:this.cell.stateSize,a=[s,i];if(!bt(r.shape,a))throw new z(`State ${o} is incompatible with layer ${this.name}: expected shape=${a}, received shape=${r.shape}`);this.states_[o]=r}}this.states_=this.states_.map(o=>Uo(o.clone()))})}apply(e,n){let s=n==null?null:n.initialState,o=n==null?null:n.constants;n==null&&(n={});const r=pS(e,s,o,this.numConstants);e=r.inputs,s=r.initialState,o=r.constants;let i=[],a=[];if(s!=null){n.initialState=s,i=i.concat(s),this.stateSpec=[];for(const c of s)this.stateSpec.push(new rn({shape:c.shape}));a=a.concat(this.stateSpec)}if(o!=null&&(n.constants=o,i=i.concat(o),this.numConstants=o.length),i[0]instanceof Do){const c=[e].concat(i),u=this.inputSpec.concat(a),h=this.inputSpec;this.inputSpec=u;const d=super.apply(c,n);return this.inputSpec=h,d}else return super.apply(e,n)}call(e,n){return J(()=>{const s=n==null?null:n.mask,o=n==null?null:n.training;let r=n==null?null:n.initialState;e=Je(e),r==null&&(this.stateful?r=this.states_:r=this.getInitialState(e));const i=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(r.length!==i)throw new z(`RNN Layer has ${i} state(s) but was passed ${r.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const a={training:o},c=mS((p,g)=>{const b=this.cell.call([p].concat(g),a);return[b[0],b.slice(1)]},e,r,this.goBackwards,s,null,this.unroll,this.returnSequences),u=c[0],h=c[1],d=c[2];this.stateful&&this.resetStates(d,o);const f=this.returnSequences?h:u;return this.returnState?[f].concat(d):f})}getInitialState(e){return J(()=>{let n=gn(e.shape);return n=Le(n,[1,2]),n=Gu(n),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(s=>s>1?rb(n,[1,s]):n):this.cell.stateSize>1?[rb(n,[1,this.cell.stateSize])]:[n]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(e)}getConfig(){const e=super.getConfig(),n={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(n.numConstants=this.numConstants);const s=this.cell.getConfig();return this.getClassName()===ei.className&&(n.cell={className:this.cell.getClassName(),config:s}),Object.assign({},s,e,n)}static fromConfig(e,n,s={}){const o=n.cell,r=Bo(o,s);return new e(Object.assign(n,{cell:r}))}}ei.className="RNN";ge(ei);class Fp extends ht{}class b0 extends Fp{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,xn(this.units,"units"),this.activation=zr(e.activation==null?this.DEFAULT_ACTIVATION:e.activation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=zt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=zt(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=zt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Wt(e.kernelRegularizer),this.recurrentRegularizer=Wt(e.recurrentRegularizer),this.biasRegularizer=Wt(e.biasRegularizer),this.kernelConstraint=ln(e.kernelConstraint),this.recurrentConstraint=ln(e.recurrentConstraint),this.biasConstraint=ln(e.biasConstraint),this.dropout=ul([1,Br([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=ul([1,Br([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=vt(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return J(()=>{if(e=e,e.length!==2)throw new z(`SimpleRNNCell expects 2 input Tensors, got ${e.length}.`);let s=e[1];e=e[0];const o=n.training==null?!1:n.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Wr({ones:()=>Xs(e),rate:this.dropout,training:o,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Wr({ones:()=>Xs(s),rate:this.recurrentDropout,training:o,dropoutFunc:this.dropoutFunc}));let r;const i=this.dropoutMask,a=this.recurrentDropoutMask;i!=null?r=Mo(V(e,i),this.kernel.read()):r=Mo(e,this.kernel.read()),this.bias!=null&&(r=wo(r,this.bias.read())),a!=null&&(s=V(s,a));let l=ye(r,Mo(s,this.recurrentKernel.read()));return this.activation!=null&&(l=this.activation.apply(l)),[l,l]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:Vr(this.activation),useBias:this.useBias,kernelInitializer:Ht(this.kernelInitializer),recurrentInitializer:Ht(this.recurrentInitializer),biasInitializer:Ht(this.biasInitializer),kernelRegularizer:St(this.kernelRegularizer),recurrentRegularizer:St(this.recurrentRegularizer),biasRegularizer:St(this.biasRegularizer),activityRegularizer:St(this.activityRegularizer),kernelConstraint:an(this.kernelConstraint),recurrentConstraint:an(this.recurrentConstraint),biasConstraint:an(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign({},e,n)}}b0.className="SimpleRNNCell";ge(b0);class gS extends ei{constructor(e){e.cell=new b0(e),super(e)}call(e,n){return J(()=>{this.cell.dropoutMask!=null&&(tt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(tt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=n==null?null:n.mask,o=n==null?null:n.training,r=n==null?null:n.initialState;return super.call(e,{mask:s,training:o,initialState:r})})}static fromConfig(e,n){return new e(n)}}gS.className="SimpleRNN";ge(gS);class x0 extends Fp{constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new z("GRUCell does not support reset_after parameter set to true.");this.units=e.units,xn(this.units,"units"),this.activation=zr(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=zr(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=zt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=zt(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=zt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Wt(e.kernelRegularizer),this.recurrentRegularizer=Wt(e.recurrentRegularizer),this.biasRegularizer=Wt(e.biasRegularizer),this.kernelConstraint=ln(e.kernelConstraint),this.recurrentConstraint=ln(e.recurrentConstraint),this.biasConstraint=ln(e.biasConstraint),this.dropout=ul([1,Br([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=ul([1,Br([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=vt(e);const n=e[e.length-1];this.kernel=this.addWeight("kernel",[n,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return J(()=>{if(e=e,e.length!==2)throw new z(`GRUCell expects 2 input Tensors (inputs, h, c), got ${e.length}.`);const s=n.training==null?!1:n.training;let o=e[1];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Wr({ones:()=>Xs(e),rate:this.dropout,training:s,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Wr({ones:()=>Xs(o),rate:this.recurrentDropout,training:s,count:3,dropoutFunc:this.dropoutFunc}));const r=this.dropoutMask,i=this.recurrentDropoutMask;let a,l,c;0<this.dropout&&this.dropout<1&&(e=V(e,r[0]));let u=Mo(e,this.kernel.read());this.useBias&&(u=wo(u,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(o=V(o,i[0]));const h=this.recurrentKernel.read(),[d,f]=_s(h,[2*this.units,this.units],h.rank-1),p=Mo(o,d),[g,b,x]=_s(u,3,u.rank-1),[y,w]=_s(p,2,p.rank-1);a=this.recurrentActivation.apply(ye(g,y)),l=this.recurrentActivation.apply(ye(b,w));const v=Mo(V(l,o),f);c=this.activation.apply(ye(x,v));const $=ye(V(a,o),V(ye(1,Gt(a)),c));return[$,$]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:Vr(this.activation),recurrentActivation:Vr(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Ht(this.kernelInitializer),recurrentInitializer:Ht(this.recurrentInitializer),biasInitializer:Ht(this.biasInitializer),kernelRegularizer:St(this.kernelRegularizer),recurrentRegularizer:St(this.recurrentRegularizer),biasRegularizer:St(this.biasRegularizer),activityRegularizer:St(this.activityRegularizer),kernelConstraint:an(this.kernelConstraint),recurrentConstraint:an(this.recurrentConstraint),biasConstraint:an(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign({},e,n)}}x0.className="GRUCell";ge(x0);class bS extends ei{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new x0(e),super(e)}call(e,n){return J(()=>{this.cell.dropoutMask!=null&&(tt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(tt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=n==null?null:n.mask,o=n==null?null:n.training,r=n==null?null:n.initialState;return super.call(e,{mask:s,training:o,initialState:r})})}static fromConfig(e,n){return n.implmentation===0&&(n.implementation=1),new e(n)}}bS.className="GRU";ge(bS);class Lp extends Fp{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,xn(this.units,"units"),this.activation=zr(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=zr(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=zt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=zt(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=zt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=Wt(e.kernelRegularizer),this.recurrentRegularizer=Wt(e.recurrentRegularizer),this.biasRegularizer=Wt(e.biasRegularizer),this.kernelConstraint=ln(e.kernelConstraint),this.recurrentConstraint=ln(e.recurrentConstraint),this.biasConstraint=ln(e.biasConstraint),this.dropout=ul([1,Br([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=ul([1,Br([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var n;e=vt(e);const s=e[e.length-1];this.kernel=this.addWeight("kernel",[s,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let o;if(this.useBias){if(this.unitForgetBias){const r=this.biasInitializer,i=this.units;o=new(n=class extends Js{apply(l,c){const u=r.apply([i]),h=new s0().apply([i]),d=r.apply([i*2]);return sC(sC(u,h),d)}},n.className="CustomInit",n)}else o=this.biasInitializer;this.bias=this.addWeight("bias",[this.units*4],null,o,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,n){return J(()=>{const s=n.training==null?!1:n.training;if(e=e,e.length!==3)throw new z(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let o=e[1];const r=e[2];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Wr({ones:()=>Xs(e),rate:this.dropout,training:s,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Wr({ones:()=>Xs(o),rate:this.recurrentDropout,training:s,count:4,dropoutFunc:this.dropoutFunc}));const i=this.dropoutMask,a=this.recurrentDropoutMask;let l,c,u,h;0<this.dropout&&this.dropout<1&&(e=V(e,i[0]));let d=Mo(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(o=V(o,a[0])),d=ye(d,Mo(o,this.recurrentKernel.read())),this.useBias&&(d=wo(d,this.bias.read()));const[f,p,g,b]=_s(d,4,d.rank-1);l=this.recurrentActivation.apply(f),c=this.recurrentActivation.apply(p),u=ye(V(c,r),V(l,this.activation.apply(g))),h=this.recurrentActivation.apply(b);const x=V(h,this.activation.apply(u));return[x,x,u]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:Vr(this.activation),recurrentActivation:Vr(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Ht(this.kernelInitializer),recurrentInitializer:Ht(this.recurrentInitializer),biasInitializer:Ht(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:St(this.kernelRegularizer),recurrentRegularizer:St(this.recurrentRegularizer),biasRegularizer:St(this.biasRegularizer),activityRegularizer:St(this.activityRegularizer),kernelConstraint:an(this.kernelConstraint),recurrentConstraint:an(this.recurrentConstraint),biasConstraint:an(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign({},e,n)}}Lp.className="LSTMCell";ge(Lp);class xS extends ei{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new Lp(e),super(e)}call(e,n){return J(()=>{this.cell.dropoutMask!=null&&(tt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(tt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=n==null?null:n.mask,o=n==null?null:n.training,r=n==null?null:n.initialState;return super.call(e,{mask:s,training:o,initialState:r})})}static fromConfig(e,n){return n.implmentation===0&&(n.implementation=1),new e(n)}}xS.className="LSTM";ge(xS);class y0 extends Fp{constructor(e){super(e),this.cells=e.cells}get stateSize(){const e=[];for(const n of this.cells.slice().reverse())Array.isArray(n.stateSize)?e.push(...n.stateSize):e.push(n.stateSize);return e}call(e,n){return J(()=>{e=e;let s=e.slice(1);const o=[];for(const a of this.cells.slice().reverse())Array.isArray(a.stateSize)?o.push(s.splice(0,a.stateSize.length)):o.push(s.splice(0,1));o.reverse();const r=[];let i;for(let a=0;a<this.cells.length;++a){const l=this.cells[a];s=o[a],a===0?i=[e[0]].concat(s):i=[i[0]].concat(s),i=l.call(i,n),r.push(i.slice(1))}s=[];for(const a of r.slice().reverse())s.push(...a);return[i[0]].concat(s)})}build(e){ab(e)&&(e=e[0]),e=e;let n;this.cells.forEach((s,o)=>{Vi(`RNNCell_${o}`,()=>{s.build(e),Array.isArray(s.stateSize)?n=s.stateSize[0]:n=s.stateSize,e=[e[0],n]})}),this.built=!0}getConfig(){const e=super.getConfig(),n=r=>({className:r.getClassName(),config:r.getConfig()}),o={cells:this.cells.map(n)};return Object.assign({},e,o)}static fromConfig(e,n,s={}){const o=[];for(const r of n.cells)o.push(Bo(r,s));return new e({cells:o})}get trainableWeights(){if(!this.trainable)return[];const e=[];for(const n of this.cells)e.push(...n.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const n of this.cells)e.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const s of this.cells)n.push(...s.trainableWeights);return n.concat(e)}return e}getWeights(){const e=[];for(const n of this.cells)e.push(...n.weights);return lb(e)}setWeights(e){const n=[];for(const s of this.cells){const o=s.weights.length,r=e.splice(o);for(let i=0;i<s.weights.length;++i)n.push([s.weights[i],r[i]])}u0(n)}}y0.className="StackedRNNCells";ge(y0);function Wr(t){const{ones:e,rate:n,training:s=!1,count:o=1,dropoutFunc:r}=t,i=()=>r!=null?r(e(),n):hE(e(),n),a=()=>qu(i,e,s);return!o||o<=1?Uo(a().clone()):Array(o).fill(void 0).map(a).map(c=>Uo(c.clone()))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var KX=globalThis&&globalThis.__rest||function(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(t);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(t,s[o])&&(n[s[o]]=t[s[o]]);return n};class yS extends ei{constructor(e){if(e.unroll)throw new Ze("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new Ze("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new rn({ndim:5})]}call(e,n){return J(()=>{if(this.cell.dropoutMask!=null&&(tt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(tt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),n&&n.constants)throw new z("ConvRNN2D cell does not support constants");const s=n==null?null:n.mask,o=n==null?null:n.training,r=n==null?null:n.initialState;return super.call(e,{mask:s,training:o,initialState:r})})}computeOutputShape(e){let n=this.computeSingleOutputShape(e);return this.returnSequences||(n=[n[0],...n.slice(2)]),this.returnState&&(n=[n,...Array(2).fill([e[0],...n.slice(-3)])]),n}getInitialState(e){return J(()=>{const{stateSize:n}=this.cell,s=e.shape,o=this.computeSingleOutputShape(s),r=[o[0],...o.slice(2)],i=gn(r);return Array.isArray(n)?Array(n.length).fill(i):[i]})}resetStates(e,n=!1){J(()=>{if(!this.stateful)throw new Eo("Cannot call resetStates() on an RNN Layer that is not stateful.");const s=this.inputSpec[0].shape,o=this.computeSingleOutputShape(s),r=[o[0],...o.slice(2)];if(s[0]==null)throw new z("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>gn(r)):this.states_=[gn(r)];else if(e==null)tt(this.states_),this.keptStates!=null&&(tt(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>gn(r)):this.states_[0]=gn(r);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new z(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);n?this.keptStates.push(this.states_.slice()):tt(this.states_);for(let a=0;a<this.states_.length;++a){const l=e[a],c=r;if(!bt(l.shape,c))throw new z(`State ${a} is incompatible with layer ${this.name}: expected shape=${c}, received shape=${l.shape}`);this.states_[a]=l}}this.states_=this.states_.map(a=>Uo(a.clone()))})}computeSingleOutputShape(e){const{dataFormat:n,filters:s,kernelSize:o,padding:r,strides:i,dilationRate:a}=this.cell,l=n==="channelsFirst",c=e[l?3:2],u=e[l?4:3],h=mo(c,o[0],r,i[0],a[0]),d=mo(u,o[1],r,i[1],a[1]);return[...e.slice(0,2),...l?[s,h,d]:[h,d,s]]}}yS.className="ConvRNN2D";class v0 extends Lp{constructor(e){const{filters:n,kernelSize:s,strides:o,padding:r,dataFormat:i,dilationRate:a}=e;super(Object.assign({},e,{units:n})),this.filters=n,xn(this.filters,"filters"),this.kernelSize=Xa(s,2,"kernelSize"),this.kernelSize.forEach(l=>xn(l,"kernelSize")),this.strides=Xa(o||1,2,"strides"),this.strides.forEach(l=>xn(l,"strides")),this.padding=r||"valid",Ts(this.padding),this.dataFormat=i||"channelsLast",Qt(this.dataFormat),this.dilationRate=Xa(a||1,2,"dilationRate"),this.dilationRate.forEach(l=>xn(l,"dilationRate"))}build(e){var n;e=vt(e);const s=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[s]==null)throw new z(`The channel dimension of the input should be defined. Found ${e[s]}`);const o=e[s],r=4,i=this.kernelSize.concat([o,this.filters*r]);this.kernel=this.addWeight("kernel",i,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const a=this.kernelSize.concat([this.filters,this.filters*r]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",a,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let l;if(this.unitForgetBias){const c=this.biasInitializer,u=this.filters;l=new(n=class extends Js{apply(d,f){const p=c.apply([u]),g=Zr([u]),b=c.apply([u*2]);return n0([p,g,b])}},n.className="CustomInit",n)}else l=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*r],null,l,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,n){return J(()=>{if(e.length!==3)throw new z(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);const s=n.training||!1,o=e[0],r=e[1],i=e[2],a=4;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Wr({ones:()=>Xs(o),rate:this.dropout,training:s,count:a,dropoutFunc:this.dropoutFunc}));const l=this.dropoutMask,c=(pe,he,xe)=>!he||!he[xe]?pe:V(he[xe],pe);let u=c(o,l,0),h=c(o,l,1),d=c(o,l,2),f=c(o,l,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Wr({ones:()=>Xs(r),rate:this.recurrentDropout,training:s,count:a,dropoutFunc:this.dropoutFunc}));const p=this.recurrentDropoutMask;let g=c(r,p,0),b=c(r,p,1),x=c(r,p,2),y=c(r,p,3);const w=3,[v,$,_,E]=_s(this.kernel.read(),a,w),[k,N,A,F]=this.useBias?_s(this.bias.read(),a):[null,null,null,null];u=this.inputConv(u,v,k,this.padding),h=this.inputConv(h,$,N,this.padding),d=this.inputConv(d,_,A,this.padding),f=this.inputConv(f,E,F,this.padding);const[L,H,M,K]=_s(this.recurrentKernel.read(),a,w);g=this.recurrentConv(g,L),b=this.recurrentConv(b,H),x=this.recurrentConv(x,M),y=this.recurrentConv(y,K);const q=this.recurrentActivation.apply(ye(u,g)),Q=this.recurrentActivation.apply(ye(h,b)),Y=ye(V(Q,i),V(q,this.activation.apply(ye(d,x)))),ie=V(this.recurrentActivation.apply(ye(f,y)),this.activation.apply(Y));return[ie,ie,Y]})}getConfig(){const e=super.getConfig(),n=KX(e,["units"]),s={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign({},n,s)}inputConv(e,n,s,o){const r=Xi(e,n,this.strides,o||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return s?wo(r,s,this.dataFormat):r}recurrentConv(e,n){return Xi(e,n,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}}v0.className="ConvLSTM2DCell";ge(v0);class vS extends yS{constructor(e){const n=new v0(e);super(Object.assign({},e,{cell:n}))}static fromConfig(e,n){return new e(n)}}vS.className="ConvLSTM2D";ge(vS);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class w0 extends ht{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(this.noiseShape==null)return this.noiseShape;const n=e.shape,s=[];for(let o=0;o<this.noiseShape.length;++o)s.push(this.noiseShape[o]==null?n[o]:this.noiseShape[o]);return s}call(e,n){return J(()=>{this.invokeCallHook(e,n);const s=Je(e);if(0<this.rate&&this.rate<1){const o=n.training==null?!1:n.training,r=this.getNoiseShape(s);return qu(()=>hE(s,this.rate,r,this.seed),()=>s,o)}return e})}getConfig(){const e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},n=super.getConfig();return Object.assign(e,n),e}dispose(){return super.dispose()}}w0.className="Dropout";ge(w0);class wS extends w0{constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){const n=e.shape;return[n[0],1,n[2]]}}wS.className="SpatialDropout1D";ge(wS);class CS extends ht{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.batchInputShape==null&&e.inputShape==null&&e.inputDim!=null){let n=null;e.batchSize!=null&&(n=e.batchSize),this.batchInputShape=[n,e.inputDim]}this.units=e.units,xn(this.units,"units"),this.activation=zr(e.activation),e.useBias!=null&&(this.useBias=e.useBias),this.kernelInitializer=zt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=zt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=ln(e.kernelConstraint),this.biasConstraint=ln(e.biasConstraint),this.kernelRegularizer=Wt(e.kernelRegularizer),this.biasRegularizer=Wt(e.biasRegularizer),this.activityRegularizer=Wt(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){e=vt(e);const n=e[e.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[n,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:n}}],this.built=!0}computeOutputShape(e){e=vt(e);const n=e.slice();return n[n.length-1]=this.units,n}call(e,n){return J(()=>{this.invokeCallHook(e,n);const s=Je(e),o=oE(this.activation.getClassName());let r;return o!=null?r=Mo(s,this.kernel.read(),o,this.bias?this.bias.read():null):(r=Mo(s,this.kernel.read()),this.bias!=null&&(r=wo(r,this.bias.read())),this.activation!=null&&(r=this.activation.apply(r))),r})}getConfig(){const e={units:this.units,activation:Vr(this.activation),useBias:this.useBias,kernelInitializer:Ht(this.kernelInitializer),biasInitializer:Ht(this.biasInitializer),kernelRegularizer:St(this.kernelRegularizer),biasRegularizer:St(this.biasRegularizer),activityRegularizer:St(this.activityRegularizer),kernelConstraint:an(this.kernelConstraint),biasConstraint:an(this.biasConstraint)},n=super.getConfig();return Object.assign(e,n),e}}CS.className="Dense";ge(CS);class $S extends ht{constructor(e){e=e||{},super(e),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=vt(e);for(const n of e.slice(1))if(n==null)throw new z(`The shape of the input to "Flatten" is not fully defined (got ${e.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[e[0],Lr(e,1)]}call(e,n){return J(()=>{this.invokeCallHook(e,n);let s=Je(e);if(this.dataFormat==="channelsFirst"&&s.rank>1){const o=[0];for(let r=2;r<s.rank;++r)o.push(r);o.push(1),s=lt(s,o)}return _6(s)})}getConfig(){const e={};this.dataFormat!=null&&(e.dataFormat=this.dataFormat);const n=super.getConfig();return Object.assign(e,n),e}}$S.className="Flatten";ge($S);class IS extends ht{constructor(e){super(e),this.supportsMasking=!0,this.activation=zr(e.activation)}call(e,n){return J(()=>{this.invokeCallHook(e,n);const s=Je(e);return this.activation.apply(s)})}getConfig(){const e={activation:Vr(this.activation)},n=super.getConfig();return Object.assign(e,n),e}}IS.className="Activation";ge(IS);class _S extends ht{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,n){return J(()=>(e=Je(e),$6(e,this.n)))}getConfig(){const e={n:this.n},n=super.getConfig();return Object.assign(e,n),e}}_S.className="RepeatVector";ge(_S);class kS extends ht{constructor(e){super(e),this.targetShape=e.targetShape;for(let n=0;n<this.targetShape.length;++n)this.isUnknown(this.targetShape[n])&&(this.targetShape[n]=null)}isUnknown(e){return e<0||e==null}fixUnknownDimension(e,n){const s="Total size of new array must be unchanged.",o=n.slice();let r=1,i=null;for(let l=0;l<o.length;++l){const c=o[l];if(this.isUnknown(c))if(i===null)i=l;else throw new z("Can only specifiy one unknown dimension.");else r*=c}const a=Lr(e);if(i!==null){if(r===0||a%r!==0)throw new z(s);o[i]=a/r}else if(a!==r)throw new z(s);return o}computeOutputShape(e){let n=!1;for(let s=0;s<e.length;++s)if(this.isUnknown(e[s])){n=!0;break}return n?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,n){return J(()=>{this.invokeCallHook(e,n);const s=Je(e),o=s.shape,r=o.slice(0,1).concat(this.fixUnknownDimension(o.slice(1),this.targetShape));return j(s,r)})}getConfig(){const e={targetShape:this.targetShape},n=super.getConfig();return Object.assign(e,n),e}}kS.className="Reshape";ge(kS);class ES extends ht{constructor(e){if(super(e),e.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${e.dims} instead.`);const n=bo(1,e.dims.length+1);if(!bt(e.dims.slice().sort(),n))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new rn({ndim:this.dims.length+1})]}computeOutputShape(e){e=vt(e);const n=e.slice();return this.dims.forEach((s,o)=>{n[o+1]=e[s]}),n}call(e,n){return lt(Je(e),this.dimsIncludingBatch)}getConfig(){const e={dims:this.dims},n=super.getConfig();return Object.assign(e,n),e}}ES.className="Permute";ge(ES);class SS extends ht{constructor(e){super(e==null?{}:e),this.supportsMasking=!0,e!=null?this.maskValue=e.maskValue==null?0:e.maskValue:this.maskValue=0}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={maskValue:this.maskValue};return Object.assign(n,e),n}computeMask(e,n){const s=Je(e),o=-1;return Qg(kc(s,this.maskValue),o)}call(e,n){return J(()=>{this.invokeCallHook(e,n);const s=Je(e),o=-1,r=!0,i=Qg(kc(s,this.maskValue),o,r);return V(s,Ae(i,s.dtype))})}}SS.className="Masking";ge(SS);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class TS extends ht{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",e.batchInputShape==null&&e.inputShape==null){let n=null;e.batchSize!=null&&(n=e.batchSize),e.inputLength==null?this.batchInputShape=[n,null]:this.batchInputShape=[n].concat(Ot(e.inputLength))}this.inputDim=e.inputDim,xn(this.inputDim,"inputDim"),this.outputDim=e.outputDim,xn(this.outputDim,"outputDim"),this.embeddingsInitializer=zt(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=Wt(e.embeddingsRegularizer),this.activityRegularizer=Wt(e.activityRegularizer),this.embeddingsConstraint=ln(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,n){return J(()=>this.maskZero?(e=Je(e),kc(e,ut(e))):null)}computeOutputShape(e){if(e=vt(e),this.inputLength==null)return[...e,this.outputDim];const n=Ot(this.inputLength);if(n.length!==e.length-1)throw new z(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);{let s=0;for(let o=0;o<n.length;++o){const r=n[o],i=e[o+1];if(r!=null&&i!=null&&r!==i)throw new z(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);r==null&&(n[s]=i),s++}}return[e[0],...n,this.outputDim]}call(e,n){return J(()=>{this.invokeCallHook(e,n);let s=Je(e);s.dtype!=="int32"&&(s=Sp(s,"int32"));const o=uE(this.embeddings.read(),j(s,[s.size]));return j(o,vt(this.computeOutputShape(s.shape)))})}getConfig(){const e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:Ht(this.embeddingsInitializer),embeddingsRegularizer:St(this.embeddingsRegularizer),activityRegularizer:St(this.activityRegularizer),embeddingsConstraint:an(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},n=super.getConfig();return Object.assign(e,n),e}}TS.className="Embedding";ge(TS);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class aa extends ht{constructor(e){super(e||{}),this.supportsMasking=!0}mergeFunction(e){throw new Ze}computeElementwiseOpOutputShape(e,n){if(e==null||n==null)return null;if(e.length<n.length)return this.computeElementwiseOpOutputShape(n,e);if(n.length===0)return e;const s=e.slice(0,e.length-n.length);for(let o=0;o<n.length;++o){const r=e[e.length-n.length+o],i=n[o];if(r==null||i==null||r<0||i<0)s.push(null);else if(r===1)s.push(i);else if(i===1)s.push(r);else{if(r!==i)throw new z("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(n));s.push(r)}}return s}build(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[vt(e)]),e=e,e.length<2)throw new z(`A merge layer should be called on an Array of at least 2 inputs. Got ${e.length} input(s).`);let n=[];for(const r of e)r!=null&&r[0]!==null&&n.push(r[0]);if(n=Fr(n),n.length>1)throw new z(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(e)}.`);let s=e[0]==null?null:e[0].slice(1);for(let r=1;r<e.length;++r){const i=e[r]==null?null:e[r].slice(1);s=this.computeElementwiseOpOutputShape(s,i)}const o=e.map(r=>r.length);e.indexOf(null)===-1&&Fr(o).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(e,n){return J(()=>{if(e=e,this.reshapeRequired){const s=[],o=e.map(r=>r.rank);if(o.indexOf(null)===-1){const r=Br(o);for(let i of e){const a=i.rank;for(let l=0;l<r-a;++l)i=Gu(i,1);s.push(i)}return this.mergeFunction(s)}else{let r=!1;for(const l of e){const c=l.rank;if(c==null){const u=l.shape,h=u[0],d=u.slice(1).concat([h]);let f=j(l,[h].concat(Lr(u.slice(1))));f=lt(f,[1,0]),f=j(f,d),s.push(f),r=!0}else if(c>1){const u=bo(1,c).concat([0]);s.push(lt(l,u)),r=!0}else s.push(l)}let i=this.mergeFunction(s);const a=i.rank;if(r){if(a==null){const l=i.shape,c=l.length,u=l[c-1],h=[u].concat(l.slice(0,l.length-1));i=j(lt(j(i,[-1,u]),[1,0]),h)}else if(a>1){const l=[a-1].concat(bo(0,a-1));i=lt(i,l)}}return i}}else return this.mergeFunction(e)})}computeOutputShape(e){e=e;let n;e[0]==null?n=null:n=e[0].slice(1);for(let o=1;o<e.length;++o){const r=e[o]==null?null:e[o].slice(1);n=this.computeElementwiseOpOutputShape(n,r)}let s=[];for(const o of e)o!=null&&o[0]!==null&&s.push(o[0]);return s=Fr(s),s.length===1?n=s.concat(n):n=[null].concat(n),n}computeMask(e,n){return J(()=>{if(n==null)return null;if(!Array.isArray(n))throw new z("`mask` should be an Array");if(!Array.isArray(e))throw new z("`inputs` should be an Array");if(n.length!==e.length)throw new z(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${e.length} vs ${n.length})`);if(n.every(o=>o==null))return null;n=n.map(o=>o==null?o:Ps(o,0));let s=n[0];for(let o=1;o<n.length-1;++o)s=ir(s,n[o]);return s})}}class NS extends aa{constructor(e){super(e)}mergeFunction(e){return J(()=>{let n=e[0].clone();for(let s=1;s<e.length;++s)n=ye(n,e[s]);return n})}}NS.className="Add";ge(NS);class AS extends aa{constructor(e){super(e)}mergeFunction(e){return J(()=>{let n=e[0].clone();for(let s=1;s<e.length;++s)n=V(n,e[s]);return n})}}AS.className="Multiply";ge(AS);class RS extends aa{constructor(e){super(e)}mergeFunction(e){return J(()=>{let n=e[0].clone();for(let s=1;s<e.length;++s)n=ye(n,e[s]);return V(1/e.length,n)})}}RS.className="Average";ge(RS);class DS extends aa{constructor(e){super(e)}mergeFunction(e){return J(()=>{let n=e[0];for(let s=1;s<e.length;++s)n=Yr(n,e[s]);return n})}}DS.className="Maximum";ge(DS);class OS extends aa{constructor(e){super(e)}mergeFunction(e){return J(()=>{let n=e[0];for(let s=1;s<e.length;++s)n=wp(n,e[s]);return n})}}OS.className="Minimum";ge(OS);class FS extends aa{constructor(e){super(e),this.DEFAULT_AXIS=-1,e==null&&(e={}),this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!(Array.isArray(e)&&Array.isArray(e[0]))||e.length===1)throw new z("A `Concatenate` layer should be called on a list of at least 2 inputs");e=e;let n=!0;for(const o of e)if(o!=null){n=!1;break}if(n)return;const s=[];for(let o=0;o<e.length;++o){const r=e[o].slice();r.splice(this.axis,1);let i=!1;for(const a of s)if(bt(a,r)){i=!0;break}i||s.push(r)}if(s.length>1)throw new z("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return J(()=>n0(e,this.axis))}computeOutputShape(e){if(!(Array.isArray(e)&&Array.isArray(e[0])))throw new z("A `Concatenate` layer should be called on a list of inputs.");const n=e,s=n[0].slice(),o=this.axis<0?s.length+this.axis:this.axis;for(const r of n.slice(1)){if(s[o]==null||r[o]==null){s[o]=null;break}s[o]+=r[o]}return s}computeMask(e,n){if(n==null)return null;if(!Array.isArray(n))throw new z("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new z("`inputs` should be an array for Concatenate");if(n.length!==e.length)throw new z(`Mismatch in the length of mask (${n.length}) and the legnth of inputs (${e.length})`);return J(()=>{let s=!0;if(n.forEach(i=>{if(i!=null){s=!1;return}}),s)return null;const o=[];for(let i=0;i<e.length;++i)n[i]==null?o.push(Ae(Xs(e[i]),"bool")):n[i].rank<e[i].rank?o.push(Ps(n[i],-1)):o.push(n[i]);const r=Dn(o,this.axis);return G_(r,-1,!1)})}getConfig(){const e={axis:this.axis},n=super.getConfig();return Object.assign(e,n),e}}FS.className="Concatenate";ge(FS);function Zl(t,e){for(;t<0;)t+=e;return t}function XX(t,e,n){if(t.shape.length>3||e.shape.length>3)throw new Ze("batchDot is not implemented for tensors of 4D or higher rank yet");if(T(t.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${t.shape.length}`),T(t.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${e.shape.length}`),typeof n=="number"&&(n=[n,n]),t.dtype==="complex64"||e.dtype==="complex64")throw new Ze("batchDot is not implemented for complex64-type Tensors yet.");const s=t.shape.length,o=e.shape.length;n==null&&(n=[s-1,o-2]);const r=n;return J(()=>{let i;if(s>o){i=s-o;const l=[];for(let c=0;c<i;++c)l.push(1);e=j(e,e.shape.concat(l))}else if(o>s){i=o-s;const l=[];for(let c=0;c<i;++c)l.push(1);t=j(t,t.shape.concat(l))}else i=0;let a;if(t.shape.length===2&&e.shape.length===2)r[0]===r[1]?a=Le(V(t,e),r[0]):a=Le(V(lt(t,[1,0]),e),r[1]);else{const l=r[0]!==t.shape.length-1,c=r[1]===e.shape.length-1;a=gt(t,e,l,c)}if(i>0){let l;s>o?l=s+o-3:l=s-1;const c=[];for(let u=l;u<l+i;++u)c.push(u);a=Bu(a,c)}return a.shape.length===1&&(a=Ps(a,1)),a})}class LS extends aa{constructor(e){super(e),this.axes=e.axes,this.normalize=e.normalize==null?!1:e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){T(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=e[0],s=e[1];if(n.length>3||s.length>3)throw new Ze("Dot layer does not support tensors of 4D or higher rank yet.");const o=this.interpretAxes(n,s);if(n[o[0]]!==s[o[1]])throw new z(`Dimension incompatibility: ${n[o[0]]} !== ${s[o[1]]}`)}mergeFunction(e){if(e.length!==2)throw new z(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${e.length} input(s).`);let n=e[0],s=e[1],o;return Array.isArray(this.axes)?o=this.axes.map((r,i)=>Zl(r,e[i].shape.length)):o=[Zl(this.axes,n.shape.length),Zl(this.axes,s.shape.length)],this.normalize&&(n=Ad(n,o[0]),s=Ad(s,o[1])),XX(n,s,o)}interpretAxes(e,n){let s;return Array.isArray(this.axes)?s=this.axes:s=[Zl(this.axes,e.length),Zl(this.axes,n.length)],s}computeOutputShape(e){T(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=e[0].slice(),s=e[1].slice();if(n.length>3||s.length>3)throw new Ze("Dot layer does not support tensors of 4D or higher rank yet.");const o=this.interpretAxes(n,s);n.splice(o[0],1),s.splice(o[1],1),s.splice(0,1);const r=n.concat(s);return r.length===1&&r.push(1),r}computeMask(e,n){return null}getConfig(){const e={axes:this.axes,normalize:this.normalize},n=super.getConfig();return Object.assign(e,n),e}}LS.className="Dot";ge(LS);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class PS extends ht{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={stddev:this.stddev};return Object.assign(n,e),n}call(e,n){return J(()=>{this.invokeCallHook(e,n);const s=Je(e);return qu(()=>ye(Tp(s.shape,0,this.stddev),s),()=>s,n.training||!1)})}}PS.className="GaussianNoise";ge(PS);class MS extends ht{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={rate:this.rate};return Object.assign(n,e),n}call(e,n){return J(()=>{this.invokeCallHook(e,n);const s=Je(e);return this.rate>0&&this.rate<1?qu(()=>{const r=Math.sqrt(this.rate/(1-this.rate));return V(s,Tp(s.shape,1,r))},()=>s,n.training||!1):s})}}MS.className="GaussianDropout";ge(MS);class BS extends ht{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||Je(e).shape}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={rate:this.rate};return Object.assign(n,e),n}call(e,n){return J(()=>{if(this.rate<1&&this.rate>0){const s=this._getNoiseShape(e);return qu(()=>{const r=Je(e),i=1.6732632423543772,a=1.0507009873554805,l=-i*a;let c=kl(Cp(s),this.rate);c=Sp(c,"float32");const u=((1-this.rate)*(1+this.rate*l**2))**-.5,h=-u*l*this.rate,d=ye(V(r,c),V(ye(c,-1),l));return ye(V(d,u),h)},()=>Je(e),n.training||!1)}return e})}}BS.className="AlphaDropout";ge(BS);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Nc(t,e,n,s,o,r=.001){let i;if(t.rank===2)i=T4(t,e,n,s,o,r);else if(t.rank===3)i=A4(t,e,n,s,o,r);else if(t.rank===4)i=D4(t,e,n,s,o,r);else throw new Ze(`batchNormalization is not implemented for array of rank ${t.rank} yet`);return i}function YX(t,e,n,s,o=.001){return J(()=>{const r=hy(t,s),i=r.mean,a=r.variance;return[Nc(t,i,a,n,e,o),i,a]})}function ZX(t,e,n,s,o=.001){return J(()=>{const r=hy(t,s),i=r.mean,a=r.variance,l=[];for(const p of bo(0,t.rank))s.indexOf(p)!==-1?l.push(1):l.push(t.shape[p]);const c=j(i,l),u=j(a,l),h=e==null?null:j(e,l),d=n==null?null:j(n,l);return[Nc(t,c,u,d,h,o),i,a]})}function QX(t,e,n,s,o=.001){return bt(s.slice().sort(),bo(0,t.rank-1))?YX(t,e,n,s,o):ZX(t,e,n,s,o)}class VS extends ht{constructor(e){e==null&&(e={}),super(e),this.supportsMasking=!0,this.axis=e.axis==null?-1:e.axis,this.momentum=e.momentum==null?.99:e.momentum,this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=zt(e.betaInitializer||"zeros"),this.gammaInitializer=zt(e.gammaInitializer||"ones"),this.movingMeanInitializer=zt(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=zt(e.movingVarianceInitializer||"ones"),this.betaConstraint=ln(e.betaConstraint),this.gammaConstraint=ln(e.gammaConstraint),this.betaRegularizer=Wt(e.betaRegularizer),this.gammaRegularizer=Wt(e.gammaRegularizer)}build(e){e=vt(e);const n=this.axis>=0?this.axis:this.axis+e.length,s=e[n];if(s==null)throw new z(`Axis ${n} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(e)}.`);this.inputSpec=[new rn({ndim:e.length,axes:{[n]:s}})];const o=[s];this.scale&&(this.gamma=this.addWeight("gamma",o,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",o,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",o,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",o,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,n){return J(()=>{const s=n.training==null?!1:n.training,o=Je(e),r=o.shape,i=r.length,a=bo(0,i),l=this.axis>=0?this.axis:this.axis+i;a.splice(l,1);const c=ea(1,i);c[l]=r[l];const u=a.slice();u.sort();const h=!bt(u,bo(0,i).slice(0,i-1)),d=()=>{if(h){const y=j(this.movingMean.read(),c),w=j(this.movingVariance.read(),c),v=this.center?j(this.beta.read(),c):null,$=this.scale?j(this.gamma.read(),c):null;return Nc(o,y,w,v,$,this.epsilon)}else return Nc(o,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!s)return d();const[f,p,g]=QX(o,this.gamma.read(),this.beta.read(),a,this.epsilon),b=(y,w,v)=>{J(()=>{const $=1-v,_=y.read(),E=V(Pe(_,w),$);y.write(Pe(_,E))})};return(()=>{b(this.movingMean,p,this.momentum),b(this.movingVariance,g,this.momentum)})(),f})}getConfig(){const e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Ht(this.betaInitializer),gammaInitializer:Ht(this.gammaInitializer),movingMeanInitializer:Ht(this.movingMeanInitializer),movingVarianceInitializer:Ht(this.movingVarianceInitializer),betaRegularizer:St(this.betaRegularizer),gammaRegularizer:St(this.gammaRegularizer),betaConstraint:an(this.betaConstraint),gammaConstraint:an(this.gammaConstraint)},n=super.getConfig();return Object.assign(e,n),e}}VS.className="BatchNormalization";ge(VS);class zS extends ht{constructor(e){if(e==null&&(e={}),super(e),this.axis=e.axis==null?-1:e.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else if(Array.isArray(this.axis)){for(const n of this.axis)if(!Number.isInteger(n))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}else throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=zt(e.betaInitializer||"zeros"),this.gammaInitializer=zt(e.gammaInitializer||"ones"),this.betaRegularizer=Wt(e.betaRegularizer),this.gammaRegularizer=Wt(e.gammaRegularizer),this.supportsMasking=!0}build(e){e=vt(e);const n=e.length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let r=0;r<this.axis.length;++r)this.axis[r]<0&&(this.axis[r]+=n);for(const r of this.axis)if(r<0||r>=n)throw new Error(`Invalid axis: ${r}`);if(this.axis.length!==Fr(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);const s=this.axis.map(r=>e[r]),o=!0;this.scale?this.gamma=this.addWeight("gamma",s,"float32",this.gammaInitializer,this.gammaRegularizer,o):this.gamma=null,this.center?this.beta=this.addWeight("beta",s,"float32",this.betaInitializer,this.betaRegularizer,o):this.beta=null,this.built=!0}call(e,n){const s=Je(e),o=s.shape,r=o.length;return J(()=>{let{mean:a,variance:l}=hy(s,this.axis,!0);const c=ea(1,r);for(const g of this.axis)c[g]=o[g];const u=g=>g!=null&&g.shape.length!==r?j(g,c):g;let h=this.scale?u(this.gamma.read()):null,d=this.center?u(this.beta.read()):null;const f=[],p=[];for(let g=0;g<r;++g)this.axis.indexOf(g)!==-1?(f.push(o[g]),p.push(1)):(f.push(1),p.push(o[g]));return a=ho(a,f),l=ho(l,f),h!=null&&(h=ho(h,p)),d!=null&&(d=ho(d,p)),Nc(s,a,l,d,h,this.epsilon)})}getConfig(){const e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Ht(this.betaInitializer),gammaInitializer:Ht(this.gammaInitializer),betaRegularizer:St(this.betaRegularizer),gammaRegularizer:St(this.gammaRegularizer)},n=super.getConfig();return Object.assign(e,n),e}}zS.className="LayerNormalization";ge(zS);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function JX(t,e,n){return J(()=>{if(t.rank!==4)throw new z(`temporalPadding expects input tensor to be 4-D, but received a ${t.rank}-D tensor.`);if(e==null&&(e=[[1,1],[1,1]]),e.length!==2||e[0].length!==2||e[1].length!==2)throw new z("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(n==null&&(n=xo()),n!=="channelsLast"&&n!=="channelsFirst")throw new z(`Unknown data format: ${n}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let s;return n==="channelsFirst"?s=[[0,0],[0,0],e[0],e[1]]:s=[[0,0],e[0],e[1],[0,0]],dy(t,s)})}class WS extends ht{constructor(e){if(e==null&&(e={}),super(e),this.dataFormat=e.dataFormat==null?xo():e.dataFormat,e.padding==null)this.padding=[[1,1],[1,1]];else if(typeof e.padding=="number")this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,e.padding.length!==2)throw new z(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${e.padding.length} array.`);let n,s;if(typeof e.padding[0]=="number")n=[e.padding[0],e.padding[0]],s=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,e.padding[0].length!==2)throw new z(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${e.padding[0].length} array.`);if(n=e.padding[0],e.padding[1].length!==2)throw new z(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${e.padding[1].length} array.`);s=e.padding[1]}this.padding=[n,s]}this.inputSpec=[new rn({ndim:4})]}computeOutputShape(e){e=vt(e);let n,s;return this.dataFormat==="channelsFirst"?(e[2]!=null&&e[2]>=0?n=e[2]+this.padding[0][0]+this.padding[0][1]:n=null,e[3]!=null&&e[3]>=0?s=e[3]+this.padding[1][0]+this.padding[1][1]:s=null,[e[0],e[1],n,s]):(e[1]!=null&&e[1]>=0?n=e[1]+this.padding[0][0]+this.padding[0][1]:n=null,e[2]!=null&&e[2]>=0?s=e[2]+this.padding[1][0]+this.padding[1][1]:s=null,[e[0],n,s,e[3]])}call(e,n){return J(()=>JX(Je(e),this.padding,this.dataFormat))}getConfig(){const e={padding:this.padding,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}WS.className="ZeroPadding2D";ge(WS);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Pp(t,e,n,s,o,r){return J(()=>{Qt(o),iE(r),Ts(s),n==null&&(n=[1,1]),s==null&&(s="valid"),o==null&&(o=xo()),r==null&&(r="max"),t=g0(t,o);let i;const a=s==="same"?"same":"valid";return r==="max"?i=uy(t,e,n,a):i=Jx(t,e,n,a),o==="channelsFirst"&&(i=lt(i,[0,3,1,2])),i})}function US(t,e,n,s,o,r){return J(()=>{Qt(o),iE(r),Ts(s),n==null&&(n=[1,1,1]),s==null&&(s="valid"),o==null&&(o=xo()),r==null&&(r="max"),t=iS(t,o);let i;const a=s==="same"?"same":"valid";return r==="max"?i=pH(t,e,n,a):i=v4(t,e,n,a),o==="channelsFirst"&&(i=lt(i,[0,4,1,2,3])),i})}class HS extends ht{constructor(e){if(e.poolSize==null&&(e.poolSize=2),super(e),typeof e.poolSize=="number")this.poolSize=[e.poolSize];else if(Array.isArray(e.poolSize)&&e.poolSize.length===1&&typeof e.poolSize[0]=="number")this.poolSize=e.poolSize;else throw new z(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.poolSize)}`);if(xn(this.poolSize,"poolSize"),e.strides==null)this.strides=this.poolSize;else if(typeof e.strides=="number")this.strides=[e.strides];else if(Array.isArray(e.strides)&&e.strides.length===1&&typeof e.strides[0]=="number")this.strides=e.strides;else throw new z(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.strides)}`);xn(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,Ts(this.padding),this.inputSpec=[new rn({ndim:3})]}computeOutputShape(e){e=vt(e);const n=mo(e[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],n,e[2]]}call(e,n){return J(()=>{this.invokeCallHook(e,n),e=Gu(Je(e),2);const s=this.poolingFunction(Je(e),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return Bu(s,[2])})}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},n=super.getConfig();return Object.assign(e,n),e}}class GS extends HS{constructor(e){super(e)}poolingFunction(e,n,s,o,r){return Qt(r),Ts(o),Pp(e,n,s,o,r,"max")}}GS.className="MaxPooling1D";ge(GS);class jS extends HS{constructor(e){super(e)}poolingFunction(e,n,s,o,r){return Qt(r),Ts(o),Pp(e,n,s,o,r,"avg")}}jS.className="AveragePooling1D";ge(jS);class qS extends ht{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==2)throw new z(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides];xn(this.poolSize,"poolSize"),xn(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Qt(this.dataFormat),Ts(this.padding),this.inputSpec=[new rn({ndim:4})]}computeOutputShape(e){e=vt(e);let n=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2];return n=mo(n,this.poolSize[0],this.padding,this.strides[0]),s=mo(s,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[e[0],e[1],n,s]:[e[0],n,s,e[3]]}call(e,n){return J(()=>(this.invokeCallHook(e,n),this.poolingFunction(Je(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class KS extends qS{constructor(e){super(e)}poolingFunction(e,n,s,o,r){return Qt(r),Ts(o),Pp(e,n,s,o,r,"max")}}KS.className="MaxPooling2D";ge(KS);class XS extends qS{constructor(e){super(e)}poolingFunction(e,n,s,o,r){return Qt(r),Ts(o),Pp(e,n,s,o,r,"avg")}}XS.className="AveragePooling2D";ge(XS);class YS extends ht{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==3)throw new z(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides,e.strides];xn(this.poolSize,"poolSize"),xn(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Qt(this.dataFormat),Ts(this.padding),this.inputSpec=[new rn({ndim:5})]}computeOutputShape(e){e=vt(e);let n=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2],o=this.dataFormat==="channelsFirst"?e[4]:e[3];return n=mo(n,this.poolSize[0],this.padding,this.strides[0]),s=mo(s,this.poolSize[1],this.padding,this.strides[1]),o=mo(o,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[e[0],e[1],n,s,o]:[e[0],n,s,o,e[4]]}call(e,n){return J(()=>(this.invokeCallHook(e,n),this.poolingFunction(Je(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class ZS extends YS{constructor(e){super(e)}poolingFunction(e,n,s,o,r){return Qt(r),Ts(o),US(e,n,s,o,r,"max")}}ZS.className="MaxPooling3D";ge(ZS);class QS extends YS{constructor(e){super(e)}poolingFunction(e,n,s,o,r){return Qt(r),Ts(o),US(e,n,s,o,r,"avg")}}QS.className="AveragePooling3D";ge(QS);class JS extends ht{constructor(e){super(e),this.inputSpec=[new rn({ndim:3})]}computeOutputShape(e){return[e[0],e[2]]}call(e,n){throw new Ze}}class eT extends JS{constructor(e){super(e||{})}call(e,n){return J(()=>{const s=Je(e);return Kt(s,1)})}}eT.className="GlobalAveragePooling1D";ge(eT);class tT extends JS{constructor(e){super(e||{})}call(e,n){return J(()=>{const s=Je(e);return Lo(s,1)})}}tT.className="GlobalMaxPooling1D";ge(tT);class nT extends ht{constructor(e){super(e),this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Qt(this.dataFormat),this.inputSpec=[new rn({ndim:4})]}computeOutputShape(e){return e=e,this.dataFormat==="channelsLast"?[e[0],e[3]]:[e[0],e[1]]}call(e,n){throw new Ze}getConfig(){const e={dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class sT extends nT{call(e,n){return J(()=>{const s=Je(e);return this.dataFormat==="channelsLast"?Kt(s,[1,2]):Kt(s,[2,3])})}}sT.className="GlobalAveragePooling2D";ge(sT);class oT extends nT{call(e,n){return J(()=>{const s=Je(e);return this.dataFormat==="channelsLast"?Lo(s,[1,2]):Lo(s,[2,3])})}}oT.className="GlobalMaxPooling2D";ge(oT);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class rT extends ht{constructor(e){super(e),this.layer=e.layer}build(e){this.built=!0}get trainable(){return this.layer!=null?this.layer.trainable:!1}set trainable(e){this.layer!=null&&(this.layer.trainable=e)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(e){this.layer.setWeights(e)}getConfig(){const e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},n=super.getConfig();return Object.assign(e,n),e}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(e)}static fromConfig(e,n,s={}){const o=n.layer,r=Bo(o,s);delete n.layer;const i={layer:r};return Object.assign(i,n),new e(i)}}class iT extends rT{constructor(e){super(e),this.supportsMasking=!0}build(e){if(e=vt(e),e.length<3)throw new z(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(e)}`);this.inputSpec=[{shape:e}];const n=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(n),this.layer.built=!0),super.build(e)}computeOutputShape(e){e=vt(e);const n=[e[0]].concat(e.slice(2)),s=this.layer.computeOutputShape(n),o=e[1];return[s[0],o].concat(s.slice(1))}call(e,n){return J(()=>(e=Je(e),mS((i,a)=>[Je(this.layer.call(i,n)),[]],e,[],!1,null,null,!1,!0)[1]))}}iT.className="TimeDistributed";ge(iT);function e5(t){ia(x6,"BidirectionalMergeMode",t)}const t5="concat";class aT extends rT{constructor(e){super(e);const n=e.layer.getConfig(),s={};s.className=e.layer.getClassName(),s.config=n,this.forwardLayer=Bo(s),n.goBackwards=n.goBackwards!==!0;const o={};if(o.className=e.layer.getClassName(),o.config=n,this.backwardLayer=Bo(o),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=e.mergeMode===void 0?t5:e.mergeMode,e5(this.mergeMode),e.weights)throw new Ze("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,this.forwardLayer!=null&&(this.forwardLayer.trainable=e),this.backwardLayer!=null&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){const n=e.length,s=Math.floor(n/2);this.forwardLayer.setWeights(e.slice(0,s)),this.backwardLayer.setWeights(e.slice(s))}computeOutputShape(e){let n=this.forwardLayer.computeOutputShape(e);Array.isArray(n)&&Array.isArray(n[0])||(n=[n]),n=n;let s,o,r;return this.returnState&&(r=n.slice(1)),s=n[0],s=s,this.mergeMode==="concat"?(s[s.length-1]*=2,o=[s]):this.mergeMode==null?o=[s,s.slice()]:o=[s],this.returnState?this.mergeMode==null?o.concat(r).concat(r.slice()):[s].concat(r).concat(r.slice()):Jn(o)}apply(e,n){let s=n==null?null:n.initialState,o=n==null?null:n.constants;n==null&&(n={});const r=pS(e,s,o,this.numConstants);if(e=r.inputs,s=r.initialState,o=r.constants,Array.isArray(e)&&(s=e.slice(1),e=e[0]),(s==null||s.length===0)&&o==null)return super.apply(e,n);const i=[],a=[];if(s!=null){const c=s.length;if(c%2>0)throw new z("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");n.initialState=s,i.push(...s);const u=s.map(h=>new rn({shape:h.shape}));this.forwardLayer.stateSpec=u.slice(0,c/2),this.backwardLayer.stateSpec=u.slice(c/2),a.push(...u)}if(o!=null)throw new Ze("Support for constants in Bidirectional layers is not implemented yet.");const l=i[0]instanceof Do;for(const c of i)if(c instanceof Do!==l)throw new z("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(l){const c=[e].concat(i),u=this.inputSpec.concat(a),h=this.inputSpec;this.inputSpec=u;const d=super.apply(c,n);return this.inputSpec=h,d}else return super.apply(e,n)}call(e,n){return J(()=>{const s=n.initialState;let o,r;if(s==null)o=this.forwardLayer.call(e,n),r=this.backwardLayer.call(e,n);else{const l=s.slice(0,s.length/2),c=s.slice(s.length/2);o=this.forwardLayer.call(e,Object.assign(n,{initialState:l})),r=this.backwardLayer.call(e,Object.assign(n,{initialState:c}))}let i;this.returnState&&(Array.isArray(o)&&(i=o.slice(1).concat(r.slice(1))),o=o[0],r=r[0]),this.returnSequences&&(r=Zi(r,1));let a;return this.mergeMode==="concat"?a=n0([o,r]):this.mergeMode==="sum"?a=ye(o,r):this.mergeMode==="ave"?a=V(.5,ye(o,r)):this.mergeMode==="mul"?a=V(o,r):this.mergeMode==null&&(a=[o,r]),this.returnState?this.mergeMode==null?a.concat(i):[a].concat(i):a})}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){Vi(this.forwardLayer.name,()=>{this.forwardLayer.build(e)}),Vi(this.backwardLayer.name,()=>{this.backwardLayer.build(e)}),this.built=!0}computeMask(e,n){Array.isArray(n)&&(n=n[0]);let s;if(this.returnSequences?this.mergeMode==null?s=[n,n]:s=n:this.mergeMode==null?s=[null,null]:s=null,this.returnState){const r=this.forwardLayer.states.map(i=>null);return Array.isArray(s)?s.concat(r).concat(r):[s].concat(r).concat(r)}else return s}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(e),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){const e={mergeMode:this.mergeMode},n=super.getConfig();return Object.assign(e,n),e}static fromConfig(e,n){const s=Bo(n.layer);if(delete n.layer,n.numConstants!=null)throw new Ze("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const o=n;return o.layer=s,new e(o)}}aT.className="Bidirectional";ge(aT);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n5=se();n5.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,t=>{t&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var wC;(function(t){t[t.DT_INVALID=0]="DT_INVALID",t[t.DT_FLOAT=1]="DT_FLOAT",t[t.DT_DOUBLE=2]="DT_DOUBLE",t[t.DT_INT32=3]="DT_INT32",t[t.DT_UINT8=4]="DT_UINT8",t[t.DT_INT16=5]="DT_INT16",t[t.DT_INT8=6]="DT_INT8",t[t.DT_STRING=7]="DT_STRING",t[t.DT_COMPLEX64=8]="DT_COMPLEX64",t[t.DT_INT64=9]="DT_INT64",t[t.DT_BOOL=10]="DT_BOOL",t[t.DT_QINT8=11]="DT_QINT8",t[t.DT_QUINT8=12]="DT_QUINT8",t[t.DT_QINT32=13]="DT_QINT32",t[t.DT_BFLOAT16=14]="DT_BFLOAT16",t[t.DT_QINT16=15]="DT_QINT16",t[t.DT_QUINT16=16]="DT_QUINT16",t[t.DT_UINT16=17]="DT_UINT16",t[t.DT_COMPLEX128=18]="DT_COMPLEX128",t[t.DT_HALF=19]="DT_HALF",t[t.DT_RESOURCE=20]="DT_RESOURCE",t[t.DT_VARIANT=21]="DT_VARIANT",t[t.DT_UINT32=22]="DT_UINT32",t[t.DT_UINT64=23]="DT_UINT64",t[t.DT_FLOAT_REF=101]="DT_FLOAT_REF",t[t.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",t[t.DT_INT32_REF=103]="DT_INT32_REF",t[t.DT_UINT8_REF=104]="DT_UINT8_REF",t[t.DT_INT16_REF=105]="DT_INT16_REF",t[t.DT_INT8_REF=106]="DT_INT8_REF",t[t.DT_STRING_REF=107]="DT_STRING_REF",t[t.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",t[t.DT_INT64_REF=109]="DT_INT64_REF",t[t.DT_BOOL_REF=110]="DT_BOOL_REF",t[t.DT_QINT8_REF=111]="DT_QINT8_REF",t[t.DT_QUINT8_REF=112]="DT_QUINT8_REF",t[t.DT_QINT32_REF=113]="DT_QINT32_REF",t[t.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",t[t.DT_QINT16_REF=115]="DT_QINT16_REF",t[t.DT_QUINT16_REF=116]="DT_QUINT16_REF",t[t.DT_UINT16_REF=117]="DT_UINT16_REF",t[t.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",t[t.DT_HALF_REF=119]="DT_HALF_REF",t[t.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",t[t.DT_VARIANT_REF=121]="DT_VARIANT_REF",t[t.DT_UINT32_REF=122]="DT_UINT32_REF",t[t.DT_UINT64_REF=123]="DT_UINT64_REF"})(wC||(wC={}));var CC;(function(t){(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(t.CheckpointFormatVersion||(t.CheckpointFormatVersion={}))})(CC||(CC={}));/** @license See the LICENSE file. *//**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var $C;(function(t){t[t.FAIL=0]="FAIL",t[t.SHORTEST=1]="SHORTEST",t[t.LONGEST=2]="LONGEST"})($C||($C={}));/** @license See the LICENSE file. *//**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function De(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&T(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the CPU backend.`)})}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s5=_k;class Mp extends qb{constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new MI(this,Er())}nextDataId(){return Mp.nextDataId++}write(e,n,s){this.firstUse&&(this.firstUse=!1,se().get("IS_NODE")&&Cs(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));const o={id:this.nextDataId()};return this.data.set(o,{values:e,dtype:s,refCount:1}),o}makeTensorInfo(e,n,s){let o;if(n==="string"&&s!=null&&s.length>0&&Mc(s[0])){const r=s.map(i=>Or(i));o=this.write(r,e,n)}else o=this.write(s,e,n);return{dataId:o,shape:e,dtype:n}}refCount(e){return this.data.has(e)?this.data.get(e).refCount:0}incRef(e){const n=this.data.get(e);n.refCount++}decRef(e){if(this.data.has(e)){const n=this.data.get(e);n.refCount--}}move(e,n,s,o,r){this.data.set(e,{values:n,dtype:o,refCount:r})}numDataIds(){return this.data.numDataIds()}async read(e){return this.readSync(e)}readSync(e){const{dtype:n,complexTensorInfos:s}=this.data.get(e);if(n==="complex64"){const o=this.readSync(s.real.dataId),r=this.readSync(s.imag.dataId);return ar(o,r)}return this.data.get(e).values}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const s=n.map(o=>Mr(o));return nt(e.shape,e.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return nt(e.shape,e.dtype,n)}makeOutput(e,n,s){return Er().makeTensorFromTensorInfo(this.makeTensorInfo(n,s,e),this)}disposeData(e,n=!1){if(this.data.has(e)){if(this.data.get(e).refCount--,!n&&this.data.get(e).refCount>0)return!1;const{complexTensorInfos:s}=this.data.get(e);s!=null&&(this.disposeData(s.real.dataId,!0),this.disposeData(s.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}async time(e){const n=Zn();return e(),{kernelMs:Zn()-n}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){De([e],"where");const n=this.readSync(e.dataId);return s5(e.shape,n)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}Mp.nextDataId=0;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lT(t){const e=new Float32Array(t.length);for(let n=0;n<t.length;++n)e[n]=Math.abs(t[n]);return e}const o5=t=>{const{x:e}=t.inputs,n=t.backend;De(e,"abs");let s=new Float32Array(ae(e.shape));const o=n.data.get(e.dataId).values;return s=lT(o),n.makeOutput(s,e.shape,e.dtype)},r5={kernelName:hf,backendName:"cpu",kernelFunc:o5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nn(t){return(e,n,s,o,r)=>{const i=Ye(e,n),a=i.length,l=Ue(i),c=ae(i),u=$n(r,c),h=e.length,d=n.length,f=Ue(e),p=Ue(n),g=al(e,i),b=al(n,i);if(g.length+b.length===0)for(let x=0;x<u.length;++x)u[x]=t(s[x%s.length],o[x%o.length]);else for(let x=0;x<u.length;++x){const y=Vc(x,a,l),w=y.slice(-h);g.forEach(E=>w[E]=0);const v=Fo(w,h,f),$=y.slice(-d);b.forEach(E=>$[E]=0);const _=Fo($,d,p);u[x]=t(s[v],o[_])}return[u,i]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cs(t){const{inputs:e,backend:n}=t,{real:s,imag:o}=e,r=n.data.get(s.dataId).values,i=n.data.get(o.dataId).values,a=n.makeTensorInfo(s.shape,"complex64"),l=n.data.get(a.dataId);return l.complexTensorInfos={real:n.makeTensorInfo(s.shape,"float32",r),imag:n.makeTensorInfo(o.shape,"float32",i)},a}const i5={kernelName:sx,backendName:"cpu",kernelFunc:cs};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pd(t,e,n="float32"){if(n==="complex64"){const o=Pd(t,e,"float32"),r=Pd(t,e,"float32");return cs({inputs:{real:o,imag:r},backend:t})}const s=Ln(ae(e),n);return t.makeTensorInfo(e,n,s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Go(t){const{inputs:e,backend:n}=t,{x:s}=e;return n.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const a5={kernelName:au,backendName:"cpu",kernelFunc:Go};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ta(t){const{inputs:e,backend:n}=t,{input:s}=e,o=n.data.get(s.dataId).complexTensorInfos.real,r=n.data.get(o.dataId).values;return n.makeTensorInfo(o.shape,o.dtype,r)}const l5={kernelName:_x,backendName:"cpu",kernelFunc:ta};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cT(t,e,n,s){if(s==="int32"){const o=Int32Array.from(t);return[e,"int32",o]}if(s==="bool"){const o=oa([0],n),[r,i]=nn((a,l)=>a!==l?1:0)(e,[],t,o,"bool");return[i,"bool",r]}throw new Error(`Error in Cast: failed to cast ${n} to ${s}`)}function Ur(t){const{inputs:e,backend:n,attrs:s}=t,{x:o}=e,{dtype:r}=s;if(r==="complex64"){if(o.dtype==="complex64")return Go({inputs:{x:o},backend:n});const u=Pd(n,o.shape,o.dtype),h=Ur({inputs:{x:o},backend:n,attrs:{dtype:"float32"}}),d=cs({inputs:{real:h,imag:u},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(h),d}if(o.dtype==="complex64"){const u=ta({inputs:{input:o},backend:n}),h=Ur({inputs:{x:u},backend:n,attrs:{dtype:r}});return n.disposeIntermediateTensorInfo(u),h}if(!zI(o.dtype,r)){const u=Go({inputs:{x:o},backend:n});return{dataId:u.dataId,shape:u.shape,dtype:r}}const i=n.data.get(o.dataId).values,[a,l,c]=cT(i,o.shape,o.dtype,r);return n.makeTensorInfo(a,l,c)}const c5={kernelName:Kc,backendName:"cpu",kernelFunc:Ur};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vn(t,e,n,s){return n==null?({inputs:o,backend:r})=>{const{a:i,b:a}=o,l=r;De([i,a],t);const c=l.data.get(i.dataId).values,u=l.data.get(a.dataId).values,h=i.dtype==="string"?Ji(c):c,d=i.dtype==="string"?Ji(u):u,f=s||i.dtype,[p,g]=e(i.shape,a.shape,h,d,f);return l.makeTensorInfo(g,f,p)}:({inputs:o,backend:r})=>{const{a:i,b:a}=o,l=r;if(i.dtype==="complex64"||a.dtype==="complex64"){const c=Ur({inputs:{x:i},backend:l,attrs:{dtype:"complex64"}}),u=l.data.get(c.dataId),h=u.complexTensorInfos.real,d=u.complexTensorInfos.imag,f=l.data.get(h.dataId).values,p=l.data.get(d.dataId).values,g=Ur({inputs:{x:a},backend:l,attrs:{dtype:"complex64"}}),b=l.data.get(g.dataId),x=b.complexTensorInfos.real,y=b.complexTensorInfos.imag,w=l.data.get(x.dataId).values,v=l.data.get(y.dataId).values,[$,_,E]=n(i.shape,a.shape,f,p,w,v),k=l.makeTensorInfo(E,"float32",$),N=l.makeTensorInfo(E,"float32",_),A=cs({inputs:{real:k,imag:N},backend:l});return l.disposeIntermediateTensorInfo(c),l.disposeIntermediateTensorInfo(g),l.disposeIntermediateTensorInfo(k),l.disposeIntermediateTensorInfo(N),A}else{const c=l.data.get(i.dataId).values,u=l.data.get(a.dataId).values,h=s||i.dtype,[d,f]=e(i.shape,a.shape,c,u,h);return l.makeTensorInfo(f,h,d)}}}function C0(t){return(e,n,s,o,r,i)=>{const a=Ye(e,n),l=ae(a),c=a.length,u=Ue(a),h=$n("float32",l),d=$n("float32",l),f=al(e,a),p=al(n,a),g=ar(s,o),b=ar(r,i),x=e.length,y=Ue(e),w=n.length,v=Ue(n);if(f.length+p.length===0)for(let $=0;$<h.length;$++){const _=$%g.length,E=$%b.length,k=t(g[_*2],g[_*2+1],b[E*2],b[E*2+1]);h[$]=k.real,d[$]=k.imag}else for(let $=0;$<h.length;$++){const _=Vc($,c,u),E=_.slice(-x);f.forEach(L=>E[L]=0);const k=Fo(E,x,y),N=_.slice(-w);p.forEach(L=>N[L]=0);const A=Fo(N,w,v),F=t(g[k*2],g[k*2+1],b[A*2],b[A*2+1]);h[$]=F.real,d[$]=F.imag}return[h,d,a]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uT=nn((t,e)=>t+e),u5=C0((t,e,n,s)=>({real:t+n,imag:e+s})),hl=vn($l,uT,u5),h5={kernelName:$l,backendName:"cpu",kernelFunc:hl};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $0(t,e,n,s,o){const r=ae(s),i=Ln(o,n);for(let a=0;a<t.length;a++){const l=t[a];if(l<0)throw new Error("Input x must be non-negative!");l>=o||(r>0?i[l]+=e[a]:i[l]+=1)}return i}function hT(t,e,n,s=!1){const o=t.shape[0],r=t.shape[1],i=nt([o,n],e.dtype);for(let a=0;a<o;a++)for(let l=0;l<r;l++){const c=t.get(a,l);if(c<0)throw new Error("Input x must be non-negative!");c>=n||(s?i.set(1,a,c):e.size>0?i.set(i.get(a,c)+e.get(a,l),a,c):i.set(i.get(a,c)+1,a,c))}return i}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ti(t){return(e,n,s)=>{const o=$n(n,e.length);for(let r=0;r<e.length;++r)o[r]=t(e[r],s);return o}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wt(t,e,n){return({inputs:s,attrs:o,backend:r})=>{const{x:i}=s;if(De(i,t),i.dtype==="string"||n==="string")throw new Error("unaryKernelFunc does not support string input/output");const a=r,l=a.data.get(i.dataId).values,c=ae(i.shape),u=n||i.dtype,h=An(u,c);for(let d=0;d<c;++d)h[d]=e(l[d],o);return a.makeTensorInfo(i.shape,u,h)}}function Nl(t,e,n){return({inputs:s,attrs:o,backend:r})=>{const{x:i}=s;if(De(i,t),i.dtype==="string"||n==="string")throw new Error("unaryKernelFunc does not support string input/output");const a=r,l=a.data.get(i.dataId).values,c=n||i.dtype,u=e(l,c,o);return a.makeTensorInfo(i.shape,c,u)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dT=ti(t=>Math.ceil(t)),d5=Nl(Xc,dT),f5={kernelName:Xc,backendName:"cpu",kernelFunc:d5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fT(t,e,n,s){const o=An(n,ae(e));if(s&&n!=="string"){let r=0;t.forEach(i=>{const a=ae(i.shape);o.set(i.vals,r),r+=a})}else{let r=0;t.forEach(i=>{const a=n==="string"?Ji(i.vals):i.vals;let l=0;for(let c=0;c<i.shape[0];++c){const u=c*e[1]+r;for(let h=0;h<i.shape[1];++h)o[u+h]=a[l++]}r+=i.shape[1]})}return o}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pT=nn((t,e)=>t===e?1:0),mT=vn(kf,pT,null,"bool"),p5={kernelName:kf,backendName:"cpu",kernelFunc:mT};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gT=ti(t=>Math.exp(t)),bT=Nl(nu,gT,"float32"),m5={kernelName:nu,backendName:"cpu",kernelFunc:bT};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xT=ti(t=>Math.expm1(t)),g5=Nl(su,xT),b5={kernelName:su,backendName:"cpu",kernelFunc:g5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yT=ti(t=>Math.floor(t)),x5=Nl(ou,yT),y5={kernelName:ou,backendName:"cpu",kernelFunc:x5};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vT(t,e,n,s,o,r,i,a,l){const c=nt([s,r],n);for(let u=0;u<s;u++){const h=[];let d=0;for(let f=0;f<o;f++){const p=t[u*o+f];d+=p*i[f],h.push(p)}if(d<0||d>=l/r)throw new Error(`Invalid indices: ${h} does not index into ${a}`);for(let f=0;f<r;f++)c.values[u*r+f]=e.get(...e.indexToLoc(d*r+f))}return c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wT(t,e,n){const s=nt(n,t.dtype);for(let o=0;o<s.size;++o){const i=s.indexToLoc(o).slice(),a=i[0],l=i[2],c=e.locToIndex([a,l]);i[2]=e.values[c];const u=t.locToIndex(i);0<=u&&u<t.values.length&&(s.values[o]=t.values[u])}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CT=nn((t,e)=>t>e?1:0),v5=vn(Nf,CT,null,"bool"),w5={kernelName:Nf,backendName:"cpu",kernelFunc:v5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $T=nn((t,e)=>t>=e?1:0),C5=vn(iu,$T,null,"bool"),$5={kernelName:iu,backendName:"cpu",kernelFunc:C5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IT=nn((t,e)=>t<e?1:0),I5=vn(Rf,IT,null,"bool"),_5={kernelName:Rf,backendName:"cpu",kernelFunc:I5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _T=nn((t,e)=>t<=e?1:0),k5=vn(Df,_T,null,"bool"),E5={kernelName:Df,backendName:"cpu",kernelFunc:k5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kT(t,e,n){const s=(e-t)/(n-1),o=Ln(n,"float32");o[0]=t;for(let r=1;r<o.length;r++)o[r]=o[r-1]+s;return o}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ET=ti(t=>Math.log(t)),S5=Nl(hu,ET),T5={kernelName:hu,backendName:"cpu",kernelFunc:S5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ST(t,e,n,s){const o=$n(s,ae(n));for(let r=0;r<o.length;++r){const i=r*e;let a=t[i];for(let l=0;l<e;++l){const c=t[i+l];(Number.isNaN(c)||c>a)&&(a=c)}o[r]=a}return o}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TT=nn((t,e)=>Math.max(t,e)),N5=vn(fu,TT),A5={kernelName:fu,backendName:"cpu",kernelFunc:N5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NT=nn((t,e)=>Math.min(t,e)),R5=vn(pu,NT),D5={kernelName:pu,backendName:"cpu",kernelFunc:R5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I0=nn((t,e)=>t*e),O5=C0((t,e,n,s)=>({real:t*n-e*s,imag:t*s+e*n})),Bp=vn(gu,I0,O5),F5={kernelName:gu,backendName:"cpu",kernelFunc:Bp};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AT(t,e,n){const s=qr(-1,n);return I0([],e,s,t,n)}function L5(t){const{inputs:e,backend:n}=t,{x:s}=e;De(s,"neg");const o=n.data.get(s.dataId).values,[r,i]=AT(o,s.shape,s.dtype);return n.makeTensorInfo(i,s.dtype,r)}const P5={kernelName:Hf,backendName:"cpu",kernelFunc:L5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RT=nn((t,e)=>t!==e?1:0),M5=vn(Gf,RT,null,"bool"),B5={kernelName:Gf,backendName:"cpu",kernelFunc:M5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _0(t,e,n,s,o){const r=e.length,i=ae(e),a=Ue(e),l=Ue(o),c=$n(n,ae(o));for(let u=0;u<i;++u){const h=Vc(u,r,a),d=new Array(h.length);for(let p=0;p<d.length;p++)d[p]=h[s[p]];const f=Fo(d,r,l);c[f]=t[u]}return c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function os(t){const{inputs:e,attrs:n,backend:s}=t,{x:o}=e,{perm:r}=n;De(o,"transpose");const i=o.shape.length,a=new Array(i);for(let h=0;h<a.length;h++)a[h]=o.shape[r[h]];const l=s.data.get(o.dataId).values,c=_0(l,o.shape,o.dtype,r,a);return{dataId:s.write(c,a,o.dtype),shape:a,dtype:o.dtype}}const V5={kernelName:ja,backendName:"cpu",kernelFunc:os};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DT(t,e,n,s){const[o,r]=yn(t,s),i=ds(e,"int32"),a=Ln(ae(o),i),l=ae(r);for(let c=0;c<a.length;++c){const u=c*l;let h=1;for(let d=0;d<l;++d)h*=n[u+d];a[c]=h}return{outVals:a,outShape:o,outDtype:i}}function z5(t){const{inputs:e,backend:n,attrs:s}=t,{x:o}=e,{axis:r,keepDims:i}=s;De(o,"prod");const a=o.shape.length,l=st(r,o.shape),c=jt(l,a);let u=l,h=o;const d=[];c!=null&&(h=os({inputs:{x:o},backend:n,attrs:{perm:c}}),d.push(h),u=Zt(u.length,a));const f=n.data.get(h.dataId).values,{outVals:p,outShape:g,outDtype:b}=DT(h.shape,h.dtype,f,u);let x=g;return i&&(x=Yt(g,l)),d.forEach(y=>n.disposeIntermediateTensorInfo(y)),n.makeTensorInfo(x,b,p)}const W5={kernelName:Zf,backendName:"cpu",kernelFunc:z5};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Os=lo;class Md{constructor(e,n,s,o,r,i,a,l,c,u){this.shape=e,this.shapeShape=n,this.values=s,this.valuesShape=o,this.valuesDType=r,this.defaultValue=i,this.defaultValueShape=a,this.rowPartitionValues=l,this.rowPartitionValuesShapes=c,this.rowPartitionTypes=Ak(u),this.raggedRank=Rk(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===Os.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===Os.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const n=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case Os.VALUE_ROWIDS:return Md.getMaxWidthValueRowID(n);case Os.ROW_SPLITS:return Md.getMaxWidthRowSplit(n);default:throw new Error(`Cannot handle partition type ${Os[this.getRowPartitionTypeByDimension(e-1)]}`)}}static getMaxWidthRowSplit(e){const n=e.length;if(n===0||n===1)return 0;let s=0;for(let o=0;o<n-1;++o){const r=e[o+1]-e[o];r>s&&(s=r)}return s}static getMaxWidthValueRowID(e){const n=e.length;if(n===0)return 0;let s=0,o=e[0],r=0;for(let i=1;i<n;++i){const a=e[i];a!==o&&(o=a,r=Math.max(i-s,r),s=i)}return Math.max(n-s,r)}tensorShapeFromTensor(e,n,s=!0){if(n.length===0){if(e[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return _C(e,s)}calculateOutputSize(e){const n=this.valuesShape,s=this.defaultValueShape;Dk(s,n);const o=this.tensorShapeFromTensor(this.shape,this.shapeShape),i=Nk(this.raggedRank,o,n);i[0]<0&&(i[0]=e);for(let a=1;a<=this.raggedRank;++a)i[a]<0&&(i[a]=this.getMaxWidth(a));return i}calculateFirstParentOutputIndex(e,n,s){const o=Math.min(e,s),r=[];let i=0;for(let a=0;a<o;++a,i+=n)r.push(i);for(let a=o;a<e;++a)r.push(-1);return T(r.length===e,()=>"Final length of result must be equal to firstDimension."),r}calculateOutputIndexRowSplit(e,n,s,o){const r=e.length,i=[];for(let a=0;a<r-1;++a){const l=e[a+1]-e[a];let c=Math.min(o,l),u=n[a];u===-1&&(c=0);for(let h=0;h<c;++h)i.push(u),u+=s;for(let h=0;h<l-c;++h)i.push(-1)}if(r>0&&i.length!==e[r-1])throw new Error("Invalid row split size.");return i}calculateOutputIndexValueRowID(e,n,s,o){const r=e.length,i=[];if(r===0)return[];let a=0,l=e[0];if(l>=n.length)throw new Error(`Got currentValueRowId=${l}, which is not less than ${n.length}`);let c=n[l];i.push(c);for(let u=1;u<r;++u){const h=e[u];if(h===l)c>=0&&(++a,a<o?c+=s:c=-1);else{if(a=0,l=h,h>=n.length)throw new Error(`Got nextValueRowId=${h} which is not less than ${n.length}`);c=n[h]}i.push(c)}if(i.length!==e.length)throw new Error("Invalid row ids.");return i}calculateOutputIndex(e,n,s,o){const r=this.getRowPartitionTensor(e),i=this.getRowPartitionTypeByDimension(e);switch(i){case Os.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(r,n,s,o);case Os.ROW_SPLITS:if(r.length-1>n.length)throw new Error(`Row partition size is greater than output size: ${r.length-1} > ${n.length}`);return this.calculateOutputIndexRowSplit(r,n,s,o);default:throw new Error(`Unsupported partition type: ${Os[i]}`)}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const n=this.rowPartitionTypes[0];switch(n){case Os.FIRST_DIM_SIZE:return e[0];case Os.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case Os.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${Os[n]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const n=this.getFirstDimensionSize(),s=this.calculateOutputSize(n),o=new Array(this.raggedRank+1);o[o.length-1]=1;for(let l=o.length-2;l>=0;--l)o[l]=o[l+1]*s[l+1];const r=_C(s,!1),i=An(this.valuesDType,ae(r));if(o[0]*s[0]>0){let l=this.calculateFirstParentOutputIndex(n,o[0],s[0]);for(let c=1;c<=this.raggedRank;++c)l=this.calculateOutputIndex(c-1,l,o[c],s[c]);this.setOutput(this.raggedRank,l,i,r)}return[r,i]}setOutput(e,n,s,o){if(s.length===0)return;const r=this.values,i=s;let a=o.slice();a=a.slice(e+1);const l=ae(a),c=n.length;let u=this.defaultValue;if(u.length!==l&&u.length!==1){const p=this.defaultValueShape;J(()=>{const g=j(u,p);u=mc(g,a).dataSync()})}let h=0,d=0,f=0;for(let p=0;p<=c;++p){let g=p<c?n[p]:-1;if(g===f){++f;continue}if(d<f){const b=r.subarray(h*l),x=i.subarray(d*l),y=(f-d)*l;IC(x,b,y)}if(p>=c){const b=s.length;g=Math.floor(b/l)}if(g>f)if(this.defaultValue.length===1)i.subarray(f*l,g*l).fill(this.defaultValue[0]),f=g;else for(;g>f;){const b=i.slice(f*l);IC(b,u,l),++f}g<0?(h=p+1,d=f):(h=p,d=f,f=d+1)}}}function IC(t,e,n){for(let s=0;s<n;s++)t[s]=e[s]}function _C(t,e){const n=[];for(let s of t){if(s<0){if(!e)throw new Error(`Dimension ${s} must be >= 0`);if(s<-1)throw new Error(`Dimension ${s} must be >= -1`);s=-1}n.push(s)}return n}function OT(t,e,n,s,o,r,i,a,l,c){return new Md(t,e,n,s,o,r,i,a,l,c).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FT(t,e,n,s){const o=t===e,r=t<e&&n<0,i=e<t&&n>1;if(o||r||i)return Ln(0,s);const a=Math.abs(Math.ceil((e-t)/n)),l=Ln(a,s);e<t&&n===1&&(n=-1),l[0]=t;for(let c=1;c<l.length;c++)l[c]=l[c-1]+n;return l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LT=ti(t=>1/Math.sqrt(t)),U5=Nl(Cu,LT),H5={kernelName:Cu,backendName:"cpu",kernelFunc:U5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ba(t,e,n,s,o,r,i,a,l,c){const u=[s/o,o],h=t.values,d=e.values;if(s===0)return nt(n,e.dtype);const f=nt(u,e.dtype);typeof l=="string"||typeof l=="number"?f.values.fill(l):typeof l=="boolean"&&f.values.fill(+l);for(let p=0;p<r;p++){const g=[];let b=0;for(let x=0;x<i;x++){const y=h[p*i+x];g.push(y),b+=y*a[x]}if(b<0||b>=s/o)throw new Error(`Invalid indices: ${g} does not index into ${n}`);for(let x=0;x<o;x++)c?f.values[b*o+x]+=d[p*o+x]:f.values[b*o+x]=e.rank===0?d[0]:d[p*o+x]}return f}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G5=ti(t=>1/(1+Math.exp(-t))),PT=wt(Eu,t=>1/(1+Math.exp(-t))),j5={kernelName:Eu,backendName:"cpu",kernelFunc:PT};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MT(t,e,n,s,o){const r=Xx(s,e,n),i=ae(n),a=Ue(s);if(r){const h=Yx(e,a);return o==="string"?t.slice(h,h+i):t.subarray(h,h+i)}const l=o==="string"?Ji(t):t,c=nt(s,o,l),u=nt(n,o);for(let h=0;h<u.size;++h){const d=u.indexToLoc(h),f=d.map((p,g)=>p+e[g]);u.set(c.get(...f),...d)}return o==="string"?Jk(u.values):u.values}function na(t){const{inputs:e,backend:n,attrs:s}=t,{x:o}=e,{begin:r,size:i}=s;De(o,"slice");const[a,l]=mp(o,r,i);qx(o,a,l);const c=n.data.get(o.dataId).values,u=MT(c,a,l,o.shape,o.dtype);return n.makeTensorInfo(l,o.dtype,u)}const q5={kernelName:sp,backendName:"cpu",kernelFunc:na};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BT(t,e,n,s,o,r,i){const a=e[0],l=r[0],c=new Array(l),u=new Array(a),h=e[1];if(l===0){if(a!==0)throw new Error(Vk(a));const b=An(n,0),x=An(o,0);return[b,[0,h],x,c,u]}let d=!0,f=0;const p=new Array(l).fill(0);for(let b=0;b<a;++b){const x=t[b*h];if(x<0)throw new Error(zk(b,x));if(x>=l)throw new Error(Wk(b,x,l));++p[x],d=d&&x>=f,f=x}let g=!0;for(let b=0;b<l;++b){const x=p[b]===0;c[b]=x,g=g&&!x,p[b]=Math.max(p[b],1),b>0&&(p[b]+=p[b-1])}if(g&&d){const b=t,x=s;for(let y=0;y<a;++y)u[y]=y;return[b,[a,h],x,c,u]}else{const b=p[l-1],x=An(n,b*h),y=An(o,b),w=new Array(l).fill(0);for(let v=0;v<a;++v){const $=t[v*h],_=w[$],E=($===0?0:p[$-1])+_;w[$]++;for(let k=0;k<h;++k)x[E*h+k]=t[v*h+k];y[E]=s[v],u[v]=E}for(let v=0;v<l;++v)if(w[v]===0){const _=v===0?0:p[v-1];x[_*h+0]=v;for(let E=1;E<h;++E)x[_*h+E]=0;y[_]=i}return[x,[b,h],y,c,u]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VT(t,e,n,s,o){const r=ae(s),i=e[0],a=o.length,l=[];let c=1,u=-1;for(let b=0;b<a;++b){const x=o[b];if(x===-1){if(u!==-1)throw new Error(Uk(u,b));u=b,l.push(1)}else{if(x<0)throw new Error(Hk(b,x));c*=x,l.push(x)}}if(u!==-1){if(c<=0)throw new Error(Gk());const b=Math.trunc(r/c);if(c*b!==r)throw new Error(jk(s,l));l[u]=b}if(ae(l)!==r)throw new Error(qk(s,l));const d=s.length,f=[];if(d>0){f[d-1]=1;for(let b=d-2;b>=0;--b)f[b]=f[b+1]*s[b+1]}const p=[];if(a>0){p[a-1]=1;for(let b=a-2;b>=0;--b)p[b]=p[b+1]*l[b+1]}const g=An(n,i*a);for(let b=0;b<i;++b){let x=0;for(let y=0;y<d;++y)x+=t[b*d+y]*f[y];for(let y=0;y<a;++y)g[b*a+y]=Math.trunc(x/p[y]),x%=p[y]}return[g,[i,a],l]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k0(t,e,n,s,o,r=!1,i=0){const a=s.length,l=[e[0],t.length/e[0]],c=l[1],h=a>0?o[a-1]+1:0;if(h<0)throw new Error(sb());const d=e.slice();d[0]=h;const f=d.reduce((w,v)=>w*v,1),p=An(n,f);if(a===0)return h>0&&p.fill(i),[p,d];if(h<=0)throw new Error(sb());let g=0,b=1,x=0,y=o[g];for(;;){let w=0;if(b<a){if(w=o[b],y===w){++b;continue}if(y>=w)throw new Error(Kk())}if(y<0||y>=h)throw new Error(Xk(y,h));y>x&&p.fill(i,x*c,y*c);for(let v=g;v<b;++v){const $=s[v];if($<0||$>=l[0])throw new Error(Yk(v,s[v],l[0]));for(let _=0;_<c;_++)p[y*c+_]+=t[$*c+_]}if(r)for(let v=0;v<c;v++)p[y*c+v]/=b-g;if(g=b,++b,x=y+1,y=w,b>a)break}return x<h&&p.fill(i,x*c,h*c),[p,d]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const K5=ti(t=>Math.sqrt(t)),X5=wt(Tu,t=>Math.sqrt(t)),Y5={kernelName:Tu,backendName:"cpu",kernelFunc:X5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zT=nn((t,e)=>{const n=t-e;return n*n}),Z5=vn(Nu,zT),Q5={kernelName:Nu,backendName:"cpu",kernelFunc:Z5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WT(t,e,n,s){const o=nt(t,e.dtype);for(let r=0;r<o.size;r++){const i=o.indexToLoc(r),a=new Array(i.length);for(let l=0;l<a.length;l++)a[l]=i[l]*n[l]+s[l];o.set(e.get(...a),...i)}return o}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class J5{constructor(e,n,s,o,r,i){this.separator=Or(e),this.nGramWidths=n,this.leftPad=Or(s),this.rightPad=Or(o),this.padWidth=r,this.preserveShort=i}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,n){const s=this.getPadWidth(n);return Math.max(0,e+2*s-n+1)}createNGrams(e,n,s,o,r,i){for(let a=0;a<r;++a){const l=this.getPadWidth(i),c=Math.max(0,l-a),u=Math.max(0,l-(r-(a+1))),h=i-(c+u),d=n+(c>0?0:a-l);let f=0;f+=c*this.leftPad.length;for(let y=0;y<h;++y)f+=e[d+y].length;f+=u*this.rightPad.length,f+=(c+u+h-1)*this.separator.length,s[o+a]=new Uint8Array(f);const g=s[o+a];let b=0;const x=y=>y.forEach(w=>g[b++]=w);for(let y=0;y<c;++y)x(this.leftPad),x(this.separator);for(let y=0;y<h-1;++y)x(e[d+y]),x(this.separator);if(h>0){x(e[d+h-1]);for(let y=0;y<u;++y)x(this.separator),x(this.rightPad)}else{for(let y=0;y<u-1;++y)x(this.rightPad),x(this.separator);x(this.rightPad)}}}compute(e,n){const s=e.length,o=n.length;if(o>0){let l=n[0];if(l!==0)throw new Error(`First split value must be 0, got ${l}`);for(let c=1;c<o;++c){let u=n[c]>=l;if(u=u&&n[c]<=s,!u)throw new Error(`Invalid split value ${n[c]}, must be in [${l}, ${s}]`);l=n[c]}if(l!==s)throw new Error(`Last split value must be data size. Expected ${s}, got ${l}`)}const r=o-1,i=An("int32",o);if(s===0||o===0){const l=new Array(s);for(let c=0;c<=r;++c)i[c]=0;return[l,i]}i[0]=0;for(let l=1;l<=r;++l){const c=n[l]-n[l-1];let u=0;this.nGramWidths.forEach(h=>{u+=this.getNumNGrams(c,h)}),this.preserveShort&&c>0&&u===0&&(u=1),i[l]=i[l-1]+u}const a=new Array(i[r]);for(let l=0;l<r;++l){const c=n[l];let u=i[l];if(this.nGramWidths.forEach(h=>{const d=n[l+1]-n[l],f=this.getNumNGrams(d,h);this.createNGrams(e,c,a,u,f,h),u+=f}),this.preserveShort&&u===i[l]){const h=n[l+1]-n[l];if(h===0)continue;const d=h+2*this.padWidth,f=1;this.createNGrams(e,c,a,u,f,d)}}return[a,i]}}function UT(t,e,n,s,o,r,i,a){return new J5(n,s,o,r,i,a).compute(t,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e8(t,e,n,s){if(!t.length)return;if(e.length===0){for(let r=0;r<t.length;++r)s.push(t.subarray(r,r+1));return}if(e.length===1){const r=e[0];let i=t.indexOf(r);for(;i!==-1;){const a=t.subarray(0,i);(!n||a.length!==0)&&s.push(a),t=t.subarray(i+1),i=t.indexOf(r)}(!n||t.length!==0)&&s.push(t);return}let o=0;for(let r=0;r<t.length+1;r++)if(r===t.length||e.indexOf(t[r])!==-1){const i=t.subarray(o,r);(!n||i.length!==0)&&s.push(i),o=r+1}}function HT(t,e,n){const s=t.length,o=[];let r=0,i=0;const a=new Array(s);for(let d=0;d<s;++d){const f=o.length;e8(t[d],e,n,o);const p=o.length-f;a[d]=p,r+=p,i=Math.max(i,p)}const l=An("int32",r*2),c=new Array(r),u=[s,i];let h=0;for(let d=0;d<s;++d)for(let f=0;f<a[d];++f)l[h*2]=d,l[h*2+1]=f,c[h]=o[h],++h;return[l,c,u]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GT(t,e){const n=An("int32",t.length);for(let s=0;s<t.length;++s)n[s]=Ez(t[s]).modulo(e).getLowBitsUnsigned();return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jT=nn((t,e)=>t-e),t8=C0((t,e,n,s)=>({real:t-n,imag:e-s})),E0=vn(Au,jT,t8),n8={kernelName:Au,backendName:"cpu",kernelFunc:E0};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qT(t,e){const n=new Array(t.rank);for(let o=0;o<n.length;o++)n[o]=t.shape[o]*e[o];const s=nt(n,t.dtype);for(let o=0;o<s.values.length;++o){const r=s.indexToLoc(o),i=new Array(t.rank);for(let l=0;l<i.length;l++)i[l]=r[l]%t.shape[l];const a=t.locToIndex(i);s.values[o]=t.values[a]}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rc=(t,e)=>{const n=e.value-t.value;return n===0?t.index-e.index:n};function KT(t,e,n=0,s=t.length-1){for(;s>n;){if(s-n>600){const a=s-n+1,l=e-n+1,c=Math.log(a),u=.5*Math.exp(2*c/3),h=.5*Math.sqrt(c*u*(a-u)/a)*Math.sign(l-a/2),d=Math.max(n,Math.floor(e-l*u/a+h)),f=Math.min(s,Math.floor(e+(a-l)*u/a+h));KT(t,e,d,f)}const o=t[e];let r=n,i=s;for(Oa(t,n,e),rc(t[s],o)>0&&Oa(t,n,s);r<i;){for(Oa(t,r,i),r++,i--;rc(t[r],o)<0;)r=r+1;for(;rc(t[i],o)>0;)i=i-1}rc(t[n],o)===0?Oa(t,n,i):(i=i+1,Oa(t,i,s)),i<=e&&(n=i+1),e<=i&&(s=i-1)}}function XT(t,e,n,s,o){const r=e[e.length-1],[i,a]=[t.length/r,r],l=$n(n,i*s),c=$n("int32",i*s);for(let h=0;h<i;h++){const d=h*a,f=t.subarray(d,d+a);let p=new Array(f.length);f.forEach((y,w)=>p[w]={value:y,index:w}),s<p.length&&(KT(p,s),p=p.slice(0,s)),o&&p.sort(rc);const g=h*s,b=l.subarray(g,g+s),x=c.subarray(g,g+s);for(let y=0;y<s;y++)b[y]=p[y].value,x[y]=p[y].index}const u=e.slice();return u[u.length-1]=s,[nt(u,n,l),nt(u,"int32",c)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YT(t,e,n,s){const o=st(e,n)[0],r=[1,n[0],1];for(let p=0;p<o;p++)r[0]*=n[p];r[1]=n[o];for(let p=o+1;p<n.length;p++)r[2]*=n[p];const i={},a=new Int32Array(n[o]),l=new Rn(r,s,t),c=[],u=r[0]===1&&r[2]===1;for(let p=0;p<n[o];p++){let g;if(u)g=t[p].toString();else{const b=[];for(let x=0;x<r[0];x++)for(let y=0;y<r[2];y++)b.push(l.get(x,p,y));g=b.join(",")}if(i[g]!==void 0)a[p]=i[g];else{const b=Object.keys(i).length;i[g]=b,a[p]=b,c.push(p)}}const h=r.slice();h[1]=Object.keys(i).length;const d=new Rn(h,s);c.forEach((p,g)=>{for(let b=0;b<r[0];b++)for(let x=0;x<r[2];x++)d.set(l.get(b,p,x),b,g,x)});const f=n.slice();return f[o]=h[1],{outputValues:d.values,outputShape:f,indices:a}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s8=Object.freeze(Object.defineProperty({__proto__:null,simpleAbsImpl:lT,addImpl:uT,bincountImpl:$0,bincountReduceImpl:hT,castImpl:cT,ceilImpl:dT,concatImpl:fT,equalImpl:pT,expImpl:gT,expm1Impl:xT,floorImpl:yT,gatherNdImpl:vT,gatherV2Impl:wT,greaterImpl:CT,greaterEqualImpl:$T,lessImpl:IT,lessEqualImpl:_T,linSpaceImpl:kT,logImpl:ET,maxImpl:ST,maximumImpl:TT,minimumImpl:NT,multiplyImpl:I0,negImpl:AT,notEqualImpl:RT,prodImpl:DT,raggedTensorToTensorImpl:OT,rangeImpl:FT,rsqrtImpl:LT,scatterImpl:Ba,sigmoidImpl:G5,sliceImpl:MT,sparseFillEmptyRowsImpl:BT,sparseReshapeImpl:VT,sparseSegmentReductionImpl:k0,sqrtImpl:K5,squaredDifferenceImpl:zT,stridedSliceImpl:WT,stringNGramsImpl:UT,stringSplitImpl:HT,stringToHashBucketFastImpl:GT,subImpl:jT,tileImpl:qT,topKImpl:XT,transposeImpl:_0,uniqueImpl:YT},Symbol.toStringTag,{value:"Module"}));/** @license See the LICENSE file. *//**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */O_("cpu",()=>new Mp,1);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZT=wt(eu,t=>t>=0?t:Math.exp(t)-1),o8={kernelName:eu,backendName:"cpu",kernelFunc:ZT};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QT(t){const{inputs:e,backend:n,attrs:s}=t,{x:o}=e,{alpha:r}=s;De([o],"leakyRelu");const i=ae(o.shape),a=n.data.get(o.dataId).values,l=$n("float32",i);for(let c=0;c<a.length;c++)l[c]=a[c]<0?r*a[c]:a[c];return n.makeTensorInfo(o.shape,"float32",l)}const r8={kernelName:Af,backendName:"cpu",kernelFunc:QT};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i8=nn((t,e)=>t<0?e*t:t);function JT(t){const{inputs:e,backend:n}=t,{x:s,alpha:o}=e;De([s,o],"prelu");const r=n.data.get(s.dataId).values,i=n.data.get(o.dataId).values,[a,l]=i8(s.shape,o.shape,r,i,"float32");return n.makeTensorInfo(l,"float32",a)}const a8={kernelName:Yf,backendName:"cpu",kernelFunc:JT};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eN=wt(yu,t=>Math.max(0,t)),l8={kernelName:yu,backendName:"cpu",kernelFunc:eN};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tN=wt(vu,t=>Math.min(Math.max(0,t),6)),c8={kernelName:vu,backendName:"cpu",kernelFunc:tN};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bd(t,e,n,s,o){if(n==="linear")return Go({inputs:{x:e},backend:t});if(n==="relu")return eN({inputs:{x:e},backend:t});if(n==="elu")return ZT({inputs:{x:e},backend:t});if(n==="relu6")return tN({inputs:{x:e},backend:t});if(n==="prelu")return JT({inputs:{x:e,alpha:s},backend:t});if(n==="leakyrelu")return QT({inputs:{x:e},backend:t,attrs:{alpha:o}});if(n==="sigmoid")return PT({inputs:{x:e},backend:t});throw new Error(`Activation ${n} has not been implemented for the CPU backend.`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rt(t){const{inputs:e,backend:n,attrs:s}=t,{x:o}=e,{shape:r}=s,i=ae(o.shape),a=VI(r,i),l=ae(a);T(i===l,()=>`The new shape (${a}) has ${l} elements and the old shape (${o.shape}) has ${i} elements. The new shape and old shape must have the same number of elements.`),n.incRef(o.dataId);const c=n.data.get(o.dataId);if(c.complexTensorInfos!=null){const u=c.complexTensorInfos.real,h=c.complexTensorInfos.imag;u.shape=a,h.shape=a}return{dataId:o.dataId,shape:a,dtype:o.dtype}}const u8={kernelName:Qf,backendName:"cpu",kernelFunc:Rt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nN(t){const{inputs:e,backend:n,attrs:s}=t,{a:o,b:r}=e,{transposeA:i,transposeB:a}=s;De([o,r],"matMul");const l=o.shape.length,c=r.shape.length,u=i?o.shape[l-2]:o.shape[l-1],h=a?r.shape[c-1]:r.shape[c-2],d=i?o.shape[l-1]:o.shape[l-2],f=a?r.shape[c-2]:r.shape[c-1],p=o.shape.slice(0,-2),g=r.shape.slice(0,-2),b=ae(p),x=ae(g),w=Ye(o.shape.slice(0,-2),r.shape.slice(0,-2)).concat([d,f]);T(u===h,()=>`Error in matMul: inner shapes (${u}) and (${h}) of Tensors with shapes ${o.shape} and ${r.shape} and transposeA=${i} and transposeB=${a} must match.`);const v=i?[b,u,d]:[b,d,u],$=a?[x,f,h]:[x,h,f],_=Rt({inputs:{x:o},backend:n,attrs:{shape:v}}),E=Rt({inputs:{x:r},backend:n,attrs:{shape:$}}),k=i?_.shape[1]:_.shape[2],N=i?_.shape[2]:_.shape[1],A=a?E.shape[1]:E.shape[2],F=Math.max(b,x),L=n.data.get(_.dataId).values,H=n.data.get(E.dataId).values,M=Ue(_.shape),K=Ue(E.shape),[q,Q,Y]=i?[M[0],1,M[1]]:[M[0],M[1],1],[ie,pe,he]=a?[1,K[1],K[0]]:[K[1],1,K[0]],xe=N*A,me=nt([F,N,A],_.dtype),Ie=me.values,G=n.blockSize;for(let le=0;le<F;le++)for(let ne=0;ne<N;ne+=G)for(let B=0;B<A;B+=G)for(let $e=0;$e<k;$e+=G){const Se=Math.min(ne+G,N),ke=Math.min(B+G,A),Ne=Math.min($e+G,k);for(let D=ne;D<Se;D++)for(let P=B;P<ke;P++){let X=0;for(let ce=$e;ce<Ne;ce++){const re=Math.min(le,b-1)*q,de=Math.min(le,x-1)*he,_e=L[re+D*Q+ce*Y],be=H[ce*ie+P*pe+de];X+=_e*be}Ie[le*xe+(D*A+P)]+=X}}return n.disposeIntermediateTensorInfo(_),n.disposeIntermediateTensorInfo(E),n.makeTensorInfo(w,me.dtype,me.values)}const h8={kernelName:gf,backendName:"cpu",kernelFunc:nN};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d8(t){const{inputs:e,backend:n,attrs:s}=t,{a:o,b:r,bias:i,preluActivationWeights:a}=e,{transposeA:l,transposeB:c,activation:u,leakyreluAlpha:h}=s;let d,f,p;const g=[];d=nN({inputs:{a:o,b:r},attrs:{transposeA:l,transposeB:c},backend:n}),i&&(f=hl({inputs:{a:d,b:i},backend:n}),g.push(d),d=f),u&&(p=Bd(n,d,u,a,h),g.push(d),d=p);for(const x of g)n.disposeIntermediateTensorInfo(x);return d}const f8={kernelName:bd,backendName:"cpu",kernelFunc:d8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const p8=wt(zc,t=>Math.acos(t)),m8={kernelName:zc,backendName:"cpu",kernelFunc:p8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g8=wt(Wc,t=>Math.acosh(t)),b8={kernelName:Wc,backendName:"cpu",kernelFunc:g8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x8(t){const{inputs:e,backend:n}=t,s=e;De(e,"addN");const o=s.map(a=>n.data.get(a.dataId).values),r=nt(s[0].shape,s[0].dtype),i=r.values;for(let a=0;a<s.length;a++){const l=o[a];for(let c=0;c<i.length;c++)i[c]+=l[c]}return n.makeTensorInfo(r.shape,r.dtype,r.values)}const y8={kernelName:Zb,backendName:"cpu",kernelFunc:x8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v8(t){const{inputs:e,backend:n,attrs:s}=t,{x:o}=e,{axis:r,keepDims:i}=s;De(o,"all");const a=st(r,o.shape);let l=a;const c=jt(l,o.shape.length);let u=o;c!=null&&(u=os({inputs:{x:o},backend:n,attrs:{perm:c}}),l=Zt(l.length,o.shape.length)),_n("all",l,u.shape.length);const[h,d]=yn(u.shape,l),f=ae(d),p=Ln(ae(h),u.dtype),g=n.data.get(u.dataId).values;for(let x=0;x<p.length;++x){const y=x*f;let w=g[y];for(let v=0;v<f;++v){const $=g[y+v];w=w&&$}p[x]=w}c!=null&&n.disposeIntermediateTensorInfo(u);const b=n.makeTensorInfo(h,u.dtype,p);if(i){const x=Yt(h,a),y=Rt({inputs:{x:b},backend:n,attrs:{shape:x}});return n.disposeIntermediateTensorInfo(b),y}return b}const w8={kernelName:Qb,backendName:"cpu",kernelFunc:v8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C8(t){const{inputs:e,backend:n,attrs:s}=t,{x:o}=e,{axis:r,keepDims:i}=s;De(o,"any");const a=st(r,o.shape);let l=a;const c=jt(l,o.shape.length);let u=o;c!=null&&(u=os({inputs:{x:o},backend:n,attrs:{perm:c}}),l=Zt(l.length,o.shape.length)),_n("any",l,u.shape.length);const[h,d]=yn(u.shape,l),f=ae(d),p=Ln(ae(h),u.dtype),g=n.data.get(u.dataId).values;for(let x=0;x<p.length;++x){const y=x*f;let w=g[y];for(let v=0;v<f;++v){const $=g[y+v];w=w||$}p[x]=w}c!=null&&n.disposeIntermediateTensorInfo(u);const b=n.makeTensorInfo(h,u.dtype,p);if(i){const x=Yt(h,a),y=Rt({inputs:{x:b},backend:n,attrs:{shape:x}});return n.disposeIntermediateTensorInfo(b),y}return b}const $8={kernelName:Jb,backendName:"cpu",kernelFunc:C8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I8(t){const{inputs:e,backend:n,attrs:s}=t,{x:o}=e,{axis:r}=s;De(o,"argMax");let i=st(r,o.shape);const a=jt(i,o.shape.length);let l=o;const c=[];a!=null&&(l=os({inputs:{x:o},backend:n,attrs:{perm:a}}),c.push(l),i=Zt(i.length,l.shape.length)),i=[i[0]],_n("argMax",i,l.shape.length);const[u,h]=yn(l.shape,i),d=ae(u),f=Ln(d,"int32"),p=ae(h),g=n.data.get(l.dataId).values;for(let b=0;b<f.length;++b){const x=b*p;let y=g[x],w=0;for(let v=0;v<p;++v){const $=g[x+v];$>y&&(y=$,w=v)}f[b]=w}return c.forEach(b=>n.disposeIntermediateTensorInfo(b)),n.makeTensorInfo(u,"int32",f)}const _8={kernelName:df,backendName:"cpu",kernelFunc:I8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k8(t){const{inputs:e,backend:n,attrs:s}=t,{x:o}=e,{axis:r}=s;De(o,"argMin");let i=st(r,o.shape);const a=jt(i,o.shape.length);let l=o;const c=[];a!=null&&(l=os({inputs:{x:o},backend:n,attrs:{perm:a}}),c.push(l),i=Zt(i.length,l.shape.length)),i=[i[0]],_n("argMin",i,l.shape.length);const[u,h]=yn(l.shape,i),d=ae(u),f=Ln(d,"int32"),p=ae(h),g=n.data.get(l.dataId).values;for(let b=0;b<f.length;++b){const x=b*p;let y=g[x],w=0;for(let v=0;v<p;++v){const $=g[x+v];$<y&&(y=$,w=v)}f[b]=w}return c.forEach(b=>n.disposeIntermediateTensorInfo(b)),n.makeTensorInfo(u,"int32",f)}const E8={kernelName:ff,backendName:"cpu",kernelFunc:k8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const S8=wt(Uc,t=>Math.asin(t)),T8={kernelName:Uc,backendName:"cpu",kernelFunc:S8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N8=wt(Hc,t=>Math.asinh(t)),A8={kernelName:Hc,backendName:"cpu",kernelFunc:N8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const R8=wt(Gc,t=>Math.atan(t)),D8={kernelName:Gc,backendName:"cpu",kernelFunc:R8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O8=nn((t,e)=>Math.atan2(t,e)),F8=vn(qc,O8),L8={kernelName:qc,backendName:"cpu",kernelFunc:F8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const P8=wt(jc,t=>Math.atanh(t)),M8={kernelName:jc,backendName:"cpu",kernelFunc:P8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S0(t,e,n,s,o,r){const i=o.strideHeight,a=o.strideWidth,l=o.dilationHeight,c=o.dilationWidth,u=o.effectiveFilterHeight,h=o.effectiveFilterWidth,d=o.padInfo.top,f=o.padInfo.left,p=r==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,g=nt(o.outShape,n),b=g.values,x=o.outShape[1]*o.outShape[2]*o.outShape[3],y=o.outShape[2]*o.outShape[3],w=o.outShape[3];for(let v=0;v<o.batchSize;++v){const $=v*x,_=v*s[0];for(let E=0;E<o.inChannels;++E)for(let k=0;k<o.outHeight;++k){const N=k*i-d,A=Math.max(0,N),F=Math.min(o.inHeight,u+N),L=$+k*y;for(let H=0;H<o.outWidth;++H){const M=H*a-f,K=Math.max(0,M),q=Math.min(o.inWidth,h+M);let Q=p,Y=0,ie=0;for(let he=A;he<F;he+=l){const xe=_+he*s[1];for(let me=K;me<q;me+=c){const Ie=xe+me*s[2],G=t[Ie+E];r==="max"&&G>Q?Q=G:r==="avg"&&(Y+=G,ie++)}if(isNaN(Q))break}const pe=L+H*w+E;b[pe]=r==="avg"?Y/ie:Q}}}return g}function sN(t,e,n,s,o=!1,r=!1){const i=nt(s.outShape,"int32"),a=s.strideHeight,l=s.strideWidth,c=s.dilationHeight,u=s.dilationWidth,h=s.effectiveFilterHeight,d=s.effectiveFilterWidth,f=s.padInfo.top,p=s.padInfo.left,g=nt(e,n,t);for(let b=0;b<s.batchSize;++b)for(let x=0;x<s.inChannels;++x)for(let y=0;y<s.outHeight;++y){const w=y*a-f;let v=w;for(;v<0;)v+=c;const $=Math.min(s.inHeight,h+w);for(let _=0;_<s.outWidth;++_){const E=_*l-p;let k=E;for(;k<0;)k+=u;const N=Math.min(s.inWidth,d+E);let A=Number.NEGATIVE_INFINITY,F=-1;for(let L=v;L<$;L+=c){const H=L-w;for(let M=k;M<N;M+=u){const K=M-E,q=g.get(b,L,M,x);q>A&&(A=q,o?F=r?((b*s.inHeight+L)*s.inWidth+M)*s.inChannels+x:(L*s.inWidth+M)*s.inChannels+x:F=H*d+K)}}i.set(F,b,y,_,x)}}return i}function oN(t,e,n,s,o,r){const i=o.strideDepth,a=o.strideHeight,l=o.strideWidth,c=o.dilationDepth,u=o.dilationHeight,h=o.dilationWidth,d=o.effectiveFilterDepth,f=o.effectiveFilterHeight,p=o.effectiveFilterWidth,g=o.padInfo.front,b=o.padInfo.top,x=o.padInfo.left,y=r==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,w=nt(o.outShape,n),v=w.values,$=o.outShape[1]*o.outShape[2]*o.outShape[3]*o.outShape[4],_=o.outShape[2]*o.outShape[3]*o.outShape[4],E=o.outShape[3]*o.outShape[4],k=o.outShape[4];for(let N=0;N<o.batchSize;++N){const A=N*$,F=N*s[0];for(let L=0;L<o.inChannels;++L)for(let H=0;H<o.outDepth;++H){const M=H*i-g;let K=M;for(;K<0;)K+=c;const q=Math.min(o.inDepth,d+M),Q=A+H*_;for(let Y=0;Y<o.outHeight;++Y){const ie=Y*a-b;let pe=ie;for(;pe<0;)pe+=u;const he=Math.min(o.inHeight,f+ie),xe=Q+Y*E;for(let me=0;me<o.outWidth;++me){const Ie=me*l-x;let G=Ie;for(;G<0;)G+=h;const le=Math.min(o.inWidth,p+Ie),ne=xe+me*k;let B=y,$e=0,Se=0;for(let Ne=K;Ne<q;Ne+=c){const D=F+Ne*s[1];for(let P=pe;P<he;P+=u){const X=D+P*s[2];for(let ce=G;ce<le;ce+=h){const re=X+ce*s[3],de=t[re+L];if(r==="max"&&de>B?B=de:r==="avg"&&($e+=de,Se++),isNaN(B))break}if(isNaN(B))break}if(isNaN(B))break}const ke=ne+L;v[ke]=r==="avg"?$e/Se:B}}}}return w}function B8(t,e){const n=nt(e.outShape,"int32"),s=e.strideDepth,o=e.strideHeight,r=e.strideWidth,i=e.dilationDepth,a=e.dilationHeight,l=e.dilationWidth,c=e.effectiveFilterDepth,u=e.effectiveFilterHeight,h=e.effectiveFilterWidth,d=e.padInfo.front,f=e.padInfo.top,p=e.padInfo.left;for(let g=0;g<e.batchSize;++g)for(let b=0;b<e.inChannels;++b)for(let x=0;x<e.outDepth;++x){const y=x*s-d;let w=y;for(;w<0;)w+=i;const v=Math.min(e.inDepth,c+y);for(let $=0;$<e.outHeight;++$){const _=$*o-f;let E=_;for(;E<0;)E+=a;const k=Math.min(e.inHeight,u+_);for(let N=0;N<e.outWidth;++N){const A=N*r-p;let F=A;for(;F<0;)F+=l;const L=Math.min(e.inWidth,h+A);let H=Number.NEGATIVE_INFINITY,M=-1;for(let K=w;K<v;K+=i){const q=K-y;for(let Q=E;Q<k;Q+=a){const Y=Q-_;for(let ie=F;ie<L;ie+=l){const pe=ie-A,he=t.get(g,K,Q,ie,b);he>=H&&(H=he,M=q*u*h+Y*u+pe)}}}n.set(M,g,x,$,N,b)}}}return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V8(t){const{inputs:e,backend:n,attrs:s}=t,{x:o}=e;De(o,"avgPool");const{filterSize:r,strides:i,pad:a,dimRoundingMode:l}=s,c=1;T(Pn(i,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);const u=Zs(o.shape,r,i,c,a,l);let h;if(u.filterWidth===1&&u.filterHeight===1&&bt(u.inShape,u.outShape))h=Go({inputs:{x:o},backend:n});else{const d=n.data.get(o.dataId).values,f=Ue(o.shape),p=S0(d,o.shape,o.dtype,f,u,"avg");h=n.makeTensorInfo(u.outShape,o.dtype,p.values)}return h}const z8={kernelName:pf,backendName:"cpu",kernelFunc:V8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W8(t){const{inputs:e,backend:n,attrs:s}=t,{x:o}=e,{filterSize:r,strides:i,pad:a,dimRoundingMode:l,dataFormat:c}=s;De(o,"avgPool3d");const u=ur(o.shape,r,i,1,a,l,c),h=n.data.get(o.dataId).values,d=oN(h,o.shape,o.dtype,Ue(o.shape),u,"avg");return n.makeTensorInfo(d.shape,"float32",d.values)}const U8={kernelName:mf,backendName:"cpu",kernelFunc:W8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H8(t){const{inputs:e,backend:n,attrs:s}=t,{dy:o,input:r}=e,{filterSize:i,strides:a,pad:l,dimRoundingMode:c}=s;De([o,r],"avgPool3DGrad");const u=ur(r.shape,i,a,1,l,c),h=u.strideDepth,d=u.strideHeight,f=u.strideWidth,p=u.filterDepth,g=u.filterHeight,b=u.filterWidth,x=u.dilationDepth,y=u.dilationHeight,w=u.dilationWidth,v=u.effectiveFilterDepth,$=u.effectiveFilterHeight,_=u.effectiveFilterWidth,E=v-1-u.padInfo.front,k=_-1-u.padInfo.left,N=$-1-u.padInfo.top,A=nt(r.shape,"float32"),F=1/(p*g*b),L=n.bufferSync(o);for(let H=0;H<u.batchSize;++H)for(let M=0;M<u.inChannels;++M)for(let K=0;K<u.inDepth;++K)for(let q=0;q<u.inHeight;++q)for(let Q=0;Q<u.inWidth;++Q){const Y=K-E,ie=q-N,pe=Q-k;let he=0;for(let xe=0;xe<v;xe+=x){const me=(Y+xe)/h;if(!(me<0||me>=u.outDepth||Math.floor(me)!==me))for(let Ie=0;Ie<$;Ie+=y){const G=(ie+Ie)/d;if(!(G<0||G>=u.outHeight||Math.floor(G)!==G))for(let le=0;le<_;le+=w){const ne=(pe+le)/f;if(ne<0||ne>=u.outWidth||Math.floor(ne)!==ne)continue;he+=L.get(H,me,G,ne,M)}}}A.set(he*F,H,K,q,Q,M)}return n.makeTensorInfo(A.shape,A.dtype,A.values)}const G8={kernelName:tx,backendName:"cpu",kernelFunc:H8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j8(t){const{inputs:e,backend:n,attrs:s}=t,{dy:o,input:r}=e,i=r;De([o,r],"avgPoolGrad");const{filterSize:a,strides:l,pad:c}=s,u=Zs(i.shape,a,l,1,c),h=u.strideHeight,d=u.strideWidth,f=u.filterHeight,p=u.filterWidth,g=u.dilationHeight,b=u.dilationWidth,x=u.effectiveFilterHeight,y=u.effectiveFilterWidth,w=y-1-u.padInfo.left,v=x-1-u.padInfo.top,$=nt(i.shape,"float32"),_=1/(f*p),E=n.data.get(o.dataId).values,k=nt(o.shape,"float32",E);for(let N=0;N<u.batchSize;++N)for(let A=0;A<u.inChannels;++A)for(let F=0;F<u.inHeight;++F)for(let L=0;L<u.inWidth;++L){const H=F-v,M=L-w;let K=0;for(let q=0;q<x;q+=g){const Q=(H+q)/h;if(!(Q<0||Q>=u.outHeight||Math.floor(Q)!==Q))for(let Y=0;Y<y;Y+=b){const ie=(M+Y)/d;if(ie<0||ie>=u.outWidth||Math.floor(ie)!==ie)continue;K+=k.get(N,Q,ie,A)}}$.set(K*_,N,F,L,A)}return n.makeTensorInfo($.shape,$.dtype,$.values)}const q8={kernelName:ex,backendName:"cpu",kernelFunc:j8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K8(t){const{inputs:e,backend:n,attrs:s}=t,{x:o,scale:r,offset:i,mean:a,variance:l}=e;T(a.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),T(i==null||a.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),T(r==null||a.shape.length===r.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),De([o,a,l,r,i],"batchNorm");let{varianceEpsilon:c}=s;c==null&&(c=.001);const u=n.data.get(o.dataId).values,h=n.data.get(a.dataId).values,d=n.data.get(l.dataId).values,f=r?n.data.get(r.dataId).values:new Float32Array([1]),p=i?n.data.get(i.dataId).values:new Float32Array([0]),g=new Float32Array(u.length),b=p.length,x=f.length,y=d.length,w=h.length;let v=0,$=0,_=0,E=0;for(let k=0;k<u.length;++k)g[k]=p[v++]+(u[k]-h[$++])*f[_++]/Math.sqrt(d[E++]+c),v>=b&&(v=0),$>=w&&($=0),_>=x&&(_=0),E>=y&&(E=0);return n.makeTensorInfo(o.shape,o.dtype,g)}const X8={kernelName:Sf,backendName:"cpu",kernelFunc:K8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y8(t){const{inputs:e,backend:n,attrs:s}=t,{x:o}=e,{blockShape:r,crops:i}=s;De([o],"batchToSpaceND");const a=r.reduce((x,y)=>x*y),l=zu(o.shape,r,a),c=Wu(l.length,r.length),u=Uu(o.shape,r,a),h=Py(i,r.length),d=My(u,i,r.length),f=Rt({inputs:{x:o},backend:n,attrs:{shape:l}}),p=os({inputs:{x:f},backend:n,attrs:{perm:c}}),g=Rt({inputs:{x:p},backend:n,attrs:{shape:u}}),b=na({inputs:{x:g},backend:n,attrs:{begin:h,size:d}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),b}const Z8={kernelName:bf,backendName:"cpu",kernelFunc:Y8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q8(t){const{inputs:e,backend:n,attrs:s}=t,{x:o,weights:r}=e,{size:i}=s,a=n.data.get(o.dataId).values,l=n.data.get(r.dataId).values,c=$0(a,l,r.dtype,r.shape,i);return n.makeTensorInfo([i],r.dtype,c)}const J8={kernelName:nx,backendName:"cpu",kernelFunc:Q8};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eY(t){const{inputs:e,backend:n}=t,{s0:s,s1:o}=e,r=n.data.get(s.dataId).values,i=n.data.get(o.dataId).values,a=Ye(Array.from(r),Array.from(i));return n.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const tY={kernelName:KI,backendName:"cpu",kernelFunc:eY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nY=wt(Yc,(t,e)=>{const n=e;return t>n.clipValueMax?n.clipValueMax:t<n.clipValueMin?n.clipValueMin:t}),sY={kernelName:Yc,backendName:"cpu",kernelFunc:nY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oY=t=>{const{x:e}=t.inputs,n=t.backend,s=new Float32Array(ae(e.shape)),o=n.data.get(e.dataId),r=o.complexTensorInfos.real,i=o.complexTensorInfos.imag,a=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values;for(let c=0;c<a.length;c++){const u=a[c],h=l[c];s[c]=Math.hypot(u,h)}return n.makeOutput(s,e.shape,"float32")},rY={kernelName:xf,backendName:"cpu",kernelFunc:oY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dl(t){const{inputs:e,backend:n}=t,{input:s}=e,o=n.data.get(s.dataId).complexTensorInfos.imag,r=n.data.get(o.dataId).values;return n.makeTensorInfo(o.shape,o.dtype,r)}const iY={kernelName:bx,backendName:"cpu",kernelFunc:dl};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fl(t){const{inputs:e,backend:n,attrs:s}=t,{axis:o}=s,r=st(o,e[0].shape)[0];let i=Po(e.map(g=>g.shape),r);if(ae(i)===0)return n.makeTensorInfo(i,e[0].dtype,[]);const a=e.filter(g=>ae(g.shape)>0);if(a.length===1)return Go({inputs:{x:a[0]},backend:n});const l=a.map(g=>g.shape);if(Oy(l,r),a[0].dtype==="complex64"){const g=a.map(v=>ta({inputs:{input:v},backend:n})),b=a.map(v=>dl({inputs:{input:v},backend:n})),x=fl({inputs:g,backend:n,attrs:{axis:r}}),y=fl({inputs:b,backend:n,attrs:{axis:r}}),w=cs({inputs:{real:x,imag:y},backend:n});return g.forEach(v=>n.disposeIntermediateTensorInfo(v)),b.forEach(v=>n.disposeIntermediateTensorInfo(v)),n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(y),w}const c=a.map(g=>{const b=ae(g.shape.slice(r));return Rt({inputs:{x:g},backend:n,attrs:{shape:[-1,b]}})}),u=c.map(g=>({vals:n.data.get(g.dataId).values,shape:g.shape}));i=Po(c.map(g=>g.shape),1);const h=c[0].shape[0]===1,d=fT(u,i,e[0].dtype,h),f=Po(a.map(g=>g.shape),r),p=n.makeTensorInfo(f,e[0].dtype,d);return c.forEach(g=>n.disposeIntermediateTensorInfo(g)),p}const aY={kernelName:yf,backendName:"cpu",kernelFunc:fl};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rN(t){const{inputs:e,backend:n,attrs:s}=t,{x:o,filter:r}=e,{strides:i,pad:a,dataFormat:l,dilations:c,dimRoundingMode:u}=s;De([o,r],"conv2d");const h=hr(l),d=In(o.shape,r.shape,i,c,a,u,!1,h),f=d.filterHeight,p=d.filterWidth,g=d.dilationHeight,b=d.dilationWidth,x=d.padInfo.left,y=d.padInfo.top,w=d.dataFormat==="channelsLast",v=new Rn(d.outShape,o.dtype),$=Ue(o.shape),_=Ue(r.shape),E=$[0],k=w?$[1]:$[2],N=w?$[2]:1,A=w?1:$[1],F=v.strides[0],L=w?v.strides[1]:v.strides[2],H=w?v.strides[2]:1,M=w?1:v.strides[1],K=n.data.get(o.dataId).values,q=n.data.get(r.dataId).values,Q=v.values;for(let Y=0;Y<d.batchSize;++Y){const ie=Y*E,pe=Y*F;for(let he=0;he<d.outHeight;++he){const xe=pe+he*L,me=he*d.strideHeight-y;for(let Ie=0;Ie<f;++Ie){const G=me+Ie*g;if(G<0||G>=d.inHeight)continue;const le=Ie*_[0],ne=ie+G*k;for(let B=0;B<d.outWidth;++B){const $e=xe+B*H,Se=B*d.strideWidth-x;for(let ke=0;ke<p;++ke){const Ne=Se+ke*b;if(Ne<0||Ne>=d.inWidth)continue;const D=le+ke*_[1],P=ne+Ne*N;let X=D;for(let ce=0;ce<d.inChannels;++ce){const re=K[P+ce*A];for(let de=0;de<d.outChannels;++de)Q[$e+de*M]+=re*q[X+de];X+=d.outChannels}}}}}}return n.makeTensorInfo(v.shape,v.dtype,Q)}const lY={kernelName:vf,backendName:"cpu",kernelFunc:rN};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cY(t){const{inputs:e,backend:n,attrs:s}=t,{x:o,dy:r}=e,{strides:i,pad:a,dataFormat:l,dimRoundingMode:c,filterShape:u}=s;De([o,r],"conv2dBackpropFilter");const h=hr(l),d=In(o.shape,u,i,1,a,c,!1,h),{strideHeight:f,strideWidth:p,filterHeight:g,filterWidth:b}=d,x=d.dataFormat==="channelsLast",y=new Rn(d.filterShape,"float32"),w=d.padInfo.left,v=d.padInfo.top,$=n.data.get(o.dataId).values,_=n.data.get(r.dataId).values,E=new Rn(o.shape,o.dtype,$),k=new Rn(r.shape,r.dtype,_);for(let N=0;N<g;++N){const A=Math.max(0,Math.ceil((v-N)/f)),F=Math.min(d.outHeight,(d.inHeight+v-N)/f);for(let L=0;L<b;++L){const H=Math.max(0,Math.ceil((w-L)/p)),M=Math.min(d.outWidth,(d.inWidth+w-L)/p);for(let K=0;K<d.inChannels;++K)for(let q=0;q<d.outChannels;++q){let Q=0;for(let Y=0;Y<d.batchSize;++Y)for(let ie=A;ie<F;++ie){const pe=N+ie*f-v;for(let he=H;he<M;++he){const xe=L+he*p-w;x?Q+=E.get(Y,pe,xe,K)*k.get(Y,ie,he,q):Q+=E.get(Y,K,pe,xe)*k.get(Y,q,ie,he)}}y.set(Q,N,L,K,q)}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}const uY={kernelName:ox,backendName:"cpu",kernelFunc:cY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hY(t){const{inputs:e,backend:n,attrs:s}=t,{dy:o,filter:r}=e,{inputShape:i,strides:a,pad:l,dataFormat:c,dimRoundingMode:u}=s;De([o,r],"conv2dBackpropInput");const h=Ue(r.shape),d=Ue(o.shape);let f=hr(c);const p=In(i,r.shape,a,1,l,u,!1,f),g=new Rn(p.inShape,"float32"),b=g.values,x=n.data.get(o.dataId).values,y=n.data.get(r.dataId).values,[w,v,$]=h,{batchSize:_,filterHeight:E,filterWidth:k,inChannels:N,inHeight:A,inWidth:F,outChannels:L,outHeight:H,outWidth:M,strideHeight:K,strideWidth:q}=p;f=p.dataFormat;const Q=E-1-p.padInfo.top,Y=k-1-p.padInfo.left,ie=f==="channelsLast",pe=g.strides[0],he=ie?g.strides[1]:g.strides[2],xe=ie?g.strides[2]:1,me=ie?1:g.strides[1],Ie=d[0],G=ie?d[1]:d[2],le=ie?d[2]:1,ne=ie?1:d[1];for(let B=0;B<_;++B)for(let $e=0;$e<N;++$e)for(let Se=0;Se<A;++Se){const ke=Se-Q,Ne=Math.max(0,Math.ceil(ke/K)),D=Math.min(H,(E+ke)/K);for(let P=0;P<F;++P){const X=P-Y,ce=Math.max(0,Math.ceil(X/q)),re=Math.min(M,(k+X)/q);let de=0;for(let be=Ne;be<D;++be){const we=be*K-ke;for(let fe=ce;fe<re;++fe){const Me=fe*q-X,Re=Ie*B+G*be+le*fe,Oe=w*(E-1-we)+v*(k-1-Me)+$*$e;for(let Ve=0;Ve<L;++Ve){const Ke=x[Re+ne*Ve],rt=y[Oe+Ve];de+=Ke*rt}}}const _e=pe*B+he*Se+xe*P+me*$e;b[_e]=de}}return n.makeTensorInfo(g.shape,g.dtype,g.values)}const dY={kernelName:wf,backendName:"cpu",kernelFunc:hY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fY(t){const{inputs:e,backend:n,attrs:s}=t,{x:o,filter:r}=e,{strides:i,pad:a,dilations:l}=s;De([o,r],"conv3d");const c=Kr(o.shape,r.shape,i,l,a),{filterDepth:u,filterHeight:h,filterWidth:d,dilationDepth:f,dilationHeight:p,dilationWidth:g,padInfo:b}=c,x=b.front,y=b.left,w=b.top,v=new Rn(c.outShape,o.dtype),$=n.data.get(o.dataId).values,_=n.data.get(r.dataId).values,E=v.values,k=Ue(o.shape),N=Ue(r.shape);for(let A=0;A<c.batchSize;++A){const F=A*k[0],L=A*v.strides[0];for(let H=0;H<c.outDepth;++H){const M=L+H*v.strides[1],K=H*c.strideDepth-x;for(let q=0;q<u;++q){const Q=K+q*f;if(Q<0||Q>=c.inDepth)continue;const Y=q*N[0],ie=F+Q*k[1];for(let pe=0;pe<c.outHeight;++pe){const he=M+pe*v.strides[2],xe=pe*c.strideHeight-w;for(let me=0;me<h;++me){const Ie=xe+me*p;if(Ie<0||Ie>=c.inHeight)continue;const G=Y+me*N[1],le=ie+Ie*k[2];for(let ne=0;ne<c.outWidth;++ne){const B=he+ne*c.outChannels,$e=ne*c.strideWidth-y;for(let Se=0;Se<d;++Se){const ke=$e+Se*g;if(ke<0||ke>=c.inWidth)continue;const Ne=G+Se*N[2],D=le+ke*c.inChannels;let P=Ne;for(let X=0;X<c.inChannels;++X){const ce=$[D+X];for(let re=0;re<c.outChannels;++re)E[B+re]+=ce*_[P+re];P+=c.outChannels}}}}}}}}return n.makeTensorInfo(v.shape,v.dtype,v.values)}const pY={kernelName:Cf,backendName:"cpu",kernelFunc:fY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mY(t){const{inputs:e,backend:n,attrs:s}=t,{x:o,dy:r}=e,{strides:i,pad:a,filterShape:l}=s;De([o,r],"conv3dBackpropFilterV2");const c=Ue(o.shape),u=Ue(r.shape),h=Kr(o.shape,l,i,1,a),d=h.strideDepth,f=h.strideHeight,p=h.strideWidth,g=h.filterDepth,b=h.filterHeight,x=h.filterWidth,y=new Rn(h.filterShape,"float32"),w=y.values,[v,$,_,E]=y.strides,k=n.data.get(r.dataId).values,[N,A,F,L]=u,H=n.data.get(o.dataId).values,[M,K,q,Q]=c,Y=h.padInfo.front,ie=h.padInfo.left,pe=h.padInfo.top;for(let he=0;he<g;++he){const xe=Math.max(0,Math.ceil((Y-he)/d)),me=Math.min(h.outDepth,(h.inDepth+Y-he)/d),Ie=he*v;for(let G=0;G<b;++G){const le=Math.max(0,Math.ceil((pe-G)/f)),ne=Math.min(h.outHeight,(h.inHeight+pe-G)/f),B=G*$+Ie;for(let $e=0;$e<x;++$e){const Se=Math.max(0,Math.ceil((ie-$e)/p)),ke=Math.min(h.outWidth,(h.inWidth+ie-$e)/p),Ne=$e*_+B;for(let D=0;D<h.inChannels;++D){const P=D*E+Ne;for(let X=0;X<h.outChannels;++X){let ce=0;for(let re=0;re<h.batchSize;++re){const de=re*M,_e=re*N;for(let be=xe;be<me;++be){const fe=(he+be*d-Y)*K+de,Me=be*A+_e;for(let Re=le;Re<ne;++Re){const Ve=(G+Re*f-pe)*q+fe,Ke=Re*F+Me;for(let rt=Se;rt<ke;++rt){const xt=($e+rt*p-ie)*Q+Ve,En=rt*L+Ke;ce+=H[xt+D]*k[En+X]}}}}w[P+X]=ce}}}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}const gY={kernelName:rx,backendName:"cpu",kernelFunc:mY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bY(t){const{inputs:e,backend:n,attrs:s}=t,{dy:o,filter:r}=e,{pad:i,strides:a,inputShape:l}=s;De([o],"conv3dBackpropInputV2");const c=Ue(o.shape),u=Ue(r.shape),h=Kr(l,r.shape,a,1,i),d=new Rn(h.inShape,"float32"),f=d.values,[p,g,b,x]=d.strides,y=n.data.get(o.dataId).values,[w,v,$,_]=c,E=n.data.get(r.dataId).values,[k,N,A,F]=u,{batchSize:L,filterDepth:H,filterHeight:M,filterWidth:K,inChannels:q,inDepth:Q,inHeight:Y,inWidth:ie,outChannels:pe,outDepth:he,outHeight:xe,outWidth:me,strideDepth:Ie,strideHeight:G,strideWidth:le}=h,ne=H-1-h.padInfo.front,B=M-1-h.padInfo.top,$e=K-1-h.padInfo.left;for(let Se=0;Se<L;++Se)for(let ke=0;ke<q;++ke)for(let Ne=0;Ne<Q;++Ne){const D=Ne-ne,P=Math.max(0,Math.ceil(D/Ie)),X=Math.min(he,(H+D)/Ie);for(let ce=0;ce<Y;++ce){const re=ce-B,de=Math.max(0,Math.ceil(re/G)),_e=Math.min(xe,(M+re)/G);for(let be=0;be<ie;++be){const we=be-$e,fe=Math.max(0,Math.ceil(we/le)),Me=Math.min(me,(K+we)/le);let Re=0;for(let Oe=P;Oe<X;++Oe){const Ve=Oe*Ie-D;for(let Ke=de;Ke<_e;++Ke){const rt=Ke*G-re;for(let ct=fe;ct<Me;++ct){const xt=ct*le-we,En=w*Se+v*Oe+$*Ke+_*ct,to=k*(H-1-Ve)+N*(M-1-rt)+A*(K-1-xt)+F*ke;for(let jo=0;jo<pe;++jo){const bs=y[En+jo],Qe=E[to+jo];Re+=bs*Qe}}}}f[p*Se+g*Ne+b*ce+x*be+ke]=Re}}}return n.makeTensorInfo(d.shape,d.dtype,d.values)}const xY={kernelName:ix,backendName:"cpu",kernelFunc:bY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yY=wt(Zc,t=>Math.cos(t)),vY={kernelName:Zc,backendName:"cpu",kernelFunc:yY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wY=wt(Qc,t=>Math.cosh(t)),CY={kernelName:Qc,backendName:"cpu",kernelFunc:wY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Y(t){const{inputs:e,backend:n,attrs:s}=t,{image:o,boxes:r,boxInd:i}=e,{cropSize:a,method:l,extrapolationValue:c}=s,[u,h,d,f]=o.shape,p=r.shape[0],[g,b]=a,x=nt([p,g,b,f],"float32"),y=n.data.get(r.dataId).values,w=n.data.get(i.dataId).values,v=n.data.get(o.dataId).values,$=Ue(o.shape),_=Ue(x.shape);for(let E=0;E<p;E++){const k=E*4,N=y[k],A=y[k+1],F=y[k+2],L=y[k+3],H=w[E];if(H>=u)continue;const M=g>1?(F-N)*(h-1)/(g-1):0,K=b>1?(L-A)*(d-1)/(b-1):0;for(let q=0;q<g;q++){const Q=g>1?N*(h-1)+q*M:.5*(N+F)*(h-1);if(Q<0||Q>h-1){for(let Y=0;Y<b;Y++)for(let ie=0;ie<f;ie++){const pe=ie+Y*_[2]+q*_[1]+E*_[0];x.values[pe]=c}continue}if(l==="bilinear"){const Y=Math.floor(Q),ie=Math.ceil(Q),pe=Q-Y;for(let he=0;he<b;he++){const xe=b>1?A*(d-1)+he*K:.5*(A+L)*(d-1);if(xe<0||xe>d-1){for(let le=0;le<f;le++){const ne=le+he*_[2]+q*_[1]+E*_[0];x.values[ne]=c}continue}const me=Math.floor(xe),Ie=Math.ceil(xe),G=xe-me;for(let le=0;le<f;le++){let ne=le+me*$[2]+Y*$[1]+H*$[0];const B=v[ne];ne=le+Ie*$[2]+Y*$[1]+H*$[0];const $e=v[ne];ne=le+me*$[2]+ie*$[1]+H*$[0];const Se=v[ne];ne=le+Ie*$[2]+ie*$[1]+H*$[0];const ke=v[ne],Ne=B+($e-B)*G,D=Se+(ke-Se)*G;ne=le+he*_[2]+q*_[1]+E*_[0],x.values[ne]=Ne+(D-Ne)*pe}}}else for(let Y=0;Y<b;++Y){const ie=b>1?A*(d-1)+Y*K:.5*(A+L)*(d-1);if(ie<0||ie>d-1){for(let xe=0;xe<f;xe++){const me=xe+Y*_[2]+q*_[1]+E*_[0];x.values[me]=c}continue}const pe=Math.round(ie),he=Math.round(Q);for(let xe=0;xe<f;xe++){const me=xe+pe*$[2]+he*$[1]+H*$[0],Ie=xe+Y*_[2]+q*_[1]+E*_[0];x.values[Ie]=v[me]}}}}return n.makeTensorInfo(x.shape,x.dtype,x.values)}const IY={kernelName:lx,backendName:"cpu",kernelFunc:$Y};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Y(t){const{inputs:e,backend:n,attrs:s}=t,{x:o}=e,{axis:r,exclusive:i,reverse:a}=s;De(o,"cumprod");const l=jt([r],o.shape.length);let c=o;l!=null&&(c=os({inputs:{x:o},backend:n,attrs:{perm:l}}));const u=Zt(1,o.shape.length)[0];if(u!==c.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${u}`);const h=ds(c.dtype,"int32"),d=Xb(ae(c.shape),h),f=n.data.get(c.dataId).values,p=c.shape[c.shape.length-1],g=a?(x,y)=>x+p-y-1:(x,y)=>x+y;for(let x=0;x<f.length;x+=p)for(let y=0;y<p;y++){const w=g(x,y);if(y===0)d[w]=i?1:f[w];else{const v=g(x,y-1);d[w]=i?f[v]*d[v]:f[w]*d[v]}}const b=n.makeTensorInfo(c.shape,h,d);if(l!=null){const x=Xr(l),y=os({inputs:{x:b},backend:n,attrs:{perm:x}});return n.disposeIntermediateTensorInfo(b),n.disposeIntermediateTensorInfo(c),y}return b}const kY={kernelName:ax,backendName:"cpu",kernelFunc:_Y};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EY(t){const{inputs:e,backend:n,attrs:s}=t,{x:o}=e,{axis:r,exclusive:i,reverse:a}=s;De(o,"cumsum");const l=jt([r],o.shape.length);let c=o;l!=null&&(c=os({inputs:{x:o},backend:n,attrs:{perm:l}}));const u=Zt(1,o.shape.length)[0];if(u!==c.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${u}`);const h=ds(c.dtype,"int32"),d=Ln(ae(c.shape),h),f=n.data.get(c.dataId).values,p=c.shape[c.shape.length-1],g=a?(x,y)=>x+p-y-1:(x,y)=>x+y;for(let x=0;x<f.length;x+=p)for(let y=0;y<p;y++){const w=g(x,y);if(y===0)d[w]=i?0:f[w];else{const v=g(x,y-1);d[w]=i?f[v]+d[v]:f[w]+d[v]}}const b=n.makeTensorInfo(c.shape,h,d);if(l!=null){const x=Xr(l),y=os({inputs:{x:b},backend:n,attrs:{perm:x}});return n.disposeIntermediateTensorInfo(b),n.disposeIntermediateTensorInfo(c),y}return b}const SY={kernelName:$f,backendName:"cpu",kernelFunc:EY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TY(t){const{inputs:e,backend:n,attrs:s}=t,{x:o,weights:r}=e,{size:i,binaryOutput:a}=s;if(o.shape.length===1){const l=n.data.get(o.dataId).values,c=n.data.get(r.dataId).values,u=$0(l,c,r.dtype,r.shape,i);return n.makeTensorInfo([i],r.dtype,u)}else if(o.shape.length===2){const l=n.bufferSync(o),c=n.bufferSync(r),u=hT(l,c,i,a);return n.makeTensorInfo(u.shape,r.dtype,u.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${o.shape.length}.`)}const NY={kernelName:XI,backendName:"cpu",kernelFunc:TY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AY(t){const{inputs:e,backend:n,attrs:s}=t,{x:o}=e,{blockSize:r,dataFormat:i}=s;T(i==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${i}`);const a=o.shape[0],l=o.shape[1],c=o.shape[2],u=o.shape[3],h=l*r,d=c*r,f=u/(r*r),p=n.data.get(o.dataId).values,g=new Float32Array(a*h*d*f);let b=0;for(let x=0;x<a;++x)for(let y=0;y<h;++y){const w=Math.floor(y/r),v=y%r;for(let $=0;$<d;++$){const _=Math.floor($/r),E=$%r,k=(v*r+E)*f;for(let N=0;N<f;++N){const F=N+k+u*(_+c*(w+l*x));g[b++]=p[F]}}}return n.makeTensorInfo([a,h,d,f],o.dtype,g)}const RY={kernelName:cx,backendName:"cpu",kernelFunc:AY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iN(t){const{inputs:e,backend:n,attrs:s}=t,{x:o,filter:r}=e,{strides:i,pad:a,dilations:l,dimRoundingMode:c}=s;De([o,r],"depthwiseConv2DNative");const u=Ue(o.shape),h=Ue(r.shape);let d=l;d==null&&(d=[1,1]),T(Pn(i,d),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${i} and dilations '${d}'`);const f=In(o.shape,r.shape,i,d,a,c,!0),{filterHeight:p,filterWidth:g,dilationHeight:b,dilationWidth:x,padInfo:y}=f,w=y.left,v=y.top,$=f.outChannels/f.inChannels,_=new Rn(f.outShape,o.dtype),E=n.data.get(o.dataId).values,k=n.data.get(r.dataId).values,N=_.values;for(let A=0;A<f.batchSize;++A){const F=A*u[0],L=A*_.strides[0];for(let H=0;H<f.outHeight;++H){const M=L+H*_.strides[1],K=H*f.strideHeight-v;for(let q=0;q<p;++q){const Q=K+q*b;if(Q<0||Q>=f.inHeight)continue;const Y=q*h[0],ie=F+Q*u[1];for(let pe=0;pe<f.outWidth;++pe){const he=M+pe*_.strides[2],xe=pe*f.strideWidth-w;for(let me=0;me<g;++me){const Ie=xe+me*x;if(Ie<0||Ie>=f.inWidth)continue;const G=Y+me*h[1],le=ie+Ie*f.inChannels;let ne=he,B=G;for(let $e=0;$e<f.inChannels;++$e){const Se=E[le+$e];for(let ke=0;ke<$;++ke)N[ne+ke]+=Se*k[B+ke];ne+=$,B+=$}}}}}}return n.makeTensorInfo(_.shape,_.dtype,_.values)}const DY={kernelName:If,backendName:"cpu",kernelFunc:iN};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OY(t){const{inputs:e,backend:n,attrs:s}=t,{x:o,dy:r}=e,{strides:i,dilations:a,pad:l,dimRoundingMode:c,filterShape:u}=s;De([o,r],"depthwiseConv2dNativeBackpropFilter");const h=In(o.shape,u,i,a,l,c,!0),{strideHeight:d,strideWidth:f,filterHeight:p,filterWidth:g}=h,b=new Rn(h.filterShape,"float32"),x=h.padInfo.left,y=h.padInfo.top,w=h.outChannels/h.inChannels,v=n.data.get(o.dataId).values,$=new Rn(o.shape,o.dtype,v),_=n.data.get(r.dataId).values,E=new Rn(r.shape,r.dtype,_);for(let k=0;k<p;++k){const N=Math.max(0,Math.ceil((y-k)/d)),A=Math.min(h.outHeight,(h.inHeight+y-k)/d);for(let F=0;F<g;++F){const L=Math.max(0,Math.ceil((x-F)/f)),H=Math.min(h.outWidth,(h.inWidth+x-F)/f);for(let M=0;M<h.outChannels;++M){const K=Math.trunc(M/w),q=M%w;let Q=0;for(let Y=0;Y<h.batchSize;++Y)for(let ie=N;ie<A;++ie){const pe=k+ie*d-y;for(let he=L;he<H;++he){const xe=F+he*f-x;Q+=$.get(Y,pe,xe,K)*E.get(Y,ie,he,M)}}b.set(Q,k,F,K,q)}}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}const FY={kernelName:ux,backendName:"cpu",kernelFunc:OY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LY(t){const{inputs:e,backend:n,attrs:s}=t,{dy:o,filter:r}=e,{strides:i,dilations:a,pad:l,dimRoundingMode:c,inputShape:u}=s;De([o,r],"depthwiseConv2DNativeBackpropInput");const h=Ue(o.shape),d=Ue(r.shape),f=In(u,r.shape,i,a,l,c,!0),p=new Rn(f.inShape,"float32"),g=p.values,[b,x,y]=p.strides,w=n.data.get(o.dataId).values,[v,$,_]=h,E=n.data.get(r.dataId).values,[k,N,A]=d,{batchSize:F,filterHeight:L,filterWidth:H,inChannels:M,inHeight:K,inWidth:q,outChannels:Q,outHeight:Y,outWidth:ie,strideHeight:pe,strideWidth:he}=f,xe=L-1-f.padInfo.top,me=H-1-f.padInfo.left,Ie=Q/M;for(let G=0;G<F;++G)for(let le=0;le<M;++le)for(let ne=0;ne<K;++ne){const B=ne-xe,$e=Math.max(0,Math.ceil(B/pe)),Se=Math.min(Y,(L+B)/pe);for(let ke=0;ke<q;++ke){const Ne=ke-me,D=Math.max(0,Math.ceil(Ne/he)),P=Math.min(ie,(H+Ne)/he);let X=0;for(let ce=$e;ce<Se;++ce){const re=ce*pe-B;for(let de=D;de<P;++de){const _e=de*he-Ne,be=v*G+$*ce+_*de,we=k*(L-1-re)+N*(H-1-_e)+A*le;for(let fe=0;fe<Ie;++fe){const Me=le*Ie+fe,Re=w[be+Me],Oe=E[we+fe];X+=Re*Oe}}}g[b*G+x*ne+y*ke+le]=X}}return n.makeTensorInfo(p.shape,p.dtype,p.values)}const PY={kernelName:hx,backendName:"cpu",kernelFunc:LY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MY(t){const{inputs:e,backend:n}=t,{x:s}=e,o=ae(s.shape),r=n.data.get(s.dataId).values,i=nt([o,o],s.dtype),a=i.values;for(let c=0;c<r.length;c++)a[c*o+c]=r[c];const l=[...s.shape,...s.shape];return n.makeTensorInfo(l,i.dtype,i.values)}const BY={kernelName:YI,backendName:"cpu",kernelFunc:MY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VY={kernelName:_f,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:s,filter:o}=t,{strides:r,pad:i,dilations:a}=n,l=e,c=l.data.get(s.dataId).values,u=s.shape.length,h=l.data.get(o.dataId).values,d=o.shape.length,{batchSize:f,inHeight:p,inWidth:g,inChannels:b,outHeight:x,outWidth:y,padInfo:w,strideHeight:v,strideWidth:$,filterHeight:_,filterWidth:E,dilationHeight:k,dilationWidth:N,outShape:A}=Pu(s.shape,o.shape,r,i,"NHWC",a),F=ae(A),L=A.length,H=An(s.dtype,F);for(let K=0;K<f;++K)for(let q=0;q<x;++q){const Q=q*v-w.top;for(let Y=0;Y<y;++Y){const ie=Y*$-w.left;for(let pe=0;pe<b;++pe){let he=Number.MIN_SAFE_INTEGER;for(let me=0;me<_;++me){const Ie=Q+me*k;if(Ie>=0&&Ie<p)for(let G=0;G<E;++G){const le=ie+G*N;if(le>=0&&le<g){const ne=Fo([K,Ie,le,pe],u,Ue(s.shape)),B=Fo([me,G,pe],d,Ue(o.shape)),$e=c[ne]+h[B];$e>he&&(he=$e)}}}const xe=Fo([K,q,Y,pe],L,Ue(A));H[xe]=he}}}return{dataId:l.write(oa(H,s.dtype),A,s.dtype),shape:A,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zY={kernelName:Mg,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:s,filter:o,dy:r}=t,{strides:i,pad:a,dilations:l}=n,c=e,u=po(s.shape,c.data.get(s.dataId).values),h=po(o.shape,c.data.get(o.dataId).values),{batchSize:d,inHeight:f,inWidth:p,inChannels:g,outHeight:b,outWidth:x,padInfo:y,strideHeight:w,strideWidth:v,filterHeight:$,filterWidth:_,dilationHeight:E,dilationWidth:k,outShape:N}=Pu(s.shape,o.shape,i,a,"NHWC",l);T(r.rank===N.length,()=>`Error in ${Mg}, dy must have the same rank as output ${N.length}, but got ${r.rank}`);const A=po(N,c.data.get(r.dataId).values),F=UI(o.shape,o.dtype);for(let H=0;H<d;++H)for(let M=0;M<b;++M){const K=M*w-y.top;for(let q=0;q<x;++q){const Q=q*v-y.left;for(let Y=0;Y<g;++Y){let ie=Number.MIN_SAFE_INTEGER,pe=0,he=0;for(let xe=0;xe<$;++xe){const me=K+xe*E;if(me>=0&&me<f)for(let Ie=0;Ie<_;++Ie){const G=Q+Ie*k;if(G>=0&&G<p){const le=u[H][me][G][Y]+h[xe][Ie][Y];le>ie&&(ie=le,pe=xe,he=Ie)}}}F[pe][he][Y]+=A[H][M][q][Y]}}}return{dataId:c.write(oa(F,s.dtype),o.shape,o.dtype),shape:o.shape,dtype:o.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WY={kernelName:Pg,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:s,filter:o,dy:r}=t,{strides:i,pad:a,dilations:l}=n,c=e,u=po(s.shape,c.data.get(s.dataId).values),h=po(o.shape,c.data.get(o.dataId).values),{batchSize:d,inHeight:f,inWidth:p,inChannels:g,outHeight:b,outWidth:x,padInfo:y,strideHeight:w,strideWidth:v,filterHeight:$,filterWidth:_,dilationHeight:E,dilationWidth:k,outShape:N}=Pu(s.shape,o.shape,i,a,"NHWC",l);T(r.rank===N.length,()=>`Error in ${Pg}, dy must have the same rank as output ${N.length}, but got ${r.rank}`);const A=po(N,c.data.get(r.dataId).values),F=UI(s.shape,s.dtype);for(let H=0;H<d;++H)for(let M=0;M<b;++M){const K=M*w-y.top;for(let q=0;q<x;++q){const Q=q*v-y.left;for(let Y=0;Y<g;++Y){let ie=Number.MIN_SAFE_INTEGER,pe=K<0?0:K,he=Q<0?0:Q;for(let xe=0;xe<$;++xe){const me=K+xe*E;if(me>=0&&me<f)for(let Ie=0;Ie<_;++Ie){const G=Q+Ie*k;if(G>=0&&G<p){const le=u[H][me][G][Y]+h[xe][Ie][Y];le>ie&&(ie=le,pe=me,he=G)}}}F[H][pe][he][Y]+=A[H][M][q][Y]}}}return{dataId:c.write(oa(F,s.dtype),s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qu(t){const{inputs:e,backend:n,attrs:s}=t,{x:o}=e,{axis:r,keepDims:i}=s;De(o,"sum");let a;o.dtype==="bool"?a=Ur({inputs:{x:o},backend:n,attrs:{dtype:"int32"}}):a=Go({inputs:{x:o},backend:n});const l=a.shape.length,c=st(r,a.shape),u=jt(c,l);let h=c,d=a;u!=null&&(d=os({inputs:{x:a},backend:n,attrs:{perm:u}}),h=Zt(h.length,l)),_n("sum",h,d.shape.length);const[f,p]=yn(d.shape,h),g=ds(d.dtype,"int32");let b=Pd(n,f,g);const x=ae(p),y=n.data.get(b.dataId).values,w=n.data.get(d.dataId).values;for(let v=0;v<y.length;++v){const $=v*x;let _=0;for(let E=0;E<x;++E)_+=w[$+E];y[v]=_}if(i){const v=Yt(b.shape,c),$=b;b=Rt({inputs:{x:b},backend:n,attrs:{shape:v}}),n.disposeIntermediateTensorInfo($)}return n.disposeIntermediateTensorInfo(a),u!=null&&n.disposeIntermediateTensorInfo(d),b}const UY={kernelName:op,backendName:"cpu",kernelFunc:Qu};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HY(t){const{inputs:e,backend:n,attrs:s}=t,{equation:o}=s,r=e,{allDims:i,summedDims:a,idDims:l}=jy(o,r.length);Ky(i.length,l,r);const{path:c,steps:u}=Xy(a,l),h=u.length;let d=null,f=i.length;const p=[];for(let g=0;g<h;++g){for(const b of u[g]){const{permutationIndices:x,expandDims:y}=qy(f,l[b]);let w;Yy(x)?w=r[b]:(w=os({inputs:{x:r[b]},backend:n,attrs:{perm:x}}),p.push(w));const v=w.shape.slice();for(let $=0;$<y.length;++$)v.splice(y[$],0,1);bt(w.shape,v)||(w=Rt({inputs:{x:w},backend:n,attrs:{shape:v}}),p.push(w)),d===null?d=w:(d=Bp({inputs:{a:w,b:d},backend:n}),p.push(d))}g<h-1&&(c[g]>=0&&(d=Qu({inputs:{x:d},backend:n,attrs:{axis:c[g]-(i.length-f),keepDims:!1}}),p.push(d)),f--)}for(const g of p)g!==d&&n.disposeIntermediateTensorInfo(g);return d}const GY={kernelName:ZI,backendName:"cpu",kernelFunc:HY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jY(t){const{inputs:e,backend:n}=t,{dy:s,y:o}=e;De([s,o],"eluGrad");const r=new Float32Array(ae(o.shape)),i=n.data.get(o.dataId).values,a=n.data.get(s.dataId).values;for(let l=0;l<i.length;++l){const c=i[l];c>=1?r[l]=a[l]:r[l]=a[l]*(c+1)}return n.makeTensorInfo(o.shape,"float32",r)}const qY={kernelName:dx,backendName:"cpu",kernelFunc:jY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KY=By,XY=Vy,YY=zy,ZY=Wy,QY=Uy,JY=Hy,e7=wt(tu,t=>{const e=Math.sign(t),n=Math.abs(t),s=1/(1+KY*n);return e*(1-((((JY*s+QY)*s+ZY)*s+YY)*s+XY)*s*Math.exp(-n*n))}),t7={kernelName:tu,backendName:"cpu",kernelFunc:e7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vd(t){const{inputs:e,backend:n,attrs:s}=t,{input:o}=e,{dim:r}=s,i=o.shape.length,a=o.shape.slice();let l=r;return r<0&&(T(-(i+1)<=r,()=>`Axis must be in the interval [${-(i+1)}, ${i}]`),l=i+r+1),a.splice(l,0,1),Rt({inputs:{x:o},backend:n,attrs:{shape:a}})}const n7={kernelName:Ef,backendName:"cpu",kernelFunc:Vd};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s7=nn((t,e)=>t/e),T0=vn(Jc,s7),pb={kernelName:Jc,backendName:"cpu",kernelFunc:T0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aN(t,e,n){const s=t.shape,o=s[0],r=s[1],i=n.data.get(t.dataId),a=i.complexTensorInfos.real,l=i.complexTensorInfos.imag,c=[o,r],u=ae(c),h=$n("float32",u),d=$n("float32",u);for(let b=0;b<o;b++){const x=na({inputs:{x:a},backend:n,attrs:{begin:[b,0],size:[1,r]}}),y=na({inputs:{x:l},backend:n,attrs:{begin:[b,0],size:[1,r]}}),w=cs({inputs:{real:x,imag:y},backend:n}),{real:v,imag:$}=o7(w,e,n),_=ar(v,$);for(let E=0;E<r;E++){const k=Gy(_,E);h[b*r+E]=k.real,d[b*r+E]=k.imag}n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(w)}const f=n.makeTensorInfo(c,"float32",h),p=n.makeTensorInfo(c,"float32",d),g=cs({inputs:{real:f,imag:p},backend:n});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),g}function o7(t,e,n){const s=ae(t.shape),o=n.data.get(t.dataId),r=n.data.get(o.complexTensorInfos.real.dataId).values,i=n.data.get(o.complexTensorInfos.imag.dataId).values;if(r7(s)){const a=mb(r,i,s,e,n),l=[t.shape[0],t.shape[1]];if(e){const c=n.makeTensorInfo(l,"float32",a.real),u=n.makeTensorInfo(l,"float32",a.imag),h=n.makeTensorInfo([],"float32",qr(s,"float32")),d=Go({inputs:{x:h},backend:n}),f=pb.kernelFunc({inputs:{a:c,b:h},backend:n}),p=pb.kernelFunc({inputs:{a:u,b:d},backend:n}),g=n.data.get(f.dataId).values,b=n.data.get(p.dataId).values;return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),{real:g,imag:b}}return a}else{const a=ar(r,i),l=i7(a,s,e);return Ok(l)}}function r7(t){return(t&t-1)===0}function mb(t,e,n,s,o){if(n===1)return{real:t,imag:e};const r=ar(t,e),i=n/2,a=Fk(r),l=a.real,c=a.imag,u=[l.length],h=o.makeTensorInfo(u,"float32",l),d=o.makeTensorInfo(u,"float32",c),f=cs({inputs:{real:h,imag:d},backend:o}),p=Lk(r),g=p.real,b=p.imag,x=[g.length],y=o.makeTensorInfo(x,"float32",g),w=o.makeTensorInfo(x,"float32",b),v=cs({inputs:{real:y,imag:w},backend:o}),$=mb(l,c,i,s,o),_=$.real,E=$.imag,k=[_.length],N=o.makeTensorInfo(k,"float32",_),A=o.makeTensorInfo(k,"float32",E),F=cs({inputs:{real:N,imag:A},backend:o}),L=mb(g,b,i,s,o),H=L.real,M=L.imag,K=[H.length],q=o.makeTensorInfo(K,"float32",H),Q=o.makeTensorInfo(K,"float32",M),Y=cs({inputs:{real:q,imag:Q},backend:o}),ie=Mk(n,s),pe=[ie.real.length],he=o.makeTensorInfo(pe,"float32",ie.real),xe=o.makeTensorInfo(pe,"float32",ie.imag),me=cs({inputs:{real:he,imag:xe},backend:o}),Ie=Bp({inputs:{a:me,b:Y},backend:o}),G=hl({inputs:{a:F,b:Ie},backend:o}),le=E0({inputs:{a:F,b:Ie},backend:o}),ne=ta({inputs:{input:G},backend:o}),B=ta({inputs:{input:le},backend:o}),$e=dl({inputs:{input:G},backend:o}),Se=dl({inputs:{input:le},backend:o}),ke=fl({inputs:[ne,B],backend:o,attrs:{axis:0}}),Ne=fl({inputs:[$e,Se],backend:o,attrs:{axis:0}}),D=o.data.get(ke.dataId).values,P=o.data.get(Ne.dataId).values;return o.disposeIntermediateTensorInfo(h),o.disposeIntermediateTensorInfo(d),o.disposeIntermediateTensorInfo(f),o.disposeIntermediateTensorInfo(y),o.disposeIntermediateTensorInfo(w),o.disposeIntermediateTensorInfo(v),o.disposeIntermediateTensorInfo(N),o.disposeIntermediateTensorInfo(A),o.disposeIntermediateTensorInfo(F),o.disposeIntermediateTensorInfo(q),o.disposeIntermediateTensorInfo(Q),o.disposeIntermediateTensorInfo(Y),o.disposeIntermediateTensorInfo(he),o.disposeIntermediateTensorInfo(xe),o.disposeIntermediateTensorInfo(me),o.disposeIntermediateTensorInfo(Ie),o.disposeIntermediateTensorInfo(G),o.disposeIntermediateTensorInfo(le),o.disposeIntermediateTensorInfo(ne),o.disposeIntermediateTensorInfo($e),o.disposeIntermediateTensorInfo(B),o.disposeIntermediateTensorInfo(Se),o.disposeIntermediateTensorInfo(ke),o.disposeIntermediateTensorInfo(Ne),{real:D,imag:P}}function i7(t,e,n){const s=new Float32Array(e*2);for(let o=0;o<e;o++){let r=0,i=0;for(let a=0;a<e;a++){const l=Bk(o*a,e,n),c=Gy(t,a);r+=c.real*l.real-c.imag*l.imag,i+=c.real*l.imag+c.imag*l.real}n&&(r/=e,i/=e),Pk(s,r,i,o)}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a7(t){const{inputs:e,backend:n}=t,{input:s}=e,o=ae(s.shape),r=s.shape[s.shape.length-1],i=o/r,a=Rt({inputs:{x:s},backend:n,attrs:{shape:[i,r]}}),l=aN(a,!1,n),c=Rt({inputs:{x:l},backend:n,attrs:{shape:s.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(l),c}const l7={kernelName:fx,backendName:"cpu",kernelFunc:a7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N0(t){const{backend:e,attrs:n}=t,{shape:s,value:o,dtype:r}=n,i=r||Bc(o),a=An(i,ae(s));return u7(a,o,i),e.makeTensorInfo(s,i,a)}const c7={kernelName:px,backendName:"cpu",kernelFunc:N0};function u7(t,e,n){t.fill(e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const h7={kernelName:mx,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:s}=t,o=n,r=$n(s.dtype,ae(s.shape)),[i,a,l,c]=s.shape,u=o.data.get(s.dataId).values;for(let d=0;d<i;d++){const f=d*l*a*c;for(let p=0;p<a;p++){const g=p*(l*c);for(let b=0;b<l;b++){const x=b*c;for(let y=0;y<c;y++){const w=Math.round(l-b-1),v=f+g+x+y;let $=u[v];if(w>=0&&w<l){const _=w*c,E=f+g+_+y;$=u[E]}r[v]=$}}}}return{dataId:o.write(r,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const d7=nn((t,e)=>Math.floor(t/e)),f7=vn(ru,d7,null,"int32"),p7={kernelName:ru,backendName:"cpu",kernelFunc:f7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m7(t){const{inputs:e,backend:n,attrs:s}=t,{x:o,filter:r,bias:i,preluActivationWeights:a}=e,{strides:l,pad:c,dataFormat:u,dilations:h,dimRoundingMode:d,activation:f,leakyreluAlpha:p}=s;let g=rN({inputs:{x:o,filter:r},backend:n,attrs:{strides:l,pad:c,dataFormat:u,dilations:h,dimRoundingMode:d}});if(i){const b=g;if(u==="NCHW"&&i.shape.length===1&&i.shape[0]!==1){const x=Rt({inputs:{x:i},backend:n,attrs:{shape:[i.shape[0],1,1]}});g=hl({inputs:{a:g,b:x},backend:n}),n.disposeIntermediateTensorInfo(x)}else g=hl({inputs:{a:g,b:i},backend:n});n.disposeIntermediateTensorInfo(b)}if(f){const b=g;if(u==="NCHW"&&f==="prelu"&&a.shape.length===1&&a.shape[0]!==1){const x=Rt({inputs:{x:a},backend:n,attrs:{shape:[a.shape[0],1,1]}});g=Bd(n,g,f,x,p),n.disposeIntermediateTensorInfo(x)}else g=Bd(n,g,f,a,p);n.disposeIntermediateTensorInfo(b)}return g}const g7={kernelName:xd,backendName:"cpu",kernelFunc:m7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b7(t){const{inputs:e,backend:n,attrs:s}=t,{x:o,filter:r,bias:i,preluActivationWeights:a}=e,{strides:l,pad:c,dataFormat:u,dilations:h,dimRoundingMode:d,activation:f,leakyreluAlpha:p}=s;let g=iN({inputs:{x:o,filter:r},backend:n,attrs:{strides:l,pad:c,dataFormat:u,dilations:h,dimRoundingMode:d}});if(i){const b=g;g=hl({inputs:{a:g,b:i},backend:n}),n.disposeIntermediateTensorInfo(b)}if(f){const b=g;g=Bd(n,g,f,a,p),n.disposeIntermediateTensorInfo(b)}return g}const x7={kernelName:i_,backendName:"cpu",kernelFunc:b7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y7(t){const{inputs:e,backend:n}=t,{params:s,indices:o}=e,r=ae(s.shape),i=o.shape,a=i[i.length-1],[l,c,u,h]=jx(s,o);if(c===0)return n.makeTensorInfo(l,s.dtype,[]);const d=n.data.get(o.dataId).values,f=n.bufferSync(s),p=vT(d,f,s.dtype,c,a,u,h,s.shape,r);return n.makeTensorInfo(l,s.dtype,p.values)}const v7={kernelName:QI,backendName:"cpu",kernelFunc:y7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w7(t){const{inputs:e,backend:n,attrs:s}=t,{x:o,indices:r}=e,{axis:i,batchDims:a}=s;De([o,r],"gatherV2");const l=st(i,o.shape)[0],c=n.data.get(r.dataId).values,u=o.shape[l];for(let v=0;v<c.length;++v){const $=c[v];T($<=u-1&&$>=0,()=>`GatherV2: the index value ${$} is not in [0, ${u-1}]`)}let h=a;a==null&&(h=0);const d=ae(r.shape),f=Qy(o,r,l,h),p=Rt({inputs:{x:o},backend:n,attrs:{shape:[f.batchSize,f.outerSize,f.dimSize,f.sliceSize]}}),g=Rt({inputs:{x:r},backend:n,attrs:{shape:[f.batchSize,d/f.batchSize]}}),b=[f.batchSize,f.outerSize,d/f.batchSize,f.sliceSize],x=n.bufferSync(g),y=n.bufferSync(p),w=wT(y,x,b);return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),n.makeTensorInfo(f.outputShape,w.dtype,w.values)}const C7={kernelName:Tf,backendName:"cpu",kernelFunc:w7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $7(t){const{inputs:e,backend:n}=t,{input:s}=e,o=ae(s.shape),r=s.shape[s.shape.length-1],i=o/r,a=Rt({inputs:{x:s},backend:n,attrs:{shape:[i,r]}}),l=aN(a,!0,n),c=Rt({inputs:{x:l},backend:n,attrs:{shape:s.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(l),c}const I7={kernelName:gx,backendName:"cpu",kernelFunc:$7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _7=wt(lu,t=>Number.isFinite(t)?1:0,"bool"),k7={kernelName:lu,backendName:"cpu",kernelFunc:_7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E7=wt(cu,t=>Math.abs(t)===1/0?1:0,"bool"),S7={kernelName:cu,backendName:"cpu",kernelFunc:E7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const T7=wt(uu,t=>Number.isNaN(t)?1:0,"bool"),N7={kernelName:uu,backendName:"cpu",kernelFunc:T7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A7(t){const{backend:e,attrs:n}=t,{start:s,stop:o,num:r}=n,i=kT(s,o,r);return e.makeTensorInfo([i.length],"float32",i)}const R7={kernelName:JI,backendName:"cpu",kernelFunc:A7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D7=wt(du,t=>Math.log1p(t)),O7={kernelName:du,backendName:"cpu",kernelFunc:D7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F7=nn((t,e)=>t&&e),L7=vn(Of,F7,null,"bool"),P7={kernelName:Of,backendName:"cpu",kernelFunc:L7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M7=wt(Ff,t=>t?0:1,"bool"),B7={kernelName:Ff,backendName:"cpu",kernelFunc:M7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const V7=nn((t,e)=>t||e),z7=vn(Lf,V7,null,"bool"),W7={kernelName:Lf,backendName:"cpu",kernelFunc:z7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U7(t){const{inputs:e,backend:n,attrs:s}=t,{x:o}=e,{depthRadius:r,bias:i,alpha:a,beta:l}=s;De(o,"LRN");const c=o.shape[3],u=c-1,h=n.data.get(o.dataId).values,d=ae(o.shape),f=new Float32Array(d);function p(g){const b=g%c;let x=g-b+Math.max(0,b-r);const y=g-b+Math.min(b+r,u);let w=0;for(;x<=y;x++){const v=h[x];w+=v*v}return w}for(let g=0;g<d;g++){const b=p(g),x=h[g]*Math.pow(i+a*b,-l);f[g]=x}return n.makeTensorInfo(o.shape,o.dtype,f)}const H7={kernelName:Pf,backendName:"cpu",kernelFunc:U7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G7(t){const{inputs:e,backend:n,attrs:s}=t,{x:o,y:r,dy:i}=e,{depthRadius:a,bias:l,alpha:c,beta:u}=s;De(i,"LRNGrad");const h=ae(i.shape),d=i.shape[3],f=n.data.get(i.dataId).values,p=n.data.get(o.dataId).values,g=n.data.get(r.dataId).values,b=new Float32Array(h),x=h;for(let y=0;y<x;y++){const w=y%d,v=y-w+Math.max(0,w-a),$=y-w+Math.min(d,w+a+1);let _=0;for(let E=v;E<$;E++)_+=Math.pow(p[E],2);_=c*_+l;for(let E=v;E<$;E++){let k=-2*c*u*p[E]*g[y]/_;y===E&&(k+=Math.pow(_,-u)),k*=f[y],b[E]+=k}}return n.makeTensorInfo(i.shape,o.dtype,b)}const j7={kernelName:xx,backendName:"cpu",kernelFunc:G7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lN(t){const{inputs:e,backend:n,attrs:s}=t,{x:o}=e,{reductionIndices:r,keepDims:i}=s,a=n;let l=o.shape;const c=l.length,u=st(r,l);let h=u;const d=jt(h,c);let f=a.data.get(o.dataId).values;if(d!=null){const v=new Array(c);for(let $=0;$<v.length;$++)v[$]=l[d[$]];f=_0(f,l,o.dtype,d,v),h=Zt(h.length,c),l=v}De(o,"max"),_n("max",h,c);const[p,g]=yn(l,h),b=ae(g),x=ST(f,b,p,o.dtype),y=a.write(x,p,o.dtype);let w=p;return i&&(w=Yt(p,u)),{dataId:y,shape:w,dtype:o.dtype}}const q7={kernelName:Mf,backendName:"cpu",kernelFunc:lN};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K7(t){const{inputs:e,backend:n,attrs:s}=t,{x:o}=e;De(o,"maxPool");const{filterSize:r,strides:i,pad:a,dimRoundingMode:l}=s,c=1;T(Pn(i,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);const u=Zs(o.shape,r,i,c,a,l);let h;if(u.filterWidth===1&&u.filterHeight===1&&bt(u.inShape,u.outShape))h=Go({inputs:{x:o},backend:n});else{const d=n.data.get(o.dataId).values,f=Ue(o.shape),p=S0(d,o.shape,o.dtype,f,u,"max");h=n.makeTensorInfo(u.outShape,o.dtype,p.values)}return h}const X7={kernelName:Bf,backendName:"cpu",kernelFunc:K7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y7(t){const{inputs:e,backend:n,attrs:s}=t,{x:o}=e,{filterSize:r,strides:i,pad:a,dimRoundingMode:l,dataFormat:c}=s;De(o,"maxPool3d");const u=ur(o.shape,r,i,1,a,l,c),h=n.data.get(o.dataId).values,d=oN(h,o.shape,o.dtype,Ue(o.shape),u,"max");return n.makeTensorInfo(d.shape,"float32",d.values)}const Z7={kernelName:Vf,backendName:"cpu",kernelFunc:Y7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q7(t){const{inputs:e,backend:n,attrs:s}=t,{dy:o,input:r}=e,{filterSize:i,strides:a,pad:l,dimRoundingMode:c}=s;De([o,r],"maxPool3DGrad");const u=ur(r.shape,i,a,1,l,c),h=n.bufferSync(r),d=B8(h,u),f=u.strideDepth,p=u.strideHeight,g=u.strideWidth,b=u.dilationDepth,x=u.dilationHeight,y=u.dilationWidth,w=u.effectiveFilterDepth,v=u.effectiveFilterHeight,$=u.effectiveFilterWidth,_=w-1-u.padInfo.front,E=$-1-u.padInfo.left,k=v-1-u.padInfo.top,N=nt(r.shape,"float32"),A=n.bufferSync(o);for(let F=0;F<u.batchSize;++F)for(let L=0;L<u.inChannels;++L)for(let H=0;H<u.inDepth;++H)for(let M=0;M<u.inHeight;++M)for(let K=0;K<u.inWidth;++K){const q=H-_,Q=M-k,Y=K-E;let ie=0;for(let pe=0;pe<w;pe+=b){const he=(q+pe)/f;if(!(he<0||he>=u.outDepth||Math.floor(he)!==he))for(let xe=0;xe<v;xe+=x){const me=(Q+xe)/p;if(!(me<0||me>=u.outHeight||Math.floor(me)!==me))for(let Ie=0;Ie<$;Ie+=y){const G=(Y+Ie)/g;if(G<0||G>=u.outWidth||Math.floor(G)!==G)continue;const le=w*v*$-1-d.get(F,he,me,G,L),ne=pe*v*$+xe*$+Ie,B=le===ne?1:0;if(B===0)continue;ie+=A.get(F,he,me,G,L)*B}}}N.set(ie,F,H,M,K,L)}return n.makeTensorInfo(N.shape,N.dtype,N.values)}const J7={kernelName:vx,backendName:"cpu",kernelFunc:Q7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e9(t){const{inputs:e,backend:n,attrs:s}=t,{dy:o,input:r,output:i}=e,a=r;De([r,i],"maxPoolGrad");const{filterSize:l,strides:c,pad:u,dimRoundingMode:h}=s,d=Zs(a.shape,l,c,1,u,h),f=n.data.get(a.dataId).values,p=nt(d.outShape,a.dtype,sN(f,a.shape,a.dtype,d).values),g=d.strideHeight,b=d.strideWidth,x=d.dilationHeight,y=d.dilationWidth,w=d.effectiveFilterHeight,v=d.effectiveFilterWidth,$=v-1-d.padInfo.left,_=w-1-d.padInfo.top,E=nt(a.shape,"float32"),k=n.data.get(o.dataId).values,N=nt(o.shape,"float32",k);for(let A=0;A<d.batchSize;++A)for(let F=0;F<d.inChannels;++F)for(let L=0;L<d.inHeight;++L)for(let H=0;H<d.inWidth;++H){const M=L-_,K=H-$;let q=0;for(let Q=0;Q<w;Q+=x){const Y=(M+Q)/g;if(!(Y<0||Y>=d.outHeight||Math.floor(Y)!==Y))for(let ie=0;ie<v;ie+=y){const pe=(K+ie)/b;if(pe<0||pe>=d.outWidth||Math.floor(pe)!==pe)continue;const he=w*v-1-p.get(A,Y,pe,F),xe=Q*v+ie,me=he===xe?1:0;if(me===0)continue;q+=N.get(A,Y,pe,F)*me}}E.set(q,A,L,H,F)}return n.makeTensorInfo(E.shape,E.dtype,E.values)}const t9={kernelName:yx,backendName:"cpu",kernelFunc:e9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n9(t,e,n,s,o){const r=Ue(e),i=S0(t,e,n,r,o,"max"),a=sN(t,e,n,o,!0,s);return[i.values,a.values]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s9={kernelName:e_,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:s}=t,{filterSize:o,strides:r,pad:i,includeBatchInIndex:a}=e,l=n;De(s,"MaxPoolWithArgmax");const c=l.data.get(s.dataId).values,u=Zs(s.shape,o,r,[1,1],i),[h,d]=n9(c,s.shape,s.dtype,a,u),f=l.write(h,u.outShape,s.dtype),p=l.write(d,u.outShape,s.dtype);return[{dataId:f,shape:u.outShape,dtype:s.dtype},{dataId:p,shape:u.outShape,dtype:"int32"}]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o9(t){const{inputs:e,backend:n,attrs:s}=t,{x:o}=e,{axis:r,keepDims:i}=s,a=st(r,o.shape),c=yn(o.shape,a)[1],u=ae(c),h=[],d=n.makeTensorInfo([],"float32",new Float32Array([u]));h.push(d);const f=Ur({inputs:{x:o},backend:n,attrs:{dtype:"float32"}});h.push(f);const p=T0({inputs:{a:f,b:d},backend:n});h.push(p);const g=Qu({inputs:{x:p},backend:n,attrs:{axis:r,keepDims:i}});return h.forEach(b=>n.disposeIntermediateTensorInfo(b)),g}const r9={kernelName:zf,backendName:"cpu",kernelFunc:o9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i9(t){const{inputs:e,backend:n,attrs:s}=t,{x:o}=e,{axis:r,keepDims:i}=s;De(o,"min");const a=st(r,o.shape);let l=a;const c=jt(l,o.shape.length);let u=o;c!=null&&(u=os({inputs:{x:o},backend:n,attrs:{perm:c}}),l=Zt(l.length,o.shape.length)),_n("min",l,u.shape.length);const[h,d]=yn(u.shape,l),f=ae(d),p=Ln(ae(h),u.dtype),g=n.data.get(u.dataId).values;for(let x=0;x<p.length;++x){const y=x*f;let w=g[y];for(let v=0;v<f;++v){const $=g[y+v];(Number.isNaN($)||$<w)&&(w=$)}p[x]=w}c!=null&&n.disposeIntermediateTensorInfo(u);const b=n.makeTensorInfo(h,u.dtype,p);if(i){const x=Yt(h,a),y=Rt({inputs:{x:b},backend:n,attrs:{shape:x}});return n.disposeIntermediateTensorInfo(b),y}return b}const a9={kernelName:Wf,backendName:"cpu",kernelFunc:i9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l9(t){const{inputs:e,backend:n,attrs:s}=t,{x:o}=e,{paddings:r,mode:i}=s;De(o,"mirrorPad");const a=r.map((w,v)=>w[0]+o.shape[v]+w[1]),l=r.map(w=>w[0]),c=r.map((w,v)=>w[0]+o.shape[v]),u=i==="reflect"?0:1,h=n.data.get(o.dataId).values,d=o.shape.length,f=Ue(o.shape),p=ae(a),g=a.length,b=Ue(a),x=$n(o.dtype,p);for(let w=0;w<p;w++){let v=Vc(w,g,b);for(let _=0;_<g;_++)v[_]<l[_]?v[_]=l[_]*2-v[_]-u:v[_]>=c[_]&&(v[_]=(c[_]-1)*2-v[_]+u);v=v.map((_,E)=>_-l[E]);const $=Fo(v,d,f);x[w]=h[$]}return{dataId:n.write(x,a,o.dtype),shape:a,dtype:o.dtype}}const c9={kernelName:Uf,backendName:"cpu",kernelFunc:l9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const u9=nn((t,e)=>{const n=t%e;return t<0&&e<0||t>=0&&e>=0?n:(n+e)%e}),h9=vn(mu,u9),d9={kernelName:mu,backendName:"cpu",kernelFunc:h9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cN(t){const{inputs:e,backend:n,attrs:s}=t,{logits:o}=e,{dim:r}=s,i=o.shape.length;let a=r;if(a===-1&&(a=i-1),a!==i-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${i} and dim was ${a}`);const l=st([a],o.shape),c=lN({inputs:{x:o},backend:n,attrs:{reductionIndices:l,keepDims:!1}}),u=Yt(c.shape,l),h=Rt({inputs:{x:c},backend:n,attrs:{shape:u}}),d=E0({inputs:{a:o,b:h},backend:n}),f=bT({inputs:{x:d},backend:n}),p=Qu({inputs:{x:f},backend:n,attrs:{axis:l,keepDims:!1}}),g=Rt({inputs:{x:p},backend:n,attrs:{shape:u}}),b=T0({inputs:{a:f,b:g},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),b}const f9={kernelName:ap,backendName:"cpu",kernelFunc:cN};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p9(t){const{inputs:e,backend:n,attrs:s}=t,{logits:o}=e,{numSamples:r,seed:i,normalized:a}=s;De(o,"multinomial");const l=a?o:cN({inputs:{logits:o},backend:n,attrs:{dim:-1}}),c=l.shape[0],u=l.shape[1],h=n.data.get(l.dataId).values,d=[c,r],f=Ln(ae(d),"int32");for(let p=0;p<c;++p){const g=p*u,b=new Float32Array(u-1);b[0]=h[g];for(let w=1;w<b.length;++w)b[w]=b[w-1]+h[g+w];const x=my.alea(i.toString()),y=p*r;for(let w=0;w<r;++w){const v=x();f[y+w]=b.length;for(let $=0;$<b.length;$++)if(v<b[$]){f[y+w]=$;break}}}return a||n.disposeIntermediateTensorInfo(l),n.makeTensorInfo(d,"int32",f)}const m9={kernelName:t_,backendName:"cpu",kernelFunc:p9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g9=Iy;function b9(t){const{inputs:e,backend:n,attrs:s}=t,{boxes:o,scores:r}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l}=s;De(o,"NonMaxSuppression");const c=n.data.get(o.dataId).values,u=n.data.get(r.dataId).values,{selectedIndices:h}=g9(c,u,i,a,l);return n.makeTensorInfo([h.length],"int32",new Int32Array(h))}const x9={kernelName:wx,backendName:"cpu",kernelFunc:b9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y9=_y;function v9(t){const{inputs:e,backend:n,attrs:s}=t,{boxes:o,scores:r}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:c}=s;De(o,"NonMaxSuppressionPadded");const u=n.data.get(o.dataId).values,h=n.data.get(r.dataId).values,{selectedIndices:d,validOutputs:f}=y9(u,h,i,a,l,c);return[n.makeTensorInfo([d.length],"int32",new Int32Array(d)),n.makeTensorInfo([],"int32",new Int32Array([f]))]}const w9={kernelName:Cx,backendName:"cpu",kernelFunc:v9};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C9=ky;function $9(t){const{inputs:e,backend:n,attrs:s}=t,{boxes:o,scores:r}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l,softNmsSigma:c}=s;De(o,"NonMaxSuppressionWithScore");const u=n.data.get(o.dataId).values,h=n.data.get(r.dataId).values,d=i,f=a,p=l,g=c,{selectedIndices:b,selectedScores:x}=C9(u,h,d,f,p,g);return[n.makeTensorInfo([b.length],"int32",new Int32Array(b)),n.makeTensorInfo([x.length],"float32",new Float32Array(x))]}const I9={kernelName:$x,backendName:"cpu",kernelFunc:$9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _9(t){const{inputs:e,backend:n,attrs:s}=t,{indices:o}=e,{dtype:r,depth:i,onValue:a,offValue:l}=s;De(o,"oneHot");const c=ae(o.shape),u=new Float32Array(c*i);u.fill(l);const h=n.data.get(o.dataId).values;for(let d=0;d<c;++d)h[d]>=0&&h[d]<i&&(u[d*i+h[d]]=a);return n.makeTensorInfo([...o.shape,i],r,u)}const k9={kernelName:qf,backendName:"cpu",kernelFunc:_9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zd(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(s.dtype==="complex64"){const o=ta({inputs:{input:s},backend:n}),r=zd({inputs:{x:o},backend:n}),i=dl({inputs:{input:s},backend:n}),a=zd({inputs:{x:i},backend:n}),l=cs({inputs:{real:r,imag:a},backend:n});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),l}else return N0({backend:n,attrs:{shape:s.shape,value:0,dtype:s.dtype}})}const E9={kernelName:up,backendName:"cpu",kernelFunc:zd};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uN(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(s.dtype==="complex64"){const o=ta({inputs:{input:s},backend:n}),r=uN({inputs:{x:o},backend:n}),i=dl({inputs:{input:s},backend:n}),a=zd({inputs:{x:i},backend:n}),l=cs({inputs:{real:r,imag:a},backend:n});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),l}else return N0({backend:n,attrs:{shape:s.shape,value:1,dtype:s.dtype}})}const S9={kernelName:jf,backendName:"cpu",kernelFunc:uN};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hN(t){const{inputs:e,backend:n,attrs:s}=t,{axis:o}=s;if(e.length===1)return Vd({inputs:{input:e[0]},backend:n,attrs:{dim:o}});const r=e[0].shape,i=e[0].dtype;e.forEach(u=>{Ys(r,u.shape,"All tensors passed to stack must have matching shapes"),T(i===u.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],l=e.map(u=>{const h=Vd({inputs:{input:u},backend:n,attrs:{dim:o}});return a.push(h),h}),c=fl({inputs:l,backend:n,attrs:{axis:o}});return a.forEach(u=>n.disposeIntermediateTensorInfo(u)),c}const T9={kernelName:Kf,backendName:"cpu",kernelFunc:hN};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N9(t){const{inputs:e,backend:n,attrs:s}=t,{x:o}=e,{paddings:r,constantValue:i}=s;De(o,"pad");const a=r.map((y,w)=>y[0]+o.shape[w]+y[1]),l=r.map(y=>y[0]),c=n.data.get(o.dataId).values,u=ae(o.shape),h=o.shape.length,d=Ue(o.shape),f=ae(a),p=a.length,g=Ue(a),b=$n(o.dtype,f);i!==0&&b.fill(i);for(let y=0;y<u;y++){const v=Vc(y,h,d).map((_,E)=>_+l[E]),$=Fo(v,p,g);b[$]=c[y]}return{dataId:n.write(b,a,o.dtype),shape:a,dtype:o.dtype}}const dN={kernelName:Xf,backendName:"cpu",kernelFunc:N9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A9=nn((t,e)=>Math.pow(t,e)),R9=vn(bu,A9),D9={kernelName:bu,backendName:"cpu",kernelFunc:R9};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O9(t){const{inputs:e,backend:n,attrs:s}=t,{shape:o,values:r,defaultValue:i,rowPartitionTensors:a}=e,{rowPartitionTypes:l}=s,c=n.data.get(o.dataId).values,u=n.data.get(r.dataId).values,h=n.data.get(i.dataId).values,d=a.map(b=>n.data.get(b.dataId).values),f=a.map(b=>b.shape),[p,g]=OT(c,o.shape,u,r.shape,r.dtype,h,i.shape,d,f,l);return n.makeTensorInfo(p,r.dtype,g)}const F9={kernelName:n_,backendName:"cpu",kernelFunc:O9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L9(t){const{backend:e,attrs:n}=t,{start:s,stop:o,dtype:r,step:i}=n,a=FT(s,o,i,r);return e.makeTensorInfo([a.length],r,a)}const P9={kernelName:Ix,backendName:"cpu",kernelFunc:L9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M9=wt(xu,t=>1/t),B9={kernelName:xu,backendName:"cpu",kernelFunc:M9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V9(t){const{inputs:e,backend:n,attrs:s}=t,{images:o}=e,{alignCorners:r,halfPixelCenters:i,size:a}=s;De(o,"resizeBilinear");const l=Ue(o.shape),[c,u]=a,[h,d,f,p]=o.shape,g=n.data.get(o.dataId).values,b=new Float32Array(ae([h,c,u,p])),x=[r&&c>1?d-1:d,r&&u>1?f-1:f],y=[r&&c>1?c-1:c,r&&u>1?u-1:u];let w=0;const v=x[0]/y[0],$=x[1]/y[1];for(let _=0;_<h;_++)for(let E=0;E<c;E++){let k;i?k=v*(E+.5)-.5:k=v*E;const N=Math.max(0,Math.floor(k)),A=k-N,F=Math.min(d-1,Math.ceil(k)),L=_*l[0]+N*l[1],H=_*l[0]+F*l[1];for(let M=0;M<u;M++){let K;i?K=$*(M+.5)-.5:K=$*M;const q=Math.max(0,Math.floor(K)),Q=K-q,Y=Math.min(f-1,Math.ceil(K)),ie=L+q*l[2],pe=H+q*l[2],he=L+Y*l[2],xe=H+Y*l[2];for(let me=0;me<p;me++){const Ie=g[ie+me],G=g[pe+me],le=g[he+me],ne=g[xe+me],B=Ie+(le-Ie)*Q,$e=G+(ne-G)*Q,Se=B+($e-B)*A;b[w++]=Se}}}return n.makeTensorInfo([h,c,u,p],"float32",b)}const z9={kernelName:ep,backendName:"cpu",kernelFunc:V9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W9(t){const{inputs:e,backend:n,attrs:s}=t,{images:o,dy:r}=e,{alignCorners:i}=s;De([r,o],"resizeBilinearGrad");const a=Ue(o.shape),[l,c,u,h]=o.shape,[,d,f]=r.shape,p=new Float32Array(l*c*u*h),g=[i&&d>1?c-1:c,i&&f>1?u-1:u],b=[i&&d>1?d-1:d,i&&f>1?f-1:f],x=g[0]/b[0],y=g[1]/b[1],w=n.data.get(r.dataId).values;let v=0;for(let $=0;$<l;$++){const _=$*a[0];for(let E=0;E<d;E++){const k=E*x,N=Math.floor(k),A=Math.min(Math.ceil(k),c-1),F=_+N*a[1],L=_+A*a[1],H=k-N,M=1-H;for(let K=0;K<f;K++){const q=K*y,Q=Math.floor(q),Y=Math.min(Math.ceil(q),u-1),ie=q-Q,pe=1-ie,he=F+Q*a[2],xe=F+Y*a[2],me=L+Q*a[2],Ie=L+Y*a[2],G=M*pe,le=M*ie,ne=H*pe,B=H*ie;for(let $e=0;$e<h;$e++){const Se=w[v++];p[he+$e]+=Se*G,p[xe+$e]+=Se*le,p[me+$e]+=Se*ne,p[Ie+$e]+=Se*B}}}}return n.makeTensorInfo([l,u,c,h],"float32",p)}const U9={kernelName:Ex,backendName:"cpu",kernelFunc:W9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H9(t){const{inputs:e,backend:n,attrs:s}=t,{images:o}=e,{alignCorners:r,halfPixelCenters:i,size:a}=s;De(o,"resizeNearestNeighbor");const l=Ue(o.shape),[c,u]=a,[h,d,f,p]=o.shape,g=n.data.get(o.dataId).values,b=new Float32Array(h*c*u*p),x=[r&&c>1?d-1:d,r&&u>1?f-1:f],y=[r&&c>1?c-1:c,r&&u>1?u-1:u],w=x[0]/y[0],v=x[1]/y[1];let $=0;for(let _=0;_<h;_++){const E=_*l[0];for(let k=0;k<c;k++){const N=i?w*(k+.5):w*k;let A=Math.min(d-1,r?Math.round(N):Math.floor(N));i&&(A=Math.max(0,A));const F=E+A*l[1];for(let L=0;L<u;L++){const H=i?v*(L+.5):v*L;let M=Math.min(f-1,r?Math.round(H):Math.floor(H));i&&(M=Math.max(0,M));const K=F+M*l[2];for(let q=0;q<p;q++){const Q=g[K+q];b[$++]=Q}}}}return n.makeTensorInfo([h,c,u,p],o.dtype,b)}const G9={kernelName:Jf,backendName:"cpu",kernelFunc:H9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j9(t){const{inputs:e,backend:n,attrs:s}=t,{images:o,dy:r}=e,{alignCorners:i}=s;De([r,o],"resizeNearestNeighborGrad");const a=Ue(o.shape),l=Ue(r.shape),[c,u,h,d]=o.shape,[,f,p]=r.shape,g=new Float32Array(c*u*h*d),b=n.data.get(r.dataId).values,x=[i&&f>1?u-1:u,i&&p>1?h-1:h],y=[i&&f>1?f-1:f,i&&p>1?p-1:p],w=x[0]/y[0],v=x[1]/y[1],$=1/w,_=1/v,E=Math.ceil($)*2+2,k=Math.ceil(_)*2+2;for(let N=0;N<c;N++){const A=N*a[0];for(let F=0;F<u;F++){const L=A+F*a[1],H=Math.floor(F*$),M=Math.floor(H-E/2);for(let K=0;K<h;K++){const q=L+K*a[2],Q=Math.floor(K*_),Y=Math.floor(Q-k/2);for(let ie=0;ie<d;ie++){let pe=0;for(let he=0;he<E;he++){const xe=he+M;if(xe<0||xe>=f)continue;const me=A+xe*l[1],Ie=xe*w,G=Math.min(u-1,i?Math.round(Ie):Math.floor(Ie));if(F===G)for(let le=0;le<k;le++){const ne=le+Y;if(ne<0||ne>=p)continue;const B=me+ne*l[2],$e=ne*v,Se=Math.min(h-1,i?Math.round($e):Math.floor($e));K===Se&&(pe+=b[B+ie])}}g[q+ie]=pe}}}}return n.makeTensorInfo(o.shape,o.dtype,g)}const q9={kernelName:kx,backendName:"cpu",kernelFunc:j9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K9(t){const{inputs:e,backend:n,attrs:s}=t,{x:o}=e,{dims:r}=s;De(o,"reverse");const i=o.shape.length,a=st(r,o.shape);if(i===0)return Go({inputs:{x:o},backend:n});const l=new Rn(o.shape,o.dtype),c=n.bufferSync(o);for(let u=0;u<l.size;u++){const h=l.indexToLoc(u),d=h.slice();a.forEach(f=>d[f]=o.shape[f]-1-d[f]),l.set(c.get(...d),...h)}return n.makeTensorInfo(l.shape,l.dtype,l.values)}const X9={kernelName:tp,backendName:"cpu",kernelFunc:K9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Y9={kernelName:Vx,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:s}=t,{radians:o,fillValue:r,center:i}=e,a=n,l=$n(s.dtype,ae(s.shape)),[c,u,h,d]=s.shape,[f,p]=Ly(i,u,h),g=255,b=Math.sin(o),x=Math.cos(o),y=a.data.get(s.dataId).values;for(let v=0;v<c;v++){const $=v*h*u*d;for(let _=0;_<u;_++){const E=_*(h*d);for(let k=0;k<h;k++){const N=k*d;for(let A=0;A<d;A++){const F=[c,_,k,A],L=F[2],H=F[1];let M=(L-f)*x-(H-p)*b,K=(L-f)*b+(H-p)*x;M=Math.round(M+f),K=Math.round(K+p);let q=r;if(typeof r!="number"&&(A===3?q=g:q=r[A]),M>=0&&M<h&&K>=0&&K<u){const Y=K*(h*d),ie=M*d,pe=$+Y+ie+A;q=y[pe]}const Q=$+E+N+A;l[Q]=q}}}}return{dataId:a.write(l,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Z9=wt(wu,t=>{const e=Math.floor(t);return t-e<.5?Math.floor(t):t-e>.5?Math.ceil(t):e%2===0?e:e+1}),Q9={kernelName:wu,backendName:"cpu",kernelFunc:Z9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J9(t){const{inputs:e,backend:n,attrs:s}=t,{indices:o,updates:r}=e,{shape:i}=s,{sliceRank:a,numUpdates:l,sliceSize:c,strides:u,outputSize:h}=Lu(r,o,i),d=!0,f=n.bufferSync(o),p=n.bufferSync(r),g=Ba(f,p,i,h,c,l,a,u,0,d);return n.makeTensorInfo(i,g.dtype,g.values)}const eZ={kernelName:s_,backendName:"cpu",kernelFunc:J9};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tZ(t,e){let n=0,s=t.length,o=0;for(;n<s;)o=Math.floor((n+s)/2),t[o]<e?n=o+1:s=o;return s}function nZ(t,e){let n=0,s=t.length,o=0;for(;n<s;)o=Math.floor((n+s)/2),t[o]<=e?n=o+1:s=o;return s}function sZ(t,e,n,s,o,r){const i=An("int32",n*o);for(let a=0;a<n;++a){const l=t.slice(a*s,(a+1)*s),c=a*o;for(let u=0;u<o;++u)i[c+u]=r==="left"?tZ(l,e[u+c]):nZ(l,e[u+c])}return i}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oZ(t){const{inputs:e,backend:n,attrs:s}=t,{sortedSequence:o,values:r}=e,{side:i}=s,a=n.data.get(o.dataId).values,l=n.data.get(r.dataId).values,c=sZ(a,l,o.shape[0],o.shape[1],r.shape[1],i);return n.makeTensorInfo(r.shape,"int32",c)}const rZ={kernelName:o_,backendName:"cpu",kernelFunc:oZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iZ(t){const{inputs:e,backend:n}=t,{condition:s,t:o,e:r}=e;De([s,o,r],"select");const i=s.shape.length,a=n.data.get(s.dataId).values,l=n.data.get(o.dataId).values,c=n.data.get(r.dataId).values,u=ds(o.dtype,r.dtype),h=Ln(ae(o.shape),u);let d=0;const f=i===0||i>1||o.shape.length===1?1:ae(o.shape.slice(1));for(let p=0;p<a.length;p++)for(let g=0;g<f;g++)a[p]===1?h[d++]=l[p]:h[d++]=c[p];return n.makeTensorInfo(o.shape,u,h)}const aZ={kernelName:np,backendName:"cpu",kernelFunc:iZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lZ=_p,cZ=kp,uZ=wt($u,t=>t>=0?cZ*t:lZ*(Math.exp(t)-1)),hZ={kernelName:$u,backendName:"cpu",kernelFunc:uZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dZ=wt(ku,t=>t<0?-1:t>0?1:0),fZ={kernelName:ku,backendName:"cpu",kernelFunc:dZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pZ=wt(Iu,t=>Math.sin(t)),mZ={kernelName:Iu,backendName:"cpu",kernelFunc:pZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gZ=wt(_u,t=>Math.sinh(t)),bZ={kernelName:_u,backendName:"cpu",kernelFunc:gZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xZ=11920928955078125e-23,kC=Math.log(xZ)+2,yZ=wt(Su,t=>{const e=t>-kC,n=t<kC,s=Math.exp(t);let o;return n?o=s:e?o=t:o=Math.log(1+s),o}),vZ={kernelName:Su,backendName:"cpu",kernelFunc:yZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wZ(t){const{inputs:e,backend:n,attrs:s}=t,{x:o}=e,{blockShape:r,paddings:i}=s;De([o],"spaceToBatchND");const a=ae(r),l=[[0,0]];l.push(...i);for(let _=1+r.length;_<o.shape.length;++_)l.push([0,0]);const c=dN.kernelFunc({inputs:{x:o},backend:n,attrs:{paddings:l,constantValue:0}}),u=zu(c.shape,r,a,!1),h=Wu(u.length,r.length,!1),d=Uu(c.shape,r,a,!1),g=Rt({inputs:{x:c},backend:n,attrs:{shape:u}}),y=os({inputs:{x:g},backend:n,attrs:{perm:h}}),$=Rt({inputs:{x:y},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),$}const CZ={kernelName:rp,backendName:"cpu",kernelFunc:wZ};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Z(t){const{inputs:e,backend:n}=t,{indices:s,values:o,denseShape:r,defaultValue:i}=e;if(r.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${r.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${s.shape}`);if(o.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${o.shape}`);if(i.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${i.shape}`);const a=n.data.get(s.dataId).values,l=n.data.get(o.dataId).values,c=n.data.get(r.dataId).values,u=n.data.get(i.dataId).values[0],[h,d,f,p,g]=BT(a,s.shape,s.dtype,l,o.dtype,c,u);return[n.makeTensorInfo(d,s.dtype,h),n.makeTensorInfo([d[0]],o.dtype,f),n.makeTensorInfo([p.length],"bool",new Uint8Array(p.map(b=>Number(b)))),n.makeTensorInfo([g.length],s.dtype,new Int32Array(g))]}const IZ={kernelName:Sx,backendName:"cpu",kernelFunc:$Z};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Z(t){const{inputs:e,backend:n}=t,{inputIndices:s,inputShape:o,newShape:r}=e;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${s.shape}`);if(o.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${o.shape}`);if(r.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${r.shape}`);const i=Array.from(n.data.get(o.dataId).values),a=n.data.get(s.dataId).values,l=Array.from(n.data.get(r.dataId).values),[c,u,h]=VT(a,s.shape,s.dtype,i,l);return[n.makeTensorInfo(u,s.dtype,c),n.makeTensorInfo([h.length],r.dtype,new Int32Array(h))]}const kZ={kernelName:Tx,backendName:"cpu",kernelFunc:_Z};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EZ(t){const{inputs:e,backend:n}=t,{data:s,indices:o,segmentIds:r}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(o.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${o.shape}`);if(r.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${r.shape}`);if(o.shape[0]!==r.shape[0])throw new Error("segmentIds and indices should have same size.");const i=n.data.get(s.dataId).values,a=n.data.get(o.dataId).values,l=n.data.get(r.dataId).values,[c,u]=k0(i,s.shape,s.dtype,a,l,!0);return n.makeTensorInfo(u,s.dtype,c)}const SZ={kernelName:Nx,backendName:"cpu",kernelFunc:EZ};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TZ(t){const{inputs:e,backend:n}=t,{data:s,indices:o,segmentIds:r}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(o.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${o.shape}`);if(r.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${r.shape}`);if(o.shape[0]!==r.shape[0])throw new Error("segmentIds and indices should have same size.");const i=n.data.get(s.dataId).values,a=n.data.get(o.dataId).values,l=n.data.get(r.dataId).values,[c,u]=k0(i,s.shape,s.dtype,a,l);return n.makeTensorInfo(u,s.dtype,c)}const NZ={kernelName:Ax,backendName:"cpu",kernelFunc:TZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AZ(t){const{inputs:e,backend:n,attrs:s}=t,{sparseIndices:o,sparseValues:r,defaultValue:i}=e,{outputShape:a}=s,{sliceRank:l,numUpdates:c,sliceSize:u,strides:h,outputSize:d}=Lu(r,o,a),f=!1,p=n.bufferSync(o);let g;switch(r.dtype){case"bool":{const b=n.bufferSync(r),x=Boolean(n.data.get(i.dataId).values[0]);g=Ba(p,b,a,d,u,c,l,h,x,f);break}case"float32":{const b=n.bufferSync(r),x=n.data.get(i.dataId).values[0];g=Ba(p,b,a,d,u,c,l,h,x,f);break}case"int32":{const b=n.bufferSync(r),x=n.data.get(i.dataId).values[0];g=Ba(p,b,a,d,u,c,l,h,x,f);break}case"string":{const b=n.bufferSync(r),x=Mr(n.data.get(i.dataId).values[0]);g=Ba(p,b,a,d,u,c,l,h,x,f);break}default:throw new Error(`Unsupported type ${r.dtype}`)}return n.makeTensorInfo(a,g.dtype,g.values)}const RZ={kernelName:r_,backendName:"cpu",kernelFunc:AZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DZ(t){const{inputs:e,backend:n,attrs:s}=t,{x:o}=e,{numOrSizeSplits:r,axis:i}=s,a=st(i,o.shape)[0],l=Zy(o,r,a),c=new Array(o.shape.length).fill(0),u=o.shape.slice();return l.map(h=>{const d=[...u];d[a]=h;const f=na({inputs:{x:o},backend:n,attrs:{begin:c,size:d}});return c[a]+=h,f})}const OZ={kernelName:ip,backendName:"cpu",kernelFunc:DZ};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FZ={kernelName:Rx,backendName:"cpu",kernelFunc:({inputs:t,backend:e})=>{const{x:n}=t,s=e;De(n,"square");const o=s.data.get(n.dataId).values,r=new Float32Array(o.length);for(let a=0;a<o.length;++a){const l=o[a];r[a]=l*l}return{dataId:s.write(r,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LZ=wt(Fu,(t,e)=>{const n=e;return isNaN(t)?NaN:t>0?1:n.alpha}),PZ={kernelName:Fu,backendName:"cpu",kernelFunc:LZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MZ(t){const{inputs:e,backend:n,attrs:s}=t,{x:o}=e,{begin:r,end:i,strides:a,beginMask:l,endMask:c,ellipsisMask:u,newAxisMask:h,shrinkAxisMask:d}=s;De(o,"stridedSlice");const{finalShapeSparse:f,finalShape:p,isIdentity:g,sliceDim0:b,isSimpleSlice:x,begin:y,end:w,strides:v}=Zx(o.shape,r,i,a,l,c,u,h,d);let $;if(g)$=Rt({inputs:{x:o},backend:n,attrs:{shape:p}});else if(b||x){T(o.shape.length>=1,()=>`Input must have rank at least 1, got: ${o.shape.length}`);const _=Kx(y,w,v),E=na({inputs:{x:o},backend:n,attrs:{begin:y,size:_}});$=Rt({inputs:{x:E},backend:n,attrs:{shape:p}}),n.disposeIntermediateTensorInfo(E)}else{const _=n.bufferSync(o),E=WT(f,_,v,y);$=n.makeTensorInfo(p,E.dtype,E.values)}return $}const BZ={kernelName:Dx,backendName:"cpu",kernelFunc:MZ};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VZ(t){const{inputs:e,backend:n,attrs:s}=t,{separator:o,nGramWidths:r,leftPad:i,rightPad:a,padWidth:l,preserveShortSequences:c}=s,{data:u,dataSplits:h}=e,d=n.data.get(u.dataId).values,f=n.data.get(h.dataId).values,[p,g]=UT(d,f,o,r,i,a,l,c);return[n.makeTensorInfo([p.length],"string",p),n.makeTensorInfo(h.shape,"int32",g)]}const zZ={kernelName:Ox,backendName:"cpu",kernelFunc:VZ};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WZ(t){const{inputs:e,backend:n,attrs:s}=t,{skipEmpty:o}=s,{input:r,delimiter:i}=e;if(r.dtype!=="string")throw new Error("Input must be of datatype string");if(r.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${r.shape}`);if(i.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${i.shape}`);const a=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values[0],[c,u,h]=HT(a,l,o),d=u.length;return[n.makeTensorInfo([d,2],"int32",c),n.makeTensorInfo([d],"string",u),n.makeTensorInfo([2],"int32",new Int32Array(h))]}const UZ={kernelName:Fx,backendName:"cpu",kernelFunc:WZ};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HZ(t){const{inputs:e,backend:n,attrs:s}=t,{numBuckets:o}=s,{input:r}=e;if(r.dtype!=="string")throw new Error("Input must be of datatype string");if(o<=0)throw new Error("Number of buckets must be at least 1");const i=n.data.get(r.dataId).values,a=GT(i,o);return n.makeTensorInfo(r.shape,"int32",a)}const GZ={kernelName:Lx,backendName:"cpu",kernelFunc:HZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jZ=wt(Ru,t=>Math.tan(t)),qZ={kernelName:Ru,backendName:"cpu",kernelFunc:jZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KZ=wt(Du,t=>Math.tanh(t)),XZ={kernelName:Du,backendName:"cpu",kernelFunc:KZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YZ(t){const{inputs:e,backend:n,attrs:s}=t,{x:o}=e,{reps:r}=s;De(o,"tile");const i=qT(n.bufferSync(o),r);return n.makeTensorInfo(i.shape,i.dtype,i.values)}const ZZ={kernelName:Ou,backendName:"cpu",kernelFunc:YZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QZ(t){const{inputs:e,backend:n,attrs:s}=t,{x:o}=e,{k:r,sorted:i}=s;De(o,"topk");const a=n.data.get(o.dataId).values,[l,c]=XT(a,o.shape,o.dtype,r,i);return[n.makeTensorInfo(l.shape,l.dtype,l.values),n.makeTensorInfo(c.shape,c.dtype,c.values)]}const JZ={kernelName:Px,backendName:"cpu",kernelFunc:QZ};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eQ(t){const{inputs:e,attrs:n,backend:s}=t,{image:o,transforms:r}=e,{interpolation:i,fillMode:a,fillValue:l,outputShape:c}=n,[u,h,d,f]=o.shape,[p,g]=c!=null?c:[h,d],b=[u,p,g,f],x=Ue(o.shape),y=x[0],w=x[1],v=x[2],$=Ue(b),_=$[0],E=$[1],k=$[2],N=$n(o.dtype,ae(b));N.fill(l);const A=s.data.get(o.dataId).values,F=s.data.get(r.dataId).values;for(let H=0;H<u;++H){const M=r.shape[0]===1?F:F.subarray(H*8,H*8+8);for(let K=0;K<p;++K)for(let q=0;q<g;++q)for(let Q=0;Q<f;++Q){let Y;const ie=M[6]*q+M[7]*K+1;if(ie===0)continue;const pe=(M[0]*q+M[1]*K+M[2])/ie,he=(M[3]*q+M[4]*K+M[5])/ie,xe=EC(pe,d,a),me=EC(he,h,a);switch(i){case"nearest":Y=iQ(A,h,d,y,w,v,H,me,xe,Q,l);break;case"bilinear":Y=aQ(A,h,d,y,w,v,H,me,xe,Q,l);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${i}`)}const Ie=H*_+K*E+q*k+Q;N[Ie]=Y}return s.makeTensorInfo(b,o.dtype,N)}return{dataId:s.write(N,b,o.dtype),shape:o.shape,dtype:o.dtype}}const tQ={kernelName:Mx,backendName:"cpu",kernelFunc:eQ};function EC(t,e,n){switch(n){case"reflect":return nQ(t,e);case"wrap":return sQ(t,e);case"nearest":return rQ(t,e);case"constant":default:return oQ(t)}}function nQ(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const s=2*e;n<s&&(n=s*Math.trunc(-n/s)+n),n=n<-e?n+s:-n-1}else if(n>e-1)if(e<=1)n=0;else{const s=2*e;n-=s*Math.trunc(n/s),n>=e&&(n=s-n-1)}return Ui(0,n,e-1)}function sQ(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const s=e-1;n+=e*(Math.trunc(-n/s)+1)}else if(n>e-1)if(e<=1)n=0;else{const s=e-1;n-=e*Math.trunc(n/s)}return Ui(0,n,e-1)}function oQ(t,e){return t}function rQ(t,e){return Ui(0,t,e-1)}function ic(t,e,n,s,o,r,i,a,l,c,u){const h=i*s+a*o+l*r+c;return 0<=a&&a<e&&0<=l&&l<n?t[h]:u}function iQ(t,e,n,s,o,r,i,a,l,c,u){const h=Math.round(a),d=Math.round(l);return ic(t,e,n,s,o,r,i,h,d,c,u)}function aQ(t,e,n,s,o,r,i,a,l,c,u){const h=Math.floor(a),d=Math.floor(l),f=h+1,p=d+1,g=(p-l)*ic(t,e,n,s,o,r,i,h,d,c,u)+(l-d)*ic(t,e,n,s,o,r,i,h,p,c,u),b=(p-l)*ic(t,e,n,s,o,r,i,f,d,c,u)+(l-d)*ic(t,e,n,s,o,r,i,f,p,c,u);return(f-a)*g+(a-h)*b}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lQ(t){const{inputs:e,attrs:n,backend:s}=t,{axis:o}=n,{x:r}=e;De(r,"unique");const i=s.data.get(r.dataId).values,{outputValues:a,outputShape:l,indices:c}=YT(i,o,r.shape,r.dtype);return[s.makeTensorInfo(l,r.dtype,a),s.makeTensorInfo([c.length],"int32",c)]}const cQ={kernelName:Bx,backendName:"cpu",kernelFunc:lQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uQ(t){const{inputs:e,backend:n,attrs:s}=t,{value:o}=e;let{axis:r}=s;r<0&&(r+=o.shape.length);const i=o.shape.length,a=o.shape[r],l=new Array(i-1);let c=0;for(let f=0;f<i;f++)f!==r&&(l[c++]=o.shape[f]);const u=new Array(i).fill(0),h=o.shape.slice();h[r]=1;const d=new Array(a);for(let f=0;f<d.length;f++){u[r]=f;const p=na({inputs:{x:o},backend:n,attrs:{begin:u,size:h}});d[f]=Rt({inputs:{x:p},backend:n,attrs:{shape:l}}),n.disposeIntermediateTensorInfo(p)}return d}const hQ={kernelName:lp,backendName:"cpu",kernelFunc:uQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dQ(t){const{inputs:e,backend:n,attrs:s}=t,{x:o,segmentIds:r}=e,{numSegments:i}=s;De(o,"unsortedSegmentSum");const a=o.shape.length,l=r.shape.length,c=[],u=[],h=a-l;let d=r;for(let p=0;p<h;++p){const g=Vd({inputs:{input:d},backend:n,attrs:{dim:p+1}});d=g,u.push(g)}for(let p=0;p<i;++p){const g=qr(p,"int32"),b=n.makeTensorInfo([],"int32",g),x=mT({inputs:{a:b,b:d},backend:n}),y=Ur({inputs:{x},backend:n,attrs:{dtype:"float32"}}),w=Bp({inputs:{a:y,b:o},backend:n}),v=Qu({inputs:{x:w},backend:n,attrs:{axis:0,keepDims:!1}});c.push(v),u.push(b),u.push(x),u.push(y),u.push(w),u.push(v)}const f=hN({inputs:c,backend:n,attrs:{axis:0}});return u.forEach(p=>n.disposeIntermediateTensorInfo(p)),f}const fQ={kernelName:cp,backendName:"cpu",kernelFunc:dQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pQ=[f8,r5,m8,b8,h5,y8,w8,$8,_8,E8,T8,A8,D8,L8,M8,z8,U8,G8,q8,h8,X8,Z8,J8,tY,c5,f5,sY,i5,rY,aY,lY,uY,dY,pY,gY,xY,vY,CY,IY,kY,SY,NY,RY,DY,FY,PY,BY,VY,zY,WY,GY,o8,qY,p5,t7,m5,n7,b5,l7,c7,h7,y5,p7,g7,x7,v7,C7,w5,$5,a5,I7,iY,k7,S7,N7,r8,_5,E5,R7,T5,O7,P7,B7,W7,H7,j7,q7,A5,X7,Z7,J7,t9,s9,r9,a9,D5,c9,d9,m9,F5,P5,x9,w9,I9,B5,k9,S9,T9,dN,D9,a8,W5,F9,P9,l5,pb,B9,l8,c8,u8,z9,U9,G9,q9,X9,Y9,Q9,H5,eZ,rZ,aZ,hZ,j5,fZ,mZ,bZ,q5,f9,vZ,CZ,IZ,kZ,SZ,NZ,RZ,OZ,Y5,FZ,Q5,PZ,BZ,zZ,UZ,GZ,n8,UY,qZ,XZ,ZZ,JZ,tQ,V5,cQ,hQ,fQ,E9];for(const t of pQ)a_(t);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Si={},Uh={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function mQ(t,e){Si[t]=e}function yo(t,e){if(!(t in Si)||e!=null){const s=bQ(t,e);if(s!==null)Si[t]=s;else return console.log("Could not get context for WebGL version",t),null}const n=Si[t];return n==null||n.isContextLost()?(delete Si[t],yo(t)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),Si[t])}function gQ(t){if(typeof OffscreenCanvas<"u"&&t===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function bQ(t,e){if(t!==1&&t!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const n=e==null?gQ(t):e;return n.addEventListener("webglcontextlost",s=>{s.preventDefault(),delete Si[t]},!1),se().getBool("SOFTWARE_WEBGL_ENABLED")&&(Uh.failIfMajorPerformanceCaveat=!1),t===1?n.getContext("webgl",Uh)||n.getContext("experimental-webgl",Uh):n.getContext("webgl2",Uh)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Ac;(function(t){t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH"})(Ac||(Ac={}));var Is;(function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"})(Is||(Is={}));var Cn;(function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(Cn||(Cn={}));function Ju(t,e){return[e,t]}function xQ(t,e){return t*e}function Hh(t){const e=ae(t),n=Math.ceil(e/4);return Rg(n)}function Al(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function yQ(t,e){const[n,s]=Al(t,e);return n*s*4}function A0(t,e){const n=t;let s,o,r,i,a,l,c,u,h,d;return se().getNumber("WEBGL_VERSION")===2?(s=n.R32F,o=n.R16F,r=n.RGBA16F,i=n.RGBA32F,a=n.RED,c=4,u=1,h=n.HALF_FLOAT,d=n.FLOAT,l=n.RGBA8):(s=t.RGBA,o=t.RGBA,r=t.RGBA,i=n.RGBA,a=t.RGBA,c=4,u=4,h=e!=null?e.HALF_FLOAT_OES:null,d=t.FLOAT,l=t.RGBA),{internalFormatFloat:s,internalFormatHalfFloat:o,internalFormatPackedHalfFloat:r,internalFormatPackedFloat:i,textureFormatFloat:a,downloadTextureFormat:l,downloadUnpackNumChannels:c,defaultNumChannels:u,textureTypeHalfFloat:h,textureTypeFloat:d}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fe(t,e){const n=e();return se().getBool("DEBUG")&&vQ(t),n}function vQ(t){const e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+IQ(t,e))}const wQ=596e-10,CQ=65504;function $Q(t){return!!(se().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||t===0||wQ<Math.abs(t)&&Math.abs(t)<CQ)}function IQ(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${e}`}}function Gh(t,e){return fr(t,()=>t.getExtension(e),'Extension "'+e+'" not supported on this browser.')}function _Q(t,e){const n=fr(t,()=>t.createShader(t.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(Fe(t,()=>t.shaderSource(n,e)),Fe(t,()=>t.compileShader(n)),t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw console.log(t.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function kQ(t,e){const n=fr(t,()=>t.createShader(t.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(Fe(t,()=>t.shaderSource(n,e)),Fe(t,()=>t.compileShader(n)),se().get("ENGINE_COMPILE_ONLY"))return n;if(t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw fN(e,t.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}const EQ=/ERROR: [0-9]+:([0-9]+):/g;function fN(t,e){const n=EQ.exec(e);if(n==null){console.log(`Couldn't parse line number in error: ${e}`),console.log(t);return}const s=+n[1],o=t.split(`
`),r=o.length.toString().length+2,i=o.map((h,d)=>Ga((d+1).toString(),r)+h);let a=0;for(let h=0;h<i.length;h++)a=Math.max(i[h].length,a);const l=i.slice(0,s-1),c=i.slice(s-1,s),u=i.slice(s);console.log(l.join(`
`)),console.log(e.split(`
`)[0]),console.log(`%c ${Ga(c[0],a)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(u.join(`
`))}function SQ(t){return fr(t,()=>t.createProgram(),"Unable to create WebGLProgram.")}function TQ(t,e){if(Fe(t,()=>t.linkProgram(e)),!se().get("ENGINE_COMPILE_ONLY")&&t.getProgramParameter(e,t.LINK_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function Qm(t,e){if(Fe(t,()=>t.validateProgram(e)),t.getProgramParameter(e,t.VALIDATE_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function NQ(t,e){const n=fr(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return Fe(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),Fe(t,()=>t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function AQ(t,e){const n=fr(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return Fe(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n)),Fe(t,()=>t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function RQ(t){return fr(t,()=>t.createTexture(),"Unable to create WebGLTexture.")}function DQ(t,e){const n=se().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0){const s=`[${t}x${e}]`;throw new Error("Requested texture size "+s+" is invalid.")}if(t>n||e>n){const s=`[${t}x${e}]`,o=`[${n}x${n}]`;throw new Error("Requested texture size "+s+" greater than WebGL maximum on this browser / GPU "+o+".")}}function OQ(t){return fr(t,()=>t.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function SC(t,e,n,s,o,r,i){const a=t.getAttribLocation(e,n);return a===-1?!1:(Fe(t,()=>t.bindBuffer(t.ARRAY_BUFFER,s)),Fe(t,()=>t.vertexAttribPointer(a,o,t.FLOAT,!1,r,i)),Fe(t,()=>t.enableVertexAttribArray(a)),!0)}function FQ(t,e,n){VQ(t,n),Fe(t,()=>t.activeTexture(t.TEXTURE0+n)),Fe(t,()=>t.bindTexture(t.TEXTURE_2D,e))}function LQ(t,e,n){return fr(t,()=>t.getUniformLocation(e,n),'uniform "'+n+'" not present in program.')}function PQ(t,e,n){return t.getUniformLocation(e,n)}function MQ(t,e,n,s){Fe(t,()=>FQ(t,e,s)),Fe(t,()=>t.uniform1i(n,s))}function Jm(t,e,n){Fe(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,n)),Fe(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0))}function TC(t,e){Fe(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,e)),Fe(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0))}function jh(t){const e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+BQ(t,e))}function BQ(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${e}`}}function fr(t,e,n){const s=Fe(t,()=>e());if(s==null)throw new Error(n);return s}function VQ(t,e){const n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,s=e+t.TEXTURE0;if(s<t.TEXTURE0||s>n){const o=`[gl.TEXTURE0, gl.TEXTURE${n}]`;throw new Error(`textureUnit must be in ${o}.`)}}function pl(t,e=2){return ae(t.slice(0,t.length-e))}function ml(t){if(t.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function eg(t){let e=[1,1,1];return t.length===0||t.length===1&&t[0]===1||(e=[pl(t),...ml(t)]),e}function zQ(t,e=!1){let n=se().getNumber("WEBGL_MAX_TEXTURE_SIZE");e&&(n=n*2,t=t.map((o,r)=>r>=t.length-2?Kb(t[r]):t[r]),t.length===1&&(t=[2,t[0]])),t.length!==2&&(t=Gr(t).newShape);let s=ae(t);if(t.length<=1&&s<=n)return[1,s];if(t.length===2&&t[0]<=n&&t[1]<=n)return t;if(t.length===3&&t[0]*t[1]<=n&&t[2]<=n)return[t[0]*t[1],t[2]];if(t.length===3&&t[0]<=n&&t[1]*t[2]<=n)return[t[0],t[1]*t[2]];if(t.length===4&&t[0]*t[1]*t[2]<=n&&t[3]<=n)return[t[0]*t[1]*t[2],t[3]];if(t.length===4&&t[0]<=n&&t[1]*t[2]*t[3]<=n)return[t[0],t[1]*t[2]*t[3]];if(e){const o=pl(t);let r=2,i=2;return t.length&&([r,i]=ml(t)),s=o*(r/2)*(i/2),Rg(s).map(a=>a*2)}return Rg(s)}function qh(t){return t%2===0}function Wd(t,e){if(t=t.slice(-2),e=e.slice(-2),bt(t,e)||!t.length||!e.length||t[0]===0||t[1]===0||e[0]===0||e[1]===0)return!0;if(t.length!==e.length){const n=t.slice(-1)[0],s=e.slice(-1)[0];if(n===s||qh(n)&&qh(s)&&(t[0]===1||e[0]===1))return!0}return t[1]===e[1]&&qh(t[0])&&qh(e[0])}let tg,ng;function WQ(t){if(tg==null){const e=yo(t);tg=e.getParameter(e.MAX_TEXTURE_SIZE)}return tg}function UQ(t){if(ng==null){const e=yo(t);ng=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,ng)}function HQ(t){if(t===0)return 0;let e;const n=yo(t);return Hs(n,"EXT_disjoint_timer_query_webgl2")&&t===2?e=2:Hs(n,"EXT_disjoint_timer_query")?e=1:e=0,e}function Hs(t,e){return t.getExtension(e)!=null}function NC(t){try{if(yo(t)!=null)return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function GQ(t){if(t===0)return!1;const e=yo(t);if(t===1){if(!Hs(e,"OES_texture_float"))return!1}else if(!Hs(e,"EXT_color_buffer_float"))return!1;return gb(e)}function jQ(t){if(t===0)return!1;const e=yo(t);if(t===1){if(!Hs(e,"OES_texture_float")||!Hs(e,"WEBGL_color_buffer_float"))return!1}else{if(Hs(e,"EXT_color_buffer_float"))return gb(e);const s="EXT_color_buffer_half_float";if(Hs(e,s)){const o=e.getExtension(s);return qQ(e,o)}return!1}return gb(e)}function gb(t){const e=A0(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n);const s=1,o=1;t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,s,o,0,e.textureFormatFloat,e.textureTypeFloat,null);const r=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,r),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);const i=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(r),i}function qQ(t,e){const n=A0(t,e),s=t.createTexture();t.bindTexture(t.TEXTURE_2D,s);const o=1,r=1;t.texImage2D(t.TEXTURE_2D,0,n.internalFormatHalfFloat,o,r,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const i=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,i),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,s,0);const a=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(s),t.deleteFramebuffer(i),a}function KQ(t){return t!==2?!1:yo(t).fenceSync!=null}function eh(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&T(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the WebGL backend.`)})}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const We=se();We.registerFlag("HAS_WEBGL",()=>We.getNumber("WEBGL_VERSION")>0);We.registerFlag("WEBGL_VERSION",()=>NC(2)?2:NC(1)?1:0);We.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);We.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>We.get("WEBGL_VERSION")===2);We.registerFlag("WEBGL_CPU_FORWARD",()=>!0);We.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);We.registerFlag("WEBGL_PACK",()=>We.getBool("HAS_WEBGL"));We.registerFlag("WEBGL_PACK_NORMALIZATION",()=>We.getBool("WEBGL_PACK"));We.registerFlag("WEBGL_PACK_CLIP",()=>We.getBool("WEBGL_PACK"));We.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>We.getBool("WEBGL_PACK"));We.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>We.getBool("WEBGL_PACK"));We.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>We.getBool("WEBGL_PACK"));We.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>We.getBool("WEBGL_PACK"));We.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>We.getBool("WEBGL_PACK"));We.registerFlag("WEBGL_PACK_REDUCE",()=>We.getBool("WEBGL_PACK"));We.registerFlag("WEBGL_LAZILY_UNPACK",()=>We.getBool("WEBGL_PACK"));We.registerFlag("WEBGL_CONV_IM2COL",()=>We.getBool("WEBGL_PACK"));We.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>WQ(We.getNumber("WEBGL_VERSION")));We.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>UQ(We.getNumber("WEBGL_VERSION")));We.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const t=We.getNumber("WEBGL_VERSION");return t===0?0:HQ(t)});We.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>We.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!y_());We.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>GQ(We.getNumber("WEBGL_VERSION")));We.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>We.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:We.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));We.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>jQ(We.getNumber("WEBGL_VERSION")));We.registerFlag("WEBGL_FENCE_API_ENABLED",()=>KQ(We.getNumber("WEBGL_VERSION")));We.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>We.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);We.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,t=>{if(t<0&&t!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${t}.`)});We.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>y_()?1:-1,t=>{if(t<0&&t!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${t}.`)});We.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);We.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);We.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);We.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);We.registerFlag("WEBGL_EXP_CONV",()=>!1);We.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>We.getBool("IS_TEST"));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hn(){let t,e,n,s,o,r,i,a,l,c;return se().getNumber("WEBGL_VERSION")===2?(t="#version 300 es",e="in",n="out",s="in",o="texture",r="outputColor",i="out vec4 outputColor;",a=`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `,l="",c=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(t="",e="attribute",n="varying",s="varying",o="texture2D",r="gl_FragColor",i="",a=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,l=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,c=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:t,attribute:e,varyingVs:n,varyingFs:s,texture2D:o,output:r,defineOutput:i,defineSpecialNaN:a,defineSpecialInf:l,defineRound:c}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function la(t,e,n="index"){const s=Ue(e);return s.map((o,r)=>{const i=`int ${t[r]} = ${n} / ${o}`,a=r===s.length-1?`int ${t[r+1]} = ${n} - ${t[r]} * ${o}`:`index -= ${t[r]} * ${o}`;return`${i}; ${a};`}).join("")}function Vp(t,e,n="index"){const s=Ue(e);return s.map((o,r)=>{const i=`int ${t[r]} = ${n} / outShapeStrides[${r}]`,a=r===s.length-1?`int ${t[r+1]} = ${n} - ${t[r]} * outShapeStrides[${r}]`:`index -= ${t[r]} * outShapeStrides[${r}]`;return`${i}; ${a};`}).join("")}function XQ(t,e){const n=t.length,s=t.map(r=>`${e}[${r}]`),o=new Array(n-1);o[n-2]=s[n-1];for(let r=n-3;r>=0;--r)o[r]=`(${o[r+1]} * ${s[r+1]})`;return o}function YQ(t,e,n="index"){const s=t.map((r,i)=>i),o=XQ(s,e);return o.map((r,i)=>{const a=`int ${t[i]} = ${n} / ${o[i]}`,l=i===o.length-1?`int ${t[i+1]} = ${n} - ${t[i]} * ${o[i]}`:`index -= ${t[i]} * ${o[i]}`;return`${a}; ${l};`}).join("")}function R0(t){const e=Ue(t).map(n=>n.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${e[0]} + coords.y * ${e[1]} + coords.z;
  }
`}function D0(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const pN=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{getBroadcastDims:mN}=rq;function ZQ(t,e,n){const s=[];if(t.forEach(f=>{const p=ae(f.shapeInfo.logicalShape);if(f.shapeInfo.isUniform?s.push(`uniform float ${f.name}${p>1?`[${p}]`:""};`):(s.push(`uniform sampler2D ${f.name};`),s.push(`uniform int offset${f.name};`)),n.enableShapeUniforms){const{uniformShape:g}=O0(n.packedInputs,f.shapeInfo.logicalShape,f.shapeInfo.texShape);switch(g.length){case 1:s.push(`uniform int ${f.name}Shape;`);break;case 2:s.push(`uniform ivec2 ${f.name}Shape;`);break;case 3:s.push(`uniform ivec3 ${f.name}Shape;`);break;case 4:s.push(`uniform ivec4 ${f.name}Shape;`);break}s.push(`uniform ivec2 ${f.name}TexShape;`)}}),n.enableShapeUniforms){switch(e.logicalShape.length){case 1:s.push("uniform int outShape;");break;case 2:s.push("uniform ivec2 outShape;"),s.push("uniform int outShapeStrides;");break;case 3:s.push("uniform ivec3 outShape;"),s.push("uniform ivec2 outShapeStrides;");break;case 4:s.push("uniform ivec4 outShape;"),s.push("uniform ivec3 outShapeStrides;");break}s.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach(f=>{s.push(`uniform ${f.type} ${f.name}${f.arrayIndex?`[${f.arrayIndex}]`:""};`)});const o=s.join(`
`),r=t.map(f=>QQ(f,e,n.packedInputs,n.enableShapeUniforms)).join(`
`),i=e.texShape,a=Hn(),l=tJ(a);let c,u,h=oJ(a);return e.isPacked?(c=JQ(e.logicalShape,i,n.enableShapeUniforms),u=sJ(a)):(c=eJ(e.logicalShape,i,n.enableShapeUniforms),u=nJ(a)),n.packedInputs&&(h+=lJ),[h,l,u,o,c,r,n.userCode].join(`
`)}function Rl(t,e=!1){const n=t.shapeInfo.logicalShape;switch(n.length){case 0:return vJ(t,e);case 1:return CJ(t,e);case 2:return IJ(t,e);case 3:return kJ(t,e);case 4:return SJ(t,e);case 5:return TJ(t);case 6:return NJ(t);default:throw new Error(`${n.length}-D input sampling is not yet supported`)}}function gN(t,e){switch(t.shapeInfo.logicalShape.length){case 0:return yJ(t);case 1:return wJ(t,e);case 2:return $J(t,e);case 3:return _J(t,e);default:return EJ(t,e)}}function QQ(t,e,n=!1,s){let o="";n?o+=gN(t,s):o+=Rl(t,s);const r=t.shapeInfo.logicalShape,i=e.logicalShape;return r.length<=i.length&&(n?o+=AJ(t,e):o+=RJ(t,e)),o}function JQ(t,e,n){switch(t.length){case 0:return bN();case 1:return cJ(t,e,n);case 2:return bJ(t,e,n);case 3:return hJ(t,e,n);default:return fJ(t,e,n)}}function eJ(t,e,n){switch(t.length){case 0:return bN();case 1:return uJ(t,e,n);case 2:return xJ(t,e,n);case 3:return dJ(t,e,n);case 4:return pJ(t,e,n);case 5:return mJ(t,e);case 6:return gJ(t,e);default:throw new Error(`${t.length}-D output sampling is not yet supported`)}}function tJ(t){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${t.texture2D}(textureSampler, uv).r;
    }
  `}function nJ(t){return`
    void setOutput(float val) {
      ${t.output} = vec4(val, 0, 0, 0);
    }
  `}function sJ(t){return`
    void setOutput(vec4 val) {
      ${t.output} = val;
    }
  `}function oJ(t){return`${t.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${t.varyingFs} vec2 resultUV;
    ${t.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${t.defineSpecialNaN}
    ${t.defineSpecialInf}
    ${t.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${rJ}
    ${iJ}
    ${aJ}
  `}const rJ=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,iJ=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,aJ=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,lJ=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function bN(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function cJ(t,e,n){const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return s[0]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${s[1]}.0);
      }
    `:s[1]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${s[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      return 2 * (resTexRC.x * ${s[1]} + resTexRC.y);
    }
  `}function uJ(t,e,n){return e[0]===1?n?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${e[1]}.0);
      }
    `:e[1]===1?n?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${e[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      return resTexRC.x * ${e[1]} + resTexRC.y;
    }
  `}function hJ(t,e,n){if(n)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],o=Math.ceil(t[2]/2),r=o*Math.ceil(t[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      int index = resTexRC.x * ${s[1]} + resTexRC.y;

      int b = index / ${r};
      index -= b * ${r};

      int r = 2 * (index / ${o});
      int c = imod(index, ${o}) * 2;

      return ivec3(b, r, c);
    }
  `}function dJ(t,e,n){if(n)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${Vp(["r","c","d"],t)}
    return ivec3(r, c, d);
  }
`;const s=la(["r","c","d"],t);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${s}
      return ivec3(r, c, d);
    }
  `}function fJ(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],o=Math.ceil(t[t.length-1]/2),r=o*Math.ceil(t[t.length-2]/2);let i=r,a="",l="b, r, c";for(let c=2;c<t.length-1;c++)i*=t[t.length-c-1],a=`
      int b${c} = index / ${i};
      index -= b${c} * ${i};
    `+a,l=`b${c}, `+l;return`
    ivec${t.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      int index = resTexRC.x * ${s[1]} + resTexRC.y;

      ${a}

      int b = index / ${r};
      index -= b * ${r};

      int r = 2 * (index / ${o});
      int c = imod(index, ${o}) * 2;

      return ivec${t.length}(${l});
    }
  `}function pJ(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${Vp(["r","c","d","d2"],t)}
      return ivec4(r, c, d, d2);
    }
  `;const s=la(["r","c","d","d2"],t);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${s}
      return ivec4(r, c, d, d2);
    }
  `}function mJ(t,e){const n=la(["r","c","d","d2","d3"],t);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${e[0]},
                             ${e[1]}));

      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function gJ(t,e){const n=la(["r","c","d","d2","d3","d4"],t);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function bJ(t,e,n){const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(bt(t,e))return n?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${s[0]}, ${s[1]}));
      }
    `;const o=Math.ceil(t[1]/2);return n?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));

      int index = resTexRC.x * ${s[1]} + resTexRC.y;
      int r = 2 * (index / ${o});
      int c = imod(index, ${o}) * 2;

      return ivec2(r, c);
    }
  `}function xJ(t,e,n){return bt(t,e)?n?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${e[0]}, ${e[1]}));
      }
    `:t[1]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:t[0]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:n?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      int r = index / ${t[1]};
      int c = index - r * ${t[1]};
      return ivec2(r, c);
    }
  `}function ca(t){return`offset${t}`}function yJ(t){const e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),s=Hn();return`
    vec4 ${n}() {
      return ${s.texture2D}(${e}, halfCR);
    }
  `}function vJ(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`float ${s}() {return ${n};}`;const[o,r]=t.shapeInfo.texShape;if(o===1&&r===1)return`
      float ${s}() {
        return sampleTexture(${n}, halfCR);
      }
    `;const i=ca(n);if(e)return`
    float ${s}() {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], ${i});
      return sampleTexture(${n}, uv);
    }
  `;const[a,l]=t.shapeInfo.texShape;return`
    float ${s}() {
      vec2 uv = uvFromFlat(${a}, ${l}, ${i});
      return sampleTexture(${n}, uv);
    }
  `}function wJ(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),o=t.shapeInfo.texShape,r=Hn();if(e)return`
    vec4 ${s}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${r.texture2D}(${n}, uv);
    }
  `;const i=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)];return`
    vec4 ${s}(int index) {
      vec2 uv = packedUVfrom1D(
        ${i[0]}, ${i[1]}, index);
      return ${r.texture2D}(${n}, uv);
    }
  `}function CJ(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`
      float ${s}(int index) {
        ${Dl(t)}
      }
    `;const o=t.shapeInfo.texShape,r=o[0],i=o[1];if(i===1&&r===1)return`
      float ${s}(int index) {
        return sampleTexture(${n}, halfCR);
      }
    `;const a=ca(n);return i===1?e?`
      float ${s}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / float(${n}TexShape[0]));
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${s}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / ${r}.0);
        return sampleTexture(${n}, uv);
      }
    `:r===1?e?`
      float ${s}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / float(${n}TexShape[1]), 0.5);
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${s}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / ${i}.0, 0.5);
        return sampleTexture(${n}, uv);
      }
    `:e?`
    float ${s}(int index) {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index + ${a});
      return sampleTexture(${n}, uv);
    }
  `:`
    float ${s}(int index) {
      vec2 uv = uvFromFlat(${r}, ${i}, index + ${a});
      return sampleTexture(${n}, uv);
    }
  `}function $J(t,e){const n=t.shapeInfo.logicalShape,s=t.name,o="get"+s.charAt(0).toUpperCase()+s.slice(1),r=t.shapeInfo.texShape,i=r[0],a=r[1],l=Hn();if(r!=null&&bt(n,r))return e?`
      vec4 ${o}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);

        return ${l.texture2D}(${s}, uv);
      }
    `:`
      vec4 ${o}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${a}.0, ${i}.0);

        return ${l.texture2D}(${s}, uv);
      }
    `;if(e)return`
    vec4 ${o}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${s}TexShape[0]) / 2.0), ceil(float(${s}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${s}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${l.texture2D}(${s}, uv);
    }
  `;const c=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)],u=Math.ceil(n[1]/2);return`
    vec4 ${o}(int row, int col) {
      vec2 uv = packedUVfrom2D(${u}, ${c[0]}, ${c[1]}, row, col);
      return ${l.texture2D}(${s}, uv);
    }
  `}function IJ(t,e){const n=t.shapeInfo.logicalShape,s=t.name,o="get"+s.charAt(0).toUpperCase()+s.slice(1),r=t.shapeInfo.texShape;if(r!=null&&bt(n,r)){if(e)return`
      float ${o}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `;const d=r[0],f=r[1];return`
    float ${o}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${f}.0, ${d}.0);
      return sampleTexture(${s}, uv);
    }
  `}const{newShape:i,keptDims:a}=Gr(n),l=i;if(l.length<n.length){const d=Ol(t,l),f=["row","col"];return`
      ${Rl(d,e)}
      float ${o}(int row, int col) {
        return ${o}(${Fl(f,a)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${o}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${n[1]}, 1)));
        ${Dl(t)}
      }
    `;const c=r[0],u=r[1],h=ca(s);return u===1?e?`
      float ${o}(int row, int col) {
        float index = dot(vec3(row, col, ${h}), vec3(${s}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${s}TexShape[0]));
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${o}(int row, int col) {
      float index = dot(vec3(row, col, ${h}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${c}.0);
      return sampleTexture(${s}, uv);
    }
  `:c===1?e?`
      float ${o}(int row, int col) {
        float index = dot(vec3(row, col, ${h}), vec3(${s}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${s}TexShape[1]), 0.5);
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${o}(int row, int col) {
      float index = dot(vec3(row, col, ${h}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${u}.0, 0.5);
      return sampleTexture(${s}, uv);
    }
  `:e?`
      float ${o}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${s}Shape[1] + col + ${h};
        vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index);
        return sampleTexture(${s}, uv);
      }
    `:`
  float ${o}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${n[1]} + col + ${h};
    vec2 uv = uvFromFlat(${c}, ${u}, index);
    return sampleTexture(${s}, uv);
  }
`}function _J(t,e){const n=t.shapeInfo.logicalShape,s=t.name,o="get"+s.charAt(0).toUpperCase()+s.slice(1),r=t.shapeInfo.texShape,i=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)];if(n[0]===1){const d=n.slice(1),f=[1,2],p=Ol(t,d),g=["b","row","col"];return`
        ${gN(p,e)}
        vec4 ${o}(int b, int row, int col) {
          return ${o}(${Fl(g,f)});
        }
      `}const a=Hn();if(e)return`
    vec4 ${o}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${s}TexShape[0]) / 2.0), ceil(float(${s}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${s}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${s}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${a.texture2D}(${s}, uv);
    }
  `;const l=i[0],c=i[1],u=Math.ceil(n[2]/2),h=u*Math.ceil(n[1]/2);return`
    vec4 ${o}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${l}, ${c}, ${h}, ${u}, b, row, col);
      return ${a.texture2D}(${s}, uv);
    }
  `}function kJ(t,e){const n=t.shapeInfo.logicalShape,s=t.name,o="get"+s.charAt(0).toUpperCase()+s.slice(1),r=n[1]*n[2],i=n[2],{newShape:a,keptDims:l}=Gr(n),c=a;if(c.length<n.length){const g=Ol(t,c),b=["row","col","depth"];return`
        ${Rl(g,e)}
        float ${o}(int row, int col, int depth) {
          return ${o}(${Fl(b,l)});
        }
      `}if(t.shapeInfo.isUniform)return`
      float ${o}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${r}, ${i}, 1)));
        ${Dl(t)}
      }
    `;const u=t.shapeInfo.texShape,h=u[0],d=u[1],f=t.shapeInfo.flatOffset;if(d===r&&f==null)return e?`
      float ${o}(int row, int col, int depth) {
        int stride1 = ${s}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
        float ${o}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${i}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${d}.0, ${h}.0);
          return sampleTexture(${s}, uv);
        }
      `;if(d===i&&f==null)return e?`
      float ${o}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${s}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${o}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${n[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${d}.0, ${h}.0);
      return sampleTexture(${s}, uv);
    }
  `;const p=ca(s);return e?`
    float ${o}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${s}Shape[1] * ${s}Shape[2];
      int stride1 = ${s}Shape[2];
      int index = row * ${r} + col * ${i} + depth + ${p};
      vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index);
      return sampleTexture(${s}, uv);
    }
    `:`
      float ${o}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${r} + col * ${i} + depth + ${p};
        vec2 uv = uvFromFlat(${h}, ${d}, index);
        return sampleTexture(${s}, uv);
      }
  `}function EJ(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),o=Hn();if(e)return`
    vec4 ${s}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${n}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${n}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${n}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${o.texture2D}(${n}, uv);
    }
  `;const r=t.shapeInfo.logicalShape,i=r.length,a=t.shapeInfo.texShape,l=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],c=l[0],u=l[1],h=Math.ceil(r[i-1]/2);let d=h*Math.ceil(r[i-2]/2),f="int b, int row, int col",p=`b * ${d} + (row / 2) * ${h} + (col / 2)`;for(let g=2;g<i-1;g++)f=`int b${g}, `+f,d*=r[i-g-1],p=`b${g} * ${d} + `+p;return`
    vec4 ${s}(${f}) {
      int index = ${p};
      int texR = index / ${u};
      int texC = index - texR * ${u};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${u}, ${c});
      return ${o.texture2D}(${n}, uv);
    }
  `}function SJ(t,e){const n=t.shapeInfo.logicalShape,s=t.name,o="get"+s.charAt(0).toUpperCase()+s.slice(1),r=n[3],i=n[2]*r,a=n[1]*i,{newShape:l,keptDims:c}=Gr(n);if(l.length<n.length){const y=Ol(t,l),w=["row","col","depth","depth2"];return`
      ${Rl(y,e)}
      float ${o}(int row, int col, int depth, int depth2) {
        return ${o}(${Fl(w,c)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${o}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${a}, ${i}, ${r}, 1)));
        ${Dl(t)}
      }
    `;const u=t.shapeInfo.flatOffset,h=t.shapeInfo.texShape,d=h[0],f=h[1],p=`int stride2 = ${s}Shape[3];`,g=`int stride1 = ${s}Shape[2] * stride2;`,b=`int stride0 = ${s}Shape[1] * stride1;`;if(f===a&&u==null)return e?`
      float ${o}(int row, int col, int depth, int depth2) {
        ${p}
        ${g}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
      float ${o}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${i}, ${r}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${d}.0);
        return sampleTexture(${s}, uv);
      }
    `;if(f===r&&u==null)return e?`
      float ${o}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${s}Shape[1] * ${s}Shape[2], ${s}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
      float ${o}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${n[1]*n[2]}, ${n[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${d}.0);
        return sampleTexture(${s}, uv);
      }
    `;const x=ca(s);return e?`
    float ${o}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${p}
      ${g}
      ${b}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index + ${x});
      return sampleTexture(${s}, uv);
    }
  `:`
    float ${o}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${i} +
          depth * ${r} + depth2;
      vec2 uv = uvFromFlat(${d}, ${f}, index + ${x});
      return sampleTexture(${s}, uv);
    }
  `}function TJ(t){const e=t.shapeInfo.logicalShape,n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),o=e[4],r=e[3]*o,i=e[2]*r,a=e[1]*i,{newShape:l,keptDims:c}=Gr(e);if(l.length<e.length){const g=Ol(t,l),b=["row","col","depth","depth2","depth3"];return`
      ${Rl(g)}
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        return ${s}(${Fl(b,c)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${a}, ${i}, ${r}, ${o})) +
          depth3;
        ${Dl(t)}
      }
    `;const u=t.shapeInfo.flatOffset,h=t.shapeInfo.texShape,d=h[0],f=h[1];if(f===a&&u==null)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${i}, ${r}, ${o}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${d}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(f===o&&u==null)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]},
               ${e[2]*e[3]}, ${e[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${d}.0);
        return sampleTexture(${n}, uv);
      }
    `;const p=ca(n);return`
    float ${s}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${i} + depth * ${r} +
          depth2 * ${o} + depth3 + ${p};
      vec2 uv = uvFromFlat(${d}, ${f}, index);
      return sampleTexture(${n}, uv);
    }
  `}function NJ(t){const e=t.shapeInfo.logicalShape,n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:o,keptDims:r}=Gr(e);if(o.length<e.length){const b=Ol(t,o),x=["row","col","depth","depth2","depth3","depth4"];return`
      ${Rl(b)}
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${s}(${Fl(x,r)});
      }
    `}const i=e[5],a=e[4]*i,l=e[3]*a,c=e[2]*l,u=e[1]*c;if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${u}, ${c}, ${l}, ${a})) +
          dot(
            vec2(depth3, depth4),
            vec2(${i}, 1)));
        ${Dl(t)}
      }
    `;const h=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,f=d[0],p=d[1];if(p===u&&h==null)return`
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${c}, ${l}, ${a}, ${i})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${p}.0, ${f}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(p===i&&h==null)return`
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]*e[4]},
               ${e[2]*e[3]*e[4]},
               ${e[3]*e[4]},
               ${e[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${p}.0, ${f}.0);
        return sampleTexture(${n}, uv);
      }
    `;const g=ca(n);return`
    float ${s}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${u} + col * ${c} + depth * ${l} +
          depth2 * ${a} + depth3 * ${i} + depth4 + ${g};
      vec2 uv = uvFromFlat(${f}, ${p}, index);
      return sampleTexture(${n}, uv);
    }
  `}function Dl(t){const e=t.name,n=ae(t.shapeInfo.logicalShape);return n<2?`return ${e};`:`
    for (int i = 0; i < ${n}; i++) {
      if (i == index) {
        return ${e}[i];
      }
    }
  `}function AJ(t,e){const n=t.name,s=n.charAt(0).toUpperCase()+n.slice(1),o="get"+s+"AtOutCoords",r=t.shapeInfo.logicalShape.length,i=e.logicalShape.length,a=mN(t.shapeInfo.logicalShape,e.logicalShape),l=It(i),c=i-r;let u;const h=["x","y","z","w","u","v"];r===0?u="":i<2&&a.length>=1?u="coords = 0;":u=a.map(y=>`coords.${h[y+c]} = 0;`).join(`
`);let d="";i<2&&r>0?d="coords":d=t.shapeInfo.logicalShape.map((y,w)=>`coords.${h[w+c]}`).join(", ");let f="return outputValue;";const g=ae(t.shapeInfo.logicalShape)===1,x=ae(e.logicalShape)===1;if(r===1&&!g&&!x)f=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(g&&!x)i===1?f=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:f=`
        return vec4(outputValue.x);
      `;else if(a.length){const y=r-2,w=r-1;a.indexOf(y)>-1&&a.indexOf(w)>-1?f="return vec4(outputValue.x);":a.indexOf(y)>-1?f="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":a.indexOf(w)>-1&&(f="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${o}() {
      ${l} coords = getOutputCoords();
      ${u}
      vec4 outputValue = get${s}(${d});
      ${f}
    }
  `}function RJ(t,e){const n=t.name,s=n.charAt(0).toUpperCase()+n.slice(1),o="get"+s+"AtOutCoords",r=e.texShape,i=t.shapeInfo.texShape,a=t.shapeInfo.logicalShape.length,l=e.logicalShape.length;if(!t.shapeInfo.isUniform&&a===l&&t.shapeInfo.flatOffset==null&&bt(i,r))return`
      float ${o}() {
        return sampleTexture(${n}, resultUV);
      }
    `;const c=It(l),u=mN(t.shapeInfo.logicalShape,e.logicalShape),h=l-a;let d;const f=["x","y","z","w","u","v"];a===0?d="":l<2&&u.length>=1?d="coords = 0;":d=u.map(g=>`coords.${f[g+h]} = 0;`).join(`
`);let p="";return l<2&&a>0?p="coords":p=t.shapeInfo.logicalShape.map((g,b)=>`coords.${f[b+h]}`).join(", "),`
    float ${o}() {
      ${c} coords = getOutputCoords();
      ${d}
      return get${s}(${p});
    }
  `}function It(t){if(t<=1)return"int";if(t===2)return"ivec2";if(t===3)return"ivec3";if(t===4)return"ivec4";if(t===5)return"ivec5";if(t===6)return"ivec6";throw Error(`GPU for rank ${t} is not yet supported`)}function O0(t,e,n){const{newShape:s,keptDims:o}=Gr(e),r=e.length,i=t&&r===3&&e[0]===1,a=i?e.slice(1):s,l=!t&&r>1&&!bt(e,n)&&s.length<r||i;return{useSqueezeShape:l,uniformShape:l?a:e,keptDims:o}}function Ol(t,e){const n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function Fl(t,e){return e.map(n=>t[n]).join(", ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DJ(t,e,n,s){const o=n.map((u,h)=>{const d={logicalShape:u.shape,texShape:u.isUniform?null:u.texData.texShape,isUniform:u.isUniform,isPacked:u.isUniform?!1:u.texData.isPacked,flatOffset:null};return u.texData!=null&&u.texData.slice!=null&&u.texData.slice.flatOffset>0&&(d.flatOffset=u.texData.slice.flatOffset),{name:e.variableNames[h],shapeInfo:d}}),r=o.map(u=>u.shapeInfo),i={logicalShape:s.shape,texShape:s.texData.texShape,isUniform:!1,isPacked:s.texData.isPacked,flatOffset:null},a=ZQ(o,i,e),l=kQ(t.gl,a),c=t.createProgram(l);return se().get("ENGINE_COMPILE_ONLY")?{program:e,fragmentShader:l,source:a,webGLProgram:c,inShapeInfos:r,outShapeInfo:i,uniformLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,inShapesLocations:null,inTexShapesLocations:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:Object.assign({program:e,fragmentShader:l,source:a,webGLProgram:c,inShapeInfos:r,outShapeInfo:i},xN(t,e,c))}function xN(t,e,n){const s={},o={},r={},i=[];let a,l,c,u=null,h=null;h=t.getUniformLocation(n,"NAN",!1),se().getNumber("WEBGL_VERSION")===1&&(u=t.getUniformLocation(n,"INFINITY",!1));const d=!1;for(let f=0;f<e.variableNames.length;f++){const p=e.variableNames[f];s[p]=t.getUniformLocation(n,p,d),s[`offset${p}`]=t.getUniformLocation(n,`offset${p}`,d),e.enableShapeUniforms&&(o[`${p}Shape`]=t.getUniformLocation(n,`${p}Shape`,d),r[`${p}TexShape`]=t.getUniformLocation(n,`${p}TexShape`,d))}return e.enableShapeUniforms&&(a=t.getUniformLocation(n,"outShape",d),c=t.getUniformLocation(n,"outShapeStrides",d),l=t.getUniformLocation(n,"outTexShape",d)),e.customUniforms&&e.customUniforms.forEach((f,p)=>{i[p]=t.getUniformLocation(n,f.name,d)}),{uniformLocations:s,customUniformLocations:i,infLoc:u,nanLoc:h,inShapesLocations:o,inTexShapesLocations:r,outShapeLocation:a,outShapeStridesLocation:c,outTexShapeLocation:l}}function AC(t,e){if(t.length!==e.length)throw Error(`Binary was compiled with ${t.length} inputs, but was executed with ${e.length} inputs`);t.forEach((n,s)=>{const o=n.logicalShape,r=e[s],i=r.shape;if(!bt(o,i))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${o} and ${i} must match`);if(n.isUniform&&r.isUniform)return;const a=n.texShape,l=r.isUniform?null:r.texData.texShape;if(!bt(a,l))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${a} and ${l} must match`)})}function OJ(t,e,n,s,o){e.program.enableShapeUniforms||(AC(e.inShapeInfos,n),AC([e.outShapeInfo],[s]));const r=s.texData.texture,i=s.texData.texShape;s.texData.isPacked?t.setOutputPackedMatrixTexture(r.texture,i[0],i[1]):t.setOutputMatrixTexture(r.texture,i[0],i[1]),t.setProgram(e.webGLProgram),se().getNumber("WEBGL_VERSION")===1&&e.infLoc!==null&&t.gl.uniform1f(e.infLoc,1/0),e.nanLoc!==null&&t.gl.uniform1f(e.nanLoc,NaN),n.forEach((l,c)=>{const u=e.program.variableNames[c],h=e.uniformLocations[u],d=e.uniformLocations[`offset${u}`],f=e.inShapesLocations[`${u}Shape`],p=e.inTexShapesLocations[`${u}TexShape`];if(f){const{uniformShape:g}=O0(e.program.packedInputs,l.shape,l.texData.texShape);switch(g.length){case 1:t.gl.uniform1iv(f,new Int32Array(g));break;case 2:t.gl.uniform2iv(f,new Int32Array(g));break;case 3:t.gl.uniform3iv(f,new Int32Array(g));break;case 4:t.gl.uniform4iv(f,new Int32Array(g));break}}if(p&&t.gl.uniform2i(p,l.texData.texShape[0],l.texData.texShape[1]),h!=null){if(l.isUniform){if(ae(l.shape)<2)t.gl.uniform1f(h,l.uniformValues[0]);else{let g=l.uniformValues;g instanceof Float32Array||(g=new Float32Array(g)),t.gl.uniform1fv(h,g)}return}l.texData.slice!=null&&d!=null&&t.gl.uniform1i(d,l.texData.slice.flatOffset),t.setInputMatrixTexture(l.texData.texture.texture,h,c)}});const a=e.outShapeLocation;if(a)switch(s.shape.length){case 1:t.gl.uniform1iv(a,new Int32Array(s.shape));break;case 2:t.gl.uniform2iv(a,new Int32Array(s.shape));break;case 3:t.gl.uniform3iv(a,new Int32Array(s.shape));break;case 4:t.gl.uniform4iv(a,new Int32Array(s.shape));break}if(e.outShapeStridesLocation){const l=Ue(s.shape);switch(s.shape.length){case 2:t.gl.uniform1iv(e.outShapeStridesLocation,new Int32Array(l));break;case 3:t.gl.uniform2iv(e.outShapeStridesLocation,new Int32Array(l));break;case 4:t.gl.uniform3iv(e.outShapeStridesLocation,new Int32Array(l));break}}e.outTexShapeLocation&&t.gl.uniform2i(e.outTexShapeLocation,s.texData.texShape[0],s.texData.texShape[1]),e.program.customUniforms&&o&&e.program.customUniforms.forEach((l,c)=>{const u=e.customUniformLocations[c],h=o[c];if(l.type==="float")t.gl.uniform1fv(u,h);else if(l.type==="vec2")t.gl.uniform2fv(u,h);else if(l.type==="vec3")t.gl.uniform3fv(u,h);else if(l.type==="vec4")t.gl.uniform4fv(u,h);else if(l.type==="int")t.gl.uniform1iv(u,h);else if(l.type==="ivec2")t.gl.uniform2iv(u,h);else if(l.type==="ivec3")t.gl.uniform3iv(u,h);else if(l.type==="ivec4")t.gl.uniform4iv(u,h);else throw Error(`uniform type ${l.type} is not supported yet.`)}),t.executeProgram()}function FJ(t,e,n){let s="";e.concat(n).forEach(i=>{const a=i.texData!=null&&i.texData.slice!=null&&i.texData.slice.flatOffset>0;if(t.enableShapeUniforms&&!i.isUniform){const l=i.texData.texShape,{useSqueezeShape:c,uniformShape:u,keptDims:h}=O0(t.packedInputs,i.shape,l);let d="",f="",p="";if(u.length===1&&t.packedInputs){const $=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)];d=`${$[0]>1}_${$[1]>1}`}else if(u.length===2&&!t.packedInputs)f=`${u[0]>1}_${u[1]>1}`;else if(u.length>2&&!t.packedInputs){const $=Ue(u);p=`${$[0]===l[1]}_${$[$.length-1]===l[1]}`}const g=i.shape.length,b=u.length===2&&bt(i.shape,l),x=ae(i.shape)===1,y=al(i.shape,n.shape),w=!t.packedInputs&&g===n.shape.length&&bt(l,n.texData.texShape),v=t.packedInputs||u.length>2?"":`${l[0]>1}_${l[1]>1}`;s+=`${g}_${w}_${c?h:""}_${u.length}_${x}_${y}_${b}_${d}_${f}_${p}_${v}_${a}`}else{const l=i.isUniform?"uniform":i.texData.texShape;s+=`${i.shape}_${l}_${a}`}});const o=t.userCode;let r=t.constructor.name;return r+="_"+s+"_"+o+`${se().getNumber("WEBGL_VERSION")}`,r}function Gn(t){return se().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&t<=4}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class LJ{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Ac.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=Hn();this.outputShape=e,this.enableShapeUniforms=Gn(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?Vp(["r","c","d"],e):la(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class PJ{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Ac.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=Hn();this.outputShape=e,this.enableShapeUniforms=Gn(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?Vp(["r","c","d"],e):la(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class MJ{constructor(e){this.variableNames=["A"],this.outTexUsage=Is.DOWNLOAD;const n=Hn();this.outputShape=e,this.userCode=`
      ${pN}

      void main() {
        float x = getAAtOutCoords();
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class BJ{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Is.DOWNLOAD;const n=Hn();this.outputShape=e,this.userCode=`
      ${pN}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class VJ{constructor(e,n=!1){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const s=Hn();this.outputShape=e,this.enableShapeUniforms=Gn(this.outputShape.length);let o="result";n&&(o="floor(result * 255. + 0.5)"),this.userCode=`
      ${this.enableShapeUniforms?D0():R0(e)}

      void main() {
        ivec3 coords = getOutputCoords();

        int flatIndex = getFlatIndex(coords);
        int offset = imod(flatIndex, 4);

        flatIndex = idiv(flatIndex, 4, 1.);

        int r = flatIndex / texShape[1];
        int c = imod(flatIndex, texShape[1]);
        vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
        vec4 values = ${s.texture2D}(A, uv);

        float result;

        if(offset == 0) {
          result = values[0];
        } else if(offset == 1) {
          result = values[1];
        } else if(offset == 2) {
          result = values[2];
        } else {
          result = values[3];
        }

        ${s.output} = vec4(${o}, 0., 0., 0.);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zJ{constructor(e,n=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const s=Hn();this.outputShape=e,this.enableShapeUniforms=Gn(this.outputShape.length);let o="",r="result";n&&(r="floor(result * 255. + 0.5)");for(let i=0;i<=1;i++)for(let a=0;a<=1;a++){const l=i*2+a;o+=`
          localCoords = coords;
          if(localCoords[2] + ${a} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {
          localCoords[2] += ${a};
          if (localCoords[1] + ${i} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {
            localCoords[1] += ${i};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${s.texture2D}(A, uv);

            if (offset == 0) {
              result[${l}] = values[0];
            } else if (offset == 1) {
              result[${l}] = values[1];
            } else if (offset == 2) {
              result[${l}] = values[2];
            } else {
              result[${l}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?D0():R0(e)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${o}

          ${s.output} = ${r};
        }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WJ(t){const e=Hn(),n=`${e.version}
    precision highp float;
    ${e.attribute} vec3 clipSpacePos;
    ${e.attribute} vec2 uv;
    ${e.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return _Q(t,n)}function UJ(t){const e=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return NQ(t,e)}function HJ(t){const e=new Uint16Array([0,1,2,2,1,3]);return AQ(t,e)}function th(t,e,n,s,o,r){DQ(e,n);const i=RQ(t),a=t.TEXTURE_2D;return Fe(t,()=>t.bindTexture(a,i)),Fe(t,()=>t.texParameteri(a,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)),Fe(t,()=>t.texParameteri(a,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)),Fe(t,()=>t.texParameteri(a,t.TEXTURE_MIN_FILTER,t.NEAREST)),Fe(t,()=>t.texParameteri(a,t.TEXTURE_MAG_FILTER,t.NEAREST)),se().getNumber("WEBGL_VERSION")===1?Fe(t,()=>t.texImage2D(a,0,s,e,n,0,o,r,null)):Fe(t,()=>t.texStorage2D(a,1,s,e,n)),Fe(t,()=>t.bindTexture(t.TEXTURE_2D,null)),{texture:i,texShape:[n,e]}}function yN(t){return t.internalFormatFloat}function GJ(t,e,n,s){const[o,r]=Ju(e,n);return th(t,o,r,yN(s),s.textureFormatFloat,t.FLOAT)}function vN(t){return t.internalFormatHalfFloat}function jJ(t,e,n,s){const[o,r]=Ju(e,n);return th(t,o,r,vN(s),s.textureFormatFloat,s.textureTypeHalfFloat)}function wN(t){return t.downloadTextureFormat}function qJ(t,e,n,s){const[o,r]=Ju(e,n);return th(t,o,r,wN(s),t.RGBA,t.UNSIGNED_BYTE)}function CN(t){return t.internalFormatPackedFloat}function KJ(t,e,n,s){const[o,r]=Al(e,n);return th(t,o,r,CN(s),t.RGBA,t.FLOAT)}function $N(t){return t.internalFormatPackedHalfFloat}function XJ(t,e,n,s){const[o,r]=Al(e,n);return th(t,o,r,$N(s),t.RGBA,s.textureTypeHalfFloat)}function YJ(t,e,n){return Fe(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),SC(t,e,"clipSpacePos",n,3,20,0)&&SC(t,e,"uv",n,2,20,12)}function ZJ(t,e,n,s,o,r){Fe(t,()=>t.bindTexture(t.TEXTURE_2D,e));let i,a,l;o instanceof Uint8Array?(i=new Uint8Array(n*s*4),a=t.UNSIGNED_BYTE,l=t.RGBA):(i=new Float32Array(n*s*4),a=t.FLOAT,l=r.internalFormatPackedFloat),i.set(o),se().getNumber("WEBGL_VERSION")===2?Fe(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n,s,t.RGBA,a,i)):Fe(t,()=>t.texImage2D(t.TEXTURE_2D,0,l,n,s,0,t.RGBA,a,i)),Fe(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function QJ(t,e,n){Fe(t,()=>t.bindTexture(t.TEXTURE_2D,e)),n.data instanceof Uint8Array?se().getNumber("WEBGL_VERSION")===2?Fe(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n.width,n.height,t.RGBA,t.UNSIGNED_BYTE,n.data)):Fe(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,n.width,n.height,0,t.RGBA,t.UNSIGNED_BYTE,n.data)):se().getNumber("WEBGL_VERSION")===2?Fe(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,n)):Fe(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n)),Fe(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function JJ(t,e,n,s){const o=t.createBuffer();Fe(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,o));const a=4*4*e*n;return Fe(t,()=>t.bufferData(t.PIXEL_PACK_BUFFER,a,t.STREAM_READ)),Fe(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,0)),Fe(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,null)),o}function eee(t,e,n){const s=t,o=new Float32Array(n);return s.bindBuffer(s.PIXEL_PACK_BUFFER,e),s.getBufferSubData(s.PIXEL_PACK_BUFFER,0,o),s.bindBuffer(s.PIXEL_PACK_BUFFER,null),o}function tee(t,e,n,s){const[o,r]=Ju(e,n),i=4,a=new Uint8Array(xQ(e*n,i));return Fe(t,()=>t.readPixels(0,0,o,r,s.downloadTextureFormat,t.UNSIGNED_BYTE,a)),new Float32Array(a.buffer)}function nee(t,e,n,s,o,r,i,a){const l=t,c=new Float32Array(yQ(r,i));return l.bindBuffer(l.PIXEL_PACK_BUFFER,e),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,c),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),c}function see(t,e,n){const s=new Float32Array(e*n*4);return Fe(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,s)),s}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sg{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];const n=se().getNumber("WEBGL_VERSION");e!=null?(this.gl=e,mQ(n,e)):this.gl=yo(n);let s="WEBGL_color_buffer_float";const o="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),se().getNumber("WEBGL_VERSION")===1){const r="OES_texture_float",i="OES_texture_half_float";if(this.textureFloatExtension=Gh(this.gl,r),Hs(this.gl,i))this.textureHalfFloatExtension=Gh(this.gl,i);else if(se().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(s),Hs(this.gl,o))this.colorBufferHalfFloatExtension=Gh(this.gl,o);else if(se().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(s="EXT_color_buffer_float",Hs(this.gl,s))this.colorBufferFloatExtension=this.gl.getExtension(s);else if(Hs(this.gl,o))this.colorBufferHalfFloatExtension=this.gl.getExtension(o);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=UJ(this.gl),this.indexBuffer=HJ(this.gl),this.framebuffer=OQ(this.gl),this.textureConfig=A0(this.gl,this.textureHalfFloatExtension)}get debug(){return se().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;Fe(e,()=>e.finish()),Fe(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),Fe(e,()=>e.deleteFramebuffer(this.framebuffer)),Fe(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),Fe(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),Fe(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,n){return this.throwIfDisposed(),GJ(this.gl,e,n,this.textureConfig)}createFloat16MatrixTexture(e,n){return this.throwIfDisposed(),jJ(this.gl,e,n,this.textureConfig)}createUnsignedBytesMatrixTexture(e,n){return this.throwIfDisposed(),qJ(this.gl,e,n,this.textureConfig)}uploadPixelDataToTexture(e,n){this.throwIfDisposed(),QJ(this.gl,e,n)}uploadDenseMatrixToTexture(e,n,s,o){this.throwIfDisposed(),ZJ(this.gl,e,n,s,o,this.textureConfig)}createFloat16PackedMatrixTexture(e,n){return this.throwIfDisposed(),XJ(this.gl,e,n,this.textureConfig)}createPackedMatrixTexture(e,n){return this.throwIfDisposed(),KJ(this.gl,e,n,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(TC(this.gl,this.framebuffer),this.outputTexture=null),Fe(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,n,s){return this.downloadMatrixDriver(e,()=>tee(this.gl,n,s,this.textureConfig))}downloadPackedMatrixFromBuffer(e,n,s,o,r,i){return nee(this.gl,e,n,s,o,r,i,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,n){return eee(this.gl,e,n)}createBufferFromTexture(e,n,s){this.bindTextureToFrameBuffer(e);const o=JJ(this.gl,n,s,this.textureConfig);return this.unbindTextureToFrameBuffer(),o}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let n,s;if(se().getBool("WEBGL_FENCE_API_ENABLED")){const o=e,r=o.fenceSync(o.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),s=()=>{const i=o.clientWaitSync(r,0,0);return i===o.ALREADY_SIGNALED||i===o.CONDITION_SATISFIED},n=r}else se().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),s=()=>this.isQueryAvailable(n,se().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):s=()=>!0;return{query:n,isFencePassed:s}}downloadMatrixFromPackedTexture(e,n,s){return this.downloadMatrixDriver(e,()=>see(this.gl,n,s))}createProgram(e){this.throwIfDisposed();const n=this.gl;this.vertexShader==null&&(this.vertexShader=WJ(n));const s=SQ(n);return Fe(n,()=>n.attachShader(s,this.vertexShader)),Fe(n,()=>n.attachShader(s,e)),TQ(n,s),this.debug&&Qm(n,s),this.vertexAttrsAreBound||(this.setProgram(s),this.vertexAttrsAreBound=YJ(n,this.program,this.vertexBuffer)),s}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&Fe(this.gl,()=>this.gl.deleteProgram(e))}setProgram(e){this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&Qm(this.gl,this.program),Fe(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,n,s=!0){return this.throwIfDisposed(),s?LQ(this.gl,e,n):PQ(this.gl,e,n)}getAttributeLocation(e,n){return this.throwIfDisposed(),Fe(this.gl,()=>this.gl.getAttribLocation(e,n))}getUniformLocationNoThrow(e,n){return this.throwIfDisposed(),this.gl.getUniformLocation(e,n)}setInputMatrixTexture(e,n,s){this.throwIfDisposed(),this.throwIfNoProgram(),MQ(this.gl,e,n,s)}setOutputMatrixTexture(e,n,s){this.setOutputMatrixTextureDriver(e,s,n)}setOutputPackedMatrixTexture(e,n,s){this.throwIfDisposed();const[o,r]=Al(n,s);this.setOutputMatrixTextureDriver(e,o,r)}setOutputMatrixWriteRegion(e,n,s,o){this.setOutputMatrixWriteRegionDriver(s,e,o,n)}setOutputPackedMatrixWriteRegion(e,n,s,o){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&Qm(this.gl,this.program),jh(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;this.debug&&this.debugValidate(),Fe(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),Fe(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=Gh(this.gl,se().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(se().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const s=this.gl,o=this.getQueryTimerExtensionWebGL2(),r=s.createQuery();return s.beginQuery(o.TIME_ELAPSED_EXT,r),r}const e=this.getQueryTimerExtensionWebGL1(),n=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,n),n}endQuery(){if(se().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const n=this.gl,s=this.getQueryTimerExtensionWebGL2();n.endQuery(s.TIME_ELAPSED_EXT);return}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await ww(()=>this.disposed||this.isQueryAvailable(e,se().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,se().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,n){if(n===0)return null;if(n===2){const s=this.gl;return s.getQueryParameter(e,s.QUERY_RESULT)/1e6}else{const s=this.getQueryTimerExtensionWebGL1();return s.getQueryObjectEXT(e,s.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,n){if(n===0)return!0;if(n===2){const s=this.gl,o=this.getQueryTimerExtensionWebGL2(),r=s.getQueryParameter(e,s.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(o.GPU_DISJOINT_EXT)),r&&!this.disjoint}else{const s=this.getQueryTimerExtensionWebGL1(),o=s.getQueryObjectEXT(e,s.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(s.GPU_DISJOINT_EXT)),o&&!this.disjoint}}pollFence(e){return new Promise(n=>{this.addItemToPoll(()=>e.isFencePassed(),()=>n())})}pollItems(){const e=oee(this.itemsToPoll.map(n=>n.isDoneFn));for(let n=0;n<=e;++n){const{resolveFn:s}=this.itemsToPoll[n];s()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,n){this.itemsToPoll.push({isDoneFn:e,resolveFn:n}),!(this.itemsToPoll.length>1)&&ww(()=>(this.pollItems(),this.itemsToPoll.length===0))}bindTextureToFrameBuffer(e){this.throwIfDisposed(),Jm(this.gl,e,this.framebuffer),this.debug&&jh(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(Jm(this.gl,this.outputTexture,this.framebuffer),this.debug&&jh(this.gl)):TC(this.gl,this.framebuffer)}downloadMatrixDriver(e,n){this.bindTextureToFrameBuffer(e);const s=n();return this.unbindTextureToFrameBuffer(),s}setOutputMatrixTextureDriver(e,n,s){this.throwIfDisposed();const o=this.gl;Jm(o,e,this.framebuffer),this.debug&&jh(o),this.outputTexture=e,Fe(o,()=>o.viewport(0,0,n,s)),Fe(o,()=>o.scissor(0,0,n,s))}setOutputMatrixWriteRegionDriver(e,n,s,o){this.throwIfDisposed(),Fe(this.gl,()=>this.gl.scissor(e,n,s,o))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function oee(t){let e=0;for(;e<t.length&&t[e]();++e);return e-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:ree,bincountImpl:IN,bincountReduceImpl:iee,castImpl:aee,ceilImpl:lee,concatImpl:cee,equalImpl:uee,expImpl:hee,expm1Impl:dee,floorImpl:fee,gatherNdImpl:pee,gatherV2Impl:mee,greaterImpl:gee,greaterEqualImpl:bee,lessImpl:xee,lessEqualImpl:yee,linSpaceImpl:vee,logImpl:wee,maxImpl:Cee,maximumImpl:$ee,minimumImpl:Iee,multiplyImpl:_ee,negImpl:kee,notEqualImpl:Eee,prodImpl:See,raggedTensorToTensorImpl:Tee,rangeImpl:Nee,rsqrtImpl:Aee,scatterImpl:Ree,sigmoidImpl:Dee,simpleAbsImpl:_N,sliceImpl:Oee,sparseFillEmptyRowsImpl:Fee,sparseReshapeImpl:Lee,sparseSegmentReductionImpl:kN,sqrtImpl:Pee,stridedSliceImpl:Mee,stringNGramsImpl:Bee,stringSplitImpl:Vee,stringToHashBucketFastImpl:zee,subImpl:Wee,tileImpl:Uee,topKImpl:Hee,transposeImpl:F0,uniqueImpl:Gee}=s8;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EN(t,e){return["x","y","z","w","u","v"].slice(0,e).map(n=>`${t}.${n}`)}function zn(t,e){return e===1?[t]:EN(t,e)}function jee(t,e){if(t===1)return"rc";let n="";for(let s=0;s<t;s++)n+=e[s],s<t-1&&(n+=",");return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qee{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=Gn(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const n=zn("rc",this.rank),s=It(this.rank),o=this.getOutOfBoundsCondition(n),r=this.getSetup(n),i=this.getOutput(n);this.userCode=`
        void main() {
          ${s} rc = getOutputCoords();

          if(${o}) {
            setOutput(vec4(0));
          } else {
            ${r}

            setOutput(vec4(${i}));
          }
        }
      `}}getSourceCoordsArr(e){const n=[];for(let s=0;s<=1;s++)for(let o=0;o<=1;o++){let r=`${s===0?"r":"rp1"}, ${o===0?"c":"cp1"}`;for(let i=2;i<this.rank;i++)r=`${e[e.length-1-i]},`+r;n.push(r)}return n}getOutOfBoundsCondition(e){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let n="";for(let s=this.rank-2;s<this.rank;s++)n+=`${e[s]} >= ${this.enableShapeUniforms?`outShape[${s}]`:this.outputShape[s]}`,s<this.rank-1&&(n+="||");return n}getSetup(e){if(this.rank===1)return"";const n=e.slice(-2),s=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],o=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${n[0]};
      int c = ${n[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${s};
      bool rEdge = rp1 >= ${o};
    `}getOutput(e){const n=this.getSourceCoordsArr(e);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${n[0]}),
            cEdge ? 0. : getA(${n[1]}),
            rEdge ? 0. : getA(${n[2]}),
            rEdge || cEdge ? 0. : getA(${n[3]})`}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class SN{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=Gn(this.outputShape.length);let s="";for(let o=0;o<4;o++){let r="thisRC = rc;";o%2===1&&(r+="thisRC.z += 1;"),o>1&&(r+="thisRC.y += 1;"),s+=`
        ${r}
        ${o>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${o}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${o>0?"}":""}
      `}this.userCode=`
      ${Kee(n,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?D0():R0(e)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};

        ${s}

        setOutput(result);
      }
    `}}function Kee(t,e){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${e?YQ(["r","c","d"],"inputShape"):la(["r","c","d"],t)}
      return ivec3(r, c, d);
    }
  `}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Xee{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}acquireTexture(e,n,s){const o=DC(n,s),r=OC(e,o,s);r in this.freeTextures||(this.freeTextures[r]=[]),r in this.usedTextures||(this.usedTextures[r]=[]);const i=RC(e,o,this.gpgpu.gl,this.gpgpu.textureConfig,s);if(this.freeTextures[r].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=i,this.log();const l=this.freeTextures[r].shift();return this.usedTextures[r].push(l),l}let a;return o===Cn.PACKED_2X2_FLOAT32?a=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):o===Cn.PACKED_2X2_FLOAT16?a=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):o===Cn.UNPACKED_FLOAT32?a=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):o===Cn.UNPACKED_FLOAT16?a=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):o===Cn.PACKED_4X1_UNSIGNED_BYTE&&(a=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[r].push(a),this.numUsedTextures++,this._numBytesAllocated+=i,this.log(),a}releaseTexture(e,n,s,o){if(this.freeTextures==null)return;const r=DC(s,o),i=OC(n,r,o);i in this.freeTextures||(this.freeTextures[i]=[]);const a=RC(n,r,this.gpgpu.gl,this.gpgpu.textureConfig,o),l=se().get("WEBGL_DELETE_TEXTURE_THRESHOLD");l!==-1&&this._numBytesAllocated>l?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=a):(this.freeTextures[i].push(e),this.numFreeTextures++,this._numBytesFree+=a),this.numUsedTextures--;const c=this.usedTextures[i],u=c.indexOf(e);if(u<0)throw new Error("Cannot release a texture that was never provided by this texture manager");c.splice(u,1),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);const n=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*n)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const e in this.freeTextures)this.freeTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});for(const e in this.usedTextures)this.usedTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function Yee(t,e){const n=t;if(e===n.R32F)return 4;if(e===n.R16F)return 2;if(e===n.RGBA32F)return 16;if(e===t.RGBA)return 16;if(e===n.RGBA16F)return 8;if(e===n.RGBA8)return 4;throw new Error(`Unknown internal format ${e}`)}function RC(t,e,n,s,o){const r=Zee(e,s);let i;if(o){const[l,c]=Al(t[0],t[1]);i=l*c}else{const[l,c]=Ju(t[0],t[1]);i=l*c}const a=Yee(n,r);return i*a}function Zee(t,e){switch(t){case Cn.PACKED_2X2_FLOAT32:return CN(e);case Cn.PACKED_2X2_FLOAT16:return $N(e);case Cn.UNPACKED_FLOAT32:return yN(e);case Cn.UNPACKED_FLOAT16:return vN(e);case Cn.PACKED_4X1_UNSIGNED_BYTE:return wN(e);default:throw new Error(`Unknown physical texture type ${t}`)}}function Qee(t){return se().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?Cn.PACKED_2X2_FLOAT32:Cn.UNPACKED_FLOAT32:t?Cn.PACKED_2X2_FLOAT16:Cn.UNPACKED_FLOAT16}function DC(t,e){if(t===Is.UPLOAD)return Cn.PACKED_2X2_FLOAT32;if(t===Is.RENDER||t==null)return Qee(e);if(t===Is.DOWNLOAD||t===Is.PIXELS)return Cn.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${t}`)}function OC(t,e,n){return`${t[0]}_${t[1]}_${e}_${n}`}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sr{constructor(e,n){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=Gn(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${n}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const eo="if (isnan(x)) return x;",Jee="return x;",FC="return abs(x);",ete="return (x >= 0.0) ? x : (exp(x) - 1.0);",tte=eo+`
  return (x < 0.0) ? 0.0 : x;
`,nte=eo+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,Aa="return x;",ste="return 1.0 / (1.0 + exp(-1.0 * x));";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ote="return x;",rte=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,ite=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,ate=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,lte="return 1.0 / (1.0 + exp(-1.0 * x));";class Ai{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=Gn(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${n}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cte{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=Gn(this.outputShape.length);const n=e.length,s=zn("rc",n),o=It(n),r=jee(n,s),i=s.slice(-2),a=n<=1?"rc":`vec2(${i.join(",")})`;this.userCode=`
      void main() {
        ${o} rc = getOutputCoords();
        vec4 packedInput = getA(${r});

        setOutput(getChannel(packedInput, ${a}));
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ute=_k,hte=1e-7,dte=1e-4,Kh={};function fte(t){return t in Kh||(Kh[t]={}),Kh[t]}const pte=se().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),mte=600;function gte(){return se().global.screen==null?1024:se().global.screen.height*se().global.screen.width*window.devicePixelRatio*mte/1024/1024}class zp extends qb{constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!se().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let n;if(e!=null){if(e instanceof sg)n=e;else{const s=yo(se().getNumber("WEBGL_VERSION"),e);n=new sg(s)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const s=yo(se().getNumber("WEBGL_VERSION"));n=new sg(s),this.binaryCache=fte(se().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=n,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new Xee(this.gpgpu),this.numMBBeforeWarning=gte(),this.texData=new MI(this,Er())}nextDataId(){return zp.nextDataId++}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}write(e,n,s){if((se().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||se().getBool("DEBUG"))&&this.checkNumericalProblems(e),s==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const o={id:this.nextDataId()};return this.texData.set(o,{shape:n,dtype:s,values:e,usage:Is.UPLOAD,refCount:1}),o}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){const n=this.texData.get(e);n.refCount++}decRef(e){if(this.texData.has(e)){const n=this.texData.get(e);n.refCount--}}move(e,n,s,o,r){if(se().getBool("DEBUG")&&this.checkNumericalProblems(n),o==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:s,dtype:o,values:n,usage:Is.UPLOAD,refCount:r})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const n=this.texData.get(e),{values:s,dtype:o,complexTensorInfos:r,slice:i,shape:a,isPacked:l}=n;if(i!=null){let d;l?d=new Ai(a,Aa):d=new sr(a,Aa);const f=this.runWebGLProgram(d,[{dataId:e,shape:a,dtype:o}],o),p=this.readSync(f.dataId);return this.disposeIntermediateTensorInfo(f),p}if(s!=null)return this.convertAndCacheOnCPU(e);if(o==="string")return s;const c=this.activeTimers!=null;let u;c&&(u=Zn());let h;if(o==="complex64"){const d=this.readSync(r.real.dataId),f=this.readSync(r.imag.dataId);h=ar(d,f)}else h=this.getValuesFromTexture(e);return c&&(this.downloadWaitMs+=Zn()-u),this.convertAndCacheOnCPU(e,h)}async read(e){if(this.pendingRead.has(e)){const p=this.pendingRead.get(e);return new Promise(g=>p.push(g))}const n=this.texData.get(e),{values:s,shape:o,slice:r,dtype:i,complexTensorInfos:a,isPacked:l}=n;if(r!=null){let p;l?p=new Ai(o,Aa):p=new sr(o,Aa);const g=this.runWebGLProgram(p,[{dataId:e,shape:o,dtype:i}],i),b=this.read(g.dataId);return this.disposeIntermediateTensorInfo(g),b}if(s!=null)return this.convertAndCacheOnCPU(e);if(se().getBool("DEBUG")&&!se().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&se().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let c=null,u;if(i!=="complex64"&&se().get("WEBGL_BUFFER_SUPPORTED")){u=this.decode(e);const p=this.texData.get(u.dataId);c=this.gpgpu.createBufferFromTexture(p.texture.texture,...Hh(o))}this.pendingRead.set(e,[]),i!=="complex64"&&await this.gpgpu.createAndWaitForFence();let h;if(i==="complex64"){const p=await Promise.all([this.read(a.real.dataId),this.read(a.imag.dataId)]),g=p[0],b=p[1];h=ar(g,b)}else if(c==null)h=this.getValuesFromTexture(e);else{const p=ae(o);h=this.gpgpu.downloadFloat32MatrixFromBuffer(c,p)}if(u!=null&&this.disposeIntermediateTensorInfo(u),c!=null){const p=this.gpgpu.gl;Fe(p,()=>p.deleteBuffer(c))}const d=this.convertAndCacheOnCPU(e,h),f=this.pendingRead.get(e);return this.pendingRead.delete(e),f.forEach(p=>p(d)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&Er().removeDataId(e,this),this.pendingDeletes--),d}readToGPU(e,n={}){const s=this.texData.get(e),{values:o,shape:r,slice:i,dtype:a,isPacked:l,texture:c}=s;if(a==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(i!=null){let f;l?f=new Ai(r,Aa):f=new sr(r,Aa);const p=this.runWebGLProgram(f,[{dataId:e,shape:r,dtype:a}],a),g=this.readToGPU(p,n);return this.disposeIntermediateTensorInfo(p),g}if(c==null)throw o!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const u=this.decode(e,n.customTexShape),h=Er().makeTensorFromTensorInfo(u),d=this.texData.get(u.dataId);return Object.assign({tensorRef:h},d.texture)}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const s=n.map(o=>Mr(o));return nt(e.shape,e.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return nt(e.shape,e.dtype,n)}checkNumericalProblems(e){if(e!=null)for(let n=0;n<e.length;n++){const s=e[n];if(!$Q(s))throw se().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${s} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${s} cannot be represented on this device.`)}}getValuesFromTexture(e){const{shape:n,dtype:s,isPacked:o}=this.texData.get(e),r=ae(n);if(se().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const d=this.decode(e),f=this.texData.get(d.dataId),p=this.gpgpu.downloadMatrixFromPackedTexture(f.texture.texture,...Hh(n)).subarray(0,r);return this.disposeIntermediateTensorInfo(d),p}const i=se().getBool("WEBGL_PACK")&&o===!0,a=i?eg(n):n,l=i?new BJ(a):new MJ(a),c=this.runWebGLProgram(l,[{shape:a,dtype:s,dataId:e}],"float32"),u=this.texData.get(c.dataId),h=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(u.texture.texture,u.texShape[0],u.texShape[1]).subarray(0,r);return this.disposeIntermediateTensorInfo(c),h}timerAvailable(){return se().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const n=this.activeTimers,s=[];let o=!1;this.programTimersStack==null?(this.programTimersStack=s,o=!0):this.activeTimers.push(s),this.activeTimers=s,e();const r=sl(this.activeTimers.map(l=>l.query)).filter(l=>l!=null),i=sl(this.activeTimers.map(l=>l.name)).filter(l=>l!=null);this.activeTimers=n,o&&(this.programTimersStack=null);const a={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(se().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const l=await Promise.all(r);a.kernelMs=oz(l),a.getExtraProfileInfo=()=>l.map((c,u)=>({name:i[u],ms:c})).map(c=>`${c.name}: ${c.ms}`).join(", ")}else a.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,a})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return se().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:Zn(),endMs:null}}endTimer(e){return se().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=Zn(),e)}async getQueryTime(e){if(se().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const n=e;return n.endMs-n.startMs}disposeData(e,n=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(n?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!n&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:s}=this.texData.get(e);return s!=null&&(this.disposeData(s.real.dataId,n),this.disposeData(s.imag.dataId,n)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:n,dtype:s,texShape:o,usage:r,isPacked:i,slice:a}=this.texData.get(e),l=a&&a.origDataId||e,c=this.dataRefCount.get(l);c>1?this.dataRefCount.set(l,c-1):(this.dataRefCount.delete(l),n!=null&&(this.numBytesInGPU-=this.computeBytes(o,s),this.textureManager.releaseTexture(n,o,r,i)));const u=this.texData.get(e);u.texture=null,u.texShape=null,u.isPacked=!1,u.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,n=pte){return se().getBool("WEBGL_CPU_FORWARD")&&e.every(s=>this.texData.get(s.dataId).texture==null&&ae(s.shape)<n)}getGPGPUContext(){return this.gpgpu}where(e){Cs("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const n=e.dataSync();return ute(e.shape,n)}packedUnaryOp(e,n,s){const o=new Ai(e.shape,n),r=this.compileAndRun(o,[e],s);return Er().makeTensorFromTensorInfo(r)}abs(e){if(this.shouldExecuteOnCPU([e])&&e.dtype!=="complex64"){const o=_N(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,o)}if(se().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,FC,e.dtype);const n=new sr(e.shape,FC),s=this.compileAndRun(n,[e]);return Er().makeTensorFromTensorInfo(s)}makeTensorInfo(e,n,s){let o;if(n==="string"&&s!=null&&s.length>0&&Mc(s[0])){const r=s.map(i=>Or(i));o=this.write(r,e,n)}else o=this.write(s,e,n);return this.texData.get(o).usage=null,{dataId:o,shape:e,dtype:n}}makeOutput(e,n,s){return Er().makeTensorFromTensorInfo(this.makeTensorInfo(e,n,s),this)}unpackTensor(e){const n=new cte(e.shape);return this.runWebGLProgram(n,[e],e.dtype)}packTensor(e){const n=new qee(e.shape),s=!0;return this.runWebGLProgram(n,[e],e.dtype,null,s)}packedReshape(e,n){const s=[pl(e.shape),...ml(e.shape)],o={dtype:e.dtype,shape:s,dataId:e.dataId},r=[pl(n),...ml(n)],i=new SN(r,s),a=!0,l=[s],c=this.runWebGLProgram(i,[o],e.dtype,l,a);return{dataId:c.dataId,shape:n,dtype:c.dtype}}decode(e,n){const s=this.texData.get(e),{isPacked:o,shape:r,dtype:i}=s;if(n!=null){const d=ae(r),f=n[0]*n[1]*4;T(d<=f,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const a=eg(r);let l;o?l=new PJ(a):l=new LJ(a);const c=!0,u=[n!=null?n:Hh(a)],h=this.runWebGLProgram(l,[{shape:a,dtype:i,dataId:e}],i,u,c,n);return{dtype:i,shape:r,dataId:h.dataId}}runWebGLProgram(e,n,s,o,r=!1,i){const a=this.makeTensorInfo(e.outputShape,s),l=this.texData.get(a.dataId);if(e.packedOutput&&(l.isPacked=!0),e.outPackingScheme===Ac.DENSE){const x=i!=null?i:Hh(e.outputShape);l.texShape=x.map(y=>y*2)}if(e.outTexUsage!=null&&(l.usage=e.outTexUsage),ae(a.shape)===0)return l.values=$n(a.dtype,0),a;const c=[],u=n.map(x=>{if(x.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let y=this.texData.get(x.dataId);if(y.texture==null){if(!e.packedInputs&&ae(x.shape)<=se().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:x.shape,texData:null,isUniform:!0,uniformValues:y.values};e.packedInputs&&(y.isPacked=!0,y.shape=x.shape)}if(this.uploadToGPU(x.dataId),!!y.isPacked!=!!e.packedInputs)x=y.isPacked?this.unpackTensor(x):this.packTensor(x),c.push(x),y=this.texData.get(x.dataId);else if(y.isPacked&&!Wd(y.shape,x.shape)){const w=x,v=x.shape;x.shape=y.shape,x=this.packedReshape(x,v),c.push(x),y=this.texData.get(x.dataId),w.shape=v}return{shape:x.shape,texData:y,isUniform:!1}});this.uploadToGPU(a.dataId);const h={shape:a.shape,texData:l,isUniform:!1},d=FJ(e,u,h),f=this.getAndSaveBinary(d,()=>DJ(this.gpgpu,e,u,h)),p=this.activeTimers!=null;let g;p&&(g=this.startTimer()),se().get("ENGINE_COMPILE_ONLY")||OJ(this.gpgpu,f,u,h,o),c.forEach(x=>this.disposeIntermediateTensorInfo(x)),p&&(g=this.endTimer(g),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(g)}));const b=se().get("WEBGL_FLUSH_THRESHOLD");if(b>0){const x=Zn();x-this.lastGlFlushTime>b&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=x)}if(!se().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&r===!1){const x=this.unpackTensor(a);return this.disposeIntermediateTensorInfo(a),x}return a}compileAndRun(e,n,s,o,r=!1){return s=s||n[0].dtype,this.runWebGLProgram(e,n,s,o,r)}getAndSaveBinary(e,n){return e in this.binaryCache||(this.binaryCache[e]=n()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(se().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(n=>{this.gpgpu.deleteProgram(this.binaryCache[n].webGLProgram),delete this.binaryCache[n]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=J(()=>{if(!se().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=se().getBool("DEBUG");se().set("DEBUG",!1);const n=this.abs(Ge(1e-8)).dataSync()[0];if(se().set("DEBUG",e),n>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?hte:dte}uploadToGPU(e){const n=this.texData.get(e),{shape:s,dtype:o,values:r,texture:i,usage:a,isPacked:l}=n;if(i!=null)return;const c=this.activeTimers!=null;let u;c&&(u=Zn());let h=n.texShape;if(h==null&&(h=zQ(s,l),n.texShape=h),r!=null){const d=eg(s);let f,p=h[1],g=h[0];const b=r instanceof Uint8Array||r instanceof Uint8ClampedArray;(l||!b)&&([p,g]=Al(h[0],h[1])),l?f=new zJ(d,b):f=new VJ(d,b);const x=b?[g,p]:h,y=this.makeTensorInfo(x,o),w=this.texData.get(y.dataId);b?w.usage=Is.PIXELS:w.usage=Is.UPLOAD,w.texShape=x,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(y.dataId),p,g,r);const v=[[g,p]],$=!0,_=this.runWebGLProgram(f,[y],o,v,$),E=this.texData.get(_.dataId);n.texShape=E.texShape,n.isPacked=E.isPacked,n.usage=E.usage,se().get("ENGINE_COMPILE_ONLY")?this.disposeData(_.dataId):(n.texture=E.texture,n.values=null,this.texData.delete(_.dataId)),this.disposeIntermediateTensorInfo(y),c&&(this.uploadWaitMs+=Zn()-u)}else{const d=this.acquireTexture(h,a,o,l);n.texture=d}}convertAndCacheOnCPU(e,n){const s=this.texData.get(e),{dtype:o}=s;return this.releaseGPUData(e),n!=null&&(s.values=bte(n,o)),s.values}acquireTexture(e,n,s,o){if(this.numBytesInGPU+=this.computeBytes(e,s),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const r=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${r} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,n,o)}computeBytes(e,n){return e[0]*e[1]*Dg(n)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,n]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(n));return Promise.all(e)}else{for(const[,n]of Object.entries(this.binaryCache)){const s=new Promise(o=>{try{this.checkCompletion_(n),o(!0)}catch(r){throw r}});e.push(s)}return Promise.all(e)}}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await Tk(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(fN(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const[,e]of Object.entries(this.binaryCache)){const{uniformLocations:n,customUniformLocations:s,infLoc:o,nanLoc:r,inShapesLocations:i,inTexShapesLocations:a,outShapeLocation:l,outShapeStridesLocation:c,outTexShapeLocation:u}=xN(this.gpgpu,e.program,e.webGLProgram);e.uniformLocations=n,e.customUniformLocations=s,e.infLoc=o,e.nanLoc=r,e.inShapesLocations=i,e.inTexShapesLocations=a,e.outShapeLocation=l,e.outShapeStridesLocation=c,e.outTexShapeLocation=u}}}zp.nextDataId=0;function bte(t,e){if(e==="float32"||e==="complex64")return t;if(e==="int32"||e==="bool"){const n=e==="int32"?new Int32Array(t.length):new Uint8Array(t.length);for(let s=0;s<n.length;++s)n[s]=Math.round(t[s]);return n}else throw new Error(`Unknown dtype ${e}`)}/** @license See the LICENSE file. *//**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */v_()&&O_("webgl",()=>new zp,2);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TN=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class gl{constructor(e,n,s){this.variableNames=["A","B"],this.outputShape=Ye(n,s),this.enableShapeUniforms=Gn(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${e}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wp=`
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;
`;class nh{constructor(e,n,s,o=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Ye(n,s);const r=this.outputShape.length;this.enableShapeUniforms=Gn(r);let i="";if(o)if(r===0||ae(this.outputShape)===1)i=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(i=`
          ${It(r)} coords = getOutputCoords();
        `,r===1)this.enableShapeUniforms?i+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:i+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const l=zn("coords",r);this.enableShapeUniforms?i+=`
            bool nextRowOutOfBounds =
              (${l[r-2]} + 1) >= outShape[${r} - 2];
            bool nextColOutOfBounds =
              (${l[r-1]} + 1) >= outShape[${r} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:i+=`
            bool nextRowOutOfBounds =
              (${l[r-2]} + 1) >= ${this.outputShape[r-2]};
            bool nextColOutOfBounds =
              (${l[r-1]} + 1) >= ${this.outputShape[r-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${e}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${i}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ms(t){const{inputs:e,backend:n}=t,{x:s}=e;return n.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const xte={kernelName:au,backendName:"webgl",kernelFunc:ms};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ni(t){const{inputs:e,backend:n}=t,{real:s,imag:o}=e,r=n.makeTensorInfo(s.shape,"complex64"),i=n.texData.get(r.dataId),a=ms({inputs:{x:s},backend:n}),l=ms({inputs:{x:o},backend:n});return i.complexTensorInfos={real:a,imag:l},r}const yte={kernelName:sx,backendName:"webgl",kernelFunc:ni};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NN="return (a < 0.) ? b * a : a;",AN=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function vte(t){const{inputs:e,backend:n,attrs:s}=t,{x:o}=e,{alpha:r}=s,i=n.makeTensorInfo([],"float32",qr(r,"float32")),a=se().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new nh(AN,o.shape,i.shape):new gl(NN,o.shape,i.shape),l=n.runWebGLProgram(a,[o,i],"float32");return n.disposeIntermediateTensorInfo(i),l}const wte={kernelName:Af,backendName:"webgl",kernelFunc:vte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RN="return (a < 0.) ? b * a : a;",DN=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function Cte(t){const{inputs:e,backend:n}=t,{x:s,alpha:o}=e,r=se().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new nh(DN,s.shape,o.shape):new gl(RN,s.shape,o.shape);return n.runWebGLProgram(r,[s,o],"float32")}const $te={kernelName:Yf,backendName:"webgl",kernelFunc:Cte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ll="if (isnan(x)) return x;",Ite=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`,_te=`
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;
`;function dt({opSnippet:t,packedOpSnippet:e,cpuKernelImpl:n,dtype:s}){return({inputs:o,backend:r})=>{const{x:i}=o,a=r,l=s||i.dtype;if(a.shouldExecuteOnCPU([i])&&n!=null){const h=a.texData.get(i.dataId),d=n(h.values,l);return a.makeTensorInfo(i.shape,l,d)}const c=se().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&e!=null;let u;return c?u=new Ai(i.shape,e):u=new sr(i.shape,t),a.runWebGLProgram(u,[i],l)}}function kn({opSnippet:t,packedOpSnippet:e,checkOutOfBounds:n=!1,supportsComplex:s=!1,cpuKernelImpl:o,dtype:r}){return({inputs:i,backend:a})=>{const{a:l,b:c}=i,u=a;if(s&&l.dtype==="complex64"){const p=u.texData.get(l.dataId),g=u.texData.get(c.dataId),[b,x]=[[p.complexTensorInfos.real,g.complexTensorInfos.real],[p.complexTensorInfos.imag,g.complexTensorInfos.imag]].map(w=>{const[v,$]=w,_={dataId:v.dataId,dtype:v.dtype,shape:l.shape},E={dataId:$.dataId,dtype:$.dtype,shape:c.shape},k=new gl(t,l.shape,c.shape);return u.runWebGLProgram(k,[_,E],ds(v.dtype,$.dtype))}),y=ni({inputs:{real:b,imag:x},backend:u});return u.disposeIntermediateTensorInfo(b),u.disposeIntermediateTensorInfo(x),y}const h=r||ds(l.dtype,c.dtype);if((l.dtype==="string"||c.dtype==="string"||u.shouldExecuteOnCPU([l,c]))&&o!=null){const p=u.texData.get(l.dataId).values,g=u.texData.get(c.dataId).values,b=l.dtype==="string"?Ji(p):p,x=l.dtype==="string"?Ji(g):g,[y,w]=o(l.shape,c.shape,b,x,h),v=u.makeTensorInfo(w,h),$=u.texData.get(v.dataId);return $.values=y,v}const d=se().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&e!=null;let f;return d?f=new nh(e,l.shape,c.shape,n):f=new gl(t,l.shape,c.shape),u.runWebGLProgram(f,[l,c],h)}}function Rc(t,e=!1){if(t==="linear")return e?ote:Jee;if(t==="relu")return e?ite:tte;if(t==="elu")return e?rte:ete;if(t==="relu6")return e?ate:nte;if(t==="prelu")return e?DN:RN;if(t==="leakyrelu")return e?AN:NN;if(t==="sigmoid")return e?lte:ste;throw new Error(`Activation ${t} has not been implemented for the WebGL backend.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ON{constructor(e,n,s,o=!1,r=!1,i=!1,a=null,l=!1,c=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=s,this.enableShapeUniforms=Gn(this.outputShape.length);const u=o?e[1]:e[2],h=Math.ceil(u/2),d=o?"i * 2, rc.y":"rc.y, i * 2",f=r?"rc.z, i * 2":"i * 2, rc.z",p=o?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],g=r?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let b="",x="";a&&(l?b=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${a}
        }`:c?b=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${a}
        }`:b=`vec4 activation(vec4 x) {
          ${a}
        }`,x="result = activation(result);");const y=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),l&&this.variableNames.push("preluActivationWeights"),c&&this.variableNames.push("leakyreluAlpha");let w="rc.x",v="rc.x";e[0]<n[0]?w=`int(min(float(rc.x), ${e[0]-1}.))`:n[0]<e[0]&&(v=`int(min(float(rc.x), ${n[0]-1}.))`),this.userCode=`
      ${b}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${h}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        for (int i = 0; i < ${h}; i++) {
          int batchA = ${w};
          int batchB = ${v};
          vec4 a = getMatrixA(batchA, ${d});
          vec4 b = getMatrixB(batchB, ${f});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${p[0]} * ${g[0]});
          result += (${p[1]} * ${g[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${y}

        ${x}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LC={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class PC{constructor(e,n,s){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Ye(n,s),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${e}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MC="return a * b;";function L0(t){const{inputs:e,backend:n}=t,{a:s,b:o}=e,r=ds(s.dtype,o.dtype);if(s.dtype==="complex64"){const a=n.texData.get(s.dataId),l=n.texData.get(o.dataId),c=new PC(LC.REAL,s.shape,o.shape),u=new PC(LC.IMAG,s.shape,o.shape),h=[{dataId:a.complexTensorInfos.real.dataId,dtype:a.complexTensorInfos.real.dtype,shape:s.shape},{dataId:a.complexTensorInfos.imag.dataId,dtype:a.complexTensorInfos.imag.dtype,shape:s.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:o.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:o.shape}],d=n.runWebGLProgram(c,h,"float32"),f=n.runWebGLProgram(u,h,"float32"),p=ni({inputs:{real:d,imag:f},backend:n});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),p}if(n.shouldExecuteOnCPU([s,o])){const a=n.texData.get(s.dataId),l=n.texData.get(o.dataId),[c,u]=_ee(s.shape,o.shape,a.values,l.values,r),h=n.makeTensorInfo(u,r),d=n.texData.get(h.dataId);return d.values=c,h}let i;return se().getBool("WEBGL_PACK_BINARY_OPERATIONS")?i=new nh(MC,s.shape,o.shape):i=new gl(MC,s.shape,o.shape),n.runWebGLProgram(i,[s,o],r)}const kte={kernelName:gu,backendName:"webgl",kernelFunc:L0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ete(t,e,n){const s=[pl(t.shape),...ml(t.shape)],o={dtype:t.dtype,shape:s,dataId:t.dataId},r=[pl(e),...ml(e)],i=new SN(r,s),a=!0,l=[s],c=n.runWebGLProgram(i,[o],t.dtype,l,a);return{dataId:c.dataId,shape:e,dtype:c.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Te(t){const{inputs:e,backend:n,attrs:s}=t,{x:o}=e,{shape:r}=s,i=n,a=ae(o.shape),l=VI(r,a),c=ae(l);T(a===c,()=>`The new shape (${l}) has ${c} elements and the old shape (${o.shape}) has ${a} elements. The new shape and old shape must have the same number of elements.`);const u=i.texData.get(o.dataId);return u.isPacked&&!Wd(o.shape,l)&&!(u.texture!==null&&Wd(u.shape,l))?Ete(o,l,i):(i.incRef(o.dataId),{dataId:o.dataId,shape:l,dtype:o.dtype})}const Ste={kernelName:Qf,backendName:"webgl",kernelFunc:Te};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class BC{constructor(e,n){this.variableNames=["x"];const{windowSize:s,batchSize:o,inSize:r,outSize:i}=e;this.outputShape=[o,i];const a=Math.floor(s/4)*4,l=s%4;let c="sumValue += dot(values, ones);";if(n!=null){const h=1/n;c=`sumValue += dot(values * ${ol(h)?h.toPrecision(2):h}, ones);`}let u="";r%s>0&&(u=`
        if (inIdx < 0 || inIdx >= ${r}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${u}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        float sumValue = 0.0;

        for (int i = 0; i < ${a}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${c}
        }

        int inIdx = inOffset + ${a};
        if (${l===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${c}
        } else if (${l===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${c}
        } else if (${l===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${c}
        }
        setOutput(sumValue);
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Tte{constructor(e,n){this.variableNames=["x"];const{windowSize:s,batchSize:o,inSize:r,outSize:i}=e;this.outputShape=[o,i];let a="0.0",l="";n==="prod"?a="1.0":n==="min"?(a="1.0 / 1e-20",l="min"):n==="max"&&(a="-1.0 / 1e-20",l="max");let c=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="sum"?c="sumValue":n==="prod"?c="prodValue":n==="all"?c="allValue":n==="any"&&(c="anyValue");const u=Math.floor(s/4)*4,h=s%4;let d=`
      if (${n==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${n==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${l}(values, minMaxValue);
        if (${n==="min"} || ${n==="max"}) {
          minMaxValue = ${l}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,f="vec4";n==="all"?(a="1.0",d=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,f="bvec4"):n==="any"&&(a="0.0",d=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,f="bvec4");let p="";r%s>0&&(p=`
        if (inIdx < 0 || inIdx >= ${r}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${a};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${p}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        vec4 minMaxValue = vec4(${a});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${u}; i += 4) {
          int inIdx = inOffset + i;
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${d}
        }

        int inIdx = inOffset + ${u};
        if (${h===1}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${d}
        } else if (${h===2}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${d}
        } else if (${h===3}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${d}
        }
        setOutput(${c});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nte(t){const e=[];for(;e.length===0||e[e.length-1].outSize!==1;){const n=e.length?e[e.length-1].outSize:t[1],s=Ip(n);e.push({inSize:n,windowSize:s,outSize:Math.ceil(n/s)})}return e}function ua(t,e,n,s){const o=Nte(t.shape);let r=t;for(let i=0;i<o.length;i++){const{inSize:a,windowSize:l,outSize:c}=o[i];let u,h;n==="mean"?u=i===0?new BC({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:c},a):new BC({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:c}):u=new Tte({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:c},n),h=r,r=s.runWebGLProgram(u,[r],e),h.dataId!==t.dataId&&s.disposeIntermediateTensorInfo(h)}return r}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ate{constructor(e,n){this.variableNames=["A"];const s=new Array(e.length);for(let i=0;i<s.length;i++)s[i]=e[n[i]];this.outputShape=s,this.rank=s.length;const o=It(this.rank),r=Rte(n);this.userCode=`
    void main() {
      ${o} resRC = getOutputCoords();
      setOutput(getA(${r}));
    }
    `}}function Rte(t){const e=t.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],s=new Array(e);for(let o=0;o<t.length;o++)s[t[o]]=n[o];return s.join()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Dte{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const s=new Array(e.length);for(let u=0;u<s.length;u++)s[u]=e[n[u]];if(this.outputShape=s,this.rank=s.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const o=It(this.rank),r=EN("rc",this.rank),i=new Array(this.rank);for(let u=0;u<n.length;u++)i[n[u]]=r[u];const a=`vec2(${i.slice(-2).join()})`,l=`++${r[this.rank-1]} < ${s[this.rank-1]}`,c=`getChannel(getA(${i.join()}), ${a})`;this.userCode=`
    void main() {
      ${o} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${c};
      if(${l}) {
        result[1] = ${c};
      }
      --${r[this.rank-1]};
      if(++${r[this.rank-2]} < ${s[this.rank-2]}) {
        result[2] = ${c};
        if(${l}) {
          result[3] = ${c};
        }
      }
      setOutput(result);
    }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Up(t,e,n){const s=se().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Dte(t.shape,e):new Ate(t.shape,e);return n.runWebGLProgram(s,[t],t.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ote(t,e,n,s){const o=e,r=t.shape.length,i=st(o,t.shape);let a=i;const l=jt(a,r),c=l!=null;let u=t;c&&(u=Up(t,l,s),a=Zt(a.length,r)),_n("sum",a,r);const[h,d]=yn(u.shape,a);let f=h;n&&(f=Yt(h,i));const p=ae(d),b=ae(t.shape)/p,x=Te({inputs:{x:u},attrs:{shape:[b,p]},backend:s}),y=Wx(t.dtype),w=ua(x,y,"sum",s),v=Te({inputs:{x:w},attrs:{shape:f},backend:s});return s.disposeIntermediateTensorInfo(x),s.disposeIntermediateTensorInfo(w),c&&s.disposeIntermediateTensorInfo(u),v}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hp(t){const{inputs:e,backend:n,attrs:s}=t,{x:o}=e,{axis:r,keepDims:i}=s;return Ote(o,r,i,n)}const Fte={kernelName:op,backendName:"webgl",kernelFunc:Hp};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Un(t){const{inputs:e,backend:n,attrs:s}=t,{x:o}=e,{perm:r}=s,i=n,a=o.shape.length,l=new Array(a);for(let u=0;u<l.length;u++)l[u]=o.shape[r[u]];let c;if(i.shouldExecuteOnCPU([o])){const h=i.texData.get(o.dataId).values,d=F0(h,o.shape,o.dtype,r,l);c=i.makeTensorInfo(l,o.dtype);const f=i.texData.get(c.dataId);f.values=d}else c=Up(o,r,i);return c}const Lte={kernelName:ja,backendName:"webgl",kernelFunc:Un};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FN=1e3;function Ud({a:t,b:e,transposeA:n,transposeB:s,backend:o,bias:r=null,preluActivationWeights:i=null,leakyreluAlpha:a=0,activation:l=null}){const c=t.shape.length,u=e.shape.length,h=n?t.shape[c-2]:t.shape[c-1],d=s?e.shape[u-1]:e.shape[u-2],f=n?t.shape[c-1]:t.shape[c-2],p=s?e.shape[u-2]:e.shape[u-1],g=t.shape.slice(0,-2),b=e.shape.slice(0,-2),x=ae(g),y=ae(b),v=Ye(t.shape.slice(0,-2),e.shape.slice(0,-2)).concat([f,p]);T(h===d,()=>`Error in matMul: inner shapes (${h}) and (${d}) of Tensors with shapes ${t.shape} and ${e.shape} and transposeA=${n} and transposeB=${s} must match.`);const $=n?[x,h,f]:[x,f,h],_=s?[y,p,d]:[y,d,p],E=Te({inputs:{x:t},backend:o,attrs:{shape:$}}),k=Te({inputs:{x:e},backend:o,attrs:{shape:_}}),N=[E,k],A=Math.max(x,y),F=n?E.shape[1]:E.shape[2],L=r!=null,H=i!=null,M=l==="leakyrelu",K=l!=null?Rc(l,!0):null,q=L||H||M||K!=null;let Q;if((f===1||p===1)&&F>FN&&q===!1){let ie=E,pe=k;n&&(ie=Un({inputs:{x:E},backend:o,attrs:{perm:[0,2,1]}}),N.push(ie)),s&&(pe=Un({inputs:{x:k},backend:o,attrs:{perm:[0,2,1]}}),N.push(pe));const he=p!==1,xe=p===1;let me=ie;he&&(me=Te({inputs:{x:ie},backend:o,attrs:{shape:[A,F,1]}}),N.push(me));const Ie=p===1?2:1;let G=pe;xe&&(G=Te({inputs:{x:pe},backend:o,attrs:{shape:[A,1,F]}}),N.push(G));const le=L0({inputs:{a:me,b:G},backend:o});Q=Hp({inputs:{x:le},backend:o,attrs:{axis:Ie,keepDims:!0}}),N.push(le)}else{const ie=ds(t.dtype,e.dtype),pe=new ON($,_,[A,f,p],n,s,L,K,H,M),he=[E,k];if(r!=null&&he.push(r),H&&he.push(i),M){const xe=o.makeTensorInfo([],"float32",qr(a,"float32"));he.push(xe),N.push(xe)}Q=o.runWebGLProgram(pe,he,ie)}const Y=Te({inputs:{x:Q},backend:o,attrs:{shape:v}});N.push(Q);for(const ie of N)o.disposeIntermediateTensorInfo(ie);return Y}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pte(t){const{inputs:e,backend:n,attrs:s}=t,{a:o,b:r,bias:i,preluActivationWeights:a}=e,{transposeA:l,transposeB:c,activation:u,leakyreluAlpha:h}=s;return Ud({a:o,b:r,transposeA:l,transposeB:c,backend:n,bias:i,preluActivationWeights:a,leakyreluAlpha:h,activation:u})}const Mte={kernelName:bd,backendName:"webgl",kernelFunc:Pte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VC="return abs(x);";function Bte(t){const{inputs:e,backend:n}=t,{x:s}=e;if(n.shouldExecuteOnCPU([s])&&s.dtype!=="complex64"){const r=n.texData.get(s.dataId),i=_N(r.values);return n.makeTensorInfo(s.shape,s.dtype,i)}let o;return se().getBool("WEBGL_PACK_UNARY_OPERATIONS")?o=new Ai(s.shape,VC):o=new sr(s.shape,VC),n.runWebGLProgram(o,[s],s.dtype)}const Vte={kernelName:hf,backendName:"webgl",kernelFunc:Bte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zte=eo+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,Wte=dt({opSnippet:zte}),Ute={kernelName:zc,backendName:"webgl",kernelFunc:Wte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hte=eo+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,Gte=dt({opSnippet:Hte}),jte={kernelName:Wc,backendName:"webgl",kernelFunc:Gte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zC="return a + b;",qte=kn({opSnippet:zC,packedOpSnippet:zC,supportsComplex:!0,cpuKernelImpl:ree}),Kte={kernelName:$l,backendName:"webgl",kernelFunc:qte};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Xte{constructor(e,n){this.outputShape=[],this.outputShape=e,this.variableNames=n.map((r,i)=>`T${i}`);const s=[];this.variableNames.forEach(r=>{s.push(`float v${r} = get${r}AtOutCoords();`)});const o=this.variableNames.map(r=>`v${r}`).join(" + ");this.userCode=`
      void main() {
        ${s.join(`
        `)}

        float result = ${o};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Yte{constructor(e,n){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=n.map((r,i)=>`T${i}`);const s=[];this.variableNames.forEach(r=>{s.push(`vec4 v${r} = get${r}AtOutCoords();`)});const o=this.variableNames.map(r=>`v${r}`).join(" + ");this.userCode=`
      void main() {
        ${s.join(`
        `)}

        vec4 result = ${o};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function od(t){const{inputs:e,backend:n}=t,s=e;if(s.length===1)return ms({inputs:{x:s[0]},backend:n});if(s.length>se().get("WEBGL_MAX_TEXTURES_IN_SHADER")){const l=Math.floor(s.length/2),c=od({inputs:s.slice(0,l),backend:n}),u=od({inputs:s.slice(l),backend:n});return od({inputs:[c,u],backend:n})}const o=s.map(l=>l.dtype).reduce((l,c)=>ds(l,c)),r=s.map(l=>l.shape),a=se().getBool("WEBGL_PACK")?new Yte(s[0].shape,r):new Xte(s[0].shape,r);return n.runWebGLProgram(a,s,o)}const Zte={kernelName:Zb,backendName:"webgl",kernelFunc:od};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qte(t){const{inputs:e,backend:n,attrs:s}=t,{x:o}=e,{axis:r,keepDims:i}=s,a=o.shape.length,l=st(r,o.shape);let c=l;const u=jt(c,a);let h=o;u!=null&&(h=Un({inputs:{x:o},backend:n,attrs:{perm:u}}),c=Zt(c.length,a)),_n("all",c,a);const[d,f]=yn(h.shape,c),p=ae(f),g=Te({inputs:{x:h},backend:n,attrs:{shape:[-1,p]}}),b=ua(g,g.dtype,"all",n);let x;if(i){const y=Yt(d,l);x=Te({inputs:{x:b},backend:n,attrs:{shape:y}})}else x=Te({inputs:{x:b},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(b),u!=null&&n.disposeIntermediateTensorInfo(h),x}const Jte={kernelName:Qb,backendName:"webgl",kernelFunc:Qte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ene(t){const{inputs:e,backend:n,attrs:s}=t,{x:o}=e,{axis:r,keepDims:i}=s,a=o.shape.length,l=st(r,o.shape);let c=l;const u=jt(c,a);let h=o;u!=null&&(h=Un({inputs:{x:o},backend:n,attrs:{perm:u}}),c=Zt(c.length,a)),_n("any",c,a);const[d,f]=yn(h.shape,c),p=ae(f),g=Te({inputs:{x:h},backend:n,attrs:{shape:[-1,p]}}),b=ua(g,g.dtype,"any",n);let x;if(i){const y=Yt(d,l);x=Te({inputs:{x:b},backend:n,attrs:{shape:y}})}else x=Te({inputs:{x:b},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(b),u!=null&&n.disposeIntermediateTensorInfo(h),x}const tne={kernelName:Jb,backendName:"webgl",kernelFunc:ene};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nne{constructor(e,n,s){this.variableNames=["A"];const{windowSize:o,batchSize:r,outSize:i}=e;s||this.variableNames.push("bestIndicesA"),this.outputShape=[r,i];const a=n==="max"?">":"<",l=s?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${o};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${o}; i++) {
          int inIdx = ${l};
          float candidate = getA(batch, inIdx);
          if (candidate ${a} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sne{constructor(e,n,s,o){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,T(e.length>2,()=>`Packed arg${s.charAt(0).toUpperCase()+s.slice(1)} supports only inputs with rank above 2.`);const r=e[e.length-1],i=Math.ceil(r/n);this.outputShape=e.slice(0,-1),i>1&&this.outputShape.push(i),o||this.variableNames.push("bestIndicesA");const a=this.outputShape,l=a.length,c=It(l),u=zn("coords",l);let h,d;if(i===1){d=l+1;const k=It(d);h=`
        ${k} sourceLocR = ${k}(${u.join()}, 0);
        ++${u[l-1]};
        ${k} sourceLocG = ${k}(${u.join()}, 0);
        ++${u[l-2]};
        ${k} sourceLocA = ${k}(${u.join()}, 0);
        --${u[l-1]};
        ${k} sourceLocB = ${k}(${u.join()}, 0);
        --${u[l-2]};`}else d=l,h=`
        ${c} sourceLocR = coords;
        ++${u[l-1]};
        ${c} sourceLocG = coords;
        ++${u[l-2]};
        ${c} sourceLocA = coords;
        --${u[l-1]};
        ${c} sourceLocB = coords;
        --${u[l-2]};`;const f=["x","y","z","w","u","v"].slice(0,d),p="."+f[d-1],g=f.map(k=>"int "+k),b=zn("sourceLocR",d-1).concat("inIdx.r"),x=zn("sourceLocG",d-1).concat("inIdx.g"),y=zn("sourceLocB",d-1).concat("inIdx.b"),w=zn("sourceLocA",d-1).concat("inIdx.a"),v=s==="max"?"greaterThan":"lessThan",$=o?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${b.join()}),
                             getBestIndicesAChannel(${x.join()}),
                             getBestIndicesAChannel(${y.join()}),
                             getBestIndicesAChannel(${w.join()})));`,_=`vec4(
            getAChannel(${b.join()}),
            hasNextCol ? getAChannel(${x.join()}) : 0.,
            hasNextRow ? getAChannel(${y.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${w.join()}) : 0.)`,E=o?"":`
      float getBestIndicesAChannel(${g.join()}) {
        return getChannel(getBestIndicesA(${f.join()}),
                                          vec2(${f.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${g.join()}) {
        return getChannel(getA(${f.join()}),
                               vec2(${f.slice(-2).join()}));
      }
      ${E}
      void main() {
        ${c} coords = getOutputCoords();
        bool hasNextCol = ${u[l-1]} < ${a[l-1]-1};
        bool hasNextRow = ${u[l-2]} < ${a[l-2]-1};
        ${h}
        ivec4 srcIdx = ivec4(sourceLocR${p}, sourceLocG${p},
          sourceLocB${p}, sourceLocA${p}) * ${n};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${_};

        for (int i = 0; i < ${n}; i++) {
          inIdx = srcIdx;
          ${$}
          vec4 candidate = ${_};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${v}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LN(t,e,n,s=null){let o=e.shape[0],r=e.shape[1];s!=null&&(o=s.shape[0],r=s.shape[1]);const i=Ip(r),a={windowSize:i,inSize:r,batchSize:o,outSize:Math.ceil(r/i)},l=new nne(a,n,s==null),c=[e];s!=null&&c.push(s);const u=t.runWebGLProgram(l,c,"int32");if(u.shape[1]===1)return u;const h=LN(t,e,n,u);return t.disposeIntermediateTensorInfo(u),h}function PN(t,e,n,s=null){const o=s!=null?s.shape:e.shape,r=o[o.length-1],i=Ip(r),a=new sne(o,i,n,s==null),l=s==null?[e]:[e,s],c=t.runWebGLProgram(a,l,"int32");if(c.shape.length===e.shape.length){const u=PN(t,e,n,c);return t.disposeIntermediateTensorInfo(c),u}return c}function MN(t,e,n,s){const o=[n];if(_n("arg"+s.charAt(0).toUpperCase()+s.slice(1),o,e.shape.length),!se().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){const r=[],i=t.texData.get(e.dataId),a=i!==null&&i.isPacked;let l=e;a&&(l=t.unpackTensor(e),r.push(l));const[c,u]=yn(l.shape,o),h=ae(u),d=Te({inputs:{x:l},backend:t,attrs:{shape:[-1,h]}});r.push(d);const f=LN(t,d,s);r.push(f);const p=Te({inputs:{x:f},backend:t,attrs:{shape:c}});return r.forEach(g=>t.disposeIntermediateTensorInfo(g)),p}return PN(t,e,s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function one(t){const{inputs:e,backend:n,attrs:s}=t,{x:o}=e,{axis:r}=s;let i=st(r,o.shape);const a=jt(i,o.shape.length);let l=o;const c=[];a!=null&&(l=Un({inputs:{x:o},backend:n,attrs:{perm:a}}),c.push(l),i=Zt(i.length,l.shape.length)),_n("argMax",[i[0]],l.shape.length);const u=MN(n,l,i[0],"max");return c.forEach(h=>n.disposeIntermediateTensorInfo(h)),u}const rne={kernelName:df,backendName:"webgl",kernelFunc:one};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ine(t){const{inputs:e,backend:n,attrs:s}=t,{x:o}=e,{axis:r}=s;let i=st(r,o.shape);const a=jt(i,o.shape.length);let l=o;const c=[];a!=null&&(l=Un({inputs:{x:o},backend:n,attrs:{perm:a}}),c.push(l),i=Zt(i.length,l.shape.length)),_n("argMin",[i[0]],l.shape.length);const u=MN(n,l,i[0],"min");return c.forEach(h=>n.disposeIntermediateTensorInfo(h)),u}const ane={kernelName:ff,backendName:"webgl",kernelFunc:ine};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lne=eo+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,cne=dt({opSnippet:lne}),une={kernelName:Uc,backendName:"webgl",kernelFunc:cne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hne=eo+"return log(x + sqrt(x * x + 1.0));",dne=dt({opSnippet:hne}),fne={kernelName:Hc,backendName:"webgl",kernelFunc:dne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pne=eo+`
  return atan(x);
`,mne=dt({opSnippet:pne}),gne={kernelName:Gc,backendName:"webgl",kernelFunc:mne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bne=Ite+`
  return atan(a, b);
`,xne=`
  vec4 result = atan(a, b);
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  `+_te+`
  return result;
`,yne=kn({opSnippet:bne,packedOpSnippet:xne}),vne={kernelName:qc,backendName:"webgl",kernelFunc:yne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wne=eo+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,Cne=dt({opSnippet:wne}),$ne={kernelName:jc,backendName:"webgl",kernelFunc:Cne};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Dc{constructor(e,n,s,o=!1,r=!1){if(this.variableNames=["x"],n==="avg"&&s)throw new Error("Cannot compute positions for average pool.");const i=e.filterWidth,a=e.strideHeight,l=e.strideWidth,c=e.dilationHeight,u=e.dilationWidth,h=e.effectiveFilterHeight,d=e.effectiveFilterWidth,f=e.padInfo.top,p=e.padInfo.left;this.outputShape=e.outShape;const g=n==="avg",b=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,x=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`;let y="0.0";if(g||(y="-1.0 / 1e-20"),s){const k=">=";this.userCode=`
        const ivec2 strides = ivec2(${a}, ${l});
        const ivec2 pads = ivec2(${f}, ${p});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${h};
              wR += ${c}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${d};
                wC += ${u}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${k} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${o?r?b:x:`wR * ${d} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const w="max";let v=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(v="avgValue / count");const $=Math.floor(i/4)*4,_=i%4,E=`
      if (${g}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${w}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${a}, ${l});
      const ivec2 pads = ivec2(${f}, ${p});
      const float initializationValue = ${y};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${y});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${h};
            wR += ${c}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${$}; wC += 4) {
            int xC = xCCorner + wC * ${u};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              getValue(batch, xR, xC + 2 * ${u}, d),
              getValue(batch, xR, xC + 3 * ${u}, d)
            );

            ${E}
          }

          int xC = xCCorner + ${$};
          if (${_===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${E}
          } else if (${_===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              initializationValue,
              initializationValue
            );

            ${E}
          } else if (${_===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              getValue(batch, xR, xC + 2 * ${u}, d),
              initializationValue
            );

            ${E}
          }
        }
        setOutput(${v});
      }
    `}}class P0{constructor(e,n,s,o=!1,r=!1){if(this.variableNames=["x"],n==="avg"&&s)throw new Error("Cannot compute positions for average pool.");const i=e.filterWidth,a=e.strideDepth,l=e.strideHeight,c=e.strideWidth,u=e.dilationDepth,h=e.dilationHeight,d=e.dilationWidth,f=e.effectiveFilterDepth,p=e.effectiveFilterHeight,g=e.effectiveFilterWidth,b=e.padInfo.front,x=e.padInfo.top,y=e.padInfo.left;this.outputShape=e.outShape;const w=n==="avg";let v="0.0";if(w||(v="-1.0 / 1e-20"),s){const A=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${a}, ${l}, ${c});
        const ivec3 pads = ivec3(${b}, ${x}, ${y});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${f};
              wD += ${u}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${e.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${p};
                wR += ${h}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${g};
                  wC += ${d}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${A} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${o?r?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${p} * ${g} +
                      wR * ${g} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const $="max";let _=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(_="avgValue / count");const E=Math.floor(i/4)*4,k=i%4,N=`
      if (${w}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${$}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${a}, ${l}, ${c});
      const ivec3 pads = ivec3(${b}, ${x}, ${y});
      const float initializationValue = ${v};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${v});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${f};
            wD += ${u}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${p};
            wR += ${h}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${E}; wC += 4) {
              int xC = xCCorner + wC * ${d};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${d}, ch),
                getValue(batch, xD, xR, xC + 2 * ${d}, ch),
                getValue(batch, xD, xR, xC + 3 * ${d}, ch)
              );

              ${N}
            }

            int xC = xCCorner + ${E};
            if (${k===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${N}
            } else if (${k===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${d}, ch),
                initializationValue,
                initializationValue
              );

              ${N}
            } else if (${k===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${d}, ch),
                getValue(batch, xD, xR, xC + 2 * ${d}, ch),
                initializationValue
              );

              ${N}
            }
          }
          setOutput(${_});
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ine(t){const{inputs:e,backend:n,attrs:s}=t,{x:o}=e;eh(o,"avgPool");const{filterSize:r,strides:i,pad:a,dimRoundingMode:l}=s,c=1;T(Pn(i,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);const u=Zs(o.shape,r,i,c,a,l);if(u.filterWidth===1&&u.filterHeight===1&&bt(u.inShape,u.outShape))return ms({inputs:{x:o},backend:n});const h=new Dc(u,"avg",!1);return n.runWebGLProgram(h,[o],"float32")}const _ne={kernelName:pf,backendName:"webgl",kernelFunc:Ine};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kne(t){const{inputs:e,backend:n,attrs:s}=t,{x:o}=e,{filterSize:r,strides:i,pad:a,dimRoundingMode:l,dataFormat:c}=s,u=[1,1,1],h=ur(o.shape,r,i,u,a,l,c),d=new P0(h,"avg",!1);return n.runWebGLProgram(d,[o],"float32")}const Ene={kernelName:mf,backendName:"webgl",kernelFunc:kne};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Sne{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterHeight,s=e.filterWidth,o=e.strideHeight,r=e.strideWidth,i=e.dilationHeight,a=e.dilationWidth,l=e.effectiveFilterHeight,c=e.effectiveFilterWidth,u=l-1-e.padInfo.top,h=c-1-e.padInfo.left,d=1/(n*s);this.userCode=`
      const ivec2 pads = ivec2(${u}, ${h});
      const float avgMultiplier = float(${d});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${l};
            wR += ${i}) {
          float dyR = float(dyRCorner + wR) / ${o}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${c};
            wC+= ${a}) {
            float dyC = float(dyCCorner + wC) / ${r}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class Tne{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterDepth,s=e.filterHeight,o=e.filterWidth,r=e.strideDepth,i=e.strideHeight,a=e.strideWidth,l=e.dilationDepth,c=e.dilationHeight,u=e.dilationWidth,h=e.effectiveFilterDepth,d=e.effectiveFilterHeight,f=e.effectiveFilterWidth,p=h-1-e.padInfo.front,g=d-1-e.padInfo.top,b=f-1-e.padInfo.left,x=1/(n*s*o);this.userCode=`
      const ivec3 pads = ivec3(${p}, ${g}, ${b});
      const float avgMultiplier = float(${x});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${h};
            wD += ${l}) {
          float dyD = float(dyDCorner + wD) / ${r}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${d};
              wR += ${c}) {
            float dyR = float(dyRCorner + wR) / ${i}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${f};
                wC += ${u}) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nne(t){const{inputs:e,backend:n,attrs:s}=t,{dy:o,input:r}=e,i=r,{filterSize:a,strides:l,pad:c,dimRoundingMode:u}=s,h=[1,1,1],d=ur(i.shape,a,l,h,c,u),f=new Tne(d);return n.runWebGLProgram(f,[o],i.dtype)}const Ane={kernelName:tx,backendName:"webgl",kernelFunc:Nne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rne(t){const{inputs:e,backend:n,attrs:s}=t,{dy:o,input:r}=e,i=r;eh([o,r],"avgPoolGrad");const{filterSize:a,strides:l,pad:c}=s,u=Zs(i.shape,a,l,1,c),h=new Sne(u);return n.runWebGLProgram(h,[o],i.dtype)}const Dne={kernelName:ex,backendName:"webgl",kernelFunc:Rne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function One(t){const{inputs:e,backend:n,attrs:s}=t,{a:o,b:r}=e,{transposeA:i,transposeB:a}=s;return Ud({a:o,b:r,transposeA:i,transposeB:a,backend:n})}const Fne={kernelName:gf,backendName:"webgl",kernelFunc:One};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Lne{constructor(e,n,s,o,r,i){this.outputShape=[],this.variableNames=["x","mean","variance"],Ye(e,n),Ye(e,s);let a="0.0";o!=null&&(Ye(e,o),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="1.0";r!=null&&(Ye(e,r),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${a};
        float scale = ${l};
        float inv = scale * inversesqrt(variance + float(${i}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Pne{constructor(e,n,s,o,r,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Ye(e,n),Ye(e,s);let a="vec4(0.0)";o!=null&&(Ye(e,o),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="vec4(1.0)";r!=null&&(Ye(e,r),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = ${a};
        vec4 scale = ${l};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${i}));

        setOutput((x - mean) * inv + offset);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mne=({inputs:t,backend:e,attrs:n})=>{const{x:s,mean:o,variance:r,offset:i,scale:a}=t;T(o.shape.length===r.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),T(i==null||o.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),T(a==null||o.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:l}=n;l==null&&(l=.001);const c=[s,o,r];let u=null;i!=null&&(u=i.shape,c.push(i));let h=null;a!=null&&(h=a.shape,c.push(a));const d=se().getBool("WEBGL_PACK_NORMALIZATION")?new Pne(s.shape,o.shape,r.shape,u,h,l):new Lne(s.shape,o.shape,r.shape,u,h,l);return e.runWebGLProgram(d,c,c[0].dtype)},Bne={kernelName:Sf,backendName:"webgl",kernelFunc:Mne};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Vne{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const n=It(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const s=zne(this.rank);let o;const r=e.map((i,a)=>`sourceLoc.${bb[a]} = start[${a}] + coords.${bb[a]};`);o=`
        ${n} sourceLoc;
        ${n} coords = getOutputCoords();
        ${r.join(`
`)}
      `,this.userCode=`
      void main() {
        ${o}
        setOutput(getSource(${s}));
      }
    `}}const bb=["x","y","z","w","u","v"];function zne(t){if(t===1)return"sourceLoc";if(t<=6)return bb.slice(0,t).map(e=>"sourceLoc."+e).join(",");throw Error(`Slicing for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Wne{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const n=It(this.rank),s=zn("coords",this.rank),o=zn("sourceLoc",this.rank),r=this.rank===1?"sourceLoc":`vec2(${o.slice(-2).join()})`,i=`getChannel(getSource(${o.join()}), ${r})`,a=`
      result.x = ${i};
      if (++${s[this.rank-1]} < ${e[this.rank-1]}) {
        ++${o[this.rank-1]};
        result.y = ${i};
        --${o[this.rank-1]};
      }
    `,l=this.rank===1?"":`
      --${s[this.rank-1]};
      if (++${s[this.rank-2]} < ${e[this.rank-2]}) {
        ++${o[this.rank-2]};
        result.z = ${i};
        if (++${s[this.rank-1]} < ${e[this.rank-1]}) {
          ++${o[this.rank-1]};
          result.w = ${i};
        }
      }
    `,c=this.rank<=4?`sourceLoc = coords +
            ${n}(${e.map((u,h)=>`start[${h}]`).join()});`:e.map((u,h)=>`${o[h]} = ${s[h]} + start[${h}];`).join(`
`);this.userCode=`
      void main() {
        ${n} coords = getOutputCoords();
        ${n} sourceLoc;
        ${c}
        vec4 result = vec4(0.);
        ${a}
        ${l}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Une(t,e,n,s){const o=s.texData.get(t.dataId),r=s.makeTensorInfo(n,t.dtype),i=s.texData.get(r.dataId);Object.assign(i,o),i.refCount=1,i.shape=n,i.dtype=t.dtype;let a=Yx(e,Ue(t.shape));o.slice&&(a+=o.slice.flatOffset),i.slice={flatOffset:a,origDataId:o.slice&&o.slice.origDataId||t.dataId};const l=s.dataRefCount.get(i.slice.origDataId)||1;return s.dataRefCount.set(i.slice.origDataId,l+1),r}function Pl(t){const{inputs:e,backend:n,attrs:s}=t,{x:o}=e,{begin:r,size:i}=s,[a,l]=mp(o,r,i);if(qx(o,a,l),ae(l)===0)return n.makeTensorInfo(l,o.dtype,[]);if(n.shouldExecuteOnCPU([o])||o.dtype==="string"){const h=n.texData.get(o.dataId),d=Oee(h.values,a,l,o.shape,o.dtype);return n.makeTensorInfo(l,o.dtype,d)}const{isPacked:c}=n.texData.get(o.dataId),u=Xx(o.shape,a,l);if(c||!u){const h=se().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Wne(l):new Vne(l),d=[a];return n.runWebGLProgram(h,[o],o.dtype,d)}return n.uploadToGPU(o.dataId),Une(o,a,l,n)}const Hne={kernelName:sp,backendName:"webgl",kernelFunc:Pl};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gne=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:o}=e,{blockShape:r,crops:i}=s;T(o.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const a=r.reduce((y,w)=>y*w),l=zu(o.shape,r,a),c=Wu(l.length,r.length),u=Uu(o.shape,r,a),h=Py(i,r.length),d=My(u,i,r.length),f=[],p=Te({inputs:{x:o},backend:n,attrs:{shape:l}}),g=Un({inputs:{x:p},backend:n,attrs:{perm:c}}),b=Te({inputs:{x:g},backend:n,attrs:{shape:u}}),x=Pl({inputs:{x:b},backend:n,attrs:{begin:h,size:d}});return f.push(p),f.push(g),f.push(b),f.forEach(y=>n.disposeIntermediateTensorInfo(y)),x},jne={kernelName:bf,backendName:"webgl",kernelFunc:Gne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qne(t){const{inputs:e,backend:n,attrs:s}=t,{x:o,weights:r}=e,{size:i}=s,a=n.readSync(o.dataId),l=n.readSync(r.dataId),c=IN(a,l,r.dtype,r.shape,i);return n.makeTensorInfo([i],r.dtype,c)}const Kne={kernelName:nx,backendName:"webgl",kernelFunc:qne};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xne(t){const{inputs:e,backend:n}=t,{s0:s,s1:o}=e,r=n.readSync(s.dataId),i=n.readSync(o.dataId),a=Ye(Array.from(r),Array.from(i));return n.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const Yne={kernelName:KI,backendName:"webgl",kernelFunc:Xne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zne="return float(a != b);",BN=kn({opSnippet:Zne,cpuKernelImpl:Eee,dtype:"bool"}),Qne={kernelName:Gf,backendName:"webgl",kernelFunc:BN};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sh(t){const{inputs:e,backend:n}=t,{input:s}=e,o=n.texData.get(s.dataId);return ms({inputs:{x:o.complexTensorInfos.real},backend:n})}const Jne={kernelName:_x,backendName:"webgl",kernelFunc:sh};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ese="return float(int(x));";function tse(t,e){const n=new sr(t.shape,ese),s=e.runWebGLProgram(n,[t],"int32");return{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xb(t){const{inputs:e,backend:n,attrs:s}=t,{x:o}=e,{dtype:r}=s;if(r==="complex64"){if(o.dtype==="complex64")return ms({inputs:{x:o},backend:n});const i=gn(o.shape),a=xb({inputs:{x:o},backend:n,attrs:{dtype:"float32"}}),l=ni({inputs:{real:a,imag:i},backend:n});return i.dispose(),n.disposeIntermediateTensorInfo(a),l}if(o.dtype==="complex64"){const i=sh({inputs:{input:o},backend:n}),a=xb({inputs:{x:i},backend:n,attrs:{dtype:r}});return n.disposeIntermediateTensorInfo(i),a}if(!zI(o.dtype,r)){const i=ms({inputs:{x:o},backend:n});return{dataId:i.dataId,shape:i.shape,dtype:r}}if(n.shouldExecuteOnCPU([o])){const i=n.texData.get(o.dataId).values,[a,l,c]=aee(i,o.shape,o.dtype,r);return n.makeTensorInfo(a,l,c)}if(r==="int32")return tse(o,n);if(r==="bool"){const i=n.makeTensorInfo([],"bool",$n("bool",1)),l=BN({inputs:{a:o,b:i},backend:n});return n.disposeIntermediateTensorInfo(i),l}throw new Error(`Error in Cast: failed to cast ${o.dtype} to ${r}`)}const nse={kernelName:Kc,backendName:"webgl",kernelFunc:xb};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WC="return ceil(x);",sse=dt({opSnippet:WC,packedOpSnippet:WC,cpuKernelImpl:lee}),ose={kernelName:Xc,backendName:"webgl",kernelFunc:sse};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rse{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ise{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ase(t){const{inputs:e,backend:n,attrs:s}=t,{x:o}=e,{clipValueMin:r,clipValueMax:i}=s;let a;se().getBool("WEBGL_PACK_CLIP")?a=new ise(o.shape):a=new rse(o.shape);const l=[[r],[i]];return n.runWebGLProgram(a,[o],o.dtype,l)}const lse={kernelName:Yc,backendName:"webgl",kernelFunc:ase};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cse{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UC(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}}function use(t){const{inputs:e,backend:n}=t,{x:s}=e,o=n.texData.get(s.dataId),r=new cse(s.shape),i=[UC(s,o.complexTensorInfos.real),UC(s,o.complexTensorInfos.imag)];return n.runWebGLProgram(r,i,i[0].dtype)}const hse={kernelName:xf,backendName:"webgl",kernelFunc:use};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dse{constructor(e){this.outputShape=[],this.outputShape=Po(e,1),this.variableNames=e.map((i,a)=>`T${a}`);const n=new Array(e.length-1);n[0]=e[0][1];for(let i=1;i<n.length;i++)n[i]=n[i-1]+e[i][1];const s=[`if (yC < ${n[0]}) setOutput(getT0(yR, yC));`];for(let i=1;i<n.length;i++){const a=n[i-1];s.push(`else if (yC < ${n[i]}) setOutput(getT${i}(yR, yC-${a}));`)}const o=n.length,r=n[n.length-1];s.push(`else setOutput(getT${o}(yR, yC-${r}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${s.join(`
        `)}
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fse{constructor(e,n){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Po(e,n);const s=this.outputShape,o=s.length,r=It(o),i=zn("coords",o),a=["x","y","z","w","u","v"].slice(0,o);this.variableNames=e.map((g,b)=>`T${b}`);const l=new Array(e.length-1);l[0]=e[0][n];for(let g=1;g<l.length;g++)l[g]=l[g-1]+e[g][n];const c=a[n],u=a.slice(-2),h=a.join();let d=`if (${c} < ${l[0]}) {
        return getChannel(
            getT0(${h}), vec2(${u.join()}));
        }`;for(let g=1;g<l.length;g++){const b=l[g-1];d+=`
        if (${c} < ${l[g]}  && ${c} >= ${l[g-1]}) {
          return getChannel(
            getT${g}(${Xh(a,c,b)}),
            vec2(${Xh(u,c,b)}));
        }`}const f=l.length,p=l[l.length-1];d+=`
        return getChannel(
          getT${f}(${Xh(a,c,p)}),
          vec2(${Xh(u,c,p)}));`,this.userCode=`
      float getValue(${a.map(g=>"int "+g)}) {
        ${d}
      }

      void main() {
        ${r} coords = getOutputCoords();
        vec4 result = vec4(getValue(${i}), 0., 0., 0.);

        ${i[o-1]} = ${i[o-1]} + 1;
        if (${i[o-1]} < ${s[o-1]}) {
          result.g = getValue(${i});
        }

        ${i[o-2]} = ${i[o-2]} + 1;
        if (${i[o-2]} < ${s[o-2]}) {
          result.a = getValue(${i});
        }

        ${i[o-1]} = ${i[o-1]} - 1;
        if (${i[o-2]} < ${s[o-2]} &&
            ${i[o-1]} < ${s[o-1]}) {
          result.b = getValue(${i});
        }
        setOutput(result);
      }
    `}}function Xh(t,e,n){const s=t.indexOf(e);return t.map((r,i)=>i===s?`${r} - ${n}`:r).join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gp(t){const{inputs:e,backend:n}=t,{input:s}=e,o=n.texData.get(s.dataId);return ms({inputs:{x:o.complexTensorInfos.imag},backend:n})}const pse={kernelName:bx,backendName:"webgl",kernelFunc:Gp};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ac(t,e,n){const s=t[0].dtype;if(s==="complex64"){const h=t.map(b=>sh({inputs:{input:b},backend:n})),d=t.map(b=>Gp({inputs:{input:b},backend:n})),f=ac(h,e,n),p=ac(d,e,n),g=ni({inputs:{real:f,imag:p},backend:n});return h.forEach(b=>n.disposeIntermediateTensorInfo(b)),d.forEach(b=>n.disposeIntermediateTensorInfo(b)),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),g}let o=n.shouldExecuteOnCPU(t);if(s==="string"&&(o=!0),o){const h=t.map(y=>{const w=ae(y.shape.slice(e));return Te({inputs:{x:y},backend:n,attrs:{shape:[-1,w]}})}),d=h.map(y=>({vals:n.readSync(y.dataId),shape:y.shape})),f=Po(h.map(y=>y.shape),1),p=h[0].shape[0]===1,g=cee(d,f,s,p),b=Po(t.map(y=>y.shape),e),x=n.makeTensorInfo(b,s,g);return h.forEach(y=>n.disposeIntermediateTensorInfo(y)),x}const r=se().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(t.length>r){const h=[];for(let f=0;f<t.length;f+=r){const p=t.slice(f,f+r);h.push(ac(p,e,n))}const d=ac(h,e,n);for(const f of h)n.disposeIntermediateTensorInfo(f);return d}if(se().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&t[0].shape.length>1){const h=new fse(t.map(d=>d.shape),e);return n.runWebGLProgram(h,t,s)}const{tensors2D:i,outShape:a}=mse(t,e,n),l=new dse(i.map(h=>h.shape)),c=n.runWebGLProgram(l,i,s);i.forEach(h=>n.disposeIntermediateTensorInfo(h));const u=Te({inputs:{x:c},attrs:{shape:a},backend:n});return n.disposeIntermediateTensorInfo(c),u}function mse(t,e,n){const s=Po(t.map(r=>r.shape),e);return{tensors2D:t.map(r=>Te({inputs:{x:r},attrs:{shape:[-1,ae(r.shape.slice(e))]},backend:n})),outShape:s}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VN(t){const{inputs:e,backend:n,attrs:s}=t,{axis:o}=s,r=st(o,e[0].shape)[0],i=Po(e.map(c=>c.shape),r);if(ae(i)===0)return n.makeTensorInfo(i,e[0].dtype,[]);const a=e.filter(c=>ae(c.shape)>0);if(a.length===1)return ms({inputs:{x:a[0]},backend:n});const l=a.map(c=>c.shape);return Oy(l,r),ac(a,r,n)}const gse={kernelName:yf,backendName:"webgl",kernelFunc:VN};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zN{constructor(e,n=!1,s=null,o=!1,r=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;const i=e.padInfo.top,a=e.padInfo.left,l=e.strideHeight,c=e.strideWidth,u=e.dilationHeight,h=e.dilationWidth,d=e.filterHeight,f=e.filterWidth,p=Math.floor(e.inChannels/4)*4,g=e.inChannels%4,b=e.dataFormat==="channelsLast",x=b?1:2,y=b?2:3,w=b?3:1;let v="",$="";s&&(o?v=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:r?v=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:v=`
          float activation(float x) {
            ${s}
          }
        `,$="result = activation(result);");const _=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),r&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${v}

      const ivec2 strides = ivec2(${l}, ${c});
      const ivec2 pads = ivec2(${i}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${w}];

        ivec2 xRCCorner =
            ivec2(coords[${x}], coords[${y}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${d}; wR++) {
          int xR = xRCorner + wR * ${u};

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${f}; wC++) {
            int xC = xCCorner + wC * ${h};

            if (xC < 0 || xC >= ${e.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${p}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${b}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${g===1}) {

              if (${b}) {
                dotProd +=
                    getX(batch, xR, xC, ${p}) *
                    getW(wR, wC, ${p}, d2);
              } else {
                dotProd +=
                    getX(batch, ${p}, xR, xC) *
                    getW(wR, wC, ${p}, d2);
              }

            } else if (${g===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${p}, d2),
                getW(wR, wC, ${p} + 1, d2)
              );

              if (${b}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${p}),
                  getX(batch, xR, xC, ${p} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${p}, xR, xC),
                  getX(batch, ${p} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${g===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${p}, d2),
                getW(wR, wC, ${p} + 1, d2),
                getW(wR, wC, ${p} + 2, d2)
              );

              if (${b}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${p}),
                  getX(batch, xR, xC, ${p} + 1),
                  getX(batch, xR, xC, ${p} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${p}, xR, xC),
                  getX(batch, ${p} + 1, xR, xC),
                  getX(batch, ${p} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${_}
        ${$}
        setOutput(result);
      }
    `}}class bse{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const n=e.padInfo.front,s=e.padInfo.top,o=e.padInfo.left,r=e.strideDepth,i=e.strideHeight,a=e.strideWidth,l=e.dilationDepth,c=e.dilationHeight,u=e.dilationWidth,h=e.filterDepth,d=e.filterHeight,f=e.filterWidth,p=Math.floor(e.inChannels/4)*4,g=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${r}, ${i}, ${a});
      const ivec3 pads = ivec3(${n}, ${s}, ${o});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${h}; wF++) {
          int xF = xFCorner + wF * ${l};

          if (xF < 0 || xF >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${d}; wR++) {
            int xR = xRCorner + wR * ${c};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${f}; wC++) {
              int xC = xCCorner + wC * ${u};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${p}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${g===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${p}) *
                  getW(wF, wR, wC, ${p}, d2);
              } else if (${g===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${p}),
                  getX(batch, xF, xR, xC, ${p} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${p}, d2),
                  getW(wF, wR, wC, ${p} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${g===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${p}),
                  getX(batch, xF, xR, xC, ${p} + 1),
                  getX(batch, xF, xR, xC, ${p} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${p}, d2),
                  getW(wF, wR, wC, ${p} + 1, d2),
                  getW(wF, wR, wC, ${p} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class WN{constructor(e,n=!1,s=null,o=!1,r=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Gn(this.outputShape.length);const i=e.padInfo.left,a=e.strideWidth,l=e.dilationWidth,c=e.filterHeight,u=e.filterWidth,h=u;let d=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let b=0;b<u;b++)d+=`
           vec4 xTexelC${b*2};
           int xTexelC${b*2}Ready;
           vec4 xTexelC${b*2+1};
           int xTexelC${b*2+1}Ready;
           vec4 xC${b};`;d+=`
     for (int r = 0; r < ${c}; r++) {
      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {
       `;for(let b=0;b<u;b++)d+=`
           xTexelC${b*2} = vec4(0.0);
           xTexelC${b*2}Ready = 0;
           xTexelC${b*2+1} = vec4(0.0);
           xTexelC${b*2+1}Ready = 0;
           xC${b} = vec4(0.0);`;d+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let b=0;b<(h+1)/2;b++){const x=b*2;if(d+=`
           xC = xCCorner + ${x*l};
           `,a===1){if(x<u&&(i%2===1?(d+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x}Ready == 0) {
                   xTexelC${x} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${x}.zw = vec2(0.0);
                   }
                   xTexelC${x}Ready = 1;
                 }
               `,l===1&&x>0?d+=`
                 xC${x} = vec4(xTexelC${x-2}.zw, xTexelC${x}.xy);
                 `:d+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${x} = vec4(previous.zw, xTexelC${x}.xy);
                   } else {
                     xC${x} = vec4(0.0, 0.0, xTexelC${x}.xy);
                   }
                   `):d+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${x}Ready == 0) {
                   xTexelC${x} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${x}.zw = vec2(0.0);
                   }
                   xTexelC${x}Ready = 1;
                 }

                 xC${x} = xTexelC${x};
                 `,x+1<u)){const y=i%2===0?Kb(l):l;l%2===0&&i%2===1||l%2!==0&&i%2!==1?(d+=`
                   xCOffset = xC + imod(pads[1], 2) + ${y};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                     xTexelC${x+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${x+1}.zw = vec2(0.0);
                     }
                     xTexelC${x+1}Ready = 1;
                   }
                   `,l>1?d+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${x+1} = vec4(previous.zw, xTexelC${x+1}.xy);
                     } else {
                      xC${x+1} = vec4(0.0, 0.0, xTexelC${x+1}.xy);
                     }
                     `:d+=`
                     xC${x+1} = vec4(xTexelC${x}.zw, xTexelC${x+1}.xy);
                     `):y===1?d+=`
                     xC${x+1} = xTexelC${x};
                     `:d+=`
                     xCOffset = xC + ${y};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                       xTexelC${x+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${x+1}.zw = vec2(0.0);
                       }
                       xTexelC${x+1}Ready = 1;
                     }

                     xC${x+1} = xTexelC${x+1};
                     `}}else x<u&&(i%2===1?(d+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x}Ready == 0) {
                   xTexelC${x} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${x}.zw = vec2(0.0);
                   }
                   xTexelC${x}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${x+1}Ready == 0) {
                   xTexelC${x+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${x+1}.zw = vec2(0.0);
                   }
                   xTexelC${x+1}Ready = 1;
                 }

                 xC${x} = vec4(xTexelC${x}.zw, xTexelC${x+1}.zw);
               `,x+1<u&&(d+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${x+1} = vec4(xTexelC${x+1}.xy, final.xy);
                 `)):(d+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${x}Ready == 0) {
                   xTexelC${x} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${x}.zw = vec2(0.0);
                   }
                   xTexelC${x}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                   xTexelC${x+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${x+1}.zw = vec2(0.);
                   }
                   xTexelC${x+1}Ready = 1;
                 }

                 xC${x} = vec4(
                   xTexelC${x}.xy, xTexelC${x+1}.xy);
               `,x+1<u&&(d+=`
                   xC${x+1} = vec4(xTexelC${x}.zw, xTexelC${x+1}.zw);
                 `)));x<u&&(d+=`
             wTexel = getW(r, ${x}, d1, d2);
             dotProd += xC${x}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${e.inChannels}) {
               dotProd += xC${x}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,x+1<u&&(d+=`
               wTexel = getW(r, ${x+1}, d1, d2);
               dotProd += xC${x+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${e.inChannels}) {
                 dotProd += xC${x+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}d+=`
     }
   `,d+=`
     }
   `,d+=`
     }
   `;let f="",p="";s&&(o?f=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${s}
         }`:r?f=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${s}
         }`:f=`vec4 activation(vec4 x) {
           ${s}
         }`,p="result = activation(result);");const g=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),r&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${f}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${d}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${g}
         ${p}
         setOutput(result);
       }
     `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xse{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=Gn(this.outputShape.length);const{dataFormat:s}=n,o=Hn(),r=s==="channelsLast",i=r?1:2,a=r?2:3,l=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`;let c="";for(let u=0;u<=1;u++)for(let h=0;h<=1;h++)c+=`
          blockIndex = rc.z + ${h};
          pos = rc.y + ${u};

          ${l}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${i}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${a}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${r}) {
                  innerDims = vec2(d1, ch);
                  result[${u*2+h}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${u*2+h}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${c}

        ${o.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hd(t,e){const n=t.length;return n>=3?e?[...t.slice(0,-3),t[n-3]*t[n-2],t[n-1]]:[...t.slice(0,-3),t[n-3],t[n-2]*t[n-1]]:!e&&n===1&&t[0]>1?[t[0],1]:null}function UN({x:t,filter:e,convInfo:n,backend:s,bias:o=null,preluActivationWeights:r=null,leakyreluAlpha:i=0,activation:a=null}){const l=t.shape,c=s.texData.get(t.dataId),u=n.inChannels,h=l[0]*l[1]*l[2],d=n.outChannels,f=n.dataFormat==="channelsLast",p=!1,g=!1;let b;const x=[];if(r!=null){const v=Hd(r.shape,f);v!=null&&(r=Te({inputs:{x:r},backend:s,attrs:{shape:v}}),x.push(r))}if(o!=null){const v=Hd(o.shape,f);v!=null&&(o=Te({inputs:{x:o},backend:s,attrs:{shape:v}}),x.push(o))}if(!((h===1||d===1)&&u>FN)&&c.isPacked&&f&&c.texture!=null&&l[2]%2!==0&&bt(c.shape.slice(-3),l.slice(-3))){const v=l[0]*l[1]*(l[2]+1),$={dataId:t.dataId,shape:[1,v,n.inChannels],dtype:t.dtype},_=c.shape;c.shape=c.shape.slice(),c.shape[c.shape.length-2]++,T(Wd(c.shape,$.shape),()=>`packed reshape ${c.shape} to ${$.shape} isn't free`);const E=Te({inputs:{x:e},backend:s,attrs:{shape:[1,n.inChannels,n.outChannels]}});x.push(E);const k=Ud({a:$,b:E,backend:s,transposeA:p,transposeB:g,bias:o,activation:a,preluActivationWeights:r,leakyreluAlpha:i}),N=s.texData.get(k.dataId);T(N.isPacked,()=>"batchMatMul result is expected to be packed"),c.shape=_,N.shape=n.outShape,b=ms({inputs:{x:k},backend:s}),b.shape=n.outShape,x.push(k)}else{const v=n.outHeight*n.outWidth,$=Te({inputs:{x:t},backend:s,attrs:{shape:f?[n.batchSize,v,n.inChannels]:[n.batchSize,n.inChannels,v]}}),_=Te({inputs:{x:e},backend:s,attrs:{shape:[1,n.inChannels,n.outChannels]}}),E=Ud({a:f?$:_,b:f?_:$,transposeA:!f,transposeB:g,backend:s,bias:o,activation:a,preluActivationWeights:r,leakyreluAlpha:i});b=Te({inputs:{x:E},backend:s,attrs:{shape:n.outShape}}),x.push($),x.push(_),x.push(E)}for(const v of x)s.disposeIntermediateTensorInfo(v);return b}function HN({x:t,filter:e,convInfo:n,backend:s,bias:o=null,preluActivationWeights:r=null,leakyreluAlpha:i=0,activation:a=null}){const{filterWidth:l,filterHeight:c,inChannels:u,outWidth:h,outHeight:d,dataFormat:f}=n,p=f==="channelsLast",g=l*c*u,b=d*h,x=[n.batchSize,g,b],y=!0,w=!1,v=[];if(r!=null){const Y=Hd(r.shape,p);Y!=null&&(r=Te({inputs:{x:r},backend:s,attrs:{shape:Y}}),v.push(r))}if(o!=null){const Y=Hd(o.shape,p);Y!=null&&(o=Te({inputs:{x:o},backend:s,attrs:{shape:Y}}),v.push(o))}const $=Te({inputs:{x:e},backend:s,attrs:{shape:[1,g,ae(e.shape)/g]}});v.push($);const _=new xse(x,n),E=[t.shape,[n.padInfo.top,n.padInfo.left],[n.strideHeight,n.strideWidth],[n.dilationHeight,n.dilationWidth],[n.inChannels],[n.filterWidth*n.inChannels],[n.outWidth]],k=s.runWebGLProgram(_,[t],"float32",E),N=Te({inputs:{x:k},backend:s,attrs:{shape:x}});v.push(k),v.push(N);const A=o!=null,F=r!=null,L=a==="leakyrelu",H=a?Rc(a,!0):null,M=new ON(p?N.shape:$.shape,p?$.shape:N.shape,p?[n.batchSize,b,n.outChannels]:[n.batchSize,n.outChannels,b],y,w,A,H,F,L),K=p?[N,$]:[$,N];if(o&&K.push(o),F&&K.push(r),L){const Y=s.makeTensorInfo([],"float32",qr(i,"float32"));K.push(Y),v.push(Y)}const q=s.runWebGLProgram(M,K,"float32"),Q=Te({inputs:{x:q},backend:s,attrs:{shape:n.outShape}});v.push(q);for(const Y of v)s.disposeIntermediateTensorInfo(Y);return Q}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yse(t){const{inputs:e,backend:n,attrs:s}=t,{x:o,filter:r}=e,{strides:i,pad:a,dataFormat:l,dilations:c,dimRoundingMode:u}=s,h=hr(l),d=In(o.shape,r.shape,i,c,a,u,!1,h);let f;if(d.filterHeight===1&&d.filterWidth===1&&d.dilationHeight===1&&d.dilationWidth===1&&d.strideHeight===1&&d.strideWidth===1&&(d.padInfo.type==="SAME"||d.padInfo.type==="VALID"))f=UN({x:o,filter:r,convInfo:d,backend:n});else if(d.strideWidth<=2&&h==="channelsLast"&&se().getBool("WEBGL_EXP_CONV")){const g=new WN(d),b=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];f=n.runWebGLProgram(g,[o,r],"float32",b)}else if(se().getBool("WEBGL_CONV_IM2COL"))f=HN({x:o,filter:r,convInfo:d,backend:n});else{const g=new zN(d);f=n.runWebGLProgram(g,[o,r],"float32")}const p=Te({inputs:{x:f},backend:n,attrs:{shape:d.outShape}});return n.disposeIntermediateTensorInfo(f),p}const vse={kernelName:vf,backendName:"webgl",kernelFunc:yse};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wse{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,s=e.strideWidth,o=e.padInfo.top,r=e.padInfo.left,i=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${o};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${s} - ${r};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              if (${i}) {
                float dyValue = getDy(b, yR, yC, d2);
                float xValue = getX(b, xR, xC, d1);
                dotProd += (xValue * dyValue);
              } else {
                float dyValue = getDy(b, d2, yR, yC);
                float xValue = getX(b, d1, xR, xC);
                dotProd += (xValue * dyValue);
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class Cse{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,s=e.filterWidth,o=e.strideHeight,r=e.strideWidth,i=e.dataFormat==="channelsLast",a=n-1-e.padInfo.top,l=s-1-e.padInfo.left,c=i?1:2,u=i?2:3,h=i?3:1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${h}];

        ivec2 dyCorner = ivec2(coords[${c}], coords[${u}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${o}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${r}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${s} - 1 - wC;

            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {

              if (${i}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class $se{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideDepth,s=e.strideHeight,o=e.strideWidth,r=e.padInfo.front,i=e.padInfo.top,a=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yF = 0; yF < ${e.outDepth}; yF++) {
            int xF = wF + yF * ${n} - ${r};

            if (xF < 0 || xF >= ${e.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${e.outHeight}; yR++) {
              int xR = wR + yR * ${s} - ${i};

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${e.outWidth}; yC++) {
                int xC = wC + yC * ${o} - ${a};

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class Ise{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterDepth,s=e.filterHeight,o=e.filterWidth,r=e.strideDepth,i=e.strideHeight,a=e.strideWidth,l=n-1-e.padInfo.front,c=s-1-e.padInfo.top,u=o-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${l}, ${c}, ${u});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${n}; wF++) {
          float dyF = float(dyFCorner + wF) / ${r}.0;

          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${n} - 1 - wF;

          for (int wR = 0; wR < ${s}; wR++) {
            float dyR = float(dyRCorner + wR) / ${i}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${s} - 1 - wR;

            for (int wC = 0; wC < ${o}; wC++) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${o} - 1 - wC;

              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _se(t){const{inputs:e,backend:n,attrs:s}=t,{x:o,dy:r}=e,{strides:i,pad:a,dataFormat:l,dimRoundingMode:c,filterShape:u}=s,h=hr(l),d=In(o.shape,u,i,1,a,c,!1,h),f=new wse(d);return n.runWebGLProgram(f,[o,r],"float32")}const kse={kernelName:ox,backendName:"webgl",kernelFunc:_se};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ese(t){const{inputs:e,backend:n,attrs:s}=t,{dy:o,filter:r}=e,{inputShape:i,strides:a,pad:l,dataFormat:c,dimRoundingMode:u}=s,h=hr(c),d=In(i,r.shape,a,1,l,u,!1,h),f=new Cse(d);return n.runWebGLProgram(f,[o,r],"float32")}const Sse={kernelName:wf,backendName:"webgl",kernelFunc:Ese};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tse(t){const{inputs:e,backend:n,attrs:s}=t,{x:o,filter:r}=e,{strides:i,pad:a,dilations:l}=s,c=Kr(o.shape,r.shape,i,l,a),u=new bse(c);return n.runWebGLProgram(u,[o,r],"float32")}const Nse={kernelName:Cf,backendName:"webgl",kernelFunc:Tse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ase(t){const{inputs:e,backend:n,attrs:s}=t,{x:o,dy:r}=e,{strides:i,pad:a,filterShape:l}=s,c=Kr(o.shape,l,i,1,a),u=new $se(c);return n.runWebGLProgram(u,[o,r],"float32")}const Rse={kernelName:rx,backendName:"webgl",kernelFunc:Ase};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dse(t){const{inputs:e,backend:n,attrs:s}=t,{dy:o,filter:r}=e,{pad:i,strides:a,inputShape:l}=s,c=Kr(l,r.shape,a,1,i),u=new Ise(c);return n.runWebGLProgram(u,[o,r],"float32")}const Ose={kernelName:ix,backendName:"webgl",kernelFunc:Dse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fse=Ll+`
  return cos(x);
`,Lse=dt({opSnippet:Fse}),Pse={kernelName:Zc,backendName:"webgl",kernelFunc:Lse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mse=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,Bse=dt({opSnippet:Mse}),Vse={kernelName:Qc,backendName:"webgl",kernelFunc:Bse};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zse{constructor(e,n,s,o,r){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[i,a,l,c]=e,[u]=n,[h,d]=s;this.outputShape=[u,h,d,c];const f=o==="bilinear"?1:0,[p,g]=[`${a-1}.0`,`${l-1}.0`],[b,x,y]=h>1?[`${(a-1)/(h-1)}`,"(y2-y1) * height_ratio",`y1*${p} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${p}`],[w,v,$]=d>1?[`${(l-1)/(d-1)}`,"(x2-x1) * width_ratio",`x1*${g} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${g}`];this.userCode=`
      const float height_ratio = float(${b});
      const float width_ratio = float(${w});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${i}) {
          return;
        }

        float height_scale = ${x};
        float width_scale = ${v};

        float in_y = ${y};
        if( in_y < 0.0 || in_y > ${p} ) {
          setOutput(float(${r}));
          return;
        }
        float in_x = ${$};
        if( in_x < 0.0 || in_x > ${g} ) {
          setOutput(float(${r}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${f} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wse=t=>{const{inputs:e,backend:n,attrs:s}=t,{image:o,boxes:r,boxInd:i}=e,{cropSize:a,method:l,extrapolationValue:c}=s,u=new zse(o.shape,r.shape,a,l,c);return n.runWebGLProgram(u,[o,r,i],"float32")},Use={kernelName:lx,backendName:"webgl",kernelFunc:Wse};var Oc;(function(t){t.Prod="*",t.Sum="+"})(Oc||(Oc={}));class HC{constructor(e,n,s,o){this.op=e,this.outputShape=n,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const r=this.outputShape.length,i=this.op===Oc.Prod?"1.0":"0.0",a=s?i:`getX(${GC(r,"coords",this.op)})`,l=this.outputShape[this.outputShape.length-1];let c="",u="";s?(c=o?`end != ${l-1}`:"end != 0",u=o?"end + 1":"end - 1"):(c=o?`end + pow2 < ${l}`:"end >= pow2",u=o?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${It(r)} coords = getOutputCoords();
        int end = ${jC(r,"coords",this.op)};
        float val = ${a};
        int pow2 = int(pow(2.0, index));
        if (${c}) {
          int idx = ${u};
          ${jC(r,"coords",this.op)} = idx;
          val ${this.op}= getX(${GC(r,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function GC(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.x, ${e}.y`;if(t===3)return`${e}.x, ${e}.y, ${e}.z`;if(t===4)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}function jC(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.y`;if(t===3)return`${e}.z`;if(t===4)return`${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GN(t,e,n,s,o,r){const i=e.shape.length,a=jt([s],i);let l=e;a!=null&&(l=Un({inputs:{x:e},backend:n,attrs:{perm:a}}));const c=Zt(1,i)[0];if(c!==i-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${e.shape.length-1} but got axis=${s}`);const u=l.shape[c];let h=ms({inputs:{x:l},backend:n});for(let d=0;d<=Math.ceil(Math.log2(u))-1;d++){const f=new HC(t,l.shape,!1,r),p=[[d]],g=h;h=n.runWebGLProgram(f,[h],h.dtype,p),n.disposeIntermediateTensorInfo(g)}if(o){const d=new HC(t,l.shape,o,r),f=h;h=n.runWebGLProgram(d,[h],h.dtype),n.disposeIntermediateTensorInfo(f)}if(a!=null){const d=Xr(a),f=Un({inputs:{x:h},backend:n,attrs:{perm:d}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(l),f}return h}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hse(t){const{inputs:e,backend:n,attrs:s}=t,{x:o}=e,{axis:r,exclusive:i,reverse:a}=s;return GN(Oc.Prod,o,n,r,i,a)}const Gse={kernelName:ax,backendName:"webgl",kernelFunc:Hse};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jse(t){const{inputs:e,backend:n,attrs:s}=t,{x:o}=e,{axis:r,exclusive:i,reverse:a}=s;return GN(Oc.Sum,o,n,r,i,a)}const qse={kernelName:$f,backendName:"webgl",kernelFunc:jse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kse(t){const{inputs:e,backend:n,attrs:s}=t,{x:o,weights:r}=e,{size:i,binaryOutput:a}=s;if(o.shape.length===1){const l=n.readSync(o.dataId),c=n.readSync(r.dataId),u=IN(l,c,r.dtype,r.shape,i);return n.makeTensorInfo([i],r.dtype,u)}else if(o.shape.length===2){const l=n.bufferSync(o),c=n.bufferSync(r),u=iee(l,c,i,a);return n.makeTensorInfo(u.shape,r.dtype,u.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${o.shape.length}.`)}const Xse={kernelName:XI,backendName:"webgl",kernelFunc:Kse};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Yse{constructor(e,n,s){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=n,this.dataFormat=s,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${n};
      int offset_h = imod(h, ${n});
      int in_w = w / ${n};
      int offset_w = imod(w, ${n});
      int offset_d = (offset_h * ${n} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zse(t){const{inputs:e,backend:n,attrs:s}=t,{x:o}=e,{blockSize:r,dataFormat:i}=s,a=o.shape[0],l=i==="NHWC"?o.shape[1]:o.shape[2],c=i==="NHWC"?o.shape[2]:o.shape[3],u=i==="NHWC"?o.shape[3]:o.shape[1],h=l*r,d=c*r,f=u/(r*r),p=i==="NHWC"?[a,h,d,f]:[a,f,h,d],g=new Yse(p,r,i);return n.runWebGLProgram(g,[o],o.dtype)}const Qse={kernelName:cx,backendName:"webgl",kernelFunc:Zse};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jN{constructor(e,n=!1,s=null,o=!1,r=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Gn(this.outputShape.length);const i=e.filterHeight,a=e.filterWidth,l=e.outChannels/e.inChannels;let c="",u="";s&&(o?c=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:r?c=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:c=`
          float activation(float x) {
            ${s}
          }
        `,u="result = activation(result);");const h=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),r&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${c}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${l};
        int q = d2 - d1 * ${l};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${i}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${a}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${h}
        ${u}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qN{constructor(e,n=!1,s=null,o=!1,r=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Gn(this.outputShape.length);const i=e.outChannels/e.inChannels,a=e.padInfo.left,l=e.strideWidth,c=e.dilationWidth,u=e.filterHeight,h=e.filterWidth,d=h;let f=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let x=0;x<h;x++)f+=`
          vec4 xTexelC${x*2};
          int xTexelC${x*2}Ready;
          vec4 xTexelC${x*2+1};
          int xTexelC${x*2+1}Ready;
          vec4 xC${x};`;f+=`
    for (int r = 0; r < ${u}; r++) {
      `;for(let x=0;x<h;x++)f+=`
          xTexelC${x*2} = vec4(0.0);
          xTexelC${x*2}Ready = 0;
          xTexelC${x*2+1} = vec4(0.0);
          xTexelC${x*2+1}Ready = 0;
          xC${x} = vec4(0.0);`;f+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let x=0;x<(d+1)/2;x++){const y=x*2;if(f+=`
          xC = xCCorner + ${y*c};
          `,l===1){if(y<h&&(a%2===1?(f+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y}Ready == 0) {
                  xTexelC${y} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${y}.zw = vec2(0.0);
                  }
                  xTexelC${y}Ready = 1;
                }
              `,c===1&&y>0?f+=`
                xC${y} = vec4(xTexelC${y-2}.zw, xTexelC${y}.xy);
                `:f+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${y} = vec4(previous.zw, xTexelC${y}.xy);
                  } else {
                    xC${y} = vec4(0.0, 0.0, xTexelC${y}.xy);
                  }
                  `):f+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${y}Ready == 0) {
                  xTexelC${y} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${y}.zw = vec2(0.0);
                  }
                  xTexelC${y}Ready = 1;
                }

                xC${y} = xTexelC${y};
                `,y+1<h)){const w=a%2===0?Kb(c):c;c%2===0&&a%2===1||c%2!==0&&a%2!==1?(f+=`
                  xCOffset = xC + imod(pads[1], 2) + ${w};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                    xTexelC${y+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${y+1}.zw = vec2(0.0);
                    }
                    xTexelC${y+1}Ready = 1;
                  }
                  `,c>1?f+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${y+1} = vec4(previous.zw, xTexelC${y+1}.xy);
                    } else {
                     xC${y+1} = vec4(0.0, 0.0, xTexelC${y+1}.xy);
                    }
                    `:f+=`
                    xC${y+1} = vec4(xTexelC${y}.zw, xTexelC${y+1}.xy);
                    `):w===1?f+=`
                    xC${y+1} = xTexelC${y};
                    `:f+=`
                    xCOffset = xC + ${w};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                      xTexelC${y+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${y+1}.zw = vec2(0.0);
                      }
                      xTexelC${y+1}Ready = 1;
                    }

                    xC${y+1} = xTexelC${y+1};
                    `}}else y<h&&(a%2===1?(f+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y}Ready == 0) {
                  xTexelC${y} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${y}.zw = vec2(0.0);
                  }
                  xTexelC${y}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${y+1}Ready == 0) {
                  xTexelC${y+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${y+1}.zw = vec2(0.0);
                  }
                  xTexelC${y+1}Ready = 1;
                }

                xC${y} = vec4(xTexelC${y}.zw, xTexelC${y+1}.zw);
              `,y+1<h&&(f+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${y+1} = vec4(xTexelC${y+1}.xy, final.xy);
                `)):(f+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${y}Ready == 0) {
                  xTexelC${y} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${y}.zw = vec2(0.0);
                  }
                  xTexelC${y}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                  xTexelC${y+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${y+1}.zw = vec2(0.);
                  }
                  xTexelC${y+1}Ready = 1;
                }

                xC${y} = vec4(
                  xTexelC${y}.xy, xTexelC${y+1}.xy);
              `,y+1<h&&(f+=`
                  xC${y+1} = vec4(xTexelC${y}.zw, xTexelC${y+1}.zw);
                `)));y<h&&(f+=`
            wTexel = getW(r, ${y}, d1, q);
            dotProd += xC${y} * vec4(wTexel.xz, wTexel.xz);
          `,y+1<h&&(f+=`
              wTexel = getW(r, ${y+1}, d1, q);
              dotProd += xC${y+1} * vec4(wTexel.xz, wTexel.xz);
            `))}f+=`
    }
  `,f+=`
      }
    `;let p="",g="";s&&(o?p=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:r?p=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:p=`vec4 activation(vec4 x) {
          ${s}
        }`,g="result = activation(result);");const b=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),r&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${p}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${i};
        int q = d2 - d1 * ${i};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${f}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${b}
        ${g}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jse(t){const{inputs:e,backend:n,attrs:s}=t,{x:o,filter:r}=e,{strides:i,pad:a,dilations:l,dimRoundingMode:c}=s;let u=l;u==null&&(u=[1,1]),T(Pn(i,u),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${i} and dilations '${u}'`);const h=In(o.shape,r.shape,i,u,a,c,!0);let d;se().getBool("WEBGL_PACK_DEPTHWISECONV")&&h.strideWidth<=2&&h.outChannels/h.inChannels===1?d=new qN(h):d=new jN(h);const f=[[h.padInfo.top,h.padInfo.left],[h.strideHeight,h.strideWidth],[h.dilationHeight,h.dilationWidth],[h.inHeight,h.inWidth]];return n.runWebGLProgram(d,[o,r],"float32",f)}const eoe={kernelName:If,backendName:"webgl",kernelFunc:Jse};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class toe{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,s=e.strideWidth,o=e.padInfo.top,r=e.padInfo.left,i=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${i} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${o};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${s} - ${r};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class noe{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,s=e.filterWidth,o=e.strideHeight,r=e.strideWidth,i=n-1-e.padInfo.top,a=s-1-e.padInfo.left,l=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${i}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${o}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${r}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${s} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${l}; dm++) {
              int d2 = d1 * ${l} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function soe(t){const{inputs:e,backend:n,attrs:s}=t,{x:o,dy:r}=e,{strides:i,dilations:a,pad:l,dimRoundingMode:c,filterShape:u}=s,h=In(o.shape,u,i,a,l,c,!0),d=new toe(h);return n.runWebGLProgram(d,[o,r],"float32")}const ooe={kernelName:ux,backendName:"webgl",kernelFunc:soe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function roe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:o,filter:r}=e,{strides:i,dilations:a,pad:l,dimRoundingMode:c,inputShape:u}=s,h=In(u,r.shape,i,a,l,c,!0),d=new noe(h);return n.runWebGLProgram(d,[o,r],"float32")}const ioe={kernelName:hx,backendName:"webgl",kernelFunc:roe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aoe{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function loe(t){const{inputs:e,backend:n}=t,{x:s}=e,o=[...s.shape,...s.shape],r=ae(s.shape),i=Te({inputs:{x:s},backend:n,attrs:{shape:[r]}}),a=new aoe(r),l=n.runWebGLProgram(a,[i],i.dtype),c=Te({inputs:{x:l},backend:n,attrs:{shape:o}});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(l),c}const coe={kernelName:YI,backendName:"webgl",kernelFunc:loe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uoe{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const{inHeight:n,inWidth:s,padInfo:o,strideHeight:r,strideWidth:i,filterHeight:a,filterWidth:l,dilationHeight:c,dilationWidth:u}=e,{top:h,left:d}=o;this.userCode=`
      const ivec2 strides = ivec2(${r}, ${i});
      const ivec2 pads = ivec2(${h}, ${d});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${a}; h++) {
          int hIn = hBeg + h * ${c};

          if (hIn >= 0 && hIn < ${n}) {
            for (int w = 0; w < ${l}; w++) {
              int wIn = wBeg + w * ${u};

              if (wIn >= 0 && wIn < ${s}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hoe(t){const{inputs:e,backend:n,attrs:s}=t,{x:o,filter:r}=e,{strides:i,pad:a,dilations:l}=s,c=Pu(o.shape,r.shape,i,a,"NHWC",l);let u;const h=new uoe(c);u=n.runWebGLProgram(h,[o,r],"float32");const d=Te({inputs:{x:u},backend:n,attrs:{shape:c.outShape}});return n.disposeIntermediateTensorInfo(u),d}const doe={kernelName:_f,backendName:"webgl",kernelFunc:hoe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function foe(t){const{inputs:e,backend:n,attrs:s}=t,{equation:o}=s,r=e,{allDims:i,summedDims:a,idDims:l}=jy(o,r.length);Ky(i.length,l,r);const{path:c,steps:u}=Xy(a,l),h=u.length;let d=null,f=i.length;const p=[];for(let g=0;g<h;++g){for(const b of u[g]){const{permutationIndices:x,expandDims:y}=qy(f,l[b]);let w;Yy(x)?w=r[b]:(w=Un({inputs:{x:r[b]},backend:n,attrs:{perm:x}}),p.push(w));const v=w.shape.slice();for(let $=0;$<y.length;++$)v.splice(y[$],0,1);bt(w.shape,v)||(w=Te({inputs:{x:w},backend:n,attrs:{shape:v}}),p.push(w)),d===null?d=w:(d=L0({inputs:{a:w,b:d},backend:n}),p.push(d))}g<h-1&&(c[g]>=0&&(d=Hp({inputs:{x:d},backend:n,attrs:{axis:c[g]-(i.length-f),keepDims:!1}}),p.push(d)),f--)}for(const g of p)g!==d&&n.disposeIntermediateTensorInfo(g);return d}const poe={kernelName:ZI,backendName:"webgl",kernelFunc:foe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const moe="return (x >= 0.0) ? x : (exp(x) - 1.0);",goe=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,boe=dt({opSnippet:moe,packedOpSnippet:goe}),xoe={kernelName:eu,backendName:"webgl",kernelFunc:boe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yoe="return (b >= 1.0) ? a : a * (b + 1.0);",voe=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,woe=t=>{const{inputs:e,backend:n}=t,{dy:s,y:o}=e,r=se().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new nh(voe,s.shape,o.shape):new gl(yoe,s.shape,o.shape);return n.runWebGLProgram(r,[s,o],s.dtype)},Coe={kernelName:dx,backendName:"webgl",kernelFunc:woe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $oe=`
  return vec4(equal(a, b));
`,Ioe="return float(a == b);",_oe=kn({opSnippet:Ioe,packedOpSnippet:$oe,dtype:"bool",cpuKernelImpl:uee}),koe={kernelName:kf,backendName:"webgl",kernelFunc:_oe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Eoe=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${By};
  float a1 = ${Vy};
  float a2 = ${zy};
  float a3 = ${Wy};
  float a4 = ${Uy};
  float a5 = ${Hy};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,Soe=dt({opSnippet:Eoe}),Toe={kernelName:tu,backendName:"webgl",kernelFunc:Soe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Noe=Ll+`
  return exp(x);
`,Aoe=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,KN=dt({opSnippet:Noe,packedOpSnippet:Aoe,cpuKernelImpl:hee,dtype:"float32"}),Roe={kernelName:nu,backendName:"webgl",kernelFunc:KN};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yb(t){const{inputs:e,attrs:n,backend:s}=t,{dim:o}=n,{input:r}=e,i=r.shape.length,a=r.shape.slice();let l=o;return o<0&&(T(-(i+1)<=o,()=>`Axis must be in the interval [${-(i+1)}, ${i}]`),l=i+o+1),a.splice(l,0,1),Te({inputs:{x:r},backend:s,attrs:{shape:a}})}const Doe={kernelName:Ef,backendName:"webgl",kernelFunc:yb};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qC="return exp(x) - 1.0;",Ooe=dt({opSnippet:qC,packedOpSnippet:qC,cpuKernelImpl:dee}),Foe={kernelName:su,backendName:"webgl",kernelFunc:Ooe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class KC{constructor(e,n,s){this.variableNames=["real","imag"];const o=n[1];this.outputShape=n;const r=s?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,i=s?`${o}.0`:"1.0";let a;if(e==="real")a="return real * expR - imag * expI;";else if(e==="imag")a="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${e}.`);this.userCode=`
      const float exponentMultiplier = ${r};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${a}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${o});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${o}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${i};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XN(t,e,n){const s=n.texData.get(t.dataId),o=ae(t.shape),r=t.shape[t.shape.length-1],i=o/r,a=Te({inputs:{x:t},backend:n,attrs:{shape:[i,r]}}),l=a.shape,c=new KC("real",l,e),u=new KC("imag",l,e),h=[{dataId:s.complexTensorInfos.real.dataId,dtype:s.complexTensorInfos.real.dtype,shape:l},{dataId:s.complexTensorInfos.imag.dataId,dtype:s.complexTensorInfos.imag.dtype,shape:l}],d=n.runWebGLProgram(c,h,"float32"),f=n.runWebGLProgram(u,h,"float32"),p=ni({inputs:{real:d,imag:f},backend:n});n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f);const g=Te({inputs:{x:p},backend:n,attrs:{shape:t.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(p),g}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Loe(t){const{inputs:e,backend:n}=t,{input:s}=e;return XN(s,!1,n)}const Poe={kernelName:fx,backendName:"webgl",kernelFunc:Loe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Moe{constructor(e,n){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oh(t){const{backend:e,attrs:n}=t,{shape:s,value:o}=n;let{dtype:r}=n;if(r=r||Bc(o),r==="string"){const i=An(r,ae(s));return i.fill(o),e.makeTensorInfo(s,r,i)}else{const i=new Moe(s,o),a=[[o]];return e.runWebGLProgram(i,[],r,a)}}const Boe={kernelName:px,backendName:"webgl",kernelFunc:oh};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Voe{constructor(e){this.variableNames=["Image"],this.outputShape=[];const n=e[2];this.outputShape=e,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${n} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${n}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zoe={kernelName:mx,backendName:"webgl",kernelFunc:({inputs:t,backend:e})=>{const{image:n}=t,s=e,o=new Voe(n.shape);return s.runWebGLProgram(o,[n],n.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XC="return floor(x);",Woe=dt({opSnippet:XC,packedOpSnippet:XC,cpuKernelImpl:fee}),Uoe={kernelName:ou,backendName:"webgl",kernelFunc:Woe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hoe=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,Goe=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,joe=kn({opSnippet:Hoe,packedOpSnippet:Goe,dtype:"int32"}),qoe={kernelName:ru,backendName:"webgl",kernelFunc:joe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Koe{constructor(e){this.variableNames=["A"];const n=Hn(),[s,o]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${o}.0, ${s}.0);

        vec4 values = ${n.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Xoe{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const n=Hn(),[s,o]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${o}.0, ${s}.0);
            vec4 values = ${n.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yoe={kernelName:bz,backendName:"webgl",kernelFunc:Zoe};let Ra,og=se().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function Zoe(t){const{inputs:e,backend:n,attrs:s}=t;let{pixels:o}=e;const{numChannels:r}=s,i=typeof HTMLVideoElement<"u"&&o instanceof HTMLVideoElement,a=typeof HTMLImageElement<"u"&&o instanceof HTMLImageElement,[l,c]=i?[o.videoWidth,o.videoHeight]:[o.width,o.height],u=[c,l],h=[c,l,r];if(a||i){const g=se().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(Ra==null||g!==og)&&(og=g,Ra=document.createElement("canvas").getContext("2d",{willReadFrequently:og})),Ra.canvas.width=l,Ra.canvas.height=c,Ra.drawImage(o,0,0,l,c),o=Ra.canvas}const d=n.makeTensorInfo(u,"int32");n.texData.get(d.dataId).usage=Is.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(d.dataId),o);const f=se().getBool("WEBGL_PACK")?new Xoe(h):new Koe(h),p=n.runWebGLProgram(f,[d],"int32");return n.disposeData(d.dataId),p}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qoe(t){const{inputs:e,backend:n,attrs:s}=t,{x:o,filter:r,bias:i,preluActivationWeights:a}=e,{strides:l,pad:c,dataFormat:u,dilations:h,dimRoundingMode:d,activation:f,leakyreluAlpha:p}=s,g=hr(u),b=In(o.shape,r.shape,l,h,c,d,!1,g);let x;const y=[],w=i!=null,v=a!=null,$=f==="leakyrelu",_=()=>{const k=[o,r],N=(A,F)=>{if(F==="NCHW"&&A.shape.length===1&&A.shape[0]!==1){const L=Te({inputs:{x:A},backend:n,attrs:{shape:[A.shape[0],1,1]}});return y.push(L),L}return A};if(w&&k.push(N(i,u)),v&&k.push(N(a,u)),$){const A=n.makeTensorInfo([],"float32",qr(p,"float32"));k.push(A),y.push(A)}return k};if(b.filterHeight===1&&b.filterWidth===1&&b.dilationHeight===1&&b.dilationWidth===1&&b.strideHeight===1&&b.strideWidth===1&&(b.padInfo.type==="SAME"||b.padInfo.type==="VALID"))x=UN({x:o,filter:r,convInfo:b,backend:n,bias:i,activation:f,preluActivationWeights:a,leakyreluAlpha:p});else if(b.strideWidth<=2&&g==="channelsLast"&&se().getBool("WEBGL_EXP_CONV")){const k=f?Rc(f,!0):null,N=new WN(b,w,k,v,$),A=[[b.padInfo.top,b.padInfo.left],[b.strideHeight,b.strideWidth],[b.dilationHeight,b.dilationWidth],[b.inHeight,b.inWidth]],F=_();x=n.runWebGLProgram(N,F,"float32",A)}else if(se().getBool("WEBGL_CONV_IM2COL"))x=HN({x:o,filter:r,convInfo:b,backend:n,bias:i,activation:f,preluActivationWeights:a,leakyreluAlpha:p});else{const k=f?Rc(f,!1):null,N=new zN(b,w,k,v,$),A=_();x=n.runWebGLProgram(N,A,"float32")}const E=Te({inputs:{x},backend:n,attrs:{shape:b.outShape}});return y.push(x),y.forEach(k=>n.disposeIntermediateTensorInfo(k)),E}const Joe={kernelName:xd,backendName:"webgl",kernelFunc:Qoe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ere(t){const{inputs:e,backend:n,attrs:s}=t,{x:o,filter:r,bias:i,preluActivationWeights:a}=e,{strides:l,pad:c,dilations:u,dimRoundingMode:h,activation:d,leakyreluAlpha:f}=s,p=[];let g=u;g==null&&(g=[1,1]),T(Pn(l,g),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${g}'`);const b=In(o.shape,r.shape,l,g,c,h,!0),x=se().getBool("WEBGL_PACK_DEPTHWISECONV")&&b.strideWidth<=2&&b.outChannels/b.inChannels===1,y=d?Rc(d,x):null,w=[o,r],v=i!=null,$=a!=null,_=d==="leakyrelu";if(v&&w.push(i),$&&w.push(a),_){const A=n.makeTensorInfo([],"float32",qr(f,"float32"));w.push(A),p.push(A)}let E;x?E=new qN(b,v,y,$,_):E=new jN(b,v,y,$,_);const k=[[b.padInfo.top,b.padInfo.left],[b.strideHeight,b.strideWidth],[b.dilationHeight,b.dilationWidth],[b.inHeight,b.inWidth]],N=n.runWebGLProgram(E,w,"float32",k);return p.forEach(A=>n.disposeIntermediateTensorInfo(A)),N}const tre={kernelName:i_,backendName:"webgl",kernelFunc:ere};class nre{constructor(e,n,s,o){this.sliceDim=e,this.strides=n,this.paramsShape=o,this.variableNames=["x","indices"],this.outputShape=s;const r=It(n.length),i=It(s.length),a=this.sliceDim>1?"strides[j]":"strides",l=It(o.length),c=o.length>1?"paramsShape[j]":"paramsShape";this.userCode=`
        ${r} strides = ${r}(${this.strides});
        ${l} paramsShape = ${l}(${this.paramsShape});
         void main() {
          ${i} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;
          for (int j = 0; j < ${this.sliceDim}; j++) {
            int index = round(getIndices(coords[0], j));
            out_of_bounds = out_of_bounds || index < 0;
            out_of_bounds = out_of_bounds || index >= ${c};
            flattenIndex += index * ${a};
          }
          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sre(t){const{inputs:e,backend:n}=t,{params:s,indices:o}=e,r=o.shape,i=r[r.length-1],a=ae(s.shape),[l,c,u,h]=jx(s,o),d=Te({inputs:{x:o},backend:n,attrs:{shape:[c,i]}}),f=Te({inputs:{x:s},backend:n,attrs:{shape:[ae(s.shape)/u,u]}});if(n.shouldExecuteOnCPU([s,o])||s.dtype==="string"){const x=n.readSync(o.dataId),y=n.bufferSync(s),w=pee(x,y,s.dtype,c,i,u,h,s.shape,a);return n.makeTensorInfo(l,s.dtype,w.values)}const p=new nre(i,h,[c,u],s.shape),g=n.runWebGLProgram(p,[f,d],f.dtype),b=Te({inputs:{x:g},backend:n,attrs:{shape:l}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(g),b}const ore={kernelName:QI,backendName:"webgl",kernelFunc:sre};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rre{constructor(e,n){this.variableNames=["A","indices"],this.outputShape=n,this.rank=n.length;const s=It(this.rank),o=ire(e);this.userCode=`
      void main() {
        ${s} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${o}));
      }
    `}}function ire(t,e){const n=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[];for(let o=0;o<t.length;o++)o===2?s.push("index"):s.push(`${n[o]}`);return s.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YN(t){const{inputs:e,backend:n,attrs:s}=t,{x:o,indices:r}=e,{axis:i,batchDims:a}=s,l=st(i,o.shape)[0];if(se().get("DEBUG")){const y=n.readSync(r.dataId),w=o.shape[l];for(let v=0;v<y.length;++v){const $=y[v];T($<=w-1&&$>=0,()=>`GatherV2: the index value ${$} is not in [0, ${w-1}]`)}}const c=Qy(o,r,l,a),u=ae(r.shape),h=[],d=Te({inputs:{x:o},backend:n,attrs:{shape:[c.batchSize,c.outerSize,c.dimSize,c.sliceSize]}}),f=Te({inputs:{x:r},backend:n,attrs:{shape:[c.batchSize,u/c.batchSize]}});h.push(d),h.push(f);const p=[c.batchSize,c.outerSize,u/c.batchSize,c.sliceSize];if(n.shouldExecuteOnCPU([o,r])||o.dtype==="string"){const y=n.bufferSync(f),w=n.bufferSync(d),v=mee(w,y,p);return h.forEach($=>n.disposeIntermediateTensorInfo($)),n.makeTensorInfo(c.outputShape,v.dtype,v.values)}const g=new rre(d.shape,p),b=n.runWebGLProgram(g,[d,f],d.dtype);h.push(b);const x=Te({inputs:{x:b},backend:n,attrs:{shape:c.outputShape}});return h.forEach(y=>n.disposeIntermediateTensorInfo(y)),x}const are={kernelName:Tf,backendName:"webgl",kernelFunc:YN};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lre="return float(a > b);",cre=`
  return vec4(greaterThan(a, b));
`,ure=kn({opSnippet:lre,packedOpSnippet:cre,cpuKernelImpl:gee,dtype:"bool"}),hre={kernelName:Nf,backendName:"webgl",kernelFunc:ure};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dre="return float(a >= b);",fre=`
  return vec4(greaterThanEqual(a, b));
`,pre=kn({opSnippet:dre,packedOpSnippet:fre,dtype:"bool",cpuKernelImpl:bee}),mre={kernelName:iu,backendName:"webgl",kernelFunc:pre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gre(t){const{inputs:e,backend:n}=t,{input:s}=e;return XN(s,!0,n)}const bre={kernelName:gx,backendName:"webgl",kernelFunc:gre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xre="return float(!isnan(x) && !isinf(x));",yre=dt({opSnippet:xre,dtype:"bool"}),vre={kernelName:lu,backendName:"webgl",kernelFunc:yre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wre="return float(isinf(x));",Cre=dt({opSnippet:wre,dtype:"bool"}),$re={kernelName:cu,backendName:"webgl",kernelFunc:Cre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ire="return float(isnan(x));",_re=dt({opSnippet:Ire,dtype:"bool"}),kre={kernelName:uu,backendName:"webgl",kernelFunc:_re};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ere="return float(a < b);",Sre=`
  return vec4(lessThan(a, b));
`,Tre=kn({opSnippet:Ere,packedOpSnippet:Sre,cpuKernelImpl:xee,dtype:"bool"}),Nre={kernelName:Rf,backendName:"webgl",kernelFunc:Tre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Are="return float(a <= b);",Rre=`
  return vec4(lessThanEqual(a, b));
`,Dre=kn({opSnippet:Are,packedOpSnippet:Rre,cpuKernelImpl:yee,dtype:"bool"}),Ore={kernelName:Df,backendName:"webgl",kernelFunc:Dre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fre(t){const{backend:e,attrs:n}=t,{start:s,stop:o,num:r}=n,i=vee(s,o,r);return e.makeTensorInfo([i.length],"float32",i)}const Lre={kernelName:JI,backendName:"webgl",kernelFunc:Fre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pre=Ll+`
  return x < 0.0 ? 0./0. : log(x);
`,Mre=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,Bre=dt({opSnippet:Pre,packedOpSnippet:Mre,cpuKernelImpl:wee}),Vre={kernelName:hu,backendName:"webgl",kernelFunc:Bre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zre=Ll+`
  return log(1.0 + x);
`,Wre=dt({opSnippet:zre}),Ure={kernelName:du,backendName:"webgl",kernelFunc:Wre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hre="return float(a >= 1.0 && b >= 1.0);",Gre=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,jre=kn({opSnippet:Hre,packedOpSnippet:Gre,dtype:"bool"}),qre={kernelName:Of,backendName:"webgl",kernelFunc:jre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kre="return float(!(x >= 1.0));",Xre=dt({opSnippet:Kre}),Yre={kernelName:Ff,backendName:"webgl",kernelFunc:Xre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zre="return float(a >= 1.0 || b >= 1.0);",Qre=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,Jre=kn({opSnippet:Zre,packedOpSnippet:Qre,dtype:"bool"}),eie={kernelName:Lf,backendName:"webgl",kernelFunc:Jre};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tie{constructor(e,n,s,o,r){this.variableNames=["x"],this.outputShape=[];const i=n,a=e[3]-1;this.outputShape=e;let l;const c=`float(${s}) + float(${o}) * sum`;r===.5?l=`inversesqrt(${c})`:r===1?l=`1.0/(${c})`:l=`exp(log(${c}) * float(-${r}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${i}; j <= ${i}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${a}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${l};
        setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nie{constructor(e,n,s,o,r){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const i=n,a=e[3]-1;this.outputShape=e;let l;const c=`float(${s}) + float(${o}) * sum`;r===.5?l=`inversesqrt(${c})`:r===1?l=`1.0/(${c})`:l=`exp(log(${c}) * float(-${r}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${i};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${i}; j <= ${i}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${a}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${l};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sie=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:o}=e,{depthRadius:r,bias:i,alpha:a,beta:l}=s,c=se().getBool("WEBGL_PACK_NORMALIZATION")?new nie(o.shape,r,i,a,l):new tie(o.shape,r,i,a,l);return n.runWebGLProgram(c,[o],o.dtype)},oie={kernelName:Pf,backendName:"webgl",kernelFunc:sie};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rie{constructor(e,n,s,o,r){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=n,this.bias=s,this.alpha=o,this.beta=r,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${n})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${n} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${o}) * norm + float(${s});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${o})
                * float(${r})
                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${r});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iie=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:o,y:r,dy:i}=e,{depthRadius:a,bias:l,alpha:c,beta:u}=s,h=new rie(o.shape,a,l,c,u);return n.runWebGLProgram(h,[o,r,i],o.dtype)},aie={kernelName:xx,backendName:"webgl",kernelFunc:iie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lie(t,e,n,s){const o=ae(e),i=ae(t.shape)/o,a=Te({inputs:{x:t},attrs:{shape:[i,o]},backend:s}),l=ua(a,t.dtype,"max",s),c=Te({inputs:{x:l},attrs:{shape:n},backend:s});return s.disposeIntermediateTensorInfo(a),s.disposeIntermediateTensorInfo(l),c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZN(t){const{inputs:e,backend:n,attrs:s}=t,{x:o}=e,{reductionIndices:r,keepDims:i}=s,a=o.shape.length,l=st(r,o.shape);let c=l;const u=jt(c,a),h=u!=null,d=n.shouldExecuteOnCPU([o]);let f=o;if(h){if(d){const w=n.texData.get(f.dataId).values,v=new Array(a);for(let E=0;E<v.length;E++)v[E]=o.shape[u[E]];const $=F0(w,o.shape,o.dtype,u,v);f=n.makeTensorInfo(v,o.dtype);const _=n.texData.get(f.dataId);_.values=$}else f=Up(o,u,n);c=Zt(c.length,a)}_n("max",c,a);const[p,g]=yn(f.shape,c);let b=p;i&&(b=Yt(p,l));let x;if(d){const w=n.texData.get(f.dataId).values,v=Cee(w,ae(g),b,o.dtype);x=n.makeTensorInfo(b,o.dtype);const $=n.texData.get(x.dataId);$.values=v}else x=lie(f,g,b,n);return h&&n.disposeIntermediateTensorInfo(f),x}const cie={kernelName:Mf,backendName:"webgl",kernelFunc:ZN};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uie=TN+`
  return max(a, b);
`,hie=`
  vec4 result = vec4(max(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  `+Wp+`
  return result;
`,die=kn({opSnippet:uie,packedOpSnippet:hie,cpuKernelImpl:$ee}),fie={kernelName:fu,backendName:"webgl",kernelFunc:die};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pie(t){const{inputs:e,backend:n,attrs:s}=t,{x:o}=e;eh(o,"maxPool");const{filterSize:r,strides:i,pad:a,dimRoundingMode:l}=s,c=1;T(Pn(i,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);const u=Zs(o.shape,r,i,c,a,l);if(u.filterWidth===1&&u.filterHeight===1&&bt(u.inShape,u.outShape))return ms({inputs:{x:o},backend:n});const h=new Dc(u,"max",!1);return n.runWebGLProgram(h,[o],o.dtype)}const mie={kernelName:Bf,backendName:"webgl",kernelFunc:pie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gie(t){const{inputs:e,backend:n,attrs:s}=t,{x:o}=e,{filterSize:r,strides:i,pad:a,dataFormat:l,dimRoundingMode:c}=s,u=[1,1,1],h=ur(o.shape,r,i,u,a,c,l),d=new P0(h,"max",!1);return n.runWebGLProgram(d,[o],o.dtype)}const bie={kernelName:Vf,backendName:"webgl",kernelFunc:gie};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xie{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideHeight,s=e.strideWidth,o=e.dilationHeight,r=e.effectiveFilterHeight,i=e.effectiveFilterWidth,a=r-1-e.padInfo.top,l=i-1-e.padInfo.left,c=r*i-1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${r};
          wR += ${o}) {
          float dyR = float(dyRCorner + wR) / ${n}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${i}; wC++) {
            float dyC = float(dyCCorner + wC) / ${s}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${c} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${i} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class yie{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideDepth,s=e.strideHeight,o=e.strideWidth,r=e.dilationDepth,i=e.dilationHeight,a=e.dilationWidth,l=e.effectiveFilterDepth,c=e.effectiveFilterHeight,u=e.effectiveFilterWidth,h=l-1-e.padInfo.front,d=c-1-e.padInfo.top,f=u-1-e.padInfo.left,p=l*c*u-1;this.userCode=`
      const ivec3 pads = ivec3(${h}, ${d}, ${f});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${l};
           wD += ${r}) {
          float dyD = float(dyDCorner + wD) / ${n}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${c};
              wR += ${i}) {
            float dyR = float(dyRCorner + wR) / ${s}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${u};
                wC += ${a}) {
              float dyC = float(dyCCorner + wC) / ${o}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${p} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${c} * ${u} +
                  wR * ${u} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vie(t){const{inputs:e,backend:n,attrs:s}=t,{dy:o,input:r}=e,i=r,{filterSize:a,strides:l,pad:c,dimRoundingMode:u}=s,h=[1,1,1],d=ur(i.shape,a,l,h,c,u),f=new P0(d,"max",!0),p=n.runWebGLProgram(f,[i],i.dtype),g=new yie(d),b=n.runWebGLProgram(g,[o,p],i.dtype);return n.disposeIntermediateTensorInfo(p),b}const wie={kernelName:vx,backendName:"webgl",kernelFunc:vie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cie(t){const{inputs:e,backend:n,attrs:s}=t,{dy:o,input:r,output:i}=e,a=r;eh([r,i],"maxPoolGrad");const{filterSize:l,strides:c,pad:u,dimRoundingMode:h}=s,d=Zs(a.shape,l,c,1,u,h),f=!0,p=new Dc(d,"max",f),g=n.runWebGLProgram(p,[a],a.dtype),b=new xie(d),x=n.runWebGLProgram(b,[o,g],a.dtype);return n.disposeIntermediateTensorInfo(g),x}const $ie={kernelName:yx,backendName:"webgl",kernelFunc:Cie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iie(t,e,n,s){let o=new Dc(n,"max",!1);const r=s.runWebGLProgram(o,[t],"float32");o=new Dc(n,"max",!0,!0,e);const i=s.runWebGLProgram(o,[t],"float32");return[r,i]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _ie={kernelName:e_,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:s}=t,{filterSize:o,strides:r,pad:i,includeBatchInIndex:a}=e,l=n;T(s.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${s.shape.length}.`);const c=[1,1];T(Pn(r,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${r} and dilations '${c}'`);const u=Zs(s.shape,o,r,c,i),[h,d]=Iie(s,a,u,l);return[h,d]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kie(t,e,n,s){const o=ae(e),i=ae(t.shape)/o,a=Te({inputs:{x:t},attrs:{shape:[i,o]},backend:s}),l=ua(a,"float32","mean",s),c=Te({inputs:{x:l},attrs:{shape:n},backend:s});return s.disposeIntermediateTensorInfo(a),s.disposeIntermediateTensorInfo(l),c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Eie={kernelName:zf,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:s}=t,{keepDims:o,axis:r}=e,i=n,a=s.shape.length,l=st(r,s.shape);let c=l;const u=jt(c,a),h=u!=null,d=i.shouldExecuteOnCPU([s]),f=[];let p=s;if(h){if(d){const v=i.texData.get(p.dataId).values,$=new Array(a);for(let k=0;k<$.length;k++)$[k]=s.shape[u[k]];const _=F0(v,s.shape,s.dtype,u,$);p=i.makeTensorInfo($,s.dtype);const E=i.texData.get(p.dataId);E.values=_}else p=Up(s,u,i);f.push(p),c=Zt(c.length,a)}_n("sum",c,a);const[g,b]=yn(p.shape,c);let x=g;o&&(x=Yt(g,l));const y=kie(p,b,x,i);for(const w of f)i.disposeIntermediateTensorInfo(w);return y}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sie(t){const{inputs:e,backend:n,attrs:s}=t,{x:o}=e,{axis:r,keepDims:i}=s,a=o.shape.length,l=st(r,o.shape);let c=l;const u=jt(c,a);let h=o;u!=null&&(h=Un({inputs:{x:o},backend:n,attrs:{perm:u}}),c=Zt(c.length,o.shape.length)),_n("min",c,a);const[d,f]=yn(h.shape,c),p=ae(f),g=Te({inputs:{x:h},backend:n,attrs:{shape:[-1,p]}}),b=ua(g,g.dtype,"min",n);let x;if(i){const y=Yt(d,l);x=Te({inputs:{x:b},backend:n,attrs:{shape:y}})}else x=Te({inputs:{x:b},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(b),u!=null&&n.disposeIntermediateTensorInfo(h),x}const Tie={kernelName:Wf,backendName:"webgl",kernelFunc:Sie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nie=TN+`
  return min(a, b);
`,Aie=`
  vec4 result = vec4(min(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  `+Wp+`
  return result;
`,Rie=kn({opSnippet:Nie,packedOpSnippet:Aie,cpuKernelImpl:Iee}),Die={kernelName:pu,backendName:"webgl",kernelFunc:Rie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Oie{constructor(e,n,s){this.variableNames=["x"],this.outputShape=n.map((u,h)=>u[0]+e[h]+u[1]);const o=e.length,r=It(o),i=n.map(u=>u[0]).join(","),a=n.map((u,h)=>u[0]+e[h]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,o),c=s==="reflect"?0:1;if(o===1){this.userCode=`
        int start = ${i};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${c};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${c};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${r} start = ${r}(${i});
      ${r} end = ${r}(${a});

      void main() {
        ${r} outC = getOutputCoords();
        for (int i = 0; i < ${o}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${c};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${c};
          }
        }
        ${r} coords = outC - start;
        setOutput(getX(${l}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Fie{constructor(e,n,s){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((p,g)=>p[0]+e[g]+p[1]);const o=e.length,r=It(o),i=n.map(p=>p[0]).join(","),a=n.map((p,g)=>p[0]+e[g]).join(","),l=zn("rc",o),c=zn("source",o),u=`${l[o-1]} < ${this.outputShape[o-1]}`,h=o===1?"source":`vec2(${c.slice(-2).join()})`,d=s==="reflect"?0:1;let f="";if(o===1){const p=`
        ${r} source = rc;
        if (source < start) {
          source = start * 2 - source - ${d};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${d};
        }
        source -= start;
      `;f=`
        ${r} rc = outputLoc;
        ${p}
        result[0] = getChannel(getX(${c.join()}), ${h});
        ${l[o-1]} += 1;
        if(${u}) {
          ${p}
          result[1] = getChannel(getX(${c.join()}), ${h});
        }
      `}else{const p=`
        ${r} source = rc;
        ${r} lt = ${r}(lessThan(source, start));
        ${r} gte = ${r}(greaterThanEqual(source, end));
        ${r} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${d}) +
                gte * ((end - 1) * 2 - source + ${d});
        source -= start;
      `;f=`
        ${r} rc = outputLoc;
        ${p}
        result[0] = getChannel(getX(${c.join()}), ${h});
        ${l[o-1]} += 1;
        if(${u}) {
          ${p}
          result[1] = getChannel(getX(${c.join()}), ${h});
        }
        rc = outputLoc;
        ${l[o-2]} += 1;
        if(${l[o-2]} < ${this.outputShape[o-2]}) {
          ${p}
          result[2] = getChannel(getX(${c.join()}), ${h});
          ${l[o-1]} += 1;
          if(${u}) {
            ${p}
            result[3] = getChannel(getX(${c.join()}), ${h});
          }
        }
      `}this.userCode=`
      const ${r} start = ${r}(${i});
      const ${r} end = ${r}(${a});

      void main() {
        ${r} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${f}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lie=({inputs:t,backend:e,attrs:n})=>{const{x:s}=t,{paddings:o,mode:r}=n,i=se().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Fie(s.shape,o,r):new Oie(s.shape,o,r);return e.runWebGLProgram(i,[s],s.dtype)},Pie={kernelName:Uf,backendName:"webgl",kernelFunc:Lie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mie=`if (b == 0.0) return NAN;
  return mod(a, b);`,Bie=`
  vec4 result = mod(a, b);
  vec4 isNaN = vec4(equal(b, vec4(0.0)));
  `+Wp+`
  return result;
`,Vie=kn({opSnippet:Mie,packedOpSnippet:Bie}),zie={kernelName:mu,backendName:"webgl",kernelFunc:Vie};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Wie{constructor(e,n,s){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,s],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${n-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${n-1}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uie=`
if (a == b) {
  return 1.0;
};
return a / b;`,Hie=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,QN=kn({opSnippet:Uie,packedOpSnippet:Hie,checkOutOfBounds:!0}),Gie={kernelName:Jc,backendName:"webgl",kernelFunc:QN};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YC="return a - b;",JN=kn({opSnippet:YC,packedOpSnippet:YC,supportsComplex:!0,cpuKernelImpl:Wee}),jie={kernelName:Au,backendName:"webgl",kernelFunc:JN};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e2(t){const{inputs:e,backend:n,attrs:s}=t,{logits:o}=e,{dim:r}=s,i=st([r],o.shape),a=ZN({inputs:{x:o},backend:n,attrs:{reductionIndices:i,keepDims:!1}}),l=Yt(a.shape,i),c=Te({inputs:{x:a},backend:n,attrs:{shape:l}}),u=JN({inputs:{a:o,b:c},backend:n}),h=KN({inputs:{x:u},backend:n}),d=Hp({inputs:{x:h},backend:n,attrs:{axis:i,keepDims:!1}}),f=Te({inputs:{x:d},backend:n,attrs:{shape:l}}),p=QN({inputs:{a:h,b:f},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),p}const qie={kernelName:ap,backendName:"webgl",kernelFunc:e2};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kie(t){const{inputs:e,backend:n,attrs:s}=t,{logits:o}=e,{numSamples:r,seed:i,normalized:a}=s,l=a?o:e2({inputs:{logits:o},backend:n,attrs:{dim:o.shape.length-1}}),c=l.shape[0],u=l.shape[1],h=new Wie(c,u,r),d=[[i]],f=n.runWebGLProgram(h,[l],"int32",d);return a||n.disposeIntermediateTensorInfo(l),f}const Xie={kernelName:t_,backendName:"webgl",kernelFunc:Kie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yie=eo+`
  return -x;
`,Zie=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function Qie(t){const{inputs:e,backend:n}=t,{x:s}=e;if(n.shouldExecuteOnCPU([s])){const r=n.texData.get(s.dataId),[i,a]=kee(r.values,s.shape,s.dtype);return n.makeTensorInfo(a,s.dtype,i)}let o;return se().getBool("WEBGL_PACK_UNARY_OPERATIONS")?o=new Ai(s.shape,Zie):o=new sr(s.shape,Yie),n.runWebGLProgram(o,[s],s.dtype)}const Jie={kernelName:Hf,backendName:"webgl",kernelFunc:Qie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eae=Iy;function tae(t){Cs("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:s}=t,{boxes:o,scores:r}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l}=s,c=n.readSync(o.dataId),u=n.readSync(r.dataId),{selectedIndices:h}=eae(c,u,i,a,l);return n.makeTensorInfo([h.length],"int32",new Int32Array(h))}const nae={kernelName:wx,backendName:"webgl",kernelFunc:tae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sae=_y;function oae(t){Cs("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:s}=t,{boxes:o,scores:r}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:c}=s,u=n.readSync(o.dataId),h=n.readSync(r.dataId),{selectedIndices:d,validOutputs:f}=sae(u,h,i,a,l,c);return[n.makeTensorInfo([d.length],"int32",new Int32Array(d)),n.makeTensorInfo([],"int32",new Int32Array([f]))]}const rae={kernelName:Cx,backendName:"webgl",kernelFunc:oae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iae=ky;function aae(t){Cs("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:s}=t,{boxes:o,scores:r}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l,softNmsSigma:c}=s,u=n.readSync(o.dataId),h=n.readSync(r.dataId),d=i,f=a,p=l,g=c,{selectedIndices:b,selectedScores:x}=iae(u,h,d,f,p,g);return[n.makeTensorInfo([b.length],"int32",new Int32Array(b)),n.makeTensorInfo([x.length],"float32",new Float32Array(x))]}const lae={kernelName:$x,backendName:"webgl",kernelFunc:aae};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cae{constructor(e,n,s,o){this.variableNames=["indices"],this.outputShape=[e,n],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${o}), float(${s}),
                      float(index == coords.y)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uae=t=>{const{inputs:e,backend:n,attrs:s}=t,{indices:o}=e,{dtype:r,depth:i,onValue:a,offValue:l}=s,c=ae(o.shape),u=new cae(c,i,a,l),h=Te({inputs:{x:o},backend:n,attrs:{shape:[c]}}),d=n.runWebGLProgram(u,[h],r);n.disposeIntermediateTensorInfo(h);const f=[...o.shape,i],p=Te({inputs:{x:d},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(d),p},hae={kernelName:qf,backendName:"webgl",kernelFunc:uae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gd(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="complex64"){const o=sh({inputs:{input:s},backend:n}),r=Gd({inputs:{x:o},backend:n}),i=Gp({inputs:{input:s},backend:n}),a=Gd({inputs:{x:i},backend:n}),l=ni({inputs:{real:r,imag:a},backend:n});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),l}else return oh({attrs:{shape:s.shape,dtype:s.dtype,value:s.dtype==="string"?"":0},backend:n})}const dae={kernelName:up,backendName:"webgl",kernelFunc:Gd};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t2(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(s.dtype==="complex64"){const o=sh({inputs:{input:s},backend:n}),r=t2({inputs:{x:o},backend:n}),i=Gp({inputs:{input:s},backend:n}),a=Gd({inputs:{x:i},backend:n}),l=ni({inputs:{real:r,imag:a},backend:n});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),l}else return oh({attrs:{shape:s.shape,dtype:s.dtype,value:1},backend:n})}const fae={kernelName:jf,backendName:"webgl",kernelFunc:t2};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pae(t){const{inputs:e,backend:n,attrs:s}=t,{axis:o}=s;if(e.length===1)return yb({inputs:{input:e[0]},backend:n,attrs:{dim:o}});const r=e[0].shape,i=e[0].dtype;e.forEach(u=>{Ys(r,u.shape,"All tensors passed to stack must have matching shapes"),T(i===u.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],l=e.map(u=>{const h=yb({inputs:{input:u},backend:n,attrs:{dim:o}});return a.push(h),h}),c=VN({inputs:l,backend:n,attrs:{axis:o}});return a.forEach(u=>n.disposeIntermediateTensorInfo(u)),c}const mae={kernelName:Kf,backendName:"webgl",kernelFunc:pae};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gae{constructor(e,n,s){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((c,u)=>c[0]+e[u]+c[1]);const o=e.length,r=It(o),i=n.map(c=>c[0]).join(","),a=n.map((c,u)=>c[0]+e[u]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,o);if(o===1){this.userCode=`
        int start = ${i};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${r} start = ${r}(${i});
      ${r} end = ${r}(${a});

      void main() {
        ${r} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${r} coords = outC - start;
          setOutput(getX(${l}));
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bae{constructor(e,n,s){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((g,b)=>g[0]+e[b]+g[1]);const o=e.length,r=It(o),i=n.map(g=>g[0]).join(","),a=n.map((g,b)=>g[0]+e[b]).join(","),l=zn("rc",o),c=zn("source",o),u=`${l[o-1]} < ${this.outputShape[o-1]}`,h=o===1?"source":`vec2(${c.slice(-2).join()})`,d=[`${r} rc = outputLoc;`,`${l[o-1]} += 1;
       if(${u}) {
      `,o===1?"":`}
       rc = outputLoc;
       ${l[o-2]} += 1;
       if(${l[o-2]} < ${this.outputShape[o-2]}) {`,o===1?"":`  ${l[o-1]} += 1;
         if(${u}) {`],f=o===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let p="";for(let g=0,b=o===1?2:4;g<b;g++)p+=`
        ${d[g]}
        if (${f}) {
          result[${g}] = float(value);
        } else {
          ${r} source = rc - start;
          result[${g}] = getChannel(getX(${c.join()}), ${h});
        }
      `;p+=o===1?"} ":"}}",this.userCode=`
      const ${r} start = ${r}(${i});
      const ${r} end = ${r}(${a});

      void main() {
        ${r} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${p}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n2=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:o}=e,{paddings:r,constantValue:i}=s;if(ae(o.shape)===0){const c=r.map((u,h)=>u[0]+o.shape[h]+u[1]);return oh({backend:n,attrs:{shape:c,value:i,dtype:o.dtype}})}const a=se().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new bae(o.shape,r,i):new gae(o.shape,r,i),l=[[i]];return n.runWebGLProgram(a,[o],o.dtype,l)},xae={kernelName:Xf,backendName:"webgl",kernelFunc:n2};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yae=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,vae=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));
  `+Wp+`
  return result;
`,wae=kn({opSnippet:yae,packedOpSnippet:vae}),Cae={kernelName:bu,backendName:"webgl",kernelFunc:wae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ae(t){const{inputs:e,backend:n,attrs:s}=t,{x:o}=e,{axis:r,keepDims:i}=s,a=o.shape.length,l=[],c=st(r,o.shape);let u=c;const h=jt(u,a);let d=o;h!=null&&(d=Un({inputs:{x:o},backend:n,attrs:{perm:h}}),u=Zt(u.length,a),l.push(d)),_n("prod",u,a);let f;if(n.shouldExecuteOnCPU([d])){const p=n.texData.get(d.dataId).values,{outVals:g,outShape:b,outDtype:x}=See(d.shape,d.dtype,p,u);f=n.makeTensorInfo(b,x,g)}else{const[p,g]=yn(d.shape,u),b=ae(g),x=Te({inputs:{x:d},backend:n,attrs:{shape:[-1,b]}}),y=Wx(o.dtype),w=ua(x,y,"prod",n);f=Te({inputs:{x:w},backend:n,attrs:{shape:p}}),l.push(x),l.push(w)}if(i){l.push(f);const p=Yt(f.shape,c);f=Te({inputs:{x:f},backend:n,attrs:{shape:p}})}return l.forEach(p=>n.disposeIntermediateTensorInfo(p)),f}const Iae={kernelName:Zf,backendName:"webgl",kernelFunc:$ae};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ae(t){const{inputs:e,backend:n,attrs:s}=t,{shape:o,values:r,defaultValue:i,rowPartitionTensors:a}=e,{rowPartitionTypes:l}=s,c=n.readSync(o.dataId),u=n.readSync(r.dataId),h=n.readSync(i.dataId),d=a.map(b=>n.readSync(b.dataId)),f=a.map(b=>b.shape),[p,g]=Tee(c,o.shape,u,r.shape,r.dtype,h,i.shape,d,f,l);return n.makeTensorInfo(p,r.dtype,g)}const kae={kernelName:n_,backendName:"webgl",kernelFunc:_ae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s2=t=>{const{backend:e,attrs:n}=t,{start:s,stop:o,step:r,dtype:i}=n,a=Nee(s,o,r,i);return e.makeTensorInfo([a.length],i,a)},Eae={kernelName:Ix,backendName:"webgl",kernelFunc:s2};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sae="return 1.0 / x;",Tae=dt({opSnippet:Sae}),Nae={kernelName:xu,backendName:"webgl",kernelFunc:Tae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Aae=eo+`
  return (x < 0.0) ? 0.0 : x;
`,Rae=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Dae=dt({opSnippet:Aae,packedOpSnippet:Rae}),Oae={kernelName:yu,backendName:"webgl",kernelFunc:Dae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fae=eo+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,Lae=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Pae=dt({opSnippet:Fae,packedOpSnippet:Lae}),Mae={kernelName:vu,backendName:"webgl",kernelFunc:Pae};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Bae{constructor(e,n,s,o,r){this.variableNames=["A"],this.outputShape=[];const[i,a,l,c]=e;this.outputShape=[i,n,s,c];const u=[o&&n>1?a-1:a,o&&s>1?l-1:l],h=[o&&n>1?n-1:n,o&&s>1?s-1:s];let d;r?d="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":d="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${u[0]/h[0]},
          ${u[1]/h[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${d};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Vae{constructor(e,n,s,o,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[i,a,l,c]=e;this.outputShape=[i,n,s,c];const u=[o&&n>1?a-1:a,o&&s>1?l-1:l],h=[o&&n>1?n-1:n,o&&s>1?s-1:s];let d;r?d="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":d="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${u[0]/h[0]},
          ${u[1]/h[1]},
          ${u[1]/h[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${d};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${c-1};
        bool hasNextRow = coords.z < ${s-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zae(t){const{inputs:e,backend:n,attrs:s}=t,{images:o}=e,{alignCorners:r,halfPixelCenters:i,size:a}=s,[l,c]=a,u=se().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Vae(o.shape,l,c,r,i):new Bae(o.shape,l,c,r,i);return n.runWebGLProgram(u,[o],"float32")}const Wae={kernelName:ep,backendName:"webgl",kernelFunc:zae};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Uae{constructor(e,n,s){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,o,r]=n,[,i,a]=e,l=[s&&i>1?o-1:o,s&&a>1?r-1:r],c=[s&&i>1?i-1:i,s&&a>1?a-1:a],u=l[0]/c[0],h=l[1]/c[1],d=1/u,f=1/h,p=Math.ceil(d)*2+2,g=Math.ceil(f)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${u});
        const float widthScale = float(${h});

        const float invHeightScale = float(${d});
        const float invWidthScale = float(${f});

        const int winHeight = int(${p});
        const int winWidth = int(${g});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${i}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${o-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${r-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hae(t){const{inputs:e,backend:n,attrs:s}=t,{images:o,dy:r}=e,{alignCorners:i}=s,a=new Uae(r.shape,o.shape,i);return n.runWebGLProgram(a,[r],r.dtype)}const Gae={kernelName:Ex,backendName:"webgl",kernelFunc:Hae};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jae{constructor(e,n,s,o,r){this.variableNames=["A"],this.outputShape=[];const[i,a,l,c]=e;this.outputShape=[i,n,s,c];const u=[o&&n>1?a-1:a,o&&s>1?l-1:l],h=[o&&n>1?n-1:n,o&&s>1?s-1:s],d=o?"0.5":"0.0";let f;r?f="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":f="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${u[0]/h[0]},
          ${u[1]/h[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${f};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${d})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qae{constructor(e,n,s,o,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[i,a,l,c]=e;this.outputShape=[i,n,s,c];const u=[o&&n>1?a-1:a,o&&s>1?l-1:l],h=[o&&n>1?n-1:n,o&&s>1?s-1:s],d=o?"0.5":"0.0";let f;r?f="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":f="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${u[0]/h[0]},
          ${u[1]/h[1]},
          ${u[1]/h[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${f};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${d})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${c-1};
        bool hasNextRow = coords.z < ${s-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kae(t){const{inputs:e,backend:n,attrs:s}=t,{images:o}=e,{alignCorners:r,halfPixelCenters:i,size:a}=s,[l,c]=a,u=se().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new qae(o.shape,l,c,r,i):new jae(o.shape,l,c,r,i);return n.runWebGLProgram(u,[o],o.dtype)}const Xae={kernelName:Jf,backendName:"webgl",kernelFunc:Kae};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Yae{constructor(e,n,s){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,o,r]=n,[,i,a]=e,l=[s&&i>1?o-1:o,s&&a>1?r-1:r],c=[s&&i>1?i-1:i,s&&a>1?a-1:a],u=l[0]/c[0],h=l[1]/c[1],d=1/u,f=1/h,p=Math.ceil(d)*2+2,g=Math.ceil(f)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${u});
        const float widthScale = float(${h});

        const float invHeightScale = float(${d});
        const float invWidthScale = float(${f});

        const int winHeight = int(${p});
        const int winWidth = int(${g});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${i}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float sourceFracRow =
              float(${l[0]}) *
                (float(dyR) / float(${c[0]}));

            float sourceFracCol =
                float(${l[1]}) *
                  (float(dyC) / float(${c[1]}));

            int sourceNearestRow = int(min(
                float(int(${o}) - 1),
                ${s} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${r}) - 1),
                ${s} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zae(t){const{inputs:e,backend:n,attrs:s}=t,{images:o,dy:r}=e,{alignCorners:i}=s,a=new Yae(r.shape,o.shape,i);return n.runWebGLProgram(a,[r],r.dtype)}const Qae={kernelName:kx,backendName:"webgl",kernelFunc:Zae};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jae{constructor(e,n){this.variableNames=["x"];const s=e.length;if(s>4)throw new Error(`WebGL backend: Reverse of rank-${s} tensor is not yet supported`);if(this.outputShape=e,s===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${e[0]} - coord - 1));
        }
      `;return}const o=a=>n.indexOf(a)!==-1&&e[a]!==1?`${e[a]} - coords[${a}] - 1`:`coords[${a}]`,r=e.map((a,l)=>o(l)).join(","),i=It(s);this.userCode=`
      void main() {
        ${i} coords = getOutputCoords();
        setOutput(getX(${r}));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ele{constructor(e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const s=e.length;if(s>4)throw new Error(`WebGL backend: Reverse of rank-${s} tensor is not yet supported`);this.outputShape=e;const o=zn("rc",s),r=`${o[s-1]} + 1 < ${this.outputShape[s-1]}`,i=`${o[s-2]} + 1 < ${this.outputShape[s-2]}`,a=It(s);s===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${e[0]} - rc - 1),
            ${e[0]} - rc - 1);
          if(${r}){
              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),
                ${e[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${a} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${l(o.slice())};
          if(${r}){
            result.g = ${c(o.slice())};
          }
          if(${i}) {
            result.b = ${u(o.slice())};
            if(${r}) {
              result.a = ${h(o.slice())};
            }
          }
          setOutput(result);
        }
    `;function l(p){return d(p)}function c(p){return p[s-1]="("+p[s-1]+" + 1)",d(p)}function u(p){return p[s-2]="("+p[s-2]+" + 1)",d(p)}function h(p){return p[s-1]="("+p[s-1]+" + 1)",p[s-2]="("+p[s-2]+" + 1)",d(p)}function d(p){const g=e.map((y,w)=>f(w,p)),b=g.join(","),x=g.slice(-2).join(",");return`getChannel(getX(${b}), vec2(${x}))`}function f(p,g){return n.indexOf(p)!==-1&&e[p]!==1?`${e[p]} - ${g[p]} - 1`:`${g[p]}`}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tle(t){const{inputs:e,backend:n,attrs:s}=t,{x:o}=e,{dims:r}=s,i=o.shape.length,a=st(r,o.shape);if(i===0)return ms({inputs:{x:o},backend:n});const l=se().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new ele(o.shape,a):new Jae(o.shape,a);return n.runWebGLProgram(l,[o],o.dtype)}const nle={kernelName:tp,backendName:"webgl",kernelFunc:tle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sle{constructor(e,n){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const s=e[1],o=e[2];this.outputShape=e;let r="";typeof n=="number"?r=`float outputValue = ${n.toFixed(2)};`:r=`
        vec3 fill = vec3(${n.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${r}
          if(coordX >= 0 && coordX < ${o} && coordY >= 0 && coordY < ${s}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ole={kernelName:Vx,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:s}=t,{radians:o,fillValue:r,center:i}=e,a=n,l=new sle(s.shape,r),[c,u]=Ly(i,s.shape[1],s.shape[2]),h=[[c,u,Math.sin(o),Math.cos(o)]];return a.runWebGLProgram(l,[s],s.dtype,h)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rle=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,ile=dt({opSnippet:rle}),ale={kernelName:wu,backendName:"webgl",kernelFunc:ile};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lle="return inversesqrt(x);",cle=dt({opSnippet:lle,cpuKernelImpl:Aee}),ule={kernelName:Cu,backendName:"webgl",kernelFunc:cle};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class o2{constructor(e,n,s,o,r,i,a=!0){this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;const l=It(r.length),c=It(i.length);let u="";s===1?u="i":s===2&&(u="i, j");const h=`getIndices(${u})`;let d="";o===1?d="i":o===2&&(d="i, coords[1]");const f=`getUpdates(${d})`,p=n>1?"strides[j]":"strides";this.userCode=`
        ${l} strides = ${l}(${r});

        void main() {
          ${c} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${e}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${n}; j++) {
              int index = round(${h});
              flattenedIndex += index * ${p};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${f};
              found = true;
            }
          }
          setOutput(mix(getDefaultValue(), sum, float(found)));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hle(t){const{inputs:e,backend:n,attrs:s}=t,{indices:o,updates:r}=e,{shape:i}=s,{sliceRank:a,numUpdates:l,sliceSize:c,strides:u,outputSize:h}=Lu(r,o,i),d=[h/c,c];if(h===0)return n.makeTensorInfo(i,o.dtype);const f=Te({inputs:{x:o},backend:n,attrs:{shape:[l,a]}}),p=Te({inputs:{x:r},backend:n,attrs:{shape:[l,c]}}),g=n.makeTensorInfo([],"float32",new Float32Array([0])),b=new o2(l,a,f.shape.length,p.shape.length,u,d),x=n.runWebGLProgram(b,[p,f,g],p.dtype),y=Te({inputs:{x},backend:n,attrs:{shape:i}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(g),y}const dle={kernelName:s_,backendName:"webgl",kernelFunc:hle};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fle{constructor(e,n,s,o){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,s];const r="while (left < right) {",i=`for (int i = 0; i < ${Math.ceil(Math.log2(n+1))}; ++i) { if (left >= right) break;`,a=se().getNumber("WEBGL_VERSION")===2?r:i,l=o==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${a}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${l} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ple(t){const{inputs:e,backend:n,attrs:s}=t,{sortedSequence:o,values:r}=e,{side:i}=s,a=new fle(o.shape[0],o.shape[1],r.shape[1],i),l=[[o.shape[1]]];return n.runWebGLProgram(a,[o,r],"int32",l)}const mle={kernelName:o_,backendName:"webgl",kernelFunc:ple};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gle{constructor(e,n,s){this.variableNames=["c","a","b"],this.outputShape=n;let o,r;if(s>4)throw Error(`Where for rank ${s} is not yet supported`);if(s===1)r="resRC",o="resRC";else{const a=["resRC.x","resRC.y","resRC.z","resRC.w"],l=[],c=[];for(let u=0;u<n.length;u++)c.push(`${a[u]}`),u<e&&l.push(`${a[u]}`);o=l.join(),r=c.join()}const i=It(s);this.userCode=`
      void main() {
        ${i} resRC = getOutputCoords();
        float cVal = getC(${o});
        if (cVal >= 1.0) {
          setOutput(getA(${r}));
        } else {
          setOutput(getB(${r}));
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ble(t){const{inputs:e,backend:n}=t,{condition:s,t:o,e:r}=e,i=new gle(s.shape.length,o.shape,o.shape.length);return n.runWebGLProgram(i,[s,o,r],ds(o.dtype,r.dtype))}const xle={kernelName:np,backendName:"webgl",kernelFunc:ble};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yle=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${_p};
  float scale = ${kp};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,vle=dt({opSnippet:yle}),wle={kernelName:$u,backendName:"webgl",kernelFunc:vle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cle=Ll+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,$le=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Ile=dt({opSnippet:Cle,packedOpSnippet:$le,cpuKernelImpl:Dee}),_le={kernelName:Eu,backendName:"webgl",kernelFunc:Ile};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kle=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,Ele=dt({opSnippet:kle}),Sle={kernelName:ku,backendName:"webgl",kernelFunc:Ele};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tle=Ll+`
  return sin(x);
`,Nle=dt({opSnippet:Tle}),Ale={kernelName:Iu,backendName:"webgl",kernelFunc:Nle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rle=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,Dle=dt({opSnippet:Rle}),Ole={kernelName:_u,backendName:"webgl",kernelFunc:Dle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fle=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,Lle=dt({opSnippet:Fle}),Ple={kernelName:Su,backendName:"webgl",kernelFunc:Lle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mle=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:o}=e,{blockShape:r,paddings:i}=s;T(o.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const a=r.reduce((x,y)=>x*y),l=[[0,0]];l.push(...i);for(let x=1+r.length;x<o.shape.length;++x)l.push([0,0]);const c=[],u=n2({inputs:{x:o},backend:n,attrs:{paddings:l,constantValue:0}}),h=zu(u.shape,r,a,!1),d=Wu(h.length,r.length,!1),f=Uu(u.shape,r,a,!1),p=Te({inputs:{x:u},backend:n,attrs:{shape:h}}),g=Un({inputs:{x:p},backend:n,attrs:{perm:d}}),b=Te({inputs:{x:g},backend:n,attrs:{shape:f}});return c.push(u),c.push(p),c.push(g),c.forEach(x=>n.disposeIntermediateTensorInfo(x)),b},Ble={kernelName:rp,backendName:"webgl",kernelFunc:Mle};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vle(t){const{inputs:e,backend:n}=t,{indices:s,values:o,denseShape:r,defaultValue:i}=e;if(r.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${r.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${s.shape}`);if(o.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${o.shape}`);if(i.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${i.shape}`);const a=n.readSync(s.dataId),l=n.readSync(o.dataId),c=n.readSync(r.dataId),u=n.readSync(i.dataId)[0],[h,d,f,p,g]=Fee(a,s.shape,s.dtype,l,o.dtype,c,u);return[n.makeTensorInfo(d,s.dtype,h),n.makeTensorInfo([d[0]],o.dtype,f),n.makeTensorInfo([p.length],"bool",new Uint8Array(p.map(b=>Number(b)))),n.makeTensorInfo([g.length],s.dtype,new Int32Array(g))]}const zle={kernelName:Sx,backendName:"webgl",kernelFunc:Vle};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wle(t){const{inputs:e,backend:n}=t,{inputIndices:s,inputShape:o,newShape:r}=e;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${s.shape}`);if(o.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${o.shape}`);if(r.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${r.shape}`);const i=Array.from(n.readSync(o.dataId)),a=n.readSync(s.dataId),l=Array.from(n.readSync(r.dataId)),[c,u,h]=Lee(a,s.shape,s.dtype,i,l);return[n.makeTensorInfo(u,s.dtype,c),n.makeTensorInfo([h.length],r.dtype,new Int32Array(h))]}const Ule={kernelName:Tx,backendName:"webgl",kernelFunc:Wle};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hle(t){const{inputs:e,backend:n}=t,{data:s,indices:o,segmentIds:r}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(o.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${o.shape}`);if(r.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${r.shape}`);const i=n.readSync(s.dataId),a=n.readSync(o.dataId),l=n.readSync(r.dataId),[c,u]=kN(i,s.shape,s.dtype,a,l,!0);return n.makeTensorInfo(u,s.dtype,c)}const Gle={kernelName:Nx,backendName:"webgl",kernelFunc:Hle};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jle(t){const{inputs:e,backend:n}=t,{data:s,indices:o,segmentIds:r}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(o.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${o.shape}`);if(r.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${r.shape}`);const i=n.readSync(s.dataId),a=n.readSync(o.dataId),l=n.readSync(r.dataId),[c,u]=kN(i,s.shape,s.dtype,a,l);return n.makeTensorInfo(u,s.dtype,c)}const qle={kernelName:Ax,backendName:"webgl",kernelFunc:jle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kle(t){const{inputs:e,backend:n,attrs:s}=t,{sparseIndices:o,sparseValues:r,defaultValue:i}=e,{outputShape:a}=s,{sliceRank:l,numUpdates:c,sliceSize:u,strides:h,outputSize:d}=Lu(r,o,a),f=!1;if(r.dtype==="string"){const x=n.bufferSync(o),y=n.bufferSync(r),w=Mr(n.readSync(i.dataId)[0]),v=Ree(x,y,a,d,u,c,l,h,w,f);return n.makeTensorInfo(a,v.dtype,v.values)}const p=new o2(c,l,o.shape.length,r.shape.length,h,[d,1],f),g=n.runWebGLProgram(p,[r,o,i],r.dtype),b=Te({inputs:{x:g},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(g),b}const Xle={kernelName:r_,backendName:"webgl",kernelFunc:Kle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yle(t){const{inputs:e,backend:n,attrs:s}=t,{x:o}=e,{numOrSizeSplits:r,axis:i}=s,a=st(i,o.shape)[0],l=Zy(o,r,a),c=o.shape.length,u=new Array(c).fill(0),h=o.shape.slice();return l.map(d=>{const f=[...h];f[a]=d;const p=Pl({inputs:{x:o},backend:n,attrs:{begin:u,size:f}});return u[a]+=d,p})}const Zle={kernelName:ip,backendName:"webgl",kernelFunc:Yle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZC="return sqrt(x);",Qle=dt({opSnippet:ZC,packedOpSnippet:ZC,cpuKernelImpl:Pee}),Jle={kernelName:Tu,backendName:"webgl",kernelFunc:Qle};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ece="return x * x;",tce=dt({opSnippet:ece}),nce={kernelName:Rx,backendName:"webgl",kernelFunc:tce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QC="return (a - b) * (a - b);",sce=kn({opSnippet:QC,packedOpSnippet:QC}),oce={kernelName:Nu,backendName:"webgl",kernelFunc:sce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rce({inputs:t,attrs:e,backend:n}){const{x:s}=t,o=eo+`
    return x > 0.0 ? 1.0 : float(${e.alpha});
  `,r=new sr(s.shape,o);return n.runWebGLProgram(r,[s],s.dtype)}const ice={kernelName:Fu,backendName:"webgl",kernelFunc:rce};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ace{constructor(e,n,s){this.variableNames=["x"],this.outputShape=s;const o=s.length,r=It(s.length),i=It(s.length);let a="";if(o===1)a="coords * strides + begin";else{let l=0;a=s.map((c,u)=>(l++,s.length===1?`coords * strides[${u}] + begin[${u}]`:`coords[${l-1}] * strides[${u}] + begin[${u}]`)).join(",")}this.userCode=`
      ${r} begin = ${r}(${e});
      ${r} strides = ${r}(${n});

      void main() {
        ${i} coords = getOutputCoords();
        setOutput(getX(${a}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lce(t){const{inputs:e,backend:n,attrs:s}=t,{x:o}=e,{begin:r,end:i,strides:a,beginMask:l,endMask:c,ellipsisMask:u,newAxisMask:h,shrinkAxisMask:d}=s,{finalShapeSparse:f,finalShape:p,isIdentity:g,sliceDim0:b,isSimpleSlice:x,begin:y,end:w,strides:v}=Zx(o.shape,r,i,a,l,c,u,h,d);let $;if(g)$=Te({inputs:{x:o},backend:n,attrs:{shape:p}});else if(b||x){T(o.shape.length>=1,()=>`Input must have rank at least 1, got: ${o.shape.length}`);const E=Kx(y,w,v),k=Pl({inputs:{x:o},backend:n,attrs:{begin:y,size:E}});$=Te({inputs:{x:k},backend:n,attrs:{shape:p}}),n.disposeIntermediateTensorInfo(k)}else if(n.shouldExecuteOnCPU([o])){const k=n.readSync(o.dataId),N=nt(o.shape,o.dtype,k),A=Mee(f,N,v,y);$=n.makeTensorInfo(p,o.dtype,A.values)}else{const k=new ace(y,v,f);$=n.runWebGLProgram(k,[o],o.dtype)}const _=Te({inputs:{x:$},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo($),_}const cce={kernelName:Dx,backendName:"webgl",kernelFunc:lce};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uce(t){const{inputs:e,backend:n,attrs:s}=t,{separator:o,nGramWidths:r,leftPad:i,rightPad:a,padWidth:l,preserveShortSequences:c}=s,{data:u,dataSplits:h}=e,d=n.readSync(u.dataId),f=n.readSync(h.dataId),[p,g]=Bee(d,f,o,r,i,a,l,c);return[n.makeTensorInfo([p.length],"string",p),n.makeTensorInfo(h.shape,"int32",g)]}const hce={kernelName:Ox,backendName:"webgl",kernelFunc:uce};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dce(t){const{inputs:e,backend:n,attrs:s}=t,{skipEmpty:o}=s,{input:r,delimiter:i}=e;if(r.dtype!=="string")throw new Error("Input must be of datatype string");if(r.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${r.shape}`);if(i.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${i.shape}`);const a=n.readSync(r.dataId),l=n.readSync(i.dataId)[0],[c,u,h]=Vee(a,l,o),d=u.length;return[n.makeTensorInfo([d,2],"int32",c),n.makeTensorInfo([d],"string",u),n.makeTensorInfo([2],"int32",new Int32Array(h))]}const fce={kernelName:Fx,backendName:"webgl",kernelFunc:dce};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pce(t){const{inputs:e,backend:n,attrs:s}=t,{numBuckets:o}=s,{input:r}=e;if(r.dtype!=="string")throw new Error("Input must be of datatype string");if(o<=0)throw new Error("Number of buckets must be at least 1");const i=n.readSync(r.dataId),a=zee(i,o);return n.makeTensorInfo(r.shape,"int32",a)}const mce={kernelName:Lx,backendName:"webgl",kernelFunc:pce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gce="return tan(x);",bce=dt({opSnippet:gce}),xce={kernelName:Ru,backendName:"webgl",kernelFunc:bce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yce=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,vce=dt({opSnippet:yce}),wce={kernelName:Du,backendName:"webgl",kernelFunc:vce};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Cce{constructor(e,n){this.variableNames=["A"];const s=new Array(e.length);for(let i=0;i<s.length;i++)s[i]=e[i]*n[i];this.outputShape=s,this.rank=s.length;const o=It(this.rank),r=$ce(e);this.userCode=`
      void main() {
        ${o} resRC = getOutputCoords();
        setOutput(getA(${r}));
      }
    `}}function $ce(t){const e=t.length;if(e>5)throw Error(`Tile for rank ${e} is not yet supported`);if(e===1)return`imod(resRC, ${t[0]})`;const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],s=[];for(let o=0;o<t.length;o++)s.push(`imod(${n[o]}, ${t[o]})`);return s.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r2(t){const{inputs:e,backend:n,attrs:s}=t,{x:o}=e,{reps:r}=s;if(o.dtype==="string"||o.shape.length>5){const l=n.readSync(o.dataId),c=o.dtype==="string"?l.map(d=>Mr(d)):l,u=nt(o.shape,o.dtype,c),h=Uee(u,r);return n.makeTensorInfo(h.shape,h.dtype,h.values)}const i=new Cce(o.shape,r);return n.runWebGLProgram(i,[o],o.dtype)}const Ice={kernelName:Ou,backendName:"webgl",kernelFunc:r2};class _ce{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class kce{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wi(t,e){e!==null&&t.disposeIntermediateTensorInfo(e)}function JC(t){let e=1;for(;e<t;)e*=2;return e}function Ece(t){const{inputs:e,backend:n,attrs:s}=t,{x:o}=e,{k:r,sorted:i}=s,a=se().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=se().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),c=o.shape,u=c[c.length-1];if(n.shouldExecuteOnCPU([o])||u<a||r>l){const A=n.readSync(o.dataId),[F,L]=Hee(A,c,o.dtype,r,i);return[n.makeTensorInfo(F.shape,F.dtype,F.values),n.makeTensorInfo(L.shape,L.dtype,L.values)]}if(r===0)return c[c.length-1]=0,[n.makeTensorInfo(c,o.dtype,[]),n.makeTensorInfo(c,"int32",[])];if(u===1)return[o,oh({attrs:{shape:c,dtype:"int32",value:0},backend:n})];const h=n.texData.get(o.dataId),d=h!==null&&h.isPacked,f=d?n.unpackTensor(o):o,g=ae(c)/u,b=Te({inputs:{x:f},attrs:{shape:[g,u]},backend:n});d&&wi(n,f);const x=JC(r),y=JC(u);let w=null;const v=()=>w===null?[b,b]:[b,w],$=(A,F,L)=>{const H=v(),M=new _ce(L),q=[[u],[w===null?1:0],[Number.NEGATIVE_INFINITY],[A],[F]],Q=w;w=n.runWebGLProgram(M,H,"int32",q),wi(n,Q)};for(let A=1;A<x;A*=2){const F=A*2;for(let L=A;L>=1;L/=2)$(F,L,[g,y])}for(let A=y;A>x;A/=2){const F=v(),L=new kce([g,A/2]),M=[[u],[w===null?1:0],[x]],K=w;w=n.runWebGLProgram(L,F,"int32",M),wi(n,K);const q=x/2,Q=q*2;for(let Y=q;Y>=1;Y/=2)$(Q,Y,w.shape)}let _=w;w=Pl({inputs:{x:w},backend:n,attrs:{begin:0,size:[g,r]}}),wi(n,_);let E=YN({inputs:{x:b,indices:w},backend:n,attrs:{axis:1,batchDims:1}});wi(n,b);const k=c.slice(0,-1);k.push(r),_=w,w=Te({inputs:{x:w},attrs:{shape:k},backend:n}),wi(n,_);const N=E;return E=Te({inputs:{x:E},attrs:{shape:k},backend:n}),wi(n,N),[E,w]}const Sce={kernelName:Px,backendName:"webgl",kernelFunc:Ece};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Tce{constructor(e,n,s,o,r,i){this.variableNames=["Image","Transforms"],this.outputShape=i;const a=s==="nearest"?1:2;let l;switch(o){case"constant":l=1;break;case"reflect":l=2;break;case"wrap":l=3;break;case"nearest":l=4;break;default:l=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${l} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${n}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${r});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${r});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${n}));
                float mapY = mapCoord(inY, float(${e}));

                if (${a} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nce(t){const{inputs:e,backend:n,attrs:s}=t,{image:o,transforms:r}=e,{interpolation:i,fillMode:a,fillValue:l,outputShape:c}=s,[u,h,d,f]=o.shape,[p,g]=c!=null?c:[h,d],b=[u,p,g,f],x=new Tce(h,d,i,a,l,b);return n.runWebGLProgram(x,[o,r],"float32")}const Ace={kernelName:Mx,backendName:"webgl",kernelFunc:Nce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rce(t){const{inputs:e,attrs:n,backend:s}=t,{axis:o}=n,{x:r}=e;eh(r,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const i=s.readSync(r.dataId),{outputValues:a,outputShape:l,indices:c}=Gee(i,o,r.shape,r.dtype);return[s.makeTensorInfo(l,r.dtype,a),s.makeTensorInfo([c.length],"int32",c)]}const Dce={kernelName:Bx,backendName:"webgl",kernelFunc:Rce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oce(t){const{inputs:e,backend:n,attrs:s}=t,{value:o}=e;let{axis:r}=s;r<0&&(r+=o.shape.length);const i=o,a=i.shape.length,l=o.shape[r],c=new Array(a-1);let u=0;for(let g=0;g<a;g++)g!==r&&(c[u++]=i.shape[g]);const h=[],d=new Array(a).fill(0),f=i.shape.slice();f[r]=1;const p=new Array(l);for(let g=0;g<p.length;g++){d[r]=g;const b=Pl({inputs:{x:i},backend:n,attrs:{begin:d,size:f}}),x=Te({inputs:{x:b},backend:n,attrs:{shape:c}});p[g]=x,h.push(b)}return h.forEach(g=>n.disposeIntermediateTensorInfo(g)),p}const Fce={kernelName:lp,backendName:"webgl",kernelFunc:Oce};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Lce{constructor(e,n){this.variableNames=["x","segmentIds"];const s=e.windowSize,o=e.batchSize,r=e.inSize,i=e.numSegments,a=i*Math.ceil(r/s);this.outputShape=[o,a];const l="0.0",c="sumValue",u=Math.floor(s/4)*4,h=s%4,d=`
        sumValue += dot(values, segFilter);
    `;let f="";r%s>0&&(f=`
        if (inIdx < 0 || inIdx >= ${r}) {
          return initializationValue;
        }
      `);let p="";r%s>0&&(p=`
        if (inIdx < 0 || inIdx >= ${r}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${l};

      float getValue(int batch, int inIdx) {
        ${f}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${p}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${i})) * float(${s}));
        int currentSeg = int(mod(float(outIdx), float(${i})));

        float sumValue = 0.0;

        for (int i = 0; i < ${u}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${d}
        }

        int inIdx = inOffset + ${u};
        if (${h===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${d}
        } else if (${h===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${d}
        } else if (${h===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${d}
        }
        setOutput(${c});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pce(t){const{inputs:e,backend:n,attrs:s}=t,{x:o,segmentIds:r}=e,{numSegments:i}=s,a=o.shape.length,l=[];let c=0;const u=jt([c],a);let h=o;u!=null&&(h=Un({inputs:{x:o},backend:n,attrs:{perm:u}}),l.push(h),c=Zt(1,a)[0]);const d=Qk(h.shape,c,i),f=ae([h.shape[c]]),p=Te({inputs:{x:h},backend:n,attrs:{shape:[-1,f]}});l.push(p);const g=Wx(o.dtype),b=(v,$,_,E,k)=>{const N=v.shape[0],A=v.shape[1],F=Zk(A,k),L={windowSize:F,inSize:A,batchSize:N,numSegments:k},H=new Lce(L,$),M=n.compileAndRun(H,[v,_],E);if(l.push(M),M.shape[1]===k)return M;const K=s2({backend:n,attrs:{start:0,stop:k,step:1,dtype:"float32"}}),q=r2({inputs:{x:K},backend:n,attrs:{reps:[A/F]}});return l.push(K),l.push(q),b(M,$,q,E,k)},x=b(p,"unsortedSegmentSum",r,g,i),y=Te({inputs:{x},backend:n,attrs:{shape:d}});let w=y;if(u!=null){l.push(y);const v=Xr(u);w=Un({inputs:{x:w},backend:n,attrs:{perm:v}})}return l.forEach(v=>n.disposeIntermediateTensorInfo(v)),w}const Mce={kernelName:cp,backendName:"webgl",kernelFunc:Pce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bce=[Mte,Vte,Ute,jte,Kte,Zte,Jte,tne,rne,ane,une,fne,gne,vne,$ne,_ne,Ene,Ane,Dne,Fne,Bne,jne,Kne,Yne,nse,ose,lse,yte,hse,gse,vse,kse,Sse,Nse,Rse,Ose,Pse,Vse,Use,Gse,qse,Xse,Qse,eoe,ooe,ioe,coe,doe,poe,xoe,Coe,koe,Toe,Roe,Doe,Foe,Poe,Boe,zoe,Uoe,qoe,Yoe,Joe,tre,ore,are,hre,mre,xte,bre,pse,vre,$re,kre,wte,Nre,Ore,Lre,Vre,Ure,qre,Yre,eie,oie,aie,cie,fie,mie,bie,wie,$ie,_ie,Eie,Tie,Die,Pie,zie,Xie,kte,Jie,nae,rae,lae,Qne,hae,fae,mae,xae,Cae,$te,Iae,kae,Eae,Jne,Gie,Nae,Oae,Mae,Ste,Wae,Gae,Xae,Qae,nle,ole,ale,ule,dle,mle,xle,wle,_le,Sle,Ale,Ole,Hne,qie,Ple,Ble,zle,Ule,Gle,qle,Xle,Zle,Jle,nce,oce,ice,cce,hce,fce,mce,jie,Fte,xce,wce,Ice,Sce,Ace,Lte,Dce,Fce,Mce,dae];for(const t of Bce)a_(t);/** @license See the LICENSE file. *//**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vce={name:"VResultTips",props:{formData:{type:Object,required:!0}}},ha=t=>(D$("data-v-1328b4a6"),t=t(),O$(),t),zce={class:"table"},Wce={key:0},Uce={class:"row"},Hce=ha(()=>te("div",{class:"col"},[te("span",{class:"mdi mdi-smoking-off text-primary icon"})],-1)),Gce={class:"col-11"},jce={key:0},qce={class:"row"},Kce=ha(()=>te("div",{class:"col"},[te("span",{class:"mdi mdi-water-alert text-primary icon"})],-1)),Xce={class:"col-11"},Yce={key:1},Zce={class:"row"},Qce=ha(()=>te("div",{class:"col"},[te("span",{class:"mdi mdi-account-alert text-primary icon"})],-1)),Jce={class:"col-11"},eue={key:2},tue={class:"row"},nue=ha(()=>te("div",{class:"col"},[te("span",{class:"mdi mdi-fruit-pear text-primary icon"})],-1)),sue={class:"col-11"},oue={key:3},rue={class:"row"},iue=ha(()=>te("div",{class:"col"},[te("span",{class:"mdi mdi-carrot text-primary icon"})],-1)),aue={class:"col-11"},lue={key:4},cue={class:"row"},uue=ha(()=>te("div",{class:"col"},[te("span",{class:"mdi mdi-basketball text-primary icon"})],-1)),hue={class:"col-11"},due={key:5},fue={class:"row"},pue=ha(()=>te("div",{class:"col"},[te("span",{class:"mdi mdi-brain text-primary icon"})],-1)),mue={class:"col-11"};function gue(t,e,n,s,o,r){const i=IB;return pt(),Vt("table",zce,[te("tbody",null,[te("tr",null,[n.formData.healthData.smoker==="1"?(pt(),Vt("td",Wce,[te("div",Uce,[Hce,te("div",Gce,[He(i,{title:"Stop smoking",content:`Smoking is the leading cause of lung
            cancer and other cancers, heart disease, stroke, and chronic
            obstructive pulmonary disease (COPD). Smoking also increases the
            risk of developing other serious health problems, such as diabetes,
            osteoporosis, and rheumatoid arthritis. Get help to quit smoking
          <strong
          ><a
            href="https://www.cdc.gov/tobacco/campaign/tips/quit-smoking/index.html"
            target="_blank"
            style="text-decoration: none"
          >here</a>
          </strong>`})])])])):Jo("",!0)]),n.formData.healthData.highBP==="1"?(pt(),Vt("tr",jce,[te("td",null,[te("div",qce,[Kce,te("div",Xce,[He(i,{title:"Watch your blood pressure",content:`High blood pressure is
            a major risk factor for heart disease and stroke. High blood
            pressure can be controlled with lifestyle changes and, if necessary,
            medications.`})])])])])):Jo("",!0),n.formData.healthData.highChol==="1"?(pt(),Vt("tr",Yce,[te("td",null,[te("div",Zce,[Qce,te("div",Jce,[He(i,{title:"Watch your cholesterol",content:"High cholesterol is a major risk factor for heart disease. High cholesterol can be controlled with lifestyle changes and, if necessary, medications."})])])])])):Jo("",!0),n.formData.healthData.fruits==="0"?(pt(),Vt("tr",eue,[te("td",null,[te("div",tue,[nue,te("div",sue,[He(i,{title:"Eat more fruits",content:`Fruits are an important part of
            a healthy diet. They are high in fiber, vitamins, and minerals.
            Fruits also contain phytochemicals that may help protect against
            heart diseases and other diseases.`})])])])])):Jo("",!0),n.formData.healthData.veggies==="0"?(pt(),Vt("tr",oue,[te("td",null,[te("div",rue,[iue,te("div",aue,[He(i,{title:"Eat more vegetables",content:"Vegetables are an important part of a healthy diet. They are high in fiber, vitamins, and minerals. Vegetables also contain phytochemicals that may help protect against heart diseases and other diseases."})])])])])):Jo("",!0),n.formData.healthData.physActivity==="0"?(pt(),Vt("tr",lue,[te("td",null,[te("div",cue,[uue,te("div",hue,[He(i,{title:"Be more physically active",content:"Physical activity is an important part of a healthy lifestyle. It can help you maintain a healthy weight, reduce your risk of heart disease and stroke, and lower your blood pressure and cholesterol levels."})])])])])):Jo("",!0),n.formData.healthData.mentHlth<10?(pt(),Vt("tr",due,[te("td",null,[te("div",fue,[pue,te("div",mue,[He(i,{title:"Watch your mental health",content:"Mental health is an important part of a healthy lifestyle. It can help you maintain a healthy weight, reduce your risk of heart disease and stroke, and lower your blood pressure and cholesterol levels."})])])])])):Jo("",!0)])])}const bue=rs(Vce,[["render",gue],["__scopeId","data-v-1328b4a6"]]),xue=_t({name:"VCheckResult",components:{VResultTips:bue},props:{formData:{type:Object,required:!0}},data(){return{prediction:0,i_formData:JSON.parse(JSON.stringify(this.formData))}},computed:{predictedValue(){return this.prediction<.15?"low":this.prediction<.3?"medium":"high"},parsedPredictedValue(){return`${(this.prediction*100).toFixed(2)}%`},isLoading(){return!!this.prediction}},mounted:async function(){const t=await UX("https://fit2getherapi.azurewebsites.net/model");this.prepareData();const e=t.predict(gc(this.processData(),[1,14]));this.prediction=await e.dataSync()},methods:{prepareData(){this.i_formData.generalData.age=Math.round(this.i_formData.generalData.age/5)},processData(){return this.prepareData(),[this.i_formData.healthData.highBP,this.i_formData.healthData.highChol,this.i_formData.healthData.bmi,this.i_formData.healthData.smoker,this.i_formData.healthData.stroke,this.i_formData.healthData.physActivity,this.i_formData.healthData.fruits,this.i_formData.healthData.veggies,this.i_formData.healthData.genHlth,this.i_formData.healthData.mentHlth,this.i_formData.healthData.physHlth,this.i_formData.healthData.diffWalk,this.i_formData.generalData.sex,this.i_formData.generalData.age].map(Number)},parseFloat(t,e){return t=t.toString(),t=t.slice(0,t.indexOf(".")+e+1),Number(t)}}}),yue=te("h1",{class:"fs-title"},"Results",-1),vue={key:0},wue=te("div",{class:"spinner-grow bg-primary",style:{width:"3rem",height:"3rem"},role:"status"},[te("span",{class:"visually-hidden"},"Loading...")],-1),Cue=te("p",{class:"text-center"},"Calculating results...",-1),$ue=[wue,Cue],Iue={key:1},_ue=te("p",{class:"h5"},"Your results are in!",-1),kue={class:"h6"},Eue=At(" Hello "),Sue=At(", "),Tue=At(" Your risk of having a heart attack in the next 10 years is "),Nue=At(". This is based on your answers to the questions in the previous steps. If you have any questions, please contact your doctor. Read more about how we calculate the risk "),Aue=At("here"),Rue=At(". And if you are interested in the privacy policy, you can read it "),Due=At("here"),Oue=At(". "),Fue={class:"text-muted"},Lue=te("hr",null,null,-1),Pue=te("p",{class:"h4"},"Tips",-1);function Mue(t,e,n,s,o,r){const i=OI,a=js("v-result-tips");return pt(),Vt("fieldset",null,[yue,t.isLoading?(pt(),Vt("div",Iue,[_ue,te("p",kue,[Eue,te("strong",null,Ro(t.formData.personalData.firstName),1),Sue]),te("p",null,[Tue,te("strong",null,Ro(t.predictedValue),1),Nue,He(i,{class:"text-decoration-none fw-bold",to:"/explain"},{default:Wi(()=>[Aue]),_:1}),Rue,He(i,{class:"text-decoration-none fw-bold",to:"/privacy"},{default:Wi(()=>[Due]),_:1}),Oue]),te("small",Fue,"*Based on our calculations you have a "+Ro(t.parsedPredictedValue)+" chance at getting cardio vascular disease.",1),Lue,Pue,He(a,{"form-data":t.i_formData},null,8,["form-data"])])):(pt(),Vt("div",vue,$ue))])}const Bue=rs(xue,[["render",Mue]]),Vue=_t({name:"VCheckGeneralInfo",components:{VRadioGroup:PI,VCheckStateHandler:uf},props:{formData:{type:Object,required:!0},nextModelValue:{type:String,default:""},previousModelValue:{type:String,default:""}},emits:["update:nextModelValue","update:previousModelValue","update:formData"],data(){return{i_formData:this.formData,nextChildModelValue:"",previousChildModelValue:""}},computed:{nextForm(){return Ft.Health},previousForm(){return Ft.Personal}},watch:{nextChildModelValue(t){this.$emit("update:nextModelValue",t)},previousChildModelValue(t){this.$emit("update:previousModelValue",t)}},methods:{updateProperty(t,e){return this.i_formData.generalData[t]=e,this.formData}}}),zue=te("h2",{class:"fs-title"},"General Data",-1),Wue=te("h3",{class:"fs-subtitle"},"General data about you",-1),Uue={class:"form-container"},Hue={class:"col-lg-5"},Gue=te("label",{for:"Age",class:"control-label col-sm label-left"},"What is your age?",-1),jue=["value"],que={class:"col-lg-5"},Kue=te("p",null,"What is your gender?",-1);function Xue(t,e,n,s,o,r){const i=js("VRadioGroup"),a=js("VCheckStateHandler");return pt(),Vt("fieldset",null,[zue,Wue,te("div",Uue,[te("div",Hue,[Gue,te("input",{id:"Age",type:"number",name:"Age",value:t.formData.generalData.age,class:"form-control",required:"",onInput:e[0]||(e[0]=l=>t.$emit("update:formData",t.updateProperty("age",l.target.value)))},null,40,jue)]),te("div",que,[Kue,He(i,{id:"Sex","v-model":t.formData.generalData.sex,options:[1,0],"options-alias":["Male","Female"],"is-required":!0,"radio-group-name":"Sex",onChange:e[1]||(e[1]=l=>t.$emit("update:formData",t.updateProperty("sex",l.target.value)))},null,8,["v-model","options"])])]),He(a,{"next-model-value":t.nextChildModelValue,"onUpdate:next-model-value":e[2]||(e[2]=l=>t.nextChildModelValue=l),"previous-model-value":t.previousChildModelValue,"onUpdate:previous-model-value":e[3]||(e[3]=l=>t.previousChildModelValue=l),"next-form":t.nextForm,"previous-form":t.previousForm},null,8,["next-model-value","previous-model-value","next-form","previous-form"])])}const Yue=rs(Vue,[["render",Xue]]),Zue=""+new URL("welcome-image.27b85f08.jpg",import.meta.url).href;const Que=_t({name:"VCheckExplanation",components:{VCheckStateHandler:uf},props:{nextModelValue:{type:String,default:""}},emits:["update:nextModelValue"],data(){return{nextChildModelValue:""}},computed:{nextForm(){return Ft.Personal}},watch:{nextChildModelValue(t){this.$emit("update:nextModelValue",t)}}}),rh=t=>(D$("data-v-5584086c"),t=t(),O$(),t),Jue=rh(()=>te("h2",{class:"text-primary"},"Welcome",-1)),ehe=rh(()=>te("img",{class:"welcome-image",src:Zue,alt:"Welcome image"},null,-1)),the={class:"text-xl",style:{"margin-top":"1rem"}},nhe=rh(()=>te("span",{class:"text-primary fw-bold"},"Welcome",-1)),she=At(" to the heart disease test. This form is designed to make a prediction based on your individual data. It is "),ohe=rh(()=>te("strong",{class:"text-primary"},"not",-1)),rhe=At(" a medical diagnosis. If you have any questions, please contact your doctor. Read more about how we calculate the risk "),ihe=At("here"),ahe=At(". And if you are interested in the privacy policy, you can read it "),lhe=At("here"),che=At(". "),uhe=rh(()=>te("p",null," The form contains 15 questions and statements regarding your personal well being and is split up in 4 sections: personal details, general information, health and finally the result. Please answer them as honestly as possible. The more accurate your answers are, the more accurate the prediction will be. The survey takes about 5 minutes. If you are ready to go, click the button below. ",-1));function hhe(t,e,n,s,o,r){const i=OI,a=js("VCheckStateHandler");return pt(),Vt("fieldset",null,[Jue,ehe,te("p",the,[nhe,she,ohe,rhe,He(i,{class:"text-decoration-none fw-bold",to:"/explain"},{default:Wi(()=>[ihe]),_:1}),ahe,He(i,{class:"text-decoration-none fw-bold",to:"/privacy"},{default:Wi(()=>[lhe]),_:1}),che]),uhe,He(a,{"next-model-value":t.nextChildModelValue,"onUpdate:next-model-value":e[0]||(e[0]=l=>t.nextChildModelValue=l),"has-previous":!1,"next-form":t.nextForm},null,8,["next-model-value","next-form"])])}const dhe=rs(Que,[["render",hhe],["__scopeId","data-v-5584086c"]]),mde=_t({name:"VCheckForm",components:{VCheckExplanation:dhe,VCheckGeneralInfo:Yue,VCheckResult:Bue,VCheckProgressBar:ez,VCheckHealthForm:OV,VCheckPersonalForm:XV},data(){return{formData:{personalData:{},healthData:{},generalData:{}},currentForm:Ft.Explanation,nextModel:"",previousModel:""}},computed:{isExplanationFormName(){return this.currentForm===Ft.Explanation},isPersonalFormName(){return Ft.Personal===this.currentForm},isHealthFormName(){return Ft.Health===this.currentForm},isGeneralFormName(){return Ft.General===this.currentForm},isResultFormName(){return Ft.Result===this.currentForm}},mounted(){this.$watch("nextModel",this.nextModelWatcher),this.$watch("previousModel",this.previousModelWatcher),this.initForm()},methods:{initForm(){this.formData={personalData:{emailAddress:"",firstName:"",lastName:""},healthData:{diffWalk:0,fruits:0,genHlth:0,highBP:0,highChol:0,mentHlth:0,physActivity:0,physHlth:0,smoker:0,stroke:0,veggies:0,bmi:0},generalData:{age:0,sex:0}}},nextModelWatcher(t){Ft.None!==t&&(this.currentForm=t)},previousModelWatcher(t){this.currentForm=t,this.nextModel=Ft.None}}}),Yh=void 0,Zh=void 0;const fhe=_t({name:"VHeart"}),phe={class:"heart"};function mhe(t,e,n,s,o,r){return pt(),Vt("div",phe)}const gde=rs(fhe,[["render",mhe],["__scopeId","data-v-bffd2d18"]]),ghe=_t({name:"VInfoBox",props:{title:{type:String,required:!0},text:{type:String,required:!0},imgSrc:{type:String,required:!0},imgAlt:{type:String,required:!0}},data(){return{isTextLimited:!1}},computed:{limitedText(){return this.isTextLimited?this.text.substring(0,125)+"...":this.text}},mounted(){this.isTextLimited=this.text.length>125},methods:{expandText(){this.isTextLimited=!1}}}),bhe={class:"card border-0 text-white mb-3 rounded-5",style:{"max-width":"20rem",margin:"1rem",padding:"1rem"}},xhe={style:{margin:"10px"}},yhe={class:"card-body text-center text-black"},vhe={class:"card-title text-primary fw-bold"},whe={class:"card-text fst-italic"},Che=["innerHTML"];function $he(t,e,n,s,o,r){return pt(),Vt("div",bhe,[te("div",xhe,[JF(t.$slots,"default")]),te("div",yhe,[te("h5",vhe,Ro(t.title),1),te("p",whe,[te("span",{innerHTML:t.limitedText},null,8,Che)]),t.isTextLimited?(pt(),Vt("button",{key:0,class:"btn btn-primary text-white",onClick:e[0]||(e[0]=(...i)=>t.expandText&&t.expandText(...i))}," Expand to read more ")):Jo("",!0)])])}const bde=rs(ghe,[["render",$he]]),Qh=void 0,Jh=void 0,e$=[{name:"about",path:"/about",file:"C:/Users/Youri/WebstormProjects/Fit2gether/src/pages/about.vue",children:[],meta:Lh,alias:(Lh==null?void 0:Lh.alias)||[],component:()=>tr(()=>import("./about.f79a825f.js"),["about.f79a825f.js","about.ec5c4c5d.css"],import.meta.url).then(t=>t.default||t)},{name:"check",path:"/check",file:"C:/Users/Youri/WebstormProjects/Fit2gether/src/pages/check.vue",children:[],meta:Yh,alias:(Yh==null?void 0:Yh.alias)||[],component:()=>tr(()=>import("./check.6cba2017.js"),[],import.meta.url).then(t=>t.default||t)},{name:"explain",path:"/explain",file:"C:/Users/Youri/WebstormProjects/Fit2gether/src/pages/explain.vue",children:[],meta:Zh,alias:(Zh==null?void 0:Zh.alias)||[],component:()=>tr(()=>import("./explain.6f6e0437.js"),["explain.6f6e0437.js","explain.b678a523.css"],import.meta.url).then(t=>t.default||t)},{name:"index",path:"/",file:"C:/Users/Youri/WebstormProjects/Fit2gether/src/pages/index.vue",children:[],meta:Qh,alias:(Qh==null?void 0:Qh.alias)||[],component:()=>tr(()=>import("./index.e8a8615a.js"),["index.e8a8615a.js","index.e0ef3958.css"],import.meta.url).then(t=>t.default||t)},{name:"privacy",path:"/privacy",file:"C:/Users/Youri/WebstormProjects/Fit2gether/src/pages/privacy.vue",children:[],meta:Jh,alias:(Jh==null?void 0:Jh.alias)||[],component:()=>tr(()=>import("./privacy.084579b2.js"),["privacy.084579b2.js","privacy.476e9f9b.css"],import.meta.url).then(t=>t.default||t)}],Ihe={},Zo={...Ihe},_he=[],rg={};function khe(t,e){const{pathname:n,search:s,hash:o}=e,r=t.indexOf("#");if(r>-1){const a=o.includes(t.slice(r))?t.slice(r).length:1;let l=o.slice(a);return l[0]!=="/"&&(l="/"+l),j1(l,"")}return j1(n,t)+s+o}const Ehe=Cl(async t=>{var p,g,b,x;let e,n;t.vueApp.component("NuxtPage",Wm),t.vueApp.component("NuxtNestedPage",Wm),t.vueApp.component("NuxtChild",Wm);let s=uM().app.baseURL;Zo.hashMode&&!s.includes("#")&&(s+="#");const o=(g=(p=Zo.history)==null?void 0:p.call(Zo,s))!=null?g:Zo.hashMode?SM(s):CI(s),r=(x=(b=Zo.routes)==null?void 0:b.call(Zo,e$))!=null?x:e$,i=khe(s,window.location),a=h3({...Zo,history:o,routes:r});t.vueApp.use(a);const l=ad(a.currentRoute.value);a.afterEach((y,w)=>{l.value=w}),Object.defineProperty(t.vueApp.config.globalProperties,"previousRoute",{get:()=>l.value});const c=ad(a.resolve(i)),u=()=>{c.value=a.currentRoute.value};t.hook("page:finish",u),a.afterEach((y,w)=>{var v,$,_,E;(($=(v=y.matched[0])==null?void 0:v.components)==null?void 0:$.default)===((E=(_=w.matched[0])==null?void 0:_.components)==null?void 0:E.default)&&u()});const h={};for(const y in c.value)h[y]=mn(()=>c.value[y]);t._route=zo(h),t._middleware=t._middleware||{global:[],named:{}};const d=lf();try{[e,n]=oM(()=>a.isReady()),await e,n()}catch(y){_r(t,ec,[y])}const f=f3("_layout");return a.beforeEach(async(y,w)=>{var $,_;y.meta=zo(y.meta),t.isHydrating&&(y.meta.layout=($=f.value)!=null?$:y.meta.layout),t._processingMiddleware=!0;const v=new Set([..._he,...t._middleware.global]);for(const E of y.matched){const k=E.meta.middleware;if(!!k)if(Array.isArray(k))for(const N of k)v.add(N);else v.add(k)}for(const E of v){const k=typeof E=="string"?t._middleware.named[E]||await((_=rg[E])==null?void 0:_.call(rg).then(A=>A.default||A)):E;if(!k)throw new Error(`Unknown route middleware: '${E}'.`);const N=await _r(t,k,[y,w]);if(!t.payload.serverRendered&&t.isHydrating&&(N===!1||N instanceof Error)){const A=N||Tg({statusMessage:`Route navigation aborted: ${i}`});return _r(t,ec,[A])}if(N||N===!1)return N}}),a.afterEach(async y=>{delete t._processingMiddleware,!t.isHydrating&&d.value&&await _r(t,m3),y.matched.length===0&&_r(t,ec,[Tg({statusCode:404,fatal:!1,statusMessage:`Page not found: ${y.fullPath}`})])}),t.hooks.hookOnce("app:created",async()=>{try{await a.replace({...a.resolve(i),name:void 0,force:!0})}catch(y){_r(t,ec,[y])}}),{provide:{router:a}}}),She=Cl(t=>{!I3()||(t.hooks.hook("link:prefetch",e=>pw(e)),cf().beforeResolve(async(e,n)=>{if(e.path===n.path)return;const s=await pw(e.path);!s||Object.assign(t.payload.data,s.data)}))});var i2={exports:{}};/*!
  * Bootstrap v5.2.1 (https://getbootstrap.com/)
  * Copyright 2011-2022 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */(function(t,e){(function(n,s){t.exports=s()})(jr,function(){const o="transitionend",r=I=>I==null?`${I}`:Object.prototype.toString.call(I).match(/\s([a-z]+)/i)[1].toLowerCase(),i=I=>{do I+=Math.floor(Math.random()*1e6);while(document.getElementById(I));return I},a=I=>{let m=I.getAttribute("data-bs-target");if(!m||m==="#"){let C=I.getAttribute("href");if(!C||!C.includes("#")&&!C.startsWith("."))return null;C.includes("#")&&!C.startsWith("#")&&(C=`#${C.split("#")[1]}`),m=C&&C!=="#"?C.trim():null}return m},l=I=>{const m=a(I);return m&&document.querySelector(m)?m:null},c=I=>{const m=a(I);return m?document.querySelector(m):null},u=I=>{if(!I)return 0;let{transitionDuration:m,transitionDelay:C}=window.getComputedStyle(I);const S=Number.parseFloat(m),O=Number.parseFloat(C);return!S&&!O?0:(m=m.split(",")[0],C=C.split(",")[0],(Number.parseFloat(m)+Number.parseFloat(C))*1e3)},h=I=>{I.dispatchEvent(new Event(o))},d=I=>!I||typeof I!="object"?!1:(typeof I.jquery<"u"&&(I=I[0]),typeof I.nodeType<"u"),f=I=>d(I)?I.jquery?I[0]:I:typeof I=="string"&&I.length>0?document.querySelector(I):null,p=I=>{if(!d(I)||I.getClientRects().length===0)return!1;const m=getComputedStyle(I).getPropertyValue("visibility")==="visible",C=I.closest("details:not([open])");if(!C)return m;if(C!==I){const S=I.closest("summary");if(S&&S.parentNode!==C||S===null)return!1}return m},g=I=>!I||I.nodeType!==Node.ELEMENT_NODE||I.classList.contains("disabled")?!0:typeof I.disabled<"u"?I.disabled:I.hasAttribute("disabled")&&I.getAttribute("disabled")!=="false",b=I=>{if(!document.documentElement.attachShadow)return null;if(typeof I.getRootNode=="function"){const m=I.getRootNode();return m instanceof ShadowRoot?m:null}return I instanceof ShadowRoot?I:I.parentNode?b(I.parentNode):null},x=()=>{},y=I=>{I.offsetHeight},w=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,v=[],$=I=>{document.readyState==="loading"?(v.length||document.addEventListener("DOMContentLoaded",()=>{for(const m of v)m()}),v.push(I)):I()},_=()=>document.documentElement.dir==="rtl",E=I=>{$(()=>{const m=w();if(m){const C=I.NAME,S=m.fn[C];m.fn[C]=I.jQueryInterface,m.fn[C].Constructor=I,m.fn[C].noConflict=()=>(m.fn[C]=S,I.jQueryInterface)}})},k=I=>{typeof I=="function"&&I()},N=(I,m,C=!0)=>{if(!C){k(I);return}const S=5,O=u(m)+S;let Z=!1;const ee=({target:ue})=>{ue===m&&(Z=!0,m.removeEventListener(o,ee),k(I))};m.addEventListener(o,ee),setTimeout(()=>{Z||h(m)},O)},A=(I,m,C,S)=>{const O=I.length;let Z=I.indexOf(m);return Z===-1?!C&&S?I[O-1]:I[0]:(Z+=C?1:-1,S&&(Z=(Z+O)%O),I[Math.max(0,Math.min(Z,O-1))])},F=/[^.]*(?=\..*)\.|.*/,L=/\..*/,H=/::\d+$/,M={};let K=1;const q={mouseenter:"mouseover",mouseleave:"mouseout"},Q=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function Y(I,m){return m&&`${m}::${K++}`||I.uidEvent||K++}function ie(I){const m=Y(I);return I.uidEvent=m,M[m]=M[m]||{},M[m]}function pe(I,m){return function C(S){return $e(S,{delegateTarget:I}),C.oneOff&&B.off(I,S.type,m),m.apply(I,[S])}}function he(I,m,C){return function S(O){const Z=I.querySelectorAll(m);for(let{target:ee}=O;ee&&ee!==this;ee=ee.parentNode)for(const ue of Z)if(ue===ee)return $e(O,{delegateTarget:ee}),S.oneOff&&B.off(I,O.type,m,C),C.apply(ee,[O])}}function xe(I,m,C=null){return Object.values(I).find(S=>S.callable===m&&S.delegationSelector===C)}function me(I,m,C){const S=typeof m=="string",O=S?C:m||C;let Z=ne(I);return Q.has(Z)||(Z=I),[S,O,Z]}function Ie(I,m,C,S,O){if(typeof m!="string"||!I)return;let[Z,ee,ue]=me(m,C,S);m in q&&(ee=(Dt=>function(ot){if(!ot.relatedTarget||ot.relatedTarget!==ot.delegateTarget&&!ot.delegateTarget.contains(ot.relatedTarget))return Dt.call(this,ot)})(ee));const ve=ie(I),Be=ve[ue]||(ve[ue]={}),Ce=xe(Be,ee,Z?C:null);if(Ce){Ce.oneOff=Ce.oneOff&&O;return}const et=Y(ee,m.replace(F,"")),it=Z?he(I,C,ee):pe(I,ee);it.delegationSelector=Z?C:null,it.callable=ee,it.oneOff=O,it.uidEvent=et,Be[et]=it,I.addEventListener(ue,it,Z)}function G(I,m,C,S,O){const Z=xe(m[C],S,O);!Z||(I.removeEventListener(C,Z,Boolean(O)),delete m[C][Z.uidEvent])}function le(I,m,C,S){const O=m[C]||{};for(const Z of Object.keys(O))if(Z.includes(S)){const ee=O[Z];G(I,m,C,ee.callable,ee.delegationSelector)}}function ne(I){return I=I.replace(L,""),q[I]||I}const B={on(I,m,C,S){Ie(I,m,C,S,!1)},one(I,m,C,S){Ie(I,m,C,S,!0)},off(I,m,C,S){if(typeof m!="string"||!I)return;const[O,Z,ee]=me(m,C,S),ue=ee!==m,ve=ie(I),Be=ve[ee]||{},Ce=m.startsWith(".");if(typeof Z<"u"){if(!Object.keys(Be).length)return;G(I,ve,ee,Z,O?C:null);return}if(Ce)for(const et of Object.keys(ve))le(I,ve,et,m.slice(1));for(const et of Object.keys(Be)){const it=et.replace(H,"");if(!ue||m.includes(it)){const qe=Be[et];G(I,ve,ee,qe.callable,qe.delegationSelector)}}},trigger(I,m,C){if(typeof m!="string"||!I)return null;const S=w(),O=ne(m),Z=m!==O;let ee=null,ue=!0,ve=!0,Be=!1;Z&&S&&(ee=S.Event(m,C),S(I).trigger(ee),ue=!ee.isPropagationStopped(),ve=!ee.isImmediatePropagationStopped(),Be=ee.isDefaultPrevented());let Ce=new Event(m,{bubbles:ue,cancelable:!0});return Ce=$e(Ce,C),Be&&Ce.preventDefault(),ve&&I.dispatchEvent(Ce),Ce.defaultPrevented&&ee&&ee.preventDefault(),Ce}};function $e(I,m){for(const[C,S]of Object.entries(m||{}))try{I[C]=S}catch{Object.defineProperty(I,C,{configurable:!0,get(){return S}})}return I}const Se=new Map,ke={set(I,m,C){Se.has(I)||Se.set(I,new Map);const S=Se.get(I);if(!S.has(m)&&S.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(S.keys())[0]}.`);return}S.set(m,C)},get(I,m){return Se.has(I)&&Se.get(I).get(m)||null},remove(I,m){if(!Se.has(I))return;const C=Se.get(I);C.delete(m),C.size===0&&Se.delete(I)}};function Ne(I){if(I==="true")return!0;if(I==="false")return!1;if(I===Number(I).toString())return Number(I);if(I===""||I==="null")return null;if(typeof I!="string")return I;try{return JSON.parse(decodeURIComponent(I))}catch{return I}}function D(I){return I.replace(/[A-Z]/g,m=>`-${m.toLowerCase()}`)}const P={setDataAttribute(I,m,C){I.setAttribute(`data-bs-${D(m)}`,C)},removeDataAttribute(I,m){I.removeAttribute(`data-bs-${D(m)}`)},getDataAttributes(I){if(!I)return{};const m={},C=Object.keys(I.dataset).filter(S=>S.startsWith("bs")&&!S.startsWith("bsConfig"));for(const S of C){let O=S.replace(/^bs/,"");O=O.charAt(0).toLowerCase()+O.slice(1,O.length),m[O]=Ne(I.dataset[S])}return m},getDataAttribute(I,m){return Ne(I.getAttribute(`data-bs-${D(m)}`))}};class X{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(m){return m=this._mergeConfigObj(m),m=this._configAfterMerge(m),this._typeCheckConfig(m),m}_configAfterMerge(m){return m}_mergeConfigObj(m,C){const S=d(C)?P.getDataAttribute(C,"config"):{};return{...this.constructor.Default,...typeof S=="object"?S:{},...d(C)?P.getDataAttributes(C):{},...typeof m=="object"?m:{}}}_typeCheckConfig(m,C=this.constructor.DefaultType){for(const S of Object.keys(C)){const O=C[S],Z=m[S],ee=d(Z)?"element":r(Z);if(!new RegExp(O).test(ee))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${S}" provided type "${ee}" but expected type "${O}".`)}}}const ce="5.2.1";class re extends X{constructor(m,C){super(),m=f(m),m&&(this._element=m,this._config=this._getConfig(C),ke.set(this._element,this.constructor.DATA_KEY,this))}dispose(){ke.remove(this._element,this.constructor.DATA_KEY),B.off(this._element,this.constructor.EVENT_KEY);for(const m of Object.getOwnPropertyNames(this))this[m]=null}_queueCallback(m,C,S=!0){N(m,C,S)}_getConfig(m){return m=this._mergeConfigObj(m,this._element),m=this._configAfterMerge(m),this._typeCheckConfig(m),m}static getInstance(m){return ke.get(f(m),this.DATA_KEY)}static getOrCreateInstance(m,C={}){return this.getInstance(m)||new this(m,typeof C=="object"?C:null)}static get VERSION(){return ce}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(m){return`${m}${this.EVENT_KEY}`}}const de=(I,m="hide")=>{const C=`click.dismiss${I.EVENT_KEY}`,S=I.NAME;B.on(document,C,`[data-bs-dismiss="${S}"]`,function(O){if(["A","AREA"].includes(this.tagName)&&O.preventDefault(),g(this))return;const Z=c(this)||this.closest(`.${S}`);I.getOrCreateInstance(Z)[m]()})},_e="alert",we=".bs.alert",fe=`close${we}`,Me=`closed${we}`,Re="fade",Oe="show";class Ve extends re{static get NAME(){return _e}close(){if(B.trigger(this._element,fe).defaultPrevented)return;this._element.classList.remove(Oe);const C=this._element.classList.contains(Re);this._queueCallback(()=>this._destroyElement(),this._element,C)}_destroyElement(){this._element.remove(),B.trigger(this._element,Me),this.dispose()}static jQueryInterface(m){return this.each(function(){const C=Ve.getOrCreateInstance(this);if(typeof m=="string"){if(C[m]===void 0||m.startsWith("_")||m==="constructor")throw new TypeError(`No method named "${m}"`);C[m](this)}})}}de(Ve,"close"),E(Ve);const Ke="button",ct=".bs.button",xt=".data-api",En="active",to='[data-bs-toggle="button"]',jo=`click${ct}${xt}`;class bs extends re{static get NAME(){return Ke}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle(En))}static jQueryInterface(m){return this.each(function(){const C=bs.getOrCreateInstance(this);m==="toggle"&&C[m]()})}}B.on(document,jo,to,I=>{I.preventDefault();const m=I.target.closest(to);bs.getOrCreateInstance(m).toggle()}),E(bs);const Qe={find(I,m=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(m,I))},findOne(I,m=document.documentElement){return Element.prototype.querySelector.call(m,I)},children(I,m){return[].concat(...I.children).filter(C=>C.matches(m))},parents(I,m){const C=[];let S=I.parentNode.closest(m);for(;S;)C.push(S),S=S.parentNode.closest(m);return C},prev(I,m){let C=I.previousElementSibling;for(;C;){if(C.matches(m))return[C];C=C.previousElementSibling}return[]},next(I,m){let C=I.nextElementSibling;for(;C;){if(C.matches(m))return[C];C=C.nextElementSibling}return[]},focusableChildren(I){const m=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(C=>`${C}:not([tabindex^="-"])`).join(",");return this.find(m,I).filter(C=>!g(C)&&p(C))}},jn="swipe",Sn=".bs.swipe",ih=`touchstart${Sn}`,a2=`touchmove${Sn}`,l2=`touchend${Sn}`,c2=`pointerdown${Sn}`,u2=`pointerup${Sn}`,h2="touch",d2="pen",f2="pointer-event",p2=40,m2={endCallback:null,leftCallback:null,rightCallback:null},g2={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class ah extends X{constructor(m,C){super(),this._element=m,!(!m||!ah.isSupported())&&(this._config=this._getConfig(C),this._deltaX=0,this._supportPointerEvents=Boolean(window.PointerEvent),this._initEvents())}static get Default(){return m2}static get DefaultType(){return g2}static get NAME(){return jn}dispose(){B.off(this._element,Sn)}_start(m){if(!this._supportPointerEvents){this._deltaX=m.touches[0].clientX;return}this._eventIsPointerPenTouch(m)&&(this._deltaX=m.clientX)}_end(m){this._eventIsPointerPenTouch(m)&&(this._deltaX=m.clientX-this._deltaX),this._handleSwipe(),k(this._config.endCallback)}_move(m){this._deltaX=m.touches&&m.touches.length>1?0:m.touches[0].clientX-this._deltaX}_handleSwipe(){const m=Math.abs(this._deltaX);if(m<=p2)return;const C=m/this._deltaX;this._deltaX=0,C&&k(C>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(B.on(this._element,c2,m=>this._start(m)),B.on(this._element,u2,m=>this._end(m)),this._element.classList.add(f2)):(B.on(this._element,ih,m=>this._start(m)),B.on(this._element,a2,m=>this._move(m)),B.on(this._element,l2,m=>this._end(m)))}_eventIsPointerPenTouch(m){return this._supportPointerEvents&&(m.pointerType===d2||m.pointerType===h2)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const b2="carousel",pr=".bs.carousel",M0=".data-api",x2="ArrowLeft",y2="ArrowRight",v2=500,Ml="next",da="prev",fa="left",lh="right",w2=`slide${pr}`,jp=`slid${pr}`,C2=`keydown${pr}`,$2=`mouseenter${pr}`,I2=`mouseleave${pr}`,_2=`dragstart${pr}`,k2=`load${pr}${M0}`,E2=`click${pr}${M0}`,B0="carousel",ch="active",S2="slide",T2="carousel-item-end",N2="carousel-item-start",A2="carousel-item-next",R2="carousel-item-prev",V0=".active",z0=".carousel-item",D2=V0+z0,O2=".carousel-item img",F2=".carousel-indicators",L2="[data-bs-slide], [data-bs-slide-to]",P2='[data-bs-ride="carousel"]',M2={[x2]:lh,[y2]:fa},B2={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},V2={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class pa extends re{constructor(m,C){super(m,C),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=Qe.findOne(F2,this._element),this._addEventListeners(),this._config.ride===B0&&this.cycle()}static get Default(){return B2}static get DefaultType(){return V2}static get NAME(){return b2}next(){this._slide(Ml)}nextWhenVisible(){!document.hidden&&p(this._element)&&this.next()}prev(){this._slide(da)}pause(){this._isSliding&&h(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(!!this._config.ride){if(this._isSliding){B.one(this._element,jp,()=>this.cycle());return}this.cycle()}}to(m){const C=this._getItems();if(m>C.length-1||m<0)return;if(this._isSliding){B.one(this._element,jp,()=>this.to(m));return}const S=this._getItemIndex(this._getActive());if(S===m)return;const O=m>S?Ml:da;this._slide(O,C[m])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(m){return m.defaultInterval=m.interval,m}_addEventListeners(){this._config.keyboard&&B.on(this._element,C2,m=>this._keydown(m)),this._config.pause==="hover"&&(B.on(this._element,$2,()=>this.pause()),B.on(this._element,I2,()=>this._maybeEnableCycle())),this._config.touch&&ah.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const S of Qe.find(O2,this._element))B.on(S,_2,O=>O.preventDefault());const C={leftCallback:()=>this._slide(this._directionToOrder(fa)),rightCallback:()=>this._slide(this._directionToOrder(lh)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),v2+this._config.interval))}};this._swipeHelper=new ah(this._element,C)}_keydown(m){if(/input|textarea/i.test(m.target.tagName))return;const C=M2[m.key];C&&(m.preventDefault(),this._slide(this._directionToOrder(C)))}_getItemIndex(m){return this._getItems().indexOf(m)}_setActiveIndicatorElement(m){if(!this._indicatorsElement)return;const C=Qe.findOne(V0,this._indicatorsElement);C.classList.remove(ch),C.removeAttribute("aria-current");const S=Qe.findOne(`[data-bs-slide-to="${m}"]`,this._indicatorsElement);S&&(S.classList.add(ch),S.setAttribute("aria-current","true"))}_updateInterval(){const m=this._activeElement||this._getActive();if(!m)return;const C=Number.parseInt(m.getAttribute("data-bs-interval"),10);this._config.interval=C||this._config.defaultInterval}_slide(m,C=null){if(this._isSliding)return;const S=this._getActive(),O=m===Ml,Z=C||A(this._getItems(),S,O,this._config.wrap);if(Z===S)return;const ee=this._getItemIndex(Z),ue=qe=>B.trigger(this._element,qe,{relatedTarget:Z,direction:this._orderToDirection(m),from:this._getItemIndex(S),to:ee});if(ue(w2).defaultPrevented||!S||!Z)return;const Be=Boolean(this._interval);this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(ee),this._activeElement=Z;const Ce=O?N2:T2,et=O?A2:R2;Z.classList.add(et),y(Z),S.classList.add(Ce),Z.classList.add(Ce);const it=()=>{Z.classList.remove(Ce,et),Z.classList.add(ch),S.classList.remove(ch,et,Ce),this._isSliding=!1,ue(jp)};this._queueCallback(it,S,this._isAnimated()),Be&&this.cycle()}_isAnimated(){return this._element.classList.contains(S2)}_getActive(){return Qe.findOne(D2,this._element)}_getItems(){return Qe.find(z0,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(m){return _()?m===fa?da:Ml:m===fa?Ml:da}_orderToDirection(m){return _()?m===da?fa:lh:m===da?lh:fa}static jQueryInterface(m){return this.each(function(){const C=pa.getOrCreateInstance(this,m);if(typeof m=="number"){C.to(m);return}if(typeof m=="string"){if(C[m]===void 0||m.startsWith("_")||m==="constructor")throw new TypeError(`No method named "${m}"`);C[m]()}})}}B.on(document,E2,L2,function(I){const m=c(this);if(!m||!m.classList.contains(B0))return;I.preventDefault();const C=pa.getOrCreateInstance(m),S=this.getAttribute("data-bs-slide-to");if(S){C.to(S),C._maybeEnableCycle();return}if(P.getDataAttribute(this,"slide")==="next"){C.next(),C._maybeEnableCycle();return}C.prev(),C._maybeEnableCycle()}),B.on(window,k2,()=>{const I=Qe.find(P2);for(const m of I)pa.getOrCreateInstance(m)}),E(pa);const z2="collapse",Bl=".bs.collapse",W2=".data-api",U2=`show${Bl}`,H2=`shown${Bl}`,G2=`hide${Bl}`,j2=`hidden${Bl}`,q2=`click${Bl}${W2}`,qp="show",ma="collapse",uh="collapsing",K2="collapsed",X2=`:scope .${ma} .${ma}`,Y2="collapse-horizontal",Z2="width",Q2="height",J2=".collapse.show, .collapse.collapsing",Kp='[data-bs-toggle="collapse"]',eA={parent:null,toggle:!0},tA={parent:"(null|element)",toggle:"boolean"};class ga extends re{constructor(m,C){super(m,C),this._isTransitioning=!1,this._triggerArray=[];const S=Qe.find(Kp);for(const O of S){const Z=l(O),ee=Qe.find(Z).filter(ue=>ue===this._element);Z!==null&&ee.length&&this._triggerArray.push(O)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return eA}static get DefaultType(){return tA}static get NAME(){return z2}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let m=[];if(this._config.parent&&(m=this._getFirstLevelChildren(J2).filter(ue=>ue!==this._element).map(ue=>ga.getOrCreateInstance(ue,{toggle:!1}))),m.length&&m[0]._isTransitioning||B.trigger(this._element,U2).defaultPrevented)return;for(const ue of m)ue.hide();const S=this._getDimension();this._element.classList.remove(ma),this._element.classList.add(uh),this._element.style[S]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const O=()=>{this._isTransitioning=!1,this._element.classList.remove(uh),this._element.classList.add(ma,qp),this._element.style[S]="",B.trigger(this._element,H2)},ee=`scroll${S[0].toUpperCase()+S.slice(1)}`;this._queueCallback(O,this._element,!0),this._element.style[S]=`${this._element[ee]}px`}hide(){if(this._isTransitioning||!this._isShown()||B.trigger(this._element,G2).defaultPrevented)return;const C=this._getDimension();this._element.style[C]=`${this._element.getBoundingClientRect()[C]}px`,y(this._element),this._element.classList.add(uh),this._element.classList.remove(ma,qp);for(const O of this._triggerArray){const Z=c(O);Z&&!this._isShown(Z)&&this._addAriaAndCollapsedClass([O],!1)}this._isTransitioning=!0;const S=()=>{this._isTransitioning=!1,this._element.classList.remove(uh),this._element.classList.add(ma),B.trigger(this._element,j2)};this._element.style[C]="",this._queueCallback(S,this._element,!0)}_isShown(m=this._element){return m.classList.contains(qp)}_configAfterMerge(m){return m.toggle=Boolean(m.toggle),m.parent=f(m.parent),m}_getDimension(){return this._element.classList.contains(Y2)?Z2:Q2}_initializeChildren(){if(!this._config.parent)return;const m=this._getFirstLevelChildren(Kp);for(const C of m){const S=c(C);S&&this._addAriaAndCollapsedClass([C],this._isShown(S))}}_getFirstLevelChildren(m){const C=Qe.find(X2,this._config.parent);return Qe.find(m,this._config.parent).filter(S=>!C.includes(S))}_addAriaAndCollapsedClass(m,C){if(!!m.length)for(const S of m)S.classList.toggle(K2,!C),S.setAttribute("aria-expanded",C)}static jQueryInterface(m){const C={};return typeof m=="string"&&/show|hide/.test(m)&&(C.toggle=!1),this.each(function(){const S=ga.getOrCreateInstance(this,C);if(typeof m=="string"){if(typeof S[m]>"u")throw new TypeError(`No method named "${m}"`);S[m]()}})}}B.on(document,q2,Kp,function(I){(I.target.tagName==="A"||I.delegateTarget&&I.delegateTarget.tagName==="A")&&I.preventDefault();const m=l(this),C=Qe.find(m);for(const S of C)ga.getOrCreateInstance(S,{toggle:!1}).toggle()}),E(ga);var qn="top",xs="bottom",ys="right",Kn="left",hh="auto",ba=[qn,xs,ys,Kn],si="start",xa="end",W0="clippingParents",Xp="viewport",ya="popper",U0="reference",Yp=ba.reduce(function(I,m){return I.concat([m+"-"+si,m+"-"+xa])},[]),Zp=[].concat(ba,[hh]).reduce(function(I,m){return I.concat([m,m+"-"+si,m+"-"+xa])},[]),H0="beforeRead",G0="read",j0="afterRead",q0="beforeMain",K0="main",X0="afterMain",Y0="beforeWrite",Z0="write",Q0="afterWrite",J0=[H0,G0,j0,q0,K0,X0,Y0,Z0,Q0];function Co(I){return I?(I.nodeName||"").toLowerCase():null}function Ns(I){if(I==null)return window;if(I.toString()!=="[object Window]"){var m=I.ownerDocument;return m&&m.defaultView||window}return I}function oi(I){var m=Ns(I).Element;return I instanceof m||I instanceof Element}function As(I){var m=Ns(I).HTMLElement;return I instanceof m||I instanceof HTMLElement}function Qp(I){if(typeof ShadowRoot>"u")return!1;var m=Ns(I).ShadowRoot;return I instanceof m||I instanceof ShadowRoot}function nA(I){var m=I.state;Object.keys(m.elements).forEach(function(C){var S=m.styles[C]||{},O=m.attributes[C]||{},Z=m.elements[C];!As(Z)||!Co(Z)||(Object.assign(Z.style,S),Object.keys(O).forEach(function(ee){var ue=O[ee];ue===!1?Z.removeAttribute(ee):Z.setAttribute(ee,ue===!0?"":ue)}))})}function sA(I){var m=I.state,C={popper:{position:m.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(m.elements.popper.style,C.popper),m.styles=C,m.elements.arrow&&Object.assign(m.elements.arrow.style,C.arrow),function(){Object.keys(m.elements).forEach(function(S){var O=m.elements[S],Z=m.attributes[S]||{},ee=Object.keys(m.styles.hasOwnProperty(S)?m.styles[S]:C[S]),ue=ee.reduce(function(ve,Be){return ve[Be]="",ve},{});!As(O)||!Co(O)||(Object.assign(O.style,ue),Object.keys(Z).forEach(function(ve){O.removeAttribute(ve)}))})}}const Jp={name:"applyStyles",enabled:!0,phase:"write",fn:nA,effect:sA,requires:["computeStyles"]};function $o(I){return I.split("-")[0]}var ri=Math.max,dh=Math.min,va=Math.round;function em(){var I=navigator.userAgentData;return I!=null&&I.brands?I.brands.map(function(m){return m.brand+"/"+m.version}).join(" "):navigator.userAgent}function ev(){return!/^((?!chrome|android).)*safari/i.test(em())}function wa(I,m,C){m===void 0&&(m=!1),C===void 0&&(C=!1);var S=I.getBoundingClientRect(),O=1,Z=1;m&&As(I)&&(O=I.offsetWidth>0&&va(S.width)/I.offsetWidth||1,Z=I.offsetHeight>0&&va(S.height)/I.offsetHeight||1);var ee=oi(I)?Ns(I):window,ue=ee.visualViewport,ve=!ev()&&C,Be=(S.left+(ve&&ue?ue.offsetLeft:0))/O,Ce=(S.top+(ve&&ue?ue.offsetTop:0))/Z,et=S.width/O,it=S.height/Z;return{width:et,height:it,top:Ce,right:Be+et,bottom:Ce+it,left:Be,x:Be,y:Ce}}function tm(I){var m=wa(I),C=I.offsetWidth,S=I.offsetHeight;return Math.abs(m.width-C)<=1&&(C=m.width),Math.abs(m.height-S)<=1&&(S=m.height),{x:I.offsetLeft,y:I.offsetTop,width:C,height:S}}function tv(I,m){var C=m.getRootNode&&m.getRootNode();if(I.contains(m))return!0;if(C&&Qp(C)){var S=m;do{if(S&&I.isSameNode(S))return!0;S=S.parentNode||S.host}while(S)}return!1}function qo(I){return Ns(I).getComputedStyle(I)}function oA(I){return["table","td","th"].indexOf(Co(I))>=0}function mr(I){return((oi(I)?I.ownerDocument:I.document)||window.document).documentElement}function fh(I){return Co(I)==="html"?I:I.assignedSlot||I.parentNode||(Qp(I)?I.host:null)||mr(I)}function nv(I){return!As(I)||qo(I).position==="fixed"?null:I.offsetParent}function rA(I){var m=/firefox/i.test(em()),C=/Trident/i.test(em());if(C&&As(I)){var S=qo(I);if(S.position==="fixed")return null}var O=fh(I);for(Qp(O)&&(O=O.host);As(O)&&["html","body"].indexOf(Co(O))<0;){var Z=qo(O);if(Z.transform!=="none"||Z.perspective!=="none"||Z.contain==="paint"||["transform","perspective"].indexOf(Z.willChange)!==-1||m&&Z.willChange==="filter"||m&&Z.filter&&Z.filter!=="none")return O;O=O.parentNode}return null}function Vl(I){for(var m=Ns(I),C=nv(I);C&&oA(C)&&qo(C).position==="static";)C=nv(C);return C&&(Co(C)==="html"||Co(C)==="body"&&qo(C).position==="static")?m:C||rA(I)||m}function nm(I){return["top","bottom"].indexOf(I)>=0?"x":"y"}function zl(I,m,C){return ri(I,dh(m,C))}function iA(I,m,C){var S=zl(I,m,C);return S>C?C:S}function sv(){return{top:0,right:0,bottom:0,left:0}}function ov(I){return Object.assign({},sv(),I)}function rv(I,m){return m.reduce(function(C,S){return C[S]=I,C},{})}var aA=function(m,C){return m=typeof m=="function"?m(Object.assign({},C.rects,{placement:C.placement})):m,ov(typeof m!="number"?m:rv(m,ba))};function lA(I){var m,C=I.state,S=I.name,O=I.options,Z=C.elements.arrow,ee=C.modifiersData.popperOffsets,ue=$o(C.placement),ve=nm(ue),Be=[Kn,ys].indexOf(ue)>=0,Ce=Be?"height":"width";if(!(!Z||!ee)){var et=aA(O.padding,C),it=tm(Z),qe=ve==="y"?qn:Kn,Dt=ve==="y"?xs:ys,ot=C.rects.reference[Ce]+C.rects.reference[ve]-ee[ve]-C.rects.popper[Ce],mt=ee[ve]-C.rects.reference[ve],Bt=Vl(Z),Jt=Bt?ve==="y"?Bt.clientHeight||0:Bt.clientWidth||0:0,en=ot/2-mt/2,at=et[qe],kt=Jt-it[Ce]-et[Dt],Et=Jt/2-it[Ce]/2+en,qt=zl(at,Et,kt),Tn=ve;C.modifiersData[S]=(m={},m[Tn]=qt,m.centerOffset=qt-Et,m)}}function cA(I){var m=I.state,C=I.options,S=C.element,O=S===void 0?"[data-popper-arrow]":S;O!=null&&(typeof O=="string"&&(O=m.elements.popper.querySelector(O),!O)||!tv(m.elements.popper,O)||(m.elements.arrow=O))}const iv={name:"arrow",enabled:!0,phase:"main",fn:lA,effect:cA,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Ca(I){return I.split("-")[1]}var uA={top:"auto",right:"auto",bottom:"auto",left:"auto"};function hA(I){var m=I.x,C=I.y,S=window,O=S.devicePixelRatio||1;return{x:va(m*O)/O||0,y:va(C*O)/O||0}}function av(I){var m,C=I.popper,S=I.popperRect,O=I.placement,Z=I.variation,ee=I.offsets,ue=I.position,ve=I.gpuAcceleration,Be=I.adaptive,Ce=I.roundOffsets,et=I.isFixed,it=ee.x,qe=it===void 0?0:it,Dt=ee.y,ot=Dt===void 0?0:Dt,mt=typeof Ce=="function"?Ce({x:qe,y:ot}):{x:qe,y:ot};qe=mt.x,ot=mt.y;var Bt=ee.hasOwnProperty("x"),Jt=ee.hasOwnProperty("y"),en=Kn,at=qn,kt=window;if(Be){var Et=Vl(C),qt="clientHeight",Tn="clientWidth";if(Et===Ns(C)&&(Et=mr(C),qo(Et).position!=="static"&&ue==="absolute"&&(qt="scrollHeight",Tn="scrollWidth")),Et=Et,O===qn||(O===Kn||O===ys)&&Z===xa){at=xs;var wn=et&&Et===kt&&kt.visualViewport?kt.visualViewport.height:Et[qt];ot-=wn-S.height,ot*=ve?1:-1}if(O===Kn||(O===qn||O===xs)&&Z===xa){en=ys;var hn=et&&Et===kt&&kt.visualViewport?kt.visualViewport.width:Et[Tn];qe-=hn-S.width,qe*=ve?1:-1}}var Mn=Object.assign({position:ue},Be&&uA),oo=Ce===!0?hA({x:qe,y:ot}):{x:qe,y:ot};if(qe=oo.x,ot=oo.y,ve){var Xn;return Object.assign({},Mn,(Xn={},Xn[at]=Jt?"0":"",Xn[en]=Bt?"0":"",Xn.transform=(kt.devicePixelRatio||1)<=1?"translate("+qe+"px, "+ot+"px)":"translate3d("+qe+"px, "+ot+"px, 0)",Xn))}return Object.assign({},Mn,(m={},m[at]=Jt?ot+"px":"",m[en]=Bt?qe+"px":"",m.transform="",m))}function dA(I){var m=I.state,C=I.options,S=C.gpuAcceleration,O=S===void 0?!0:S,Z=C.adaptive,ee=Z===void 0?!0:Z,ue=C.roundOffsets,ve=ue===void 0?!0:ue,Be={placement:$o(m.placement),variation:Ca(m.placement),popper:m.elements.popper,popperRect:m.rects.popper,gpuAcceleration:O,isFixed:m.options.strategy==="fixed"};m.modifiersData.popperOffsets!=null&&(m.styles.popper=Object.assign({},m.styles.popper,av(Object.assign({},Be,{offsets:m.modifiersData.popperOffsets,position:m.options.strategy,adaptive:ee,roundOffsets:ve})))),m.modifiersData.arrow!=null&&(m.styles.arrow=Object.assign({},m.styles.arrow,av(Object.assign({},Be,{offsets:m.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:ve})))),m.attributes.popper=Object.assign({},m.attributes.popper,{"data-popper-placement":m.placement})}const sm={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:dA,data:{}};var ph={passive:!0};function fA(I){var m=I.state,C=I.instance,S=I.options,O=S.scroll,Z=O===void 0?!0:O,ee=S.resize,ue=ee===void 0?!0:ee,ve=Ns(m.elements.popper),Be=[].concat(m.scrollParents.reference,m.scrollParents.popper);return Z&&Be.forEach(function(Ce){Ce.addEventListener("scroll",C.update,ph)}),ue&&ve.addEventListener("resize",C.update,ph),function(){Z&&Be.forEach(function(Ce){Ce.removeEventListener("scroll",C.update,ph)}),ue&&ve.removeEventListener("resize",C.update,ph)}}const om={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:fA,data:{}};var pA={left:"right",right:"left",bottom:"top",top:"bottom"};function mh(I){return I.replace(/left|right|bottom|top/g,function(m){return pA[m]})}var mA={start:"end",end:"start"};function lv(I){return I.replace(/start|end/g,function(m){return mA[m]})}function rm(I){var m=Ns(I),C=m.pageXOffset,S=m.pageYOffset;return{scrollLeft:C,scrollTop:S}}function im(I){return wa(mr(I)).left+rm(I).scrollLeft}function gA(I,m){var C=Ns(I),S=mr(I),O=C.visualViewport,Z=S.clientWidth,ee=S.clientHeight,ue=0,ve=0;if(O){Z=O.width,ee=O.height;var Be=ev();(Be||!Be&&m==="fixed")&&(ue=O.offsetLeft,ve=O.offsetTop)}return{width:Z,height:ee,x:ue+im(I),y:ve}}function bA(I){var m,C=mr(I),S=rm(I),O=(m=I.ownerDocument)==null?void 0:m.body,Z=ri(C.scrollWidth,C.clientWidth,O?O.scrollWidth:0,O?O.clientWidth:0),ee=ri(C.scrollHeight,C.clientHeight,O?O.scrollHeight:0,O?O.clientHeight:0),ue=-S.scrollLeft+im(I),ve=-S.scrollTop;return qo(O||C).direction==="rtl"&&(ue+=ri(C.clientWidth,O?O.clientWidth:0)-Z),{width:Z,height:ee,x:ue,y:ve}}function am(I){var m=qo(I),C=m.overflow,S=m.overflowX,O=m.overflowY;return/auto|scroll|overlay|hidden/.test(C+O+S)}function cv(I){return["html","body","#document"].indexOf(Co(I))>=0?I.ownerDocument.body:As(I)&&am(I)?I:cv(fh(I))}function Wl(I,m){var C;m===void 0&&(m=[]);var S=cv(I),O=S===((C=I.ownerDocument)==null?void 0:C.body),Z=Ns(S),ee=O?[Z].concat(Z.visualViewport||[],am(S)?S:[]):S,ue=m.concat(ee);return O?ue:ue.concat(Wl(fh(ee)))}function lm(I){return Object.assign({},I,{left:I.x,top:I.y,right:I.x+I.width,bottom:I.y+I.height})}function xA(I,m){var C=wa(I,!1,m==="fixed");return C.top=C.top+I.clientTop,C.left=C.left+I.clientLeft,C.bottom=C.top+I.clientHeight,C.right=C.left+I.clientWidth,C.width=I.clientWidth,C.height=I.clientHeight,C.x=C.left,C.y=C.top,C}function uv(I,m,C){return m===Xp?lm(gA(I,C)):oi(m)?xA(m,C):lm(bA(mr(I)))}function yA(I){var m=Wl(fh(I)),C=["absolute","fixed"].indexOf(qo(I).position)>=0,S=C&&As(I)?Vl(I):I;return oi(S)?m.filter(function(O){return oi(O)&&tv(O,S)&&Co(O)!=="body"}):[]}function vA(I,m,C,S){var O=m==="clippingParents"?yA(I):[].concat(m),Z=[].concat(O,[C]),ee=Z[0],ue=Z.reduce(function(ve,Be){var Ce=uv(I,Be,S);return ve.top=ri(Ce.top,ve.top),ve.right=dh(Ce.right,ve.right),ve.bottom=dh(Ce.bottom,ve.bottom),ve.left=ri(Ce.left,ve.left),ve},uv(I,ee,S));return ue.width=ue.right-ue.left,ue.height=ue.bottom-ue.top,ue.x=ue.left,ue.y=ue.top,ue}function hv(I){var m=I.reference,C=I.element,S=I.placement,O=S?$o(S):null,Z=S?Ca(S):null,ee=m.x+m.width/2-C.width/2,ue=m.y+m.height/2-C.height/2,ve;switch(O){case qn:ve={x:ee,y:m.y-C.height};break;case xs:ve={x:ee,y:m.y+m.height};break;case ys:ve={x:m.x+m.width,y:ue};break;case Kn:ve={x:m.x-C.width,y:ue};break;default:ve={x:m.x,y:m.y}}var Be=O?nm(O):null;if(Be!=null){var Ce=Be==="y"?"height":"width";switch(Z){case si:ve[Be]=ve[Be]-(m[Ce]/2-C[Ce]/2);break;case xa:ve[Be]=ve[Be]+(m[Ce]/2-C[Ce]/2);break}}return ve}function $a(I,m){m===void 0&&(m={});var C=m,S=C.placement,O=S===void 0?I.placement:S,Z=C.strategy,ee=Z===void 0?I.strategy:Z,ue=C.boundary,ve=ue===void 0?W0:ue,Be=C.rootBoundary,Ce=Be===void 0?Xp:Be,et=C.elementContext,it=et===void 0?ya:et,qe=C.altBoundary,Dt=qe===void 0?!1:qe,ot=C.padding,mt=ot===void 0?0:ot,Bt=ov(typeof mt!="number"?mt:rv(mt,ba)),Jt=it===ya?U0:ya,en=I.rects.popper,at=I.elements[Dt?Jt:it],kt=vA(oi(at)?at:at.contextElement||mr(I.elements.popper),ve,Ce,ee),Et=wa(I.elements.reference),qt=hv({reference:Et,element:en,strategy:"absolute",placement:O}),Tn=lm(Object.assign({},en,qt)),wn=it===ya?Tn:Et,hn={top:kt.top-wn.top+Bt.top,bottom:wn.bottom-kt.bottom+Bt.bottom,left:kt.left-wn.left+Bt.left,right:wn.right-kt.right+Bt.right},Mn=I.modifiersData.offset;if(it===ya&&Mn){var oo=Mn[O];Object.keys(hn).forEach(function(Xn){var hi=[ys,xs].indexOf(Xn)>=0?1:-1,di=[qn,xs].indexOf(Xn)>=0?"y":"x";hn[Xn]+=oo[di]*hi})}return hn}function wA(I,m){m===void 0&&(m={});var C=m,S=C.placement,O=C.boundary,Z=C.rootBoundary,ee=C.padding,ue=C.flipVariations,ve=C.allowedAutoPlacements,Be=ve===void 0?Zp:ve,Ce=Ca(S),et=Ce?ue?Yp:Yp.filter(function(Dt){return Ca(Dt)===Ce}):ba,it=et.filter(function(Dt){return Be.indexOf(Dt)>=0});it.length===0&&(it=et);var qe=it.reduce(function(Dt,ot){return Dt[ot]=$a(I,{placement:ot,boundary:O,rootBoundary:Z,padding:ee})[$o(ot)],Dt},{});return Object.keys(qe).sort(function(Dt,ot){return qe[Dt]-qe[ot]})}function CA(I){if($o(I)===hh)return[];var m=mh(I);return[lv(I),m,lv(m)]}function $A(I){var m=I.state,C=I.options,S=I.name;if(!m.modifiersData[S]._skip){for(var O=C.mainAxis,Z=O===void 0?!0:O,ee=C.altAxis,ue=ee===void 0?!0:ee,ve=C.fallbackPlacements,Be=C.padding,Ce=C.boundary,et=C.rootBoundary,it=C.altBoundary,qe=C.flipVariations,Dt=qe===void 0?!0:qe,ot=C.allowedAutoPlacements,mt=m.options.placement,Bt=$o(mt),Jt=Bt===mt,en=ve||(Jt||!Dt?[mh(mt)]:CA(mt)),at=[mt].concat(en).reduce(function(Ea,xr){return Ea.concat($o(xr)===hh?wA(m,{placement:xr,boundary:Ce,rootBoundary:et,padding:Be,flipVariations:Dt,allowedAutoPlacements:ot}):xr)},[]),kt=m.rects.reference,Et=m.rects.popper,qt=new Map,Tn=!0,wn=at[0],hn=0;hn<at.length;hn++){var Mn=at[hn],oo=$o(Mn),Xn=Ca(Mn)===si,hi=[qn,xs].indexOf(oo)>=0,di=hi?"width":"height",vs=$a(m,{placement:Mn,boundary:Ce,rootBoundary:et,altBoundary:it,padding:Be}),ro=hi?Xn?ys:Kn:Xn?xs:qn;kt[di]>Et[di]&&(ro=mh(ro));var $h=mh(ro),fi=[];if(Z&&fi.push(vs[oo]<=0),ue&&fi.push(vs[ro]<=0,vs[$h]<=0),fi.every(function(Ea){return Ea})){wn=Mn,Tn=!1;break}qt.set(Mn,fi)}if(Tn)for(var Ih=Dt?3:1,Cm=function(xr){var ql=at.find(function(kh){var pi=qt.get(kh);if(pi)return pi.slice(0,xr).every(function($m){return $m})});if(ql)return wn=ql,"break"},jl=Ih;jl>0;jl--){var _h=Cm(jl);if(_h==="break")break}m.placement!==wn&&(m.modifiersData[S]._skip=!0,m.placement=wn,m.reset=!0)}}const dv={name:"flip",enabled:!0,phase:"main",fn:$A,requiresIfExists:["offset"],data:{_skip:!1}};function fv(I,m,C){return C===void 0&&(C={x:0,y:0}),{top:I.top-m.height-C.y,right:I.right-m.width+C.x,bottom:I.bottom-m.height+C.y,left:I.left-m.width-C.x}}function pv(I){return[qn,ys,xs,Kn].some(function(m){return I[m]>=0})}function IA(I){var m=I.state,C=I.name,S=m.rects.reference,O=m.rects.popper,Z=m.modifiersData.preventOverflow,ee=$a(m,{elementContext:"reference"}),ue=$a(m,{altBoundary:!0}),ve=fv(ee,S),Be=fv(ue,O,Z),Ce=pv(ve),et=pv(Be);m.modifiersData[C]={referenceClippingOffsets:ve,popperEscapeOffsets:Be,isReferenceHidden:Ce,hasPopperEscaped:et},m.attributes.popper=Object.assign({},m.attributes.popper,{"data-popper-reference-hidden":Ce,"data-popper-escaped":et})}const mv={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:IA};function _A(I,m,C){var S=$o(I),O=[Kn,qn].indexOf(S)>=0?-1:1,Z=typeof C=="function"?C(Object.assign({},m,{placement:I})):C,ee=Z[0],ue=Z[1];return ee=ee||0,ue=(ue||0)*O,[Kn,ys].indexOf(S)>=0?{x:ue,y:ee}:{x:ee,y:ue}}function kA(I){var m=I.state,C=I.options,S=I.name,O=C.offset,Z=O===void 0?[0,0]:O,ee=Zp.reduce(function(Ce,et){return Ce[et]=_A(et,m.rects,Z),Ce},{}),ue=ee[m.placement],ve=ue.x,Be=ue.y;m.modifiersData.popperOffsets!=null&&(m.modifiersData.popperOffsets.x+=ve,m.modifiersData.popperOffsets.y+=Be),m.modifiersData[S]=ee}const gv={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:kA};function EA(I){var m=I.state,C=I.name;m.modifiersData[C]=hv({reference:m.rects.reference,element:m.rects.popper,strategy:"absolute",placement:m.placement})}const cm={name:"popperOffsets",enabled:!0,phase:"read",fn:EA,data:{}};function SA(I){return I==="x"?"y":"x"}function TA(I){var m=I.state,C=I.options,S=I.name,O=C.mainAxis,Z=O===void 0?!0:O,ee=C.altAxis,ue=ee===void 0?!1:ee,ve=C.boundary,Be=C.rootBoundary,Ce=C.altBoundary,et=C.padding,it=C.tether,qe=it===void 0?!0:it,Dt=C.tetherOffset,ot=Dt===void 0?0:Dt,mt=$a(m,{boundary:ve,rootBoundary:Be,padding:et,altBoundary:Ce}),Bt=$o(m.placement),Jt=Ca(m.placement),en=!Jt,at=nm(Bt),kt=SA(at),Et=m.modifiersData.popperOffsets,qt=m.rects.reference,Tn=m.rects.popper,wn=typeof ot=="function"?ot(Object.assign({},m.rects,{placement:m.placement})):ot,hn=typeof wn=="number"?{mainAxis:wn,altAxis:wn}:Object.assign({mainAxis:0,altAxis:0},wn),Mn=m.modifiersData.offset?m.modifiersData.offset[m.placement]:null,oo={x:0,y:0};if(!!Et){if(Z){var Xn,hi=at==="y"?qn:Kn,di=at==="y"?xs:ys,vs=at==="y"?"height":"width",ro=Et[at],$h=ro+mt[hi],fi=ro-mt[di],Ih=qe?-Tn[vs]/2:0,Cm=Jt===si?qt[vs]:Tn[vs],jl=Jt===si?-Tn[vs]:-qt[vs],_h=m.elements.arrow,Ea=qe&&_h?tm(_h):{width:0,height:0},xr=m.modifiersData["arrow#persistent"]?m.modifiersData["arrow#persistent"].padding:sv(),ql=xr[hi],kh=xr[di],pi=zl(0,qt[vs],Ea[vs]),$m=en?qt[vs]/2-Ih-pi-ql-hn.mainAxis:Cm-pi-ql-hn.mainAxis,_O=en?-qt[vs]/2+Ih+pi+kh+hn.mainAxis:jl+pi+kh+hn.mainAxis,Im=m.elements.arrow&&Vl(m.elements.arrow),kO=Im?at==="y"?Im.clientTop||0:Im.clientLeft||0:0,n1=(Xn=Mn==null?void 0:Mn[at])!=null?Xn:0,EO=ro+$m-n1-kO,SO=ro+_O-n1,s1=zl(qe?dh($h,EO):$h,ro,qe?ri(fi,SO):fi);Et[at]=s1,oo[at]=s1-ro}if(ue){var o1,TO=at==="x"?qn:Kn,NO=at==="x"?xs:ys,mi=Et[kt],Eh=kt==="y"?"height":"width",r1=mi+mt[TO],i1=mi-mt[NO],_m=[qn,Kn].indexOf(Bt)!==-1,a1=(o1=Mn==null?void 0:Mn[kt])!=null?o1:0,l1=_m?r1:mi-qt[Eh]-Tn[Eh]-a1+hn.altAxis,c1=_m?mi+qt[Eh]+Tn[Eh]-a1-hn.altAxis:i1,u1=qe&&_m?iA(l1,mi,c1):zl(qe?l1:r1,mi,qe?c1:i1);Et[kt]=u1,oo[kt]=u1-mi}m.modifiersData[S]=oo}}const bv={name:"preventOverflow",enabled:!0,phase:"main",fn:TA,requiresIfExists:["offset"]};function NA(I){return{scrollLeft:I.scrollLeft,scrollTop:I.scrollTop}}function AA(I){return I===Ns(I)||!As(I)?rm(I):NA(I)}function RA(I){var m=I.getBoundingClientRect(),C=va(m.width)/I.offsetWidth||1,S=va(m.height)/I.offsetHeight||1;return C!==1||S!==1}function DA(I,m,C){C===void 0&&(C=!1);var S=As(m),O=As(m)&&RA(m),Z=mr(m),ee=wa(I,O,C),ue={scrollLeft:0,scrollTop:0},ve={x:0,y:0};return(S||!S&&!C)&&((Co(m)!=="body"||am(Z))&&(ue=AA(m)),As(m)?(ve=wa(m,!0),ve.x+=m.clientLeft,ve.y+=m.clientTop):Z&&(ve.x=im(Z))),{x:ee.left+ue.scrollLeft-ve.x,y:ee.top+ue.scrollTop-ve.y,width:ee.width,height:ee.height}}function OA(I){var m=new Map,C=new Set,S=[];I.forEach(function(Z){m.set(Z.name,Z)});function O(Z){C.add(Z.name);var ee=[].concat(Z.requires||[],Z.requiresIfExists||[]);ee.forEach(function(ue){if(!C.has(ue)){var ve=m.get(ue);ve&&O(ve)}}),S.push(Z)}return I.forEach(function(Z){C.has(Z.name)||O(Z)}),S}function FA(I){var m=OA(I);return J0.reduce(function(C,S){return C.concat(m.filter(function(O){return O.phase===S}))},[])}function LA(I){var m;return function(){return m||(m=new Promise(function(C){Promise.resolve().then(function(){m=void 0,C(I())})})),m}}function PA(I){var m=I.reduce(function(C,S){var O=C[S.name];return C[S.name]=O?Object.assign({},O,S,{options:Object.assign({},O.options,S.options),data:Object.assign({},O.data,S.data)}):S,C},{});return Object.keys(m).map(function(C){return m[C]})}var xv={placement:"bottom",modifiers:[],strategy:"absolute"};function yv(){for(var I=arguments.length,m=new Array(I),C=0;C<I;C++)m[C]=arguments[C];return!m.some(function(S){return!(S&&typeof S.getBoundingClientRect=="function")})}function gh(I){I===void 0&&(I={});var m=I,C=m.defaultModifiers,S=C===void 0?[]:C,O=m.defaultOptions,Z=O===void 0?xv:O;return function(ue,ve,Be){Be===void 0&&(Be=Z);var Ce={placement:"bottom",orderedModifiers:[],options:Object.assign({},xv,Z),modifiersData:{},elements:{reference:ue,popper:ve},attributes:{},styles:{}},et=[],it=!1,qe={state:Ce,setOptions:function(Bt){var Jt=typeof Bt=="function"?Bt(Ce.options):Bt;ot(),Ce.options=Object.assign({},Z,Ce.options,Jt),Ce.scrollParents={reference:oi(ue)?Wl(ue):ue.contextElement?Wl(ue.contextElement):[],popper:Wl(ve)};var en=FA(PA([].concat(S,Ce.options.modifiers)));return Ce.orderedModifiers=en.filter(function(at){return at.enabled}),Dt(),qe.update()},forceUpdate:function(){if(!it){var Bt=Ce.elements,Jt=Bt.reference,en=Bt.popper;if(!!yv(Jt,en)){Ce.rects={reference:DA(Jt,Vl(en),Ce.options.strategy==="fixed"),popper:tm(en)},Ce.reset=!1,Ce.placement=Ce.options.placement,Ce.orderedModifiers.forEach(function(hn){return Ce.modifiersData[hn.name]=Object.assign({},hn.data)});for(var at=0;at<Ce.orderedModifiers.length;at++){if(Ce.reset===!0){Ce.reset=!1,at=-1;continue}var kt=Ce.orderedModifiers[at],Et=kt.fn,qt=kt.options,Tn=qt===void 0?{}:qt,wn=kt.name;typeof Et=="function"&&(Ce=Et({state:Ce,options:Tn,name:wn,instance:qe})||Ce)}}}},update:LA(function(){return new Promise(function(mt){qe.forceUpdate(),mt(Ce)})}),destroy:function(){ot(),it=!0}};if(!yv(ue,ve))return qe;qe.setOptions(Be).then(function(mt){!it&&Be.onFirstUpdate&&Be.onFirstUpdate(mt)});function Dt(){Ce.orderedModifiers.forEach(function(mt){var Bt=mt.name,Jt=mt.options,en=Jt===void 0?{}:Jt,at=mt.effect;if(typeof at=="function"){var kt=at({state:Ce,name:Bt,instance:qe,options:en}),Et=function(){};et.push(kt||Et)}})}function ot(){et.forEach(function(mt){return mt()}),et=[]}return qe}}var MA=gh(),BA=[om,cm,sm,Jp],VA=gh({defaultModifiers:BA}),zA=[om,cm,sm,Jp,gv,dv,bv,iv,mv],um=gh({defaultModifiers:zA});const vv=Object.freeze(Object.defineProperty({__proto__:null,popperGenerator:gh,detectOverflow:$a,createPopperBase:MA,createPopper:um,createPopperLite:VA,top:qn,bottom:xs,right:ys,left:Kn,auto:hh,basePlacements:ba,start:si,end:xa,clippingParents:W0,viewport:Xp,popper:ya,reference:U0,variationPlacements:Yp,placements:Zp,beforeRead:H0,read:G0,afterRead:j0,beforeMain:q0,main:K0,afterMain:X0,beforeWrite:Y0,write:Z0,afterWrite:Q0,modifierPhases:J0,applyStyles:Jp,arrow:iv,computeStyles:sm,eventListeners:om,flip:dv,hide:mv,offset:gv,popperOffsets:cm,preventOverflow:bv},Symbol.toStringTag,{value:"Module"})),wv="dropdown",ii=".bs.dropdown",hm=".data-api",WA="Escape",Cv="Tab",UA="ArrowUp",$v="ArrowDown",HA=2,GA=`hide${ii}`,jA=`hidden${ii}`,qA=`show${ii}`,KA=`shown${ii}`,Iv=`click${ii}${hm}`,_v=`keydown${ii}${hm}`,XA=`keyup${ii}${hm}`,Ia="show",YA="dropup",ZA="dropend",QA="dropstart",JA="dropup-center",eR="dropdown-center",_a='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',tR=`${_a}.${Ia}`,dm=".dropdown-menu",nR=".navbar",sR=".navbar-nav",oR=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",rR=_()?"top-end":"top-start",iR=_()?"top-start":"top-end",aR=_()?"bottom-end":"bottom-start",lR=_()?"bottom-start":"bottom-end",cR=_()?"left-start":"right-start",uR=_()?"right-start":"left-start",hR="top",dR="bottom",fR={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},pR={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class no extends re{constructor(m,C){super(m,C),this._popper=null,this._parent=this._element.parentNode,this._menu=Qe.next(this._element,dm)[0]||Qe.prev(this._element,dm)[0],this._inNavbar=this._detectNavbar()}static get Default(){return fR}static get DefaultType(){return pR}static get NAME(){return wv}toggle(){return this._isShown()?this.hide():this.show()}show(){if(g(this._element)||this._isShown())return;const m={relatedTarget:this._element};if(!B.trigger(this._element,qA,m).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(sR))for(const S of[].concat(...document.body.children))B.on(S,"mouseover",x);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(Ia),this._element.classList.add(Ia),B.trigger(this._element,KA,m)}}hide(){if(g(this._element)||!this._isShown())return;const m={relatedTarget:this._element};this._completeHide(m)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(m){if(!B.trigger(this._element,GA,m).defaultPrevented){if("ontouchstart"in document.documentElement)for(const S of[].concat(...document.body.children))B.off(S,"mouseover",x);this._popper&&this._popper.destroy(),this._menu.classList.remove(Ia),this._element.classList.remove(Ia),this._element.setAttribute("aria-expanded","false"),P.removeDataAttribute(this._menu,"popper"),B.trigger(this._element,jA,m)}}_getConfig(m){if(m=super._getConfig(m),typeof m.reference=="object"&&!d(m.reference)&&typeof m.reference.getBoundingClientRect!="function")throw new TypeError(`${wv.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return m}_createPopper(){if(typeof vv>"u")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org)");let m=this._element;this._config.reference==="parent"?m=this._parent:d(this._config.reference)?m=f(this._config.reference):typeof this._config.reference=="object"&&(m=this._config.reference);const C=this._getPopperConfig();this._popper=um(m,this._menu,C)}_isShown(){return this._menu.classList.contains(Ia)}_getPlacement(){const m=this._parent;if(m.classList.contains(ZA))return cR;if(m.classList.contains(QA))return uR;if(m.classList.contains(JA))return hR;if(m.classList.contains(eR))return dR;const C=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return m.classList.contains(YA)?C?iR:rR:C?lR:aR}_detectNavbar(){return this._element.closest(nR)!==null}_getOffset(){const{offset:m}=this._config;return typeof m=="string"?m.split(",").map(C=>Number.parseInt(C,10)):typeof m=="function"?C=>m(C,this._element):m}_getPopperConfig(){const m={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(P.setDataAttribute(this._menu,"popper","static"),m.modifiers=[{name:"applyStyles",enabled:!1}]),{...m,...typeof this._config.popperConfig=="function"?this._config.popperConfig(m):this._config.popperConfig}}_selectMenuItem({key:m,target:C}){const S=Qe.find(oR,this._menu).filter(O=>p(O));!S.length||A(S,C,m===$v,!S.includes(C)).focus()}static jQueryInterface(m){return this.each(function(){const C=no.getOrCreateInstance(this,m);if(typeof m=="string"){if(typeof C[m]>"u")throw new TypeError(`No method named "${m}"`);C[m]()}})}static clearMenus(m){if(m.button===HA||m.type==="keyup"&&m.key!==Cv)return;const C=Qe.find(tR);for(const S of C){const O=no.getInstance(S);if(!O||O._config.autoClose===!1)continue;const Z=m.composedPath(),ee=Z.includes(O._menu);if(Z.includes(O._element)||O._config.autoClose==="inside"&&!ee||O._config.autoClose==="outside"&&ee||O._menu.contains(m.target)&&(m.type==="keyup"&&m.key===Cv||/input|select|option|textarea|form/i.test(m.target.tagName)))continue;const ue={relatedTarget:O._element};m.type==="click"&&(ue.clickEvent=m),O._completeHide(ue)}}static dataApiKeydownHandler(m){const C=/input|textarea/i.test(m.target.tagName),S=m.key===WA,O=[UA,$v].includes(m.key);if(!O&&!S||C&&!S)return;m.preventDefault();const Z=this.matches(_a)?this:Qe.prev(this,_a)[0]||Qe.next(this,_a)[0],ee=no.getOrCreateInstance(Z);if(O){m.stopPropagation(),ee.show(),ee._selectMenuItem(m);return}ee._isShown()&&(m.stopPropagation(),ee.hide(),Z.focus())}}B.on(document,_v,_a,no.dataApiKeydownHandler),B.on(document,_v,dm,no.dataApiKeydownHandler),B.on(document,Iv,no.clearMenus),B.on(document,XA,no.clearMenus),B.on(document,Iv,_a,function(I){I.preventDefault(),no.getOrCreateInstance(this).toggle()}),E(no);const kv=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",Ev=".sticky-top",bh="padding-right",Sv="margin-right";class fm{constructor(){this._element=document.body}getWidth(){const m=document.documentElement.clientWidth;return Math.abs(window.innerWidth-m)}hide(){const m=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,bh,C=>C+m),this._setElementAttributes(kv,bh,C=>C+m),this._setElementAttributes(Ev,Sv,C=>C-m)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,bh),this._resetElementAttributes(kv,bh),this._resetElementAttributes(Ev,Sv)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(m,C,S){const O=this.getWidth(),Z=ee=>{if(ee!==this._element&&window.innerWidth>ee.clientWidth+O)return;this._saveInitialAttribute(ee,C);const ue=window.getComputedStyle(ee).getPropertyValue(C);ee.style.setProperty(C,`${S(Number.parseFloat(ue))}px`)};this._applyManipulationCallback(m,Z)}_saveInitialAttribute(m,C){const S=m.style.getPropertyValue(C);S&&P.setDataAttribute(m,C,S)}_resetElementAttributes(m,C){const S=O=>{const Z=P.getDataAttribute(O,C);if(Z===null){O.style.removeProperty(C);return}P.removeDataAttribute(O,C),O.style.setProperty(C,Z)};this._applyManipulationCallback(m,S)}_applyManipulationCallback(m,C){if(d(m)){C(m);return}for(const S of Qe.find(m,this._element))C(S)}}const Tv="backdrop",mR="fade",Nv="show",Av=`mousedown.bs.${Tv}`,gR={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},bR={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class Rv extends X{constructor(m){super(),this._config=this._getConfig(m),this._isAppended=!1,this._element=null}static get Default(){return gR}static get DefaultType(){return bR}static get NAME(){return Tv}show(m){if(!this._config.isVisible){k(m);return}this._append();const C=this._getElement();this._config.isAnimated&&y(C),C.classList.add(Nv),this._emulateAnimation(()=>{k(m)})}hide(m){if(!this._config.isVisible){k(m);return}this._getElement().classList.remove(Nv),this._emulateAnimation(()=>{this.dispose(),k(m)})}dispose(){!this._isAppended||(B.off(this._element,Av),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const m=document.createElement("div");m.className=this._config.className,this._config.isAnimated&&m.classList.add(mR),this._element=m}return this._element}_configAfterMerge(m){return m.rootElement=f(m.rootElement),m}_append(){if(this._isAppended)return;const m=this._getElement();this._config.rootElement.append(m),B.on(m,Av,()=>{k(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(m){N(m,this._getElement(),this._config.isAnimated)}}const xR="focustrap",xh=".bs.focustrap",yR=`focusin${xh}`,vR=`keydown.tab${xh}`,wR="Tab",CR="forward",Dv="backward",$R={autofocus:!0,trapElement:null},IR={autofocus:"boolean",trapElement:"element"};class Ov extends X{constructor(m){super(),this._config=this._getConfig(m),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return $R}static get DefaultType(){return IR}static get NAME(){return xR}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),B.off(document,xh),B.on(document,yR,m=>this._handleFocusin(m)),B.on(document,vR,m=>this._handleKeydown(m)),this._isActive=!0)}deactivate(){!this._isActive||(this._isActive=!1,B.off(document,xh))}_handleFocusin(m){const{trapElement:C}=this._config;if(m.target===document||m.target===C||C.contains(m.target))return;const S=Qe.focusableChildren(C);S.length===0?C.focus():this._lastTabNavDirection===Dv?S[S.length-1].focus():S[0].focus()}_handleKeydown(m){m.key===wR&&(this._lastTabNavDirection=m.shiftKey?Dv:CR)}}const _R="modal",so=".bs.modal",kR=".data-api",ER="Escape",SR=`hide${so}`,TR=`hidePrevented${so}`,Fv=`hidden${so}`,Lv=`show${so}`,NR=`shown${so}`,AR=`resize${so}`,RR=`click.dismiss${so}`,DR=`mousedown.dismiss${so}`,OR=`keydown.dismiss${so}`,FR=`click${so}${kR}`,Pv="modal-open",LR="fade",Mv="show",pm="modal-static",PR=".modal.show",MR=".modal-dialog",BR=".modal-body",VR='[data-bs-toggle="modal"]',zR={backdrop:!0,focus:!0,keyboard:!0},WR={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class ai extends re{constructor(m,C){super(m,C),this._dialog=Qe.findOne(MR,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new fm,this._addEventListeners()}static get Default(){return zR}static get DefaultType(){return WR}static get NAME(){return _R}toggle(m){return this._isShown?this.hide():this.show(m)}show(m){this._isShown||this._isTransitioning||B.trigger(this._element,Lv,{relatedTarget:m}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(Pv),this._adjustDialog(),this._backdrop.show(()=>this._showElement(m)))}hide(){!this._isShown||this._isTransitioning||B.trigger(this._element,SR).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(Mv),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){for(const m of[window,this._dialog])B.off(m,so);this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new Rv({isVisible:Boolean(this._config.backdrop),isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new Ov({trapElement:this._element})}_showElement(m){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const C=Qe.findOne(BR,this._dialog);C&&(C.scrollTop=0),y(this._element),this._element.classList.add(Mv);const S=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,B.trigger(this._element,NR,{relatedTarget:m})};this._queueCallback(S,this._dialog,this._isAnimated())}_addEventListeners(){B.on(this._element,OR,m=>{if(m.key===ER){if(this._config.keyboard){m.preventDefault(),this.hide();return}this._triggerBackdropTransition()}}),B.on(window,AR,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),B.on(this._element,DR,m=>{B.one(this._element,RR,C=>{if(!(this._dialog.contains(m.target)||this._dialog.contains(C.target))){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(Pv),this._resetAdjustments(),this._scrollBar.reset(),B.trigger(this._element,Fv)})}_isAnimated(){return this._element.classList.contains(LR)}_triggerBackdropTransition(){if(B.trigger(this._element,TR).defaultPrevented)return;const C=this._element.scrollHeight>document.documentElement.clientHeight,S=this._element.style.overflowY;S==="hidden"||this._element.classList.contains(pm)||(C||(this._element.style.overflowY="hidden"),this._element.classList.add(pm),this._queueCallback(()=>{this._element.classList.remove(pm),this._queueCallback(()=>{this._element.style.overflowY=S},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const m=this._element.scrollHeight>document.documentElement.clientHeight,C=this._scrollBar.getWidth(),S=C>0;if(S&&!m){const O=_()?"paddingLeft":"paddingRight";this._element.style[O]=`${C}px`}if(!S&&m){const O=_()?"paddingRight":"paddingLeft";this._element.style[O]=`${C}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(m,C){return this.each(function(){const S=ai.getOrCreateInstance(this,m);if(typeof m=="string"){if(typeof S[m]>"u")throw new TypeError(`No method named "${m}"`);S[m](C)}})}}B.on(document,FR,VR,function(I){const m=c(this);["A","AREA"].includes(this.tagName)&&I.preventDefault(),B.one(m,Lv,O=>{O.defaultPrevented||B.one(m,Fv,()=>{p(this)&&this.focus()})});const C=Qe.findOne(PR);C&&ai.getInstance(C).hide(),ai.getOrCreateInstance(m).toggle(this)}),de(ai),E(ai);const UR="offcanvas",Ko=".bs.offcanvas",Bv=".data-api",HR=`load${Ko}${Bv}`,GR="Escape",Vv="show",zv="showing",Wv="hiding",jR="offcanvas-backdrop",Uv=".offcanvas.show",qR=`show${Ko}`,KR=`shown${Ko}`,XR=`hide${Ko}`,Hv=`hidePrevented${Ko}`,Gv=`hidden${Ko}`,YR=`resize${Ko}`,ZR=`click${Ko}${Bv}`,QR=`keydown.dismiss${Ko}`,JR='[data-bs-toggle="offcanvas"]',eD={backdrop:!0,keyboard:!0,scroll:!1},tD={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class Xo extends re{constructor(m,C){super(m,C),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return eD}static get DefaultType(){return tD}static get NAME(){return UR}toggle(m){return this._isShown?this.hide():this.show(m)}show(m){if(this._isShown||B.trigger(this._element,qR,{relatedTarget:m}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||new fm().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(zv);const S=()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add(Vv),this._element.classList.remove(zv),B.trigger(this._element,KR,{relatedTarget:m})};this._queueCallback(S,this._element,!0)}hide(){if(!this._isShown||B.trigger(this._element,XR).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(Wv),this._backdrop.hide();const C=()=>{this._element.classList.remove(Vv,Wv),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new fm().reset(),B.trigger(this._element,Gv)};this._queueCallback(C,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const m=()=>{if(this._config.backdrop==="static"){B.trigger(this._element,Hv);return}this.hide()},C=Boolean(this._config.backdrop);return new Rv({className:jR,isVisible:C,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:C?m:null})}_initializeFocusTrap(){return new Ov({trapElement:this._element})}_addEventListeners(){B.on(this._element,QR,m=>{if(m.key===GR){if(!this._config.keyboard){B.trigger(this._element,Hv);return}this.hide()}})}static jQueryInterface(m){return this.each(function(){const C=Xo.getOrCreateInstance(this,m);if(typeof m=="string"){if(C[m]===void 0||m.startsWith("_")||m==="constructor")throw new TypeError(`No method named "${m}"`);C[m](this)}})}}B.on(document,ZR,JR,function(I){const m=c(this);if(["A","AREA"].includes(this.tagName)&&I.preventDefault(),g(this))return;B.one(m,Gv,()=>{p(this)&&this.focus()});const C=Qe.findOne(Uv);C&&C!==m&&Xo.getInstance(C).hide(),Xo.getOrCreateInstance(m).toggle(this)}),B.on(window,HR,()=>{for(const I of Qe.find(Uv))Xo.getOrCreateInstance(I).show()}),B.on(window,YR,()=>{for(const I of Qe.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(I).position!=="fixed"&&Xo.getOrCreateInstance(I).hide()}),de(Xo),E(Xo);const nD=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),sD=/^aria-[\w-]*$/i,oD=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^#&/:?]*(?:[#/?]|$))/i,rD=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[\d+/a-z]+=*$/i,iD=(I,m)=>{const C=I.nodeName.toLowerCase();return m.includes(C)?nD.has(C)?Boolean(oD.test(I.nodeValue)||rD.test(I.nodeValue)):!0:m.filter(S=>S instanceof RegExp).some(S=>S.test(C))},jv={"*":["class","dir","id","lang","role",sD],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]};function aD(I,m,C){if(!I.length)return I;if(C&&typeof C=="function")return C(I);const O=new window.DOMParser().parseFromString(I,"text/html"),Z=[].concat(...O.body.querySelectorAll("*"));for(const ee of Z){const ue=ee.nodeName.toLowerCase();if(!Object.keys(m).includes(ue)){ee.remove();continue}const ve=[].concat(...ee.attributes),Be=[].concat(m["*"]||[],m[ue]||[]);for(const Ce of ve)iD(Ce,Be)||ee.removeAttribute(Ce.nodeName)}return O.body.innerHTML}const lD="TemplateFactory",cD={allowList:jv,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},uD={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},hD={entry:"(string|element|function|null)",selector:"(string|element)"};class dD extends X{constructor(m){super(),this._config=this._getConfig(m)}static get Default(){return cD}static get DefaultType(){return uD}static get NAME(){return lD}getContent(){return Object.values(this._config.content).map(m=>this._resolvePossibleFunction(m)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(m){return this._checkContent(m),this._config.content={...this._config.content,...m},this}toHtml(){const m=document.createElement("div");m.innerHTML=this._maybeSanitize(this._config.template);for(const[O,Z]of Object.entries(this._config.content))this._setContent(m,Z,O);const C=m.children[0],S=this._resolvePossibleFunction(this._config.extraClass);return S&&C.classList.add(...S.split(" ")),C}_typeCheckConfig(m){super._typeCheckConfig(m),this._checkContent(m.content)}_checkContent(m){for(const[C,S]of Object.entries(m))super._typeCheckConfig({selector:C,entry:S},hD)}_setContent(m,C,S){const O=Qe.findOne(S,m);if(!!O){if(C=this._resolvePossibleFunction(C),!C){O.remove();return}if(d(C)){this._putElementInTemplate(f(C),O);return}if(this._config.html){O.innerHTML=this._maybeSanitize(C);return}O.textContent=C}}_maybeSanitize(m){return this._config.sanitize?aD(m,this._config.allowList,this._config.sanitizeFn):m}_resolvePossibleFunction(m){return typeof m=="function"?m(this):m}_putElementInTemplate(m,C){if(this._config.html){C.innerHTML="",C.append(m);return}C.textContent=m.textContent}}const fD="tooltip",pD=new Set(["sanitize","allowList","sanitizeFn"]),mm="fade",mD="modal",yh="show",gD=".tooltip-inner",qv=`.${mD}`,Kv="hide.bs.modal",Ul="hover",gm="focus",bD="click",xD="manual",yD="hide",vD="hidden",wD="show",CD="shown",$D="inserted",ID="click",_D="focusin",kD="focusout",ED="mouseenter",SD="mouseleave",TD={AUTO:"auto",TOP:"top",RIGHT:_()?"left":"right",BOTTOM:"bottom",LEFT:_()?"right":"left"},ND={allowList:jv,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,0],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},AD={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class li extends re{constructor(m,C){if(typeof vv>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org)");super(m,C),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners()}static get Default(){return ND}static get DefaultType(){return AD}static get NAME(){return fD}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(m){if(!!this._isEnabled){if(m){const C=this._initializeOnDelegatedTarget(m);C._activeTrigger.click=!C._activeTrigger.click,C._isWithActiveTrigger()?C._enter():C._leave();return}if(this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),B.off(this._element.closest(qv),Kv,this._hideModalHandler),this.tip&&this.tip.remove(),this._config.originalTitle&&this._element.setAttribute("title",this._config.originalTitle),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;const m=B.trigger(this._element,this.constructor.eventName(wD)),S=(b(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(m.defaultPrevented||!S)return;this.tip&&(this.tip.remove(),this.tip=null);const O=this._getTipElement();this._element.setAttribute("aria-describedby",O.getAttribute("id"));const{container:Z}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(Z.append(O),B.trigger(this._element,this.constructor.eventName($D))),this._popper?this._popper.update():this._popper=this._createPopper(O),O.classList.add(yh),"ontouchstart"in document.documentElement)for(const ue of[].concat(...document.body.children))B.on(ue,"mouseover",x);const ee=()=>{B.trigger(this._element,this.constructor.eventName(CD)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(ee,this.tip,this._isAnimated())}hide(){if(!this._isShown()||B.trigger(this._element,this.constructor.eventName(yD)).defaultPrevented)return;const C=this._getTipElement();if(C.classList.remove(yh),"ontouchstart"in document.documentElement)for(const O of[].concat(...document.body.children))B.off(O,"mouseover",x);this._activeTrigger[bD]=!1,this._activeTrigger[gm]=!1,this._activeTrigger[Ul]=!1,this._isHovered=null;const S=()=>{this._isWithActiveTrigger()||(this._isHovered||C.remove(),this._element.removeAttribute("aria-describedby"),B.trigger(this._element,this.constructor.eventName(vD)),this._disposePopper())};this._queueCallback(S,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return Boolean(this._getTitle())}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(m){const C=this._getTemplateFactory(m).toHtml();if(!C)return null;C.classList.remove(mm,yh),C.classList.add(`bs-${this.constructor.NAME}-auto`);const S=i(this.constructor.NAME).toString();return C.setAttribute("id",S),this._isAnimated()&&C.classList.add(mm),C}setContent(m){this._newContent=m,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(m){return this._templateFactory?this._templateFactory.changeContent(m):this._templateFactory=new dD({...this._config,content:m,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[gD]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._config.originalTitle}_initializeOnDelegatedTarget(m){return this.constructor.getOrCreateInstance(m.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(mm)}_isShown(){return this.tip&&this.tip.classList.contains(yh)}_createPopper(m){const C=typeof this._config.placement=="function"?this._config.placement.call(this,m,this._element):this._config.placement,S=TD[C.toUpperCase()];return um(this._element,m,this._getPopperConfig(S))}_getOffset(){const{offset:m}=this._config;return typeof m=="string"?m.split(",").map(C=>Number.parseInt(C,10)):typeof m=="function"?C=>m(C,this._element):m}_resolvePossibleFunction(m){return typeof m=="function"?m.call(this._element):m}_getPopperConfig(m){const C={placement:m,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:S=>{this._getTipElement().setAttribute("data-popper-placement",S.state.placement)}}]};return{...C,...typeof this._config.popperConfig=="function"?this._config.popperConfig(C):this._config.popperConfig}}_setListeners(){const m=this._config.trigger.split(" ");for(const C of m)if(C==="click")B.on(this._element,this.constructor.eventName(ID),this._config.selector,S=>this.toggle(S));else if(C!==xD){const S=C===Ul?this.constructor.eventName(ED):this.constructor.eventName(_D),O=C===Ul?this.constructor.eventName(SD):this.constructor.eventName(kD);B.on(this._element,S,this._config.selector,Z=>{const ee=this._initializeOnDelegatedTarget(Z);ee._activeTrigger[Z.type==="focusin"?gm:Ul]=!0,ee._enter()}),B.on(this._element,O,this._config.selector,Z=>{const ee=this._initializeOnDelegatedTarget(Z);ee._activeTrigger[Z.type==="focusout"?gm:Ul]=ee._element.contains(Z.relatedTarget),ee._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},B.on(this._element.closest(qv),Kv,this._hideModalHandler),this._config.selector?this._config={...this._config,trigger:"manual",selector:""}:this._fixTitle()}_fixTitle(){const m=this._config.originalTitle;!m||(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",m),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(m,C){clearTimeout(this._timeout),this._timeout=setTimeout(m,C)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(m){const C=P.getDataAttributes(this._element);for(const S of Object.keys(C))pD.has(S)&&delete C[S];return m={...C,...typeof m=="object"&&m?m:{}},m=this._mergeConfigObj(m),m=this._configAfterMerge(m),this._typeCheckConfig(m),m}_configAfterMerge(m){return m.container=m.container===!1?document.body:f(m.container),typeof m.delay=="number"&&(m.delay={show:m.delay,hide:m.delay}),m.originalTitle=this._element.getAttribute("title")||"",typeof m.title=="number"&&(m.title=m.title.toString()),typeof m.content=="number"&&(m.content=m.content.toString()),m}_getDelegateConfig(){const m={};for(const C in this._config)this.constructor.Default[C]!==this._config[C]&&(m[C]=this._config[C]);return m}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null)}static jQueryInterface(m){return this.each(function(){const C=li.getOrCreateInstance(this,m);if(typeof m=="string"){if(typeof C[m]>"u")throw new TypeError(`No method named "${m}"`);C[m]()}})}}E(li);const RD="popover",DD=".popover-header",OD=".popover-body",FD={...li.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},LD={...li.DefaultType,content:"(null|string|element|function)"};class vh extends li{static get Default(){return FD}static get DefaultType(){return LD}static get NAME(){return RD}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[DD]:this._getTitle(),[OD]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(m){return this.each(function(){const C=vh.getOrCreateInstance(this,m);if(typeof m=="string"){if(typeof C[m]>"u")throw new TypeError(`No method named "${m}"`);C[m]()}})}}E(vh);const PD="scrollspy",bm=".bs.scrollspy",MD=".data-api",BD=`activate${bm}`,Xv=`click${bm}`,VD=`load${bm}${MD}`,zD="dropdown-item",ka="active",WD='[data-bs-spy="scroll"]',xm="[href]",UD=".nav, .list-group",Yv=".nav-link",HD=`${Yv}, .nav-item > ${Yv}, .list-group-item`,GD=".dropdown",jD=".dropdown-toggle",qD={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},KD={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class Hl extends re{constructor(m,C){super(m,C),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return qD}static get DefaultType(){return KD}static get NAME(){return PD}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const m of this._observableSections.values())this._observer.observe(m)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(m){return m.target=f(m.target)||document.body,m.rootMargin=m.offset?`${m.offset}px 0px -30%`:m.rootMargin,typeof m.threshold=="string"&&(m.threshold=m.threshold.split(",").map(C=>Number.parseFloat(C))),m}_maybeEnableSmoothScroll(){!this._config.smoothScroll||(B.off(this._config.target,Xv),B.on(this._config.target,Xv,xm,m=>{const C=this._observableSections.get(m.target.hash);if(C){m.preventDefault();const S=this._rootElement||window,O=C.offsetTop-this._element.offsetTop;if(S.scrollTo){S.scrollTo({top:O,behavior:"smooth"});return}S.scrollTop=O}}))}_getNewObserver(){const m={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(C=>this._observerCallback(C),m)}_observerCallback(m){const C=ee=>this._targetLinks.get(`#${ee.target.id}`),S=ee=>{this._previousScrollData.visibleEntryTop=ee.target.offsetTop,this._process(C(ee))},O=(this._rootElement||document.documentElement).scrollTop,Z=O>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=O;for(const ee of m){if(!ee.isIntersecting){this._activeTarget=null,this._clearActiveClass(C(ee));continue}const ue=ee.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(Z&&ue){if(S(ee),!O)return;continue}!Z&&!ue&&S(ee)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const m=Qe.find(xm,this._config.target);for(const C of m){if(!C.hash||g(C))continue;const S=Qe.findOne(C.hash,this._element);p(S)&&(this._targetLinks.set(C.hash,C),this._observableSections.set(C.hash,S))}}_process(m){this._activeTarget!==m&&(this._clearActiveClass(this._config.target),this._activeTarget=m,m.classList.add(ka),this._activateParents(m),B.trigger(this._element,BD,{relatedTarget:m}))}_activateParents(m){if(m.classList.contains(zD)){Qe.findOne(jD,m.closest(GD)).classList.add(ka);return}for(const C of Qe.parents(m,UD))for(const S of Qe.prev(C,HD))S.classList.add(ka)}_clearActiveClass(m){m.classList.remove(ka);const C=Qe.find(`${xm}.${ka}`,m);for(const S of C)S.classList.remove(ka)}static jQueryInterface(m){return this.each(function(){const C=Hl.getOrCreateInstance(this,m);if(typeof m=="string"){if(C[m]===void 0||m.startsWith("_")||m==="constructor")throw new TypeError(`No method named "${m}"`);C[m]()}})}}B.on(window,VD,()=>{for(const I of Qe.find(WD))Hl.getOrCreateInstance(I)}),E(Hl);const XD="tab",ci=".bs.tab",YD=`hide${ci}`,ZD=`hidden${ci}`,QD=`show${ci}`,JD=`shown${ci}`,eO=`click${ci}`,tO=`keydown${ci}`,nO=`load${ci}`,sO="ArrowLeft",Zv="ArrowRight",oO="ArrowUp",Qv="ArrowDown",gr="active",Jv="fade",ym="show",rO="dropdown",iO=".dropdown-toggle",aO=".dropdown-menu",lO=".dropdown-item",vm=":not(.dropdown-toggle)",cO='.list-group, .nav, [role="tablist"]',uO=".nav-item, .list-group-item",hO=`.nav-link${vm}, .list-group-item${vm}, [role="tab"]${vm}`,e1='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',wm=`${hO}, ${e1}`,dO=`.${gr}[data-bs-toggle="tab"], .${gr}[data-bs-toggle="pill"], .${gr}[data-bs-toggle="list"]`;class ui extends re{constructor(m){super(m),this._parent=this._element.closest(cO),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),B.on(this._element,tO,C=>this._keydown(C)))}static get NAME(){return XD}show(){const m=this._element;if(this._elemIsActive(m))return;const C=this._getActiveElem(),S=C?B.trigger(C,YD,{relatedTarget:m}):null;B.trigger(m,QD,{relatedTarget:C}).defaultPrevented||S&&S.defaultPrevented||(this._deactivate(C,m),this._activate(m,C))}_activate(m,C){if(!m)return;m.classList.add(gr),this._activate(c(m));const S=()=>{if(m.getAttribute("role")!=="tab"){m.classList.add(ym);return}m.focus(),m.removeAttribute("tabindex"),m.setAttribute("aria-selected",!0),this._toggleDropDown(m,!0),B.trigger(m,JD,{relatedTarget:C})};this._queueCallback(S,m,m.classList.contains(Jv))}_deactivate(m,C){if(!m)return;m.classList.remove(gr),m.blur(),this._deactivate(c(m));const S=()=>{if(m.getAttribute("role")!=="tab"){m.classList.remove(ym);return}m.setAttribute("aria-selected",!1),m.setAttribute("tabindex","-1"),this._toggleDropDown(m,!1),B.trigger(m,ZD,{relatedTarget:C})};this._queueCallback(S,m,m.classList.contains(Jv))}_keydown(m){if(![sO,Zv,oO,Qv].includes(m.key))return;m.stopPropagation(),m.preventDefault();const C=[Zv,Qv].includes(m.key),S=A(this._getChildren().filter(O=>!g(O)),m.target,C,!0);S&&ui.getOrCreateInstance(S).show()}_getChildren(){return Qe.find(wm,this._parent)}_getActiveElem(){return this._getChildren().find(m=>this._elemIsActive(m))||null}_setInitialAttributes(m,C){this._setAttributeIfNotExists(m,"role","tablist");for(const S of C)this._setInitialAttributesOnChild(S)}_setInitialAttributesOnChild(m){m=this._getInnerElement(m);const C=this._elemIsActive(m),S=this._getOuterElement(m);m.setAttribute("aria-selected",C),S!==m&&this._setAttributeIfNotExists(S,"role","presentation"),C||m.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(m,"role","tab"),this._setInitialAttributesOnTargetPanel(m)}_setInitialAttributesOnTargetPanel(m){const C=c(m);!C||(this._setAttributeIfNotExists(C,"role","tabpanel"),m.id&&this._setAttributeIfNotExists(C,"aria-labelledby",`#${m.id}`))}_toggleDropDown(m,C){const S=this._getOuterElement(m);if(!S.classList.contains(rO))return;const O=(Z,ee)=>{const ue=Qe.findOne(Z,S);ue&&ue.classList.toggle(ee,C)};O(iO,gr),O(aO,ym),O(lO,gr),S.setAttribute("aria-expanded",C)}_setAttributeIfNotExists(m,C,S){m.hasAttribute(C)||m.setAttribute(C,S)}_elemIsActive(m){return m.classList.contains(gr)}_getInnerElement(m){return m.matches(wm)?m:Qe.findOne(wm,m)}_getOuterElement(m){return m.closest(uO)||m}static jQueryInterface(m){return this.each(function(){const C=ui.getOrCreateInstance(this);if(typeof m=="string"){if(C[m]===void 0||m.startsWith("_")||m==="constructor")throw new TypeError(`No method named "${m}"`);C[m]()}})}}B.on(document,eO,e1,function(I){["A","AREA"].includes(this.tagName)&&I.preventDefault(),!g(this)&&ui.getOrCreateInstance(this).show()}),B.on(window,nO,()=>{for(const I of Qe.find(dO))ui.getOrCreateInstance(I)}),E(ui);const fO="toast",br=".bs.toast",pO=`mouseover${br}`,mO=`mouseout${br}`,gO=`focusin${br}`,bO=`focusout${br}`,xO=`hide${br}`,yO=`hidden${br}`,vO=`show${br}`,wO=`shown${br}`,CO="fade",t1="hide",wh="show",Ch="showing",$O={animation:"boolean",autohide:"boolean",delay:"number"},IO={animation:!0,autohide:!0,delay:5e3};class Gl extends re{constructor(m,C){super(m,C),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return IO}static get DefaultType(){return $O}static get NAME(){return fO}show(){if(B.trigger(this._element,vO).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(CO);const C=()=>{this._element.classList.remove(Ch),B.trigger(this._element,wO),this._maybeScheduleHide()};this._element.classList.remove(t1),y(this._element),this._element.classList.add(wh,Ch),this._queueCallback(C,this._element,this._config.animation)}hide(){if(!this.isShown()||B.trigger(this._element,xO).defaultPrevented)return;const C=()=>{this._element.classList.add(t1),this._element.classList.remove(Ch,wh),B.trigger(this._element,yO)};this._element.classList.add(Ch),this._queueCallback(C,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(wh),super.dispose()}isShown(){return this._element.classList.contains(wh)}_maybeScheduleHide(){!this._config.autohide||this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay))}_onInteraction(m,C){switch(m.type){case"mouseover":case"mouseout":this._hasMouseInteraction=C;break;case"focusin":case"focusout":this._hasKeyboardInteraction=C;break}if(C){this._clearTimeout();return}const S=m.relatedTarget;this._element===S||this._element.contains(S)||this._maybeScheduleHide()}_setListeners(){B.on(this._element,pO,m=>this._onInteraction(m,!0)),B.on(this._element,mO,m=>this._onInteraction(m,!1)),B.on(this._element,gO,m=>this._onInteraction(m,!0)),B.on(this._element,bO,m=>this._onInteraction(m,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(m){return this.each(function(){const C=Gl.getOrCreateInstance(this,m);if(typeof m=="string"){if(typeof C[m]>"u")throw new TypeError(`No method named "${m}"`);C[m](this)}})}}return de(Gl),E(Gl),{Alert:Ve,Button:bs,Carousel:pa,Collapse:ga,Dropdown:no,Modal:ai,Offcanvas:Xo,Popover:vh,ScrollSpy:Hl,Tab:ui,Toast:Gl,Tooltip:li}})})(i2);const The=i2.exports,Nhe=Cl(t=>{t.provide("bootstrap",The)}),Ahe=[L3,j3,cB,Ehe,She,Nhe],t$={__name:"nuxt-root",setup(t){const e=dg(()=>tr(()=>import("./error-component.aeff44e8.js"),[],import.meta.url).then(r=>r.default||r)),n=Fn(),s=()=>n.callHook("app:suspense:resolve");Oi("_route",DI()),n.hooks.callHookWith(r=>r.map(i=>i()),"vue:setup");const o=lf();return G$((r,i,a)=>{n.hooks.callHook("vue:error",r,i,a).catch(l=>console.error("[nuxt] Error in `vue:error` hook",l)),g3(r)&&(r.fatal||r.unhandled)&&_r(n,ec,[r])}),(r,i)=>{const a=js("App");return pt(),Li(L$,{onResolve:s},{default:Wi(()=>[ts(o)?(pt(),Li(ts(e),{key:0,error:ts(o)},null,8,["error"])):(pt(),Li(a,{key:1}))]),_:1})}}},n$={default:dg(()=>tr(()=>import("./default.8d81fca5.js"),["default.8d81fca5.js","default.82360714.css"],import.meta.url).then(t=>t.default||t)),error:dg(()=>tr(()=>import("./error.ae4cdf8f.js"),[],import.meta.url).then(t=>t.default||t))},Rhe=_t({props:{name:{type:[String,Boolean,Object],default:null}},setup(t,e){const n=DI();return()=>{var i,a,l;const s=(a=(i=bn(t.name)?t.name.value:t.name)!=null?i:n.meta.layout)!=null?a:"default",o=s&&s in n$,r=(l=n.meta.layoutTransition)!=null?l:rB;return Ag(sf,o&&r,{default:()=>Ag(n$[s],o,e.slots).default()}).default()}}}),Dhe={};function Ohe(t,e,n,s,o,r){const i=js("NuxtPage"),a=Rhe;return pt(),Li(a,null,{default:Wi(()=>[He(i)]),_:1})}const Fhe=rs(Dhe,[["render",Ohe]]);globalThis.$fetch||(globalThis.$fetch=GP.create({baseURL:qP()}));let s$;const Lhe=cM(Ahe);s$=async function(){var o;const n=Boolean((o=window.__NUXT__)==null?void 0:o.serverRendered)?sP(t$):nP(t$);n.component("App",Fhe);const s=iM({vueApp:n});s.hooks.hookOnce("app:suspense:resolve",()=>{s.isHydrating=!1});try{await lM(s,Lhe)}catch(r){await s.callHook("app:error",r),s.payload.error=s.payload.error||r}try{await s.hooks.callHook("app:created",n),await s.hooks.callHook("app:beforeMount",n),n.mount("#__nuxt"),await s.hooks.callHook("app:mounted",n),await Fb()}catch(r){await s.callHook("app:error",r),s.payload.error=s.payload.error||r}},s$().catch(t=>{console.error("Error while mounting app:",t)});export{tr as _,rs as a,Vt as b,Li as c,dg as d,He as e,O$ as f,yL as g,te as h,IB as i,mde as j,Jo as k,gde as l,OI as m,Xhe as n,pt as o,D$ as p,bde as q,js as r,_t as s,At as t,ts as u,JF as v,Wi as w,jb as x,Ro as y};
